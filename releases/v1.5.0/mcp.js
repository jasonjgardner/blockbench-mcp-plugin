/* v1.5.0 */
let process = requireNativeModule('process');var tF=Object.create;var{getPrototypeOf:sF,defineProperty:Z4,getOwnPropertyNames:eF}=Object;var QL=Object.prototype.hasOwnProperty;var PX=(Q,$,W)=>{W=Q!=null?tF(sF(Q)):{};let Y=$||!Q||!Q.__esModule?Z4(W,"default",{value:Q,enumerable:!0}):W;for(let X of eF(Q))if(!QL.call(Y,X))Z4(Y,X,{get:()=>Q[X],enumerable:!0});return Y};var b=(Q,$)=>()=>($||Q(($={exports:{}}).exports,$),$.exports);var C4=(Q,$)=>{for(var W in $)Z4(Q,W,{get:$[W],enumerable:!0,configurable:!0,set:(Y)=>$[W]=()=>Y})};var n9=b((H0)=>{Object.defineProperty(H0,"__esModule",{value:!0});H0.regexpCode=H0.getEsmExportName=H0.getProperty=H0.safeStringify=H0.stringify=H0.strConcat=H0.addCodeArg=H0.str=H0._=H0.nil=H0._Code=H0.Name=H0.IDENTIFIER=H0._CodeOrName=void 0;class v5{}H0._CodeOrName=v5;H0.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class m8 extends v5{constructor(Q){super();if(!H0.IDENTIFIER.test(Q))throw Error("CodeGen: name must be a valid identifier");this.str=Q}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}H0.Name=m8;class T1 extends v5{constructor(Q){super();this._items=typeof Q==="string"?[Q]:Q}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let Q=this._items[0];return Q===""||Q==='""'}get str(){var Q;return(Q=this._str)!==null&&Q!==void 0?Q:this._str=this._items.reduce(($,W)=>`${$}${W}`,"")}get names(){var Q;return(Q=this._names)!==null&&Q!==void 0?Q:this._names=this._items.reduce(($,W)=>{if(W instanceof m8)$[W.str]=($[W.str]||0)+1;return $},{})}}H0._Code=T1;H0.nil=new T1("");function MH(Q,...$){let W=[Q[0]],Y=0;while(Y<$.length)AY(W,$[Y]),W.push(Q[++Y]);return new T1(W)}H0._=MH;var UY=new T1("+");function jH(Q,...$){let W=[i9(Q[0])],Y=0;while(Y<$.length)W.push(UY),AY(W,$[Y]),W.push(UY,i9(Q[++Y]));return Qz(W),new T1(W)}H0.str=jH;function AY(Q,$){if($ instanceof T1)Q.push(...$._items);else if($ instanceof m8)Q.push($);else Q.push(Yz($))}H0.addCodeArg=AY;function Qz(Q){let $=1;while($<Q.length-1){if(Q[$]===UY){let W=$z(Q[$-1],Q[$+1]);if(W!==void 0){Q.splice($-1,3,W);continue}Q[$++]="+"}$++}}function $z(Q,$){if($==='""')return Q;if(Q==='""')return $;if(typeof Q=="string"){if($ instanceof m8||Q[Q.length-1]!=='"')return;if(typeof $!="string")return`${Q.slice(0,-1)}${$}"`;if($[0]==='"')return Q.slice(0,-1)+$.slice(1);return}if(typeof $=="string"&&$[0]==='"'&&!(Q instanceof m8))return`"${Q}${$.slice(1)}`;return}function Wz(Q,$){return $.emptyStr()?Q:Q.emptyStr()?$:jH`${Q}${$}`}H0.strConcat=Wz;function Yz(Q){return typeof Q=="number"||typeof Q=="boolean"||Q===null?Q:i9(Array.isArray(Q)?Q.join(","):Q)}function Xz(Q){return new T1(i9(Q))}H0.stringify=Xz;function i9(Q){return JSON.stringify(Q).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}H0.safeStringify=i9;function Jz(Q){return typeof Q=="string"&&H0.IDENTIFIER.test(Q)?new T1(`.${Q}`):MH`[${Q}]`}H0.getProperty=Jz;function Hz(Q){if(typeof Q=="string"&&H0.IDENTIFIER.test(Q))return new T1(`${Q}`);throw Error(`CodeGen: invalid export name: ${Q}, use explicit $id name mapping`)}H0.getEsmExportName=Hz;function Gz(Q){return new T1(Q.toString())}H0.regexpCode=Gz});var OY=b((H1)=>{Object.defineProperty(H1,"__esModule",{value:!0});H1.ValueScope=H1.ValueScopeName=H1.Scope=H1.varKinds=H1.UsedValueState=void 0;var J1=n9();class DH extends Error{constructor(Q){super(`CodeGen: "code" for ${Q} not defined`);this.value=Q.value}}var k5;(function(Q){Q[Q.Started=0]="Started",Q[Q.Completed=1]="Completed"})(k5||(H1.UsedValueState=k5={}));H1.varKinds={const:new J1.Name("const"),let:new J1.Name("let"),var:new J1.Name("var")};class zY{constructor({prefixes:Q,parent:$}={}){this._names={},this._prefixes=Q,this._parent=$}toName(Q){return Q instanceof J1.Name?Q:this.name(Q)}name(Q){return new J1.Name(this._newName(Q))}_newName(Q){let $=this._names[Q]||this._nameGroup(Q);return`${Q}${$.index++}`}_nameGroup(Q){var $,W;if(((W=($=this._parent)===null||$===void 0?void 0:$._prefixes)===null||W===void 0?void 0:W.has(Q))||this._prefixes&&!this._prefixes.has(Q))throw Error(`CodeGen: prefix "${Q}" is not allowed in this scope`);return this._names[Q]={prefix:Q,index:0}}}H1.Scope=zY;class wY extends J1.Name{constructor(Q,$){super($);this.prefix=Q}setValue(Q,{property:$,itemIndex:W}){this.value=Q,this.scopePath=J1._`.${new J1.Name($)}[${W}]`}}H1.ValueScopeName=wY;var Bz=J1._`\n`;class EH extends zY{constructor(Q){super(Q);this._values={},this._scope=Q.scope,this.opts={...Q,_n:Q.lines?Bz:J1.nil}}get(){return this._scope}name(Q){return new wY(Q,this._newName(Q))}value(Q,$){var W;if($.ref===void 0)throw Error("CodeGen: ref must be passed in value");let Y=this.toName(Q),{prefix:X}=Y,J=(W=$.key)!==null&&W!==void 0?W:$.ref,H=this._values[X];if(H){let K=H.get(J);if(K)return K}else H=this._values[X]=new Map;H.set(J,Y);let G=this._scope[X]||(this._scope[X]=[]),B=G.length;return G[B]=$.ref,Y.setValue($,{property:X,itemIndex:B}),Y}getValue(Q,$){let W=this._values[Q];if(!W)return;return W.get($)}scopeRefs(Q,$=this._values){return this._reduceValues($,(W)=>{if(W.scopePath===void 0)throw Error(`CodeGen: name "${W}" has no value`);return J1._`${Q}${W.scopePath}`})}scopeCode(Q=this._values,$,W){return this._reduceValues(Q,(Y)=>{if(Y.value===void 0)throw Error(`CodeGen: name "${Y}" has no value`);return Y.value.code},$,W)}_reduceValues(Q,$,W={},Y){let X=J1.nil;for(let J in Q){let H=Q[J];if(!H)continue;let G=W[J]=W[J]||new Map;H.forEach((B)=>{if(G.has(B))return;G.set(B,k5.Started);let K=$(B);if(K){let F=this.opts.es5?H1.varKinds.var:H1.varKinds.const;X=J1._`${X}${F} ${B} = ${K};${this.opts._n}`}else if(K=Y===null||Y===void 0?void 0:Y(B))X=J1._`${X}${K}${this.opts._n}`;else throw new DH(B);G.set(B,k5.Completed)})}return X}}H1.ValueScope=EH});var i=b((o)=>{Object.defineProperty(o,"__esModule",{value:!0});o.or=o.and=o.not=o.CodeGen=o.operators=o.varKinds=o.ValueScopeName=o.ValueScope=o.Scope=o.Name=o.regexpCode=o.stringify=o.getProperty=o.nil=o.strConcat=o.str=o._=void 0;var X0=n9(),_1=OY(),S6=n9();Object.defineProperty(o,"_",{enumerable:!0,get:function(){return S6._}});Object.defineProperty(o,"str",{enumerable:!0,get:function(){return S6.str}});Object.defineProperty(o,"strConcat",{enumerable:!0,get:function(){return S6.strConcat}});Object.defineProperty(o,"nil",{enumerable:!0,get:function(){return S6.nil}});Object.defineProperty(o,"getProperty",{enumerable:!0,get:function(){return S6.getProperty}});Object.defineProperty(o,"stringify",{enumerable:!0,get:function(){return S6.stringify}});Object.defineProperty(o,"regexpCode",{enumerable:!0,get:function(){return S6.regexpCode}});Object.defineProperty(o,"Name",{enumerable:!0,get:function(){return S6.Name}});var h5=OY();Object.defineProperty(o,"Scope",{enumerable:!0,get:function(){return h5.Scope}});Object.defineProperty(o,"ValueScope",{enumerable:!0,get:function(){return h5.ValueScope}});Object.defineProperty(o,"ValueScopeName",{enumerable:!0,get:function(){return h5.ValueScopeName}});Object.defineProperty(o,"varKinds",{enumerable:!0,get:function(){return h5.varKinds}});o.operators={GT:new X0._Code(">"),GTE:new X0._Code(">="),LT:new X0._Code("<"),LTE:new X0._Code("<="),EQ:new X0._Code("==="),NEQ:new X0._Code("!=="),NOT:new X0._Code("!"),OR:new X0._Code("||"),AND:new X0._Code("&&"),ADD:new X0._Code("+")};class Z6{optimizeNodes(){return this}optimizeNames(Q,$){return this}}class RH extends Z6{constructor(Q,$,W){super();this.varKind=Q,this.name=$,this.rhs=W}render({es5:Q,_n:$}){let W=Q?_1.varKinds.var:this.varKind,Y=this.rhs===void 0?"":` = ${this.rhs}`;return`${W} ${this.name}${Y};`+$}optimizeNames(Q,$){if(!Q[this.name.str])return;if(this.rhs)this.rhs=p8(this.rhs,Q,$);return this}get names(){return this.rhs instanceof X0._CodeOrName?this.rhs.names:{}}}class jY extends Z6{constructor(Q,$,W){super();this.lhs=Q,this.rhs=$,this.sideEffects=W}render({_n:Q}){return`${this.lhs} = ${this.rhs};`+Q}optimizeNames(Q,$){if(this.lhs instanceof X0.Name&&!Q[this.lhs.str]&&!this.sideEffects)return;return this.rhs=p8(this.rhs,Q,$),this}get names(){let Q=this.lhs instanceof X0.Name?{}:{...this.lhs.names};return g5(Q,this.rhs)}}class PH extends jY{constructor(Q,$,W,Y){super(Q,W,Y);this.op=$}render({_n:Q}){return`${this.lhs} ${this.op}= ${this.rhs};`+Q}}class IH extends Z6{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`${this.label}:`+Q}}class SH extends Z6{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`break${this.label?` ${this.label}`:""};`+Q}}class ZH extends Z6{constructor(Q){super();this.error=Q}render({_n:Q}){return`throw ${this.error};`+Q}get names(){return this.error.names}}class CH extends Z6{constructor(Q){super();this.code=Q}render({_n:Q}){return`${this.code};`+Q}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Q,$){return this.code=p8(this.code,Q,$),this}get names(){return this.code instanceof X0._CodeOrName?this.code.names:{}}}class f5 extends Z6{constructor(Q=[]){super();this.nodes=Q}render(Q){return this.nodes.reduce(($,W)=>$+W.render(Q),"")}optimizeNodes(){let{nodes:Q}=this,$=Q.length;while($--){let W=Q[$].optimizeNodes();if(Array.isArray(W))Q.splice($,1,...W);else if(W)Q[$]=W;else Q.splice($,1)}return Q.length>0?this:void 0}optimizeNames(Q,$){let{nodes:W}=this,Y=W.length;while(Y--){let X=W[Y];if(X.optimizeNames(Q,$))continue;Kz(Q,X.names),W.splice(Y,1)}return W.length>0?this:void 0}get names(){return this.nodes.reduce((Q,$)=>e6(Q,$.names),{})}}class C6 extends f5{render(Q){return"{"+Q._n+super.render(Q)+"}"+Q._n}}class bH extends f5{}class r9 extends C6{}r9.kind="else";class W6 extends C6{constructor(Q,$){super($);this.condition=Q}render(Q){let $=`if(${this.condition})`+super.render(Q);if(this.else)$+="else "+this.else.render(Q);return $}optimizeNodes(){super.optimizeNodes();let Q=this.condition;if(Q===!0)return this.nodes;let $=this.else;if($){let W=$.optimizeNodes();$=this.else=Array.isArray(W)?new r9(W):W}if($){if(Q===!1)return $ instanceof W6?$:$.nodes;if(this.nodes.length)return this;return new W6(xH(Q),$ instanceof W6?[$]:$.nodes)}if(Q===!1||!this.nodes.length)return;return this}optimizeNames(Q,$){var W;if(this.else=(W=this.else)===null||W===void 0?void 0:W.optimizeNames(Q,$),!(super.optimizeNames(Q,$)||this.else))return;return this.condition=p8(this.condition,Q,$),this}get names(){let Q=super.names;if(g5(Q,this.condition),this.else)e6(Q,this.else.names);return Q}}W6.kind="if";class c8 extends C6{}c8.kind="for";class vH extends c8{constructor(Q){super();this.iteration=Q}render(Q){return`for(${this.iteration})`+super.render(Q)}optimizeNames(Q,$){if(!super.optimizeNames(Q,$))return;return this.iteration=p8(this.iteration,Q,$),this}get names(){return e6(super.names,this.iteration.names)}}class kH extends c8{constructor(Q,$,W,Y){super();this.varKind=Q,this.name=$,this.from=W,this.to=Y}render(Q){let $=Q.es5?_1.varKinds.var:this.varKind,{name:W,from:Y,to:X}=this;return`for(${$} ${W}=${Y}; ${W}<${X}; ${W}++)`+super.render(Q)}get names(){let Q=g5(super.names,this.from);return g5(Q,this.to)}}class NY extends c8{constructor(Q,$,W,Y){super();this.loop=Q,this.varKind=$,this.name=W,this.iterable=Y}render(Q){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Q)}optimizeNames(Q,$){if(!super.optimizeNames(Q,$))return;return this.iterable=p8(this.iterable,Q,$),this}get names(){return e6(super.names,this.iterable.names)}}class T5 extends C6{constructor(Q,$,W){super();this.name=Q,this.args=$,this.async=W}render(Q){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Q)}}T5.kind="func";class _5 extends f5{render(Q){return"return "+super.render(Q)}}_5.kind="return";class TH extends C6{render(Q){let $="try"+super.render(Q);if(this.catch)$+=this.catch.render(Q);if(this.finally)$+=this.finally.render(Q);return $}optimizeNodes(){var Q,$;return super.optimizeNodes(),(Q=this.catch)===null||Q===void 0||Q.optimizeNodes(),($=this.finally)===null||$===void 0||$.optimizeNodes(),this}optimizeNames(Q,$){var W,Y;return super.optimizeNames(Q,$),(W=this.catch)===null||W===void 0||W.optimizeNames(Q,$),(Y=this.finally)===null||Y===void 0||Y.optimizeNames(Q,$),this}get names(){let Q=super.names;if(this.catch)e6(Q,this.catch.names);if(this.finally)e6(Q,this.finally.names);return Q}}class x5 extends C6{constructor(Q){super();this.error=Q}render(Q){return`catch(${this.error})`+super.render(Q)}}x5.kind="catch";class y5 extends C6{render(Q){return"finally"+super.render(Q)}}y5.kind="finally";class _H{constructor(Q,$={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...$,_n:$.lines?`
`:""},this._extScope=Q,this._scope=new _1.Scope({parent:Q}),this._nodes=[new bH]}toString(){return this._root.render(this.opts)}name(Q){return this._scope.name(Q)}scopeName(Q){return this._extScope.name(Q)}scopeValue(Q,$){let W=this._extScope.value(Q,$);return(this._values[W.prefix]||(this._values[W.prefix]=new Set)).add(W),W}getScopeValue(Q,$){return this._extScope.getValue(Q,$)}scopeRefs(Q){return this._extScope.scopeRefs(Q,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Q,$,W,Y){let X=this._scope.toName($);if(W!==void 0&&Y)this._constants[X.str]=W;return this._leafNode(new RH(Q,X,W)),X}const(Q,$,W){return this._def(_1.varKinds.const,Q,$,W)}let(Q,$,W){return this._def(_1.varKinds.let,Q,$,W)}var(Q,$,W){return this._def(_1.varKinds.var,Q,$,W)}assign(Q,$,W){return this._leafNode(new jY(Q,$,W))}add(Q,$){return this._leafNode(new PH(Q,o.operators.ADD,$))}code(Q){if(typeof Q=="function")Q();else if(Q!==X0.nil)this._leafNode(new CH(Q));return this}object(...Q){let $=["{"];for(let[W,Y]of Q){if($.length>1)$.push(",");if($.push(W),W!==Y||this.opts.es5)$.push(":"),(0,X0.addCodeArg)($,Y)}return $.push("}"),new X0._Code($)}if(Q,$,W){if(this._blockNode(new W6(Q)),$&&W)this.code($).else().code(W).endIf();else if($)this.code($).endIf();else if(W)throw Error('CodeGen: "else" body without "then" body');return this}elseIf(Q){return this._elseNode(new W6(Q))}else(){return this._elseNode(new r9)}endIf(){return this._endBlockNode(W6,r9)}_for(Q,$){if(this._blockNode(Q),$)this.code($).endFor();return this}for(Q,$){return this._for(new vH(Q),$)}forRange(Q,$,W,Y,X=this.opts.es5?_1.varKinds.var:_1.varKinds.let){let J=this._scope.toName(Q);return this._for(new kH(X,J,$,W),()=>Y(J))}forOf(Q,$,W,Y=_1.varKinds.const){let X=this._scope.toName(Q);if(this.opts.es5){let J=$ instanceof X0.Name?$:this.var("_arr",$);return this.forRange("_i",0,X0._`${J}.length`,(H)=>{this.var(X,X0._`${J}[${H}]`),W(X)})}return this._for(new NY("of",Y,X,$),()=>W(X))}forIn(Q,$,W,Y=this.opts.es5?_1.varKinds.var:_1.varKinds.const){if(this.opts.ownProperties)return this.forOf(Q,X0._`Object.keys(${$})`,W);let X=this._scope.toName(Q);return this._for(new NY("in",Y,X,$),()=>W(X))}endFor(){return this._endBlockNode(c8)}label(Q){return this._leafNode(new IH(Q))}break(Q){return this._leafNode(new SH(Q))}return(Q){let $=new _5;if(this._blockNode($),this.code(Q),$.nodes.length!==1)throw Error('CodeGen: "return" should have one node');return this._endBlockNode(_5)}try(Q,$,W){if(!$&&!W)throw Error('CodeGen: "try" without "catch" and "finally"');let Y=new TH;if(this._blockNode(Y),this.code(Q),$){let X=this.name("e");this._currNode=Y.catch=new x5(X),$(X)}if(W)this._currNode=Y.finally=new y5,this.code(W);return this._endBlockNode(x5,y5)}throw(Q){return this._leafNode(new ZH(Q))}block(Q,$){if(this._blockStarts.push(this._nodes.length),Q)this.code(Q).endBlock($);return this}endBlock(Q){let $=this._blockStarts.pop();if($===void 0)throw Error("CodeGen: not in self-balancing block");let W=this._nodes.length-$;if(W<0||Q!==void 0&&W!==Q)throw Error(`CodeGen: wrong number of nodes: ${W} vs ${Q} expected`);return this._nodes.length=$,this}func(Q,$=X0.nil,W,Y){if(this._blockNode(new T5(Q,$,W)),Y)this.code(Y).endFunc();return this}endFunc(){return this._endBlockNode(T5)}optimize(Q=1){while(Q-- >0)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Q){return this._currNode.nodes.push(Q),this}_blockNode(Q){this._currNode.nodes.push(Q),this._nodes.push(Q)}_endBlockNode(Q,$){let W=this._currNode;if(W instanceof Q||$&&W instanceof $)return this._nodes.pop(),this;throw Error(`CodeGen: not in block "${$?`${Q.kind}/${$.kind}`:Q.kind}"`)}_elseNode(Q){let $=this._currNode;if(!($ instanceof W6))throw Error('CodeGen: "else" without "if"');return this._currNode=$.else=Q,this}get _root(){return this._nodes[0]}get _currNode(){let Q=this._nodes;return Q[Q.length-1]}set _currNode(Q){let $=this._nodes;$[$.length-1]=Q}}o.CodeGen=_H;function e6(Q,$){for(let W in $)Q[W]=(Q[W]||0)+($[W]||0);return Q}function g5(Q,$){return $ instanceof X0._CodeOrName?e6(Q,$.names):Q}function p8(Q,$,W){if(Q instanceof X0.Name)return Y(Q);if(!X(Q))return Q;return new X0._Code(Q._items.reduce((J,H)=>{if(H instanceof X0.Name)H=Y(H);if(H instanceof X0._Code)J.push(...H._items);else J.push(H);return J},[]));function Y(J){let H=W[J.str];if(H===void 0||$[J.str]!==1)return J;return delete $[J.str],H}function X(J){return J instanceof X0._Code&&J._items.some((H)=>H instanceof X0.Name&&$[H.str]===1&&W[H.str]!==void 0)}}function Kz(Q,$){for(let W in $)Q[W]=(Q[W]||0)-($[W]||0)}function xH(Q){return typeof Q=="boolean"||typeof Q=="number"||Q===null?!Q:X0._`!${MY(Q)}`}o.not=xH;var Fz=yH(o.operators.AND);function Lz(...Q){return Q.reduce(Fz)}o.and=Lz;var qz=yH(o.operators.OR);function Vz(...Q){return Q.reduce(qz)}o.or=Vz;function yH(Q){return($,W)=>$===X0.nil?W:W===X0.nil?$:X0._`${MY($)} ${Q} ${MY(W)}`}function MY(Q){return Q instanceof X0.Name?Q:X0._`(${Q})`}});var G0=b((a)=>{Object.defineProperty(a,"__esModule",{value:!0});a.checkStrictMode=a.getErrorPath=a.Type=a.useFunc=a.setEvaluated=a.evaluatedPropsToName=a.mergeEvaluated=a.eachItem=a.unescapeJsonPointer=a.escapeJsonPointer=a.escapeFragment=a.unescapeFragment=a.schemaRefOrVal=a.schemaHasRulesButRef=a.schemaHasRules=a.checkUnknownRules=a.alwaysValidSchema=a.toHash=void 0;var V0=i(),Uz=n9();function Az(Q){let $={};for(let W of Q)$[W]=!0;return $}a.toHash=Az;function zz(Q,$){if(typeof $=="boolean")return $;if(Object.keys($).length===0)return!0;return fH(Q,$),!uH($,Q.self.RULES.all)}a.alwaysValidSchema=zz;function fH(Q,$=Q.schema){let{opts:W,self:Y}=Q;if(!W.strictSchema)return;if(typeof $==="boolean")return;let X=Y.RULES.keywords;for(let J in $)if(!X[J])cH(Q,`unknown keyword: "${J}"`)}a.checkUnknownRules=fH;function uH(Q,$){if(typeof Q=="boolean")return!Q;for(let W in Q)if($[W])return!0;return!1}a.schemaHasRules=uH;function wz(Q,$){if(typeof Q=="boolean")return!Q;for(let W in Q)if(W!=="$ref"&&$.all[W])return!0;return!1}a.schemaHasRulesButRef=wz;function Oz({topSchemaRef:Q,schemaPath:$},W,Y,X){if(!X){if(typeof W=="number"||typeof W=="boolean")return W;if(typeof W=="string")return V0._`${W}`}return V0._`${Q}${$}${(0,V0.getProperty)(Y)}`}a.schemaRefOrVal=Oz;function Nz(Q){return lH(decodeURIComponent(Q))}a.unescapeFragment=Nz;function Mz(Q){return encodeURIComponent(EY(Q))}a.escapeFragment=Mz;function EY(Q){if(typeof Q=="number")return`${Q}`;return Q.replace(/~/g,"~0").replace(/\//g,"~1")}a.escapeJsonPointer=EY;function lH(Q){return Q.replace(/~1/g,"/").replace(/~0/g,"~")}a.unescapeJsonPointer=lH;function jz(Q,$){if(Array.isArray(Q))for(let W of Q)$(W);else $(Q)}a.eachItem=jz;function gH({mergeNames:Q,mergeToName:$,mergeValues:W,resultToName:Y}){return(X,J,H,G)=>{let B=H===void 0?J:H instanceof V0.Name?(J instanceof V0.Name?Q(X,J,H):$(X,J,H),H):J instanceof V0.Name?($(X,H,J),J):W(J,H);return G===V0.Name&&!(B instanceof V0.Name)?Y(X,B):B}}a.mergeEvaluated={props:gH({mergeNames:(Q,$,W)=>Q.if(V0._`${W} !== true && ${$} !== undefined`,()=>{Q.if(V0._`${$} === true`,()=>Q.assign(W,!0),()=>Q.assign(W,V0._`${W} || {}`).code(V0._`Object.assign(${W}, ${$})`))}),mergeToName:(Q,$,W)=>Q.if(V0._`${W} !== true`,()=>{if($===!0)Q.assign(W,!0);else Q.assign(W,V0._`${W} || {}`),RY(Q,W,$)}),mergeValues:(Q,$)=>Q===!0?!0:{...Q,...$},resultToName:mH}),items:gH({mergeNames:(Q,$,W)=>Q.if(V0._`${W} !== true && ${$} !== undefined`,()=>Q.assign(W,V0._`${$} === true ? true : ${W} > ${$} ? ${W} : ${$}`)),mergeToName:(Q,$,W)=>Q.if(V0._`${W} !== true`,()=>Q.assign(W,$===!0?!0:V0._`${W} > ${$} ? ${W} : ${$}`)),mergeValues:(Q,$)=>Q===!0?!0:Math.max(Q,$),resultToName:(Q,$)=>Q.var("items",$)})};function mH(Q,$){if($===!0)return Q.var("props",!0);let W=Q.var("props",V0._`{}`);if($!==void 0)RY(Q,W,$);return W}a.evaluatedPropsToName=mH;function RY(Q,$,W){Object.keys(W).forEach((Y)=>Q.assign(V0._`${$}${(0,V0.getProperty)(Y)}`,!0))}a.setEvaluated=RY;var hH={};function Dz(Q,$){return Q.scopeValue("func",{ref:$,code:hH[$.code]||(hH[$.code]=new Uz._Code($.code))})}a.useFunc=Dz;var DY;(function(Q){Q[Q.Num=0]="Num",Q[Q.Str=1]="Str"})(DY||(a.Type=DY={}));function Ez(Q,$,W){if(Q instanceof V0.Name){let Y=$===DY.Num;return W?Y?V0._`"[" + ${Q} + "]"`:V0._`"['" + ${Q} + "']"`:Y?V0._`"/" + ${Q}`:V0._`"/" + ${Q}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return W?(0,V0.getProperty)(Q).toString():"/"+EY(Q)}a.getErrorPath=Ez;function cH(Q,$,W=Q.opts.strictSchema){if(!W)return;if($=`strict mode: ${$}`,W===!0)throw Error($);Q.self.logger.warn($)}a.checkStrictMode=cH});var Y6=b((PY)=>{Object.defineProperty(PY,"__esModule",{value:!0});var p0=i(),Rz={data:new p0.Name("data"),valCxt:new p0.Name("valCxt"),instancePath:new p0.Name("instancePath"),parentData:new p0.Name("parentData"),parentDataProperty:new p0.Name("parentDataProperty"),rootData:new p0.Name("rootData"),dynamicAnchors:new p0.Name("dynamicAnchors"),vErrors:new p0.Name("vErrors"),errors:new p0.Name("errors"),this:new p0.Name("this"),self:new p0.Name("self"),scope:new p0.Name("scope"),json:new p0.Name("json"),jsonPos:new p0.Name("jsonPos"),jsonLen:new p0.Name("jsonLen"),jsonPart:new p0.Name("jsonPart")};PY.default=Rz});var o9=b((d0)=>{Object.defineProperty(d0,"__esModule",{value:!0});d0.extendErrors=d0.resetErrorsCount=d0.reportExtraError=d0.reportError=d0.keyword$DataError=d0.keywordError=void 0;var J0=i(),u5=G0(),s0=Y6();d0.keywordError={message:({keyword:Q})=>J0.str`must pass "${Q}" keyword validation`};d0.keyword$DataError={message:({keyword:Q,schemaType:$})=>$?J0.str`"${Q}" keyword must be ${$} ($data)`:J0.str`"${Q}" keyword is invalid ($data)`};function Pz(Q,$=d0.keywordError,W,Y){let{it:X}=Q,{gen:J,compositeRule:H,allErrors:G}=X,B=iH(Q,$,W);if(Y!==null&&Y!==void 0?Y:H||G)pH(J,B);else dH(X,J0._`[${B}]`)}d0.reportError=Pz;function Iz(Q,$=d0.keywordError,W){let{it:Y}=Q,{gen:X,compositeRule:J,allErrors:H}=Y,G=iH(Q,$,W);if(pH(X,G),!(J||H))dH(Y,s0.default.vErrors)}d0.reportExtraError=Iz;function Sz(Q,$){Q.assign(s0.default.errors,$),Q.if(J0._`${s0.default.vErrors} !== null`,()=>Q.if($,()=>Q.assign(J0._`${s0.default.vErrors}.length`,$),()=>Q.assign(s0.default.vErrors,null)))}d0.resetErrorsCount=Sz;function Zz({gen:Q,keyword:$,schemaValue:W,data:Y,errsCount:X,it:J}){if(X===void 0)throw Error("ajv implementation error");let H=Q.name("err");Q.forRange("i",X,s0.default.errors,(G)=>{if(Q.const(H,J0._`${s0.default.vErrors}[${G}]`),Q.if(J0._`${H}.instancePath === undefined`,()=>Q.assign(J0._`${H}.instancePath`,(0,J0.strConcat)(s0.default.instancePath,J.errorPath))),Q.assign(J0._`${H}.schemaPath`,J0.str`${J.errSchemaPath}/${$}`),J.opts.verbose)Q.assign(J0._`${H}.schema`,W),Q.assign(J0._`${H}.data`,Y)})}d0.extendErrors=Zz;function pH(Q,$){let W=Q.const("err",$);Q.if(J0._`${s0.default.vErrors} === null`,()=>Q.assign(s0.default.vErrors,J0._`[${W}]`),J0._`${s0.default.vErrors}.push(${W})`),Q.code(J0._`${s0.default.errors}++`)}function dH(Q,$){let{gen:W,validateName:Y,schemaEnv:X}=Q;if(X.$async)W.throw(J0._`new ${Q.ValidationError}(${$})`);else W.assign(J0._`${Y}.errors`,$),W.return(!1)}var Q8={keyword:new J0.Name("keyword"),schemaPath:new J0.Name("schemaPath"),params:new J0.Name("params"),propertyName:new J0.Name("propertyName"),message:new J0.Name("message"),schema:new J0.Name("schema"),parentSchema:new J0.Name("parentSchema")};function iH(Q,$,W){let{createErrors:Y}=Q.it;if(Y===!1)return J0._`{}`;return Cz(Q,$,W)}function Cz(Q,$,W={}){let{gen:Y,it:X}=Q,J=[bz(X,W),vz(Q,W)];return kz(Q,$,J),Y.object(...J)}function bz({errorPath:Q},{instancePath:$}){let W=$?J0.str`${Q}${(0,u5.getErrorPath)($,u5.Type.Str)}`:Q;return[s0.default.instancePath,(0,J0.strConcat)(s0.default.instancePath,W)]}function vz({keyword:Q,it:{errSchemaPath:$}},{schemaPath:W,parentSchema:Y}){let X=Y?$:J0.str`${$}/${Q}`;if(W)X=J0.str`${X}${(0,u5.getErrorPath)(W,u5.Type.Str)}`;return[Q8.schemaPath,X]}function kz(Q,{params:$,message:W},Y){let{keyword:X,data:J,schemaValue:H,it:G}=Q,{opts:B,propertyName:K,topSchemaRef:F,schemaPath:q}=G;if(Y.push([Q8.keyword,X],[Q8.params,typeof $=="function"?$(Q):$||J0._`{}`]),B.messages)Y.push([Q8.message,typeof W=="function"?W(Q):W]);if(B.verbose)Y.push([Q8.schema,H],[Q8.parentSchema,J0._`${F}${q}`],[s0.default.data,J]);if(K)Y.push([Q8.propertyName,K])}});var rH=b((d8)=>{Object.defineProperty(d8,"__esModule",{value:!0});d8.boolOrEmptySchema=d8.topBoolOrEmptySchema=void 0;var Tz=o9(),_z=i(),xz=Y6(),yz={message:"boolean schema is false"};function gz(Q){let{gen:$,schema:W,validateName:Y}=Q;if(W===!1)nH(Q,!1);else if(typeof W=="object"&&W.$async===!0)$.return(xz.default.data);else $.assign(_z._`${Y}.errors`,null),$.return(!0)}d8.topBoolOrEmptySchema=gz;function hz(Q,$){let{gen:W,schema:Y}=Q;if(Y===!1)W.var($,!1),nH(Q);else W.var($,!0)}d8.boolOrEmptySchema=hz;function nH(Q,$){let{gen:W,data:Y}=Q,X={gen:W,keyword:"false schema",data:Y,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:Q};(0,Tz.reportError)(X,yz,void 0,$)}});var IY=b((i8)=>{Object.defineProperty(i8,"__esModule",{value:!0});i8.getRules=i8.isJSONType=void 0;var fz=["string","number","integer","boolean","null","object","array"],uz=new Set(fz);function lz(Q){return typeof Q=="string"&&uz.has(Q)}i8.isJSONType=lz;function mz(){let Q={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...Q,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},Q.number,Q.string,Q.array,Q.object],post:{rules:[]},all:{},keywords:{}}}i8.getRules=mz});var SY=b((b6)=>{Object.defineProperty(b6,"__esModule",{value:!0});b6.shouldUseRule=b6.shouldUseGroup=b6.schemaHasRulesForType=void 0;function cz({schema:Q,self:$},W){let Y=$.RULES.types[W];return Y&&Y!==!0&&oH(Q,Y)}b6.schemaHasRulesForType=cz;function oH(Q,$){return $.rules.some((W)=>aH(Q,W))}b6.shouldUseGroup=oH;function aH(Q,$){var W;return Q[$.keyword]!==void 0||((W=$.definition.implements)===null||W===void 0?void 0:W.some((Y)=>Q[Y]!==void 0))}b6.shouldUseRule=aH});var a9=b((i0)=>{Object.defineProperty(i0,"__esModule",{value:!0});i0.reportTypeError=i0.checkDataTypes=i0.checkDataType=i0.coerceAndCheckDataType=i0.getJSONTypes=i0.getSchemaTypes=i0.DataType=void 0;var pz=IY(),dz=SY(),iz=o9(),p=i(),tH=G0(),n8;(function(Q){Q[Q.Correct=0]="Correct",Q[Q.Wrong=1]="Wrong"})(n8||(i0.DataType=n8={}));function nz(Q){let $=sH(Q.type);if($.includes("null")){if(Q.nullable===!1)throw Error("type: null contradicts nullable: false")}else{if(!$.length&&Q.nullable!==void 0)throw Error('"nullable" cannot be used without "type"');if(Q.nullable===!0)$.push("null")}return $}i0.getSchemaTypes=nz;function sH(Q){let $=Array.isArray(Q)?Q:Q?[Q]:[];if($.every(pz.isJSONType))return $;throw Error("type must be JSONType or JSONType[]: "+$.join(","))}i0.getJSONTypes=sH;function rz(Q,$){let{gen:W,data:Y,opts:X}=Q,J=oz($,X.coerceTypes),H=$.length>0&&!(J.length===0&&$.length===1&&(0,dz.schemaHasRulesForType)(Q,$[0]));if(H){let G=CY($,Y,X.strictNumbers,n8.Wrong);W.if(G,()=>{if(J.length)az(Q,$,J);else bY(Q)})}return H}i0.coerceAndCheckDataType=rz;var eH=new Set(["string","number","integer","boolean","null"]);function oz(Q,$){return $?Q.filter((W)=>eH.has(W)||$==="array"&&W==="array"):[]}function az(Q,$,W){let{gen:Y,data:X,opts:J}=Q,H=Y.let("dataType",p._`typeof ${X}`),G=Y.let("coerced",p._`undefined`);if(J.coerceTypes==="array")Y.if(p._`${H} == 'object' && Array.isArray(${X}) && ${X}.length == 1`,()=>Y.assign(X,p._`${X}[0]`).assign(H,p._`typeof ${X}`).if(CY($,X,J.strictNumbers),()=>Y.assign(G,X)));Y.if(p._`${G} !== undefined`);for(let K of W)if(eH.has(K)||K==="array"&&J.coerceTypes==="array")B(K);Y.else(),bY(Q),Y.endIf(),Y.if(p._`${G} !== undefined`,()=>{Y.assign(X,G),tz(Q,G)});function B(K){switch(K){case"string":Y.elseIf(p._`${H} == "number" || ${H} == "boolean"`).assign(G,p._`"" + ${X}`).elseIf(p._`${X} === null`).assign(G,p._`""`);return;case"number":Y.elseIf(p._`${H} == "boolean" || ${X} === null
              || (${H} == "string" && ${X} && ${X} == +${X})`).assign(G,p._`+${X}`);return;case"integer":Y.elseIf(p._`${H} === "boolean" || ${X} === null
              || (${H} === "string" && ${X} && ${X} == +${X} && !(${X} % 1))`).assign(G,p._`+${X}`);return;case"boolean":Y.elseIf(p._`${X} === "false" || ${X} === 0 || ${X} === null`).assign(G,!1).elseIf(p._`${X} === "true" || ${X} === 1`).assign(G,!0);return;case"null":Y.elseIf(p._`${X} === "" || ${X} === 0 || ${X} === false`),Y.assign(G,null);return;case"array":Y.elseIf(p._`${H} === "string" || ${H} === "number"
              || ${H} === "boolean" || ${X} === null`).assign(G,p._`[${X}]`)}}}function tz({gen:Q,parentData:$,parentDataProperty:W},Y){Q.if(p._`${$} !== undefined`,()=>Q.assign(p._`${$}[${W}]`,Y))}function ZY(Q,$,W,Y=n8.Correct){let X=Y===n8.Correct?p.operators.EQ:p.operators.NEQ,J;switch(Q){case"null":return p._`${$} ${X} null`;case"array":J=p._`Array.isArray(${$})`;break;case"object":J=p._`${$} && typeof ${$} == "object" && !Array.isArray(${$})`;break;case"integer":J=H(p._`!(${$} % 1) && !isNaN(${$})`);break;case"number":J=H();break;default:return p._`typeof ${$} ${X} ${Q}`}return Y===n8.Correct?J:(0,p.not)(J);function H(G=p.nil){return(0,p.and)(p._`typeof ${$} == "number"`,G,W?p._`isFinite(${$})`:p.nil)}}i0.checkDataType=ZY;function CY(Q,$,W,Y){if(Q.length===1)return ZY(Q[0],$,W,Y);let X,J=(0,tH.toHash)(Q);if(J.array&&J.object){let H=p._`typeof ${$} != "object"`;X=J.null?H:p._`!${$} || ${H}`,delete J.null,delete J.array,delete J.object}else X=p.nil;if(J.number)delete J.integer;for(let H in J)X=(0,p.and)(X,ZY(H,$,W,Y));return X}i0.checkDataTypes=CY;var sz={message:({schema:Q})=>`must be ${Q}`,params:({schema:Q,schemaValue:$})=>typeof Q=="string"?p._`{type: ${Q}}`:p._`{type: ${$}}`};function bY(Q){let $=ez(Q);(0,iz.reportError)($,sz)}i0.reportTypeError=bY;function ez(Q){let{gen:$,data:W,schema:Y}=Q,X=(0,tH.schemaRefOrVal)(Q,Y,"type");return{gen:$,keyword:"type",data:W,schema:Y.type,schemaCode:X,schemaValue:X,parentSchema:Y,params:{},it:Q}}});var $G=b((l5)=>{Object.defineProperty(l5,"__esModule",{value:!0});l5.assignDefaults=void 0;var r8=i(),Qw=G0();function $w(Q,$){let{properties:W,items:Y}=Q.schema;if($==="object"&&W)for(let X in W)QG(Q,X,W[X].default);else if($==="array"&&Array.isArray(Y))Y.forEach((X,J)=>QG(Q,J,X.default))}l5.assignDefaults=$w;function QG(Q,$,W){let{gen:Y,compositeRule:X,data:J,opts:H}=Q;if(W===void 0)return;let G=r8._`${J}${(0,r8.getProperty)($)}`;if(X){(0,Qw.checkStrictMode)(Q,`default is ignored for: ${G}`);return}let B=r8._`${G} === undefined`;if(H.useDefaults==="empty")B=r8._`${B} || ${G} === null || ${G} === ""`;Y.if(B,r8._`${G} = ${(0,r8.stringify)(W)}`)}});var M1=b((q0)=>{Object.defineProperty(q0,"__esModule",{value:!0});q0.validateUnion=q0.validateArray=q0.usePattern=q0.callValidateCode=q0.schemaProperties=q0.allSchemaProperties=q0.noPropertyInData=q0.propertyInData=q0.isOwnProperty=q0.hasPropFunc=q0.reportMissingProp=q0.checkMissingProp=q0.checkReportMissingProp=void 0;var w0=i(),vY=G0(),v6=Y6(),Ww=G0();function Yw(Q,$){let{gen:W,data:Y,it:X}=Q;W.if(TY(W,Y,$,X.opts.ownProperties),()=>{Q.setParams({missingProperty:w0._`${$}`},!0),Q.error()})}q0.checkReportMissingProp=Yw;function Xw({gen:Q,data:$,it:{opts:W}},Y,X){return(0,w0.or)(...Y.map((J)=>(0,w0.and)(TY(Q,$,J,W.ownProperties),w0._`${X} = ${J}`)))}q0.checkMissingProp=Xw;function Jw(Q,$){Q.setParams({missingProperty:$},!0),Q.error()}q0.reportMissingProp=Jw;function WG(Q){return Q.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:w0._`Object.prototype.hasOwnProperty`})}q0.hasPropFunc=WG;function kY(Q,$,W){return w0._`${WG(Q)}.call(${$}, ${W})`}q0.isOwnProperty=kY;function Hw(Q,$,W,Y){let X=w0._`${$}${(0,w0.getProperty)(W)} !== undefined`;return Y?w0._`${X} && ${kY(Q,$,W)}`:X}q0.propertyInData=Hw;function TY(Q,$,W,Y){let X=w0._`${$}${(0,w0.getProperty)(W)} === undefined`;return Y?(0,w0.or)(X,(0,w0.not)(kY(Q,$,W))):X}q0.noPropertyInData=TY;function YG(Q){return Q?Object.keys(Q).filter(($)=>$!=="__proto__"):[]}q0.allSchemaProperties=YG;function Gw(Q,$){return YG($).filter((W)=>!(0,vY.alwaysValidSchema)(Q,$[W]))}q0.schemaProperties=Gw;function Bw({schemaCode:Q,data:$,it:{gen:W,topSchemaRef:Y,schemaPath:X,errorPath:J},it:H},G,B,K){let F=K?w0._`${Q}, ${$}, ${Y}${X}`:$,q=[[v6.default.instancePath,(0,w0.strConcat)(v6.default.instancePath,J)],[v6.default.parentData,H.parentData],[v6.default.parentDataProperty,H.parentDataProperty],[v6.default.rootData,v6.default.rootData]];if(H.opts.dynamicRef)q.push([v6.default.dynamicAnchors,v6.default.dynamicAnchors]);let A=w0._`${F}, ${W.object(...q)}`;return B!==w0.nil?w0._`${G}.call(${B}, ${A})`:w0._`${G}(${A})`}q0.callValidateCode=Bw;var Kw=w0._`new RegExp`;function Fw({gen:Q,it:{opts:$}},W){let Y=$.unicodeRegExp?"u":"",{regExp:X}=$.code,J=X(W,Y);return Q.scopeValue("pattern",{key:J.toString(),ref:J,code:w0._`${X.code==="new RegExp"?Kw:(0,Ww.useFunc)(Q,X)}(${W}, ${Y})`})}q0.usePattern=Fw;function Lw(Q){let{gen:$,data:W,keyword:Y,it:X}=Q,J=$.name("valid");if(X.allErrors){let G=$.let("valid",!0);return H(()=>$.assign(G,!1)),G}return $.var(J,!0),H(()=>$.break()),J;function H(G){let B=$.const("len",w0._`${W}.length`);$.forRange("i",0,B,(K)=>{Q.subschema({keyword:Y,dataProp:K,dataPropType:vY.Type.Num},J),$.if((0,w0.not)(J),G)})}}q0.validateArray=Lw;function qw(Q){let{gen:$,schema:W,keyword:Y,it:X}=Q;if(!Array.isArray(W))throw Error("ajv implementation error");if(W.some((B)=>(0,vY.alwaysValidSchema)(X,B))&&!X.opts.unevaluated)return;let H=$.let("valid",!1),G=$.name("_valid");$.block(()=>W.forEach((B,K)=>{let F=Q.subschema({keyword:Y,schemaProp:K,compositeRule:!0},G);if($.assign(H,w0._`${H} || ${G}`),!Q.mergeValidEvaluated(F,G))$.if((0,w0.not)(H))})),Q.result(H,()=>Q.reset(),()=>Q.error(!0))}q0.validateUnion=qw});var HG=b((i1)=>{Object.defineProperty(i1,"__esModule",{value:!0});i1.validateKeywordUsage=i1.validSchemaType=i1.funcKeywordCode=i1.macroKeywordCode=void 0;var e0=i(),$8=Y6(),Vw=M1(),Uw=o9();function Aw(Q,$){let{gen:W,keyword:Y,schema:X,parentSchema:J,it:H}=Q,G=$.macro.call(H.self,X,J,H),B=JG(W,Y,G);if(H.opts.validateSchema!==!1)H.self.validateSchema(G,!0);let K=W.name("valid");Q.subschema({schema:G,schemaPath:e0.nil,errSchemaPath:`${H.errSchemaPath}/${Y}`,topSchemaRef:B,compositeRule:!0},K),Q.pass(K,()=>Q.error(!0))}i1.macroKeywordCode=Aw;function zw(Q,$){var W;let{gen:Y,keyword:X,schema:J,parentSchema:H,$data:G,it:B}=Q;Ow(B,$);let K=!G&&$.compile?$.compile.call(B.self,J,H,B):$.validate,F=JG(Y,X,K),q=Y.let("valid");Q.block$data(q,A),Q.ok((W=$.valid)!==null&&W!==void 0?W:q);function A(){if($.errors===!1){if(z(),$.modifying)XG(Q);w(()=>Q.error())}else{let O=$.async?V():U();if($.modifying)XG(Q);w(()=>ww(Q,O))}}function V(){let O=Y.let("ruleErrs",null);return Y.try(()=>z(e0._`await `),(D)=>Y.assign(q,!1).if(e0._`${D} instanceof ${B.ValidationError}`,()=>Y.assign(O,e0._`${D}.errors`),()=>Y.throw(D))),O}function U(){let O=e0._`${F}.errors`;return Y.assign(O,null),z(e0.nil),O}function z(O=$.async?e0._`await `:e0.nil){let D=B.opts.passContext?$8.default.this:$8.default.self,j=!(("compile"in $)&&!G||$.schema===!1);Y.assign(q,e0._`${O}${(0,Vw.callValidateCode)(Q,F,D,j)}`,$.modifying)}function w(O){var D;Y.if((0,e0.not)((D=$.valid)!==null&&D!==void 0?D:q),O)}}i1.funcKeywordCode=zw;function XG(Q){let{gen:$,data:W,it:Y}=Q;$.if(Y.parentData,()=>$.assign(W,e0._`${Y.parentData}[${Y.parentDataProperty}]`))}function ww(Q,$){let{gen:W}=Q;W.if(e0._`Array.isArray(${$})`,()=>{W.assign($8.default.vErrors,e0._`${$8.default.vErrors} === null ? ${$} : ${$8.default.vErrors}.concat(${$})`).assign($8.default.errors,e0._`${$8.default.vErrors}.length`),(0,Uw.extendErrors)(Q)},()=>Q.error())}function Ow({schemaEnv:Q},$){if($.async&&!Q.$async)throw Error("async keyword in sync schema")}function JG(Q,$,W){if(W===void 0)throw Error(`keyword "${$}" failed to compile`);return Q.scopeValue("keyword",typeof W=="function"?{ref:W}:{ref:W,code:(0,e0.stringify)(W)})}function Nw(Q,$,W=!1){return!$.length||$.some((Y)=>Y==="array"?Array.isArray(Q):Y==="object"?Q&&typeof Q=="object"&&!Array.isArray(Q):typeof Q==Y||W&&typeof Q>"u")}i1.validSchemaType=Nw;function Mw({schema:Q,opts:$,self:W,errSchemaPath:Y},X,J){if(Array.isArray(X.keyword)?!X.keyword.includes(J):X.keyword!==J)throw Error("ajv implementation error");let H=X.dependencies;if(H===null||H===void 0?void 0:H.some((G)=>!Object.prototype.hasOwnProperty.call(Q,G)))throw Error(`parent schema must have dependencies of ${J}: ${H.join(",")}`);if(X.validateSchema){if(!X.validateSchema(Q[J])){let B=`keyword "${J}" value is invalid at path "${Y}": `+W.errorsText(X.validateSchema.errors);if($.validateSchema==="log")W.logger.error(B);else throw Error(B)}}}i1.validateKeywordUsage=Mw});var BG=b((k6)=>{Object.defineProperty(k6,"__esModule",{value:!0});k6.extendSubschemaMode=k6.extendSubschemaData=k6.getSubschema=void 0;var n1=i(),GG=G0();function jw(Q,{keyword:$,schemaProp:W,schema:Y,schemaPath:X,errSchemaPath:J,topSchemaRef:H}){if($!==void 0&&Y!==void 0)throw Error('both "keyword" and "schema" passed, only one allowed');if($!==void 0){let G=Q.schema[$];return W===void 0?{schema:G,schemaPath:n1._`${Q.schemaPath}${(0,n1.getProperty)($)}`,errSchemaPath:`${Q.errSchemaPath}/${$}`}:{schema:G[W],schemaPath:n1._`${Q.schemaPath}${(0,n1.getProperty)($)}${(0,n1.getProperty)(W)}`,errSchemaPath:`${Q.errSchemaPath}/${$}/${(0,GG.escapeFragment)(W)}`}}if(Y!==void 0){if(X===void 0||J===void 0||H===void 0)throw Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:Y,schemaPath:X,topSchemaRef:H,errSchemaPath:J}}throw Error('either "keyword" or "schema" must be passed')}k6.getSubschema=jw;function Dw(Q,$,{dataProp:W,dataPropType:Y,data:X,dataTypes:J,propertyName:H}){if(X!==void 0&&W!==void 0)throw Error('both "data" and "dataProp" passed, only one allowed');let{gen:G}=$;if(W!==void 0){let{errorPath:K,dataPathArr:F,opts:q}=$,A=G.let("data",n1._`${$.data}${(0,n1.getProperty)(W)}`,!0);B(A),Q.errorPath=n1.str`${K}${(0,GG.getErrorPath)(W,Y,q.jsPropertySyntax)}`,Q.parentDataProperty=n1._`${W}`,Q.dataPathArr=[...F,Q.parentDataProperty]}if(X!==void 0){let K=X instanceof n1.Name?X:G.let("data",X,!0);if(B(K),H!==void 0)Q.propertyName=H}if(J)Q.dataTypes=J;function B(K){Q.data=K,Q.dataLevel=$.dataLevel+1,Q.dataTypes=[],$.definedProperties=new Set,Q.parentData=$.data,Q.dataNames=[...$.dataNames,K]}}k6.extendSubschemaData=Dw;function Ew(Q,{jtdDiscriminator:$,jtdMetadata:W,compositeRule:Y,createErrors:X,allErrors:J}){if(Y!==void 0)Q.compositeRule=Y;if(X!==void 0)Q.createErrors=X;if(J!==void 0)Q.allErrors=J;Q.jtdDiscriminator=$,Q.jtdMetadata=W}k6.extendSubschemaMode=Ew});var _Y=b((NZ,KG)=>{KG.exports=function Q($,W){if($===W)return!0;if($&&W&&typeof $=="object"&&typeof W=="object"){if($.constructor!==W.constructor)return!1;var Y,X,J;if(Array.isArray($)){if(Y=$.length,Y!=W.length)return!1;for(X=Y;X--!==0;)if(!Q($[X],W[X]))return!1;return!0}if($.constructor===RegExp)return $.source===W.source&&$.flags===W.flags;if($.valueOf!==Object.prototype.valueOf)return $.valueOf()===W.valueOf();if($.toString!==Object.prototype.toString)return $.toString()===W.toString();if(J=Object.keys($),Y=J.length,Y!==Object.keys(W).length)return!1;for(X=Y;X--!==0;)if(!Object.prototype.hasOwnProperty.call(W,J[X]))return!1;for(X=Y;X--!==0;){var H=J[X];if(!Q($[H],W[H]))return!1}return!0}return $!==$&&W!==W}});var LG=b((MZ,FG)=>{var T6=FG.exports=function(Q,$,W){if(typeof $=="function")W=$,$={};W=$.cb||W;var Y=typeof W=="function"?W:W.pre||function(){},X=W.post||function(){};m5($,Y,X,Q,"",Q)};T6.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};T6.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};T6.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};T6.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function m5(Q,$,W,Y,X,J,H,G,B,K){if(Y&&typeof Y=="object"&&!Array.isArray(Y)){$(Y,X,J,H,G,B,K);for(var F in Y){var q=Y[F];if(Array.isArray(q)){if(F in T6.arrayKeywords)for(var A=0;A<q.length;A++)m5(Q,$,W,q[A],X+"/"+F+"/"+A,J,X,F,Y,A)}else if(F in T6.propsKeywords){if(q&&typeof q=="object")for(var V in q)m5(Q,$,W,q[V],X+"/"+F+"/"+Rw(V),J,X,F,Y,V)}else if(F in T6.keywords||Q.allKeys&&!(F in T6.skipKeywords))m5(Q,$,W,q,X+"/"+F,J,X,F,Y)}W(Y,X,J,H,G,B,K)}}function Rw(Q){return Q.replace(/~/g,"~0").replace(/\//g,"~1")}});var t9=b((G1)=>{Object.defineProperty(G1,"__esModule",{value:!0});G1.getSchemaRefs=G1.resolveUrl=G1.normalizeId=G1._getFullPath=G1.getFullPath=G1.inlineRef=void 0;var Pw=G0(),Iw=_Y(),Sw=LG(),Zw=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Cw(Q,$=!0){if(typeof Q=="boolean")return!0;if($===!0)return!xY(Q);if(!$)return!1;return qG(Q)<=$}G1.inlineRef=Cw;var bw=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function xY(Q){for(let $ in Q){if(bw.has($))return!0;let W=Q[$];if(Array.isArray(W)&&W.some(xY))return!0;if(typeof W=="object"&&xY(W))return!0}return!1}function qG(Q){let $=0;for(let W in Q){if(W==="$ref")return 1/0;if($++,Zw.has(W))continue;if(typeof Q[W]=="object")(0,Pw.eachItem)(Q[W],(Y)=>$+=qG(Y));if($===1/0)return 1/0}return $}function VG(Q,$="",W){if(W!==!1)$=o8($);let Y=Q.parse($);return UG(Q,Y)}G1.getFullPath=VG;function UG(Q,$){return Q.serialize($).split("#")[0]+"#"}G1._getFullPath=UG;var vw=/#\/?$/;function o8(Q){return Q?Q.replace(vw,""):""}G1.normalizeId=o8;function kw(Q,$,W){return W=o8(W),Q.resolve($,W)}G1.resolveUrl=kw;var Tw=/^[a-z_][-a-z0-9._]*$/i;function _w(Q,$){if(typeof Q=="boolean")return{};let{schemaId:W,uriResolver:Y}=this.opts,X=o8(Q[W]||$),J={"":X},H=VG(Y,X,!1),G={},B=new Set;return Sw(Q,{allKeys:!0},(q,A,V,U)=>{if(U===void 0)return;let z=H+A,w=J[U];if(typeof q[W]=="string")w=O.call(this,q[W]);D.call(this,q.$anchor),D.call(this,q.$dynamicAnchor),J[A]=w;function O(j){let S=this.opts.uriResolver.resolve;if(j=o8(w?S(w,j):j),B.has(j))throw F(j);B.add(j);let C=this.refs[j];if(typeof C=="string")C=this.refs[C];if(typeof C=="object")K(q,C.schema,j);else if(j!==o8(z))if(j[0]==="#")K(q,G[j],j),G[j]=q;else this.refs[j]=z;return j}function D(j){if(typeof j=="string"){if(!Tw.test(j))throw Error(`invalid anchor "${j}"`);O.call(this,`#${j}`)}}}),G;function K(q,A,V){if(A!==void 0&&!Iw(q,A))throw F(V)}function F(q){return Error(`reference "${q}" resolves to more than one schema`)}}G1.getSchemaRefs=_w});var QQ=b((_6)=>{Object.defineProperty(_6,"__esModule",{value:!0});_6.getData=_6.KeywordCxt=_6.validateFunctionCode=void 0;var NG=rH(),AG=a9(),gY=SY(),c5=a9(),xw=$G(),e9=HG(),yY=BG(),y=i(),m=Y6(),yw=t9(),X6=G0(),s9=o9();function gw(Q){if(DG(Q)){if(EG(Q),jG(Q)){uw(Q);return}}MG(Q,()=>(0,NG.topBoolOrEmptySchema)(Q))}_6.validateFunctionCode=gw;function MG({gen:Q,validateName:$,schema:W,schemaEnv:Y,opts:X},J){if(X.code.es5)Q.func($,y._`${m.default.data}, ${m.default.valCxt}`,Y.$async,()=>{Q.code(y._`"use strict"; ${zG(W,X)}`),fw(Q,X),Q.code(J)});else Q.func($,y._`${m.default.data}, ${hw(X)}`,Y.$async,()=>Q.code(zG(W,X)).code(J))}function hw(Q){return y._`{${m.default.instancePath}="", ${m.default.parentData}, ${m.default.parentDataProperty}, ${m.default.rootData}=${m.default.data}${Q.dynamicRef?y._`, ${m.default.dynamicAnchors}={}`:y.nil}}={}`}function fw(Q,$){Q.if(m.default.valCxt,()=>{if(Q.var(m.default.instancePath,y._`${m.default.valCxt}.${m.default.instancePath}`),Q.var(m.default.parentData,y._`${m.default.valCxt}.${m.default.parentData}`),Q.var(m.default.parentDataProperty,y._`${m.default.valCxt}.${m.default.parentDataProperty}`),Q.var(m.default.rootData,y._`${m.default.valCxt}.${m.default.rootData}`),$.dynamicRef)Q.var(m.default.dynamicAnchors,y._`${m.default.valCxt}.${m.default.dynamicAnchors}`)},()=>{if(Q.var(m.default.instancePath,y._`""`),Q.var(m.default.parentData,y._`undefined`),Q.var(m.default.parentDataProperty,y._`undefined`),Q.var(m.default.rootData,m.default.data),$.dynamicRef)Q.var(m.default.dynamicAnchors,y._`{}`)})}function uw(Q){let{schema:$,opts:W,gen:Y}=Q;MG(Q,()=>{if(W.$comment&&$.$comment)PG(Q);if(dw(Q),Y.let(m.default.vErrors,null),Y.let(m.default.errors,0),W.unevaluated)lw(Q);RG(Q),rw(Q)});return}function lw(Q){let{gen:$,validateName:W}=Q;Q.evaluated=$.const("evaluated",y._`${W}.evaluated`),$.if(y._`${Q.evaluated}.dynamicProps`,()=>$.assign(y._`${Q.evaluated}.props`,y._`undefined`)),$.if(y._`${Q.evaluated}.dynamicItems`,()=>$.assign(y._`${Q.evaluated}.items`,y._`undefined`))}function zG(Q,$){let W=typeof Q=="object"&&Q[$.schemaId];return W&&($.code.source||$.code.process)?y._`/*# sourceURL=${W} */`:y.nil}function mw(Q,$){if(DG(Q)){if(EG(Q),jG(Q)){cw(Q,$);return}}(0,NG.boolOrEmptySchema)(Q,$)}function jG({schema:Q,self:$}){if(typeof Q=="boolean")return!Q;for(let W in Q)if($.RULES.all[W])return!0;return!1}function DG(Q){return typeof Q.schema!="boolean"}function cw(Q,$){let{schema:W,gen:Y,opts:X}=Q;if(X.$comment&&W.$comment)PG(Q);iw(Q),nw(Q);let J=Y.const("_errs",m.default.errors);RG(Q,J),Y.var($,y._`${J} === ${m.default.errors}`)}function EG(Q){(0,X6.checkUnknownRules)(Q),pw(Q)}function RG(Q,$){if(Q.opts.jtd)return wG(Q,[],!1,$);let W=(0,AG.getSchemaTypes)(Q.schema),Y=(0,AG.coerceAndCheckDataType)(Q,W);wG(Q,W,!Y,$)}function pw(Q){let{schema:$,errSchemaPath:W,opts:Y,self:X}=Q;if($.$ref&&Y.ignoreKeywordsWithRef&&(0,X6.schemaHasRulesButRef)($,X.RULES))X.logger.warn(`$ref: keywords ignored in schema at path "${W}"`)}function dw(Q){let{schema:$,opts:W}=Q;if($.default!==void 0&&W.useDefaults&&W.strictSchema)(0,X6.checkStrictMode)(Q,"default is ignored in the schema root")}function iw(Q){let $=Q.schema[Q.opts.schemaId];if($)Q.baseId=(0,yw.resolveUrl)(Q.opts.uriResolver,Q.baseId,$)}function nw(Q){if(Q.schema.$async&&!Q.schemaEnv.$async)throw Error("async schema in sync schema")}function PG({gen:Q,schemaEnv:$,schema:W,errSchemaPath:Y,opts:X}){let J=W.$comment;if(X.$comment===!0)Q.code(y._`${m.default.self}.logger.log(${J})`);else if(typeof X.$comment=="function"){let H=y.str`${Y}/$comment`,G=Q.scopeValue("root",{ref:$.root});Q.code(y._`${m.default.self}.opts.$comment(${J}, ${H}, ${G}.schema)`)}}function rw(Q){let{gen:$,schemaEnv:W,validateName:Y,ValidationError:X,opts:J}=Q;if(W.$async)$.if(y._`${m.default.errors} === 0`,()=>$.return(m.default.data),()=>$.throw(y._`new ${X}(${m.default.vErrors})`));else{if($.assign(y._`${Y}.errors`,m.default.vErrors),J.unevaluated)ow(Q);$.return(y._`${m.default.errors} === 0`)}}function ow({gen:Q,evaluated:$,props:W,items:Y}){if(W instanceof y.Name)Q.assign(y._`${$}.props`,W);if(Y instanceof y.Name)Q.assign(y._`${$}.items`,Y)}function wG(Q,$,W,Y){let{gen:X,schema:J,data:H,allErrors:G,opts:B,self:K}=Q,{RULES:F}=K;if(J.$ref&&(B.ignoreKeywordsWithRef||!(0,X6.schemaHasRulesButRef)(J,F))){X.block(()=>SG(Q,"$ref",F.all.$ref.definition));return}if(!B.jtd)aw(Q,$);X.block(()=>{for(let A of F.rules)q(A);q(F.post)});function q(A){if(!(0,gY.shouldUseGroup)(J,A))return;if(A.type){if(X.if((0,c5.checkDataType)(A.type,H,B.strictNumbers)),OG(Q,A),$.length===1&&$[0]===A.type&&W)X.else(),(0,c5.reportTypeError)(Q);X.endIf()}else OG(Q,A);if(!G)X.if(y._`${m.default.errors} === ${Y||0}`)}}function OG(Q,$){let{gen:W,schema:Y,opts:{useDefaults:X}}=Q;if(X)(0,xw.assignDefaults)(Q,$.type);W.block(()=>{for(let J of $.rules)if((0,gY.shouldUseRule)(Y,J))SG(Q,J.keyword,J.definition,$.type)})}function aw(Q,$){if(Q.schemaEnv.meta||!Q.opts.strictTypes)return;if(tw(Q,$),!Q.opts.allowUnionTypes)sw(Q,$);ew(Q,Q.dataTypes)}function tw(Q,$){if(!$.length)return;if(!Q.dataTypes.length){Q.dataTypes=$;return}$.forEach((W)=>{if(!IG(Q.dataTypes,W))hY(Q,`type "${W}" not allowed by context "${Q.dataTypes.join(",")}"`)}),$O(Q,$)}function sw(Q,$){if($.length>1&&!($.length===2&&$.includes("null")))hY(Q,"use allowUnionTypes to allow union type keyword")}function ew(Q,$){let W=Q.self.RULES.all;for(let Y in W){let X=W[Y];if(typeof X=="object"&&(0,gY.shouldUseRule)(Q.schema,X)){let{type:J}=X.definition;if(J.length&&!J.some((H)=>QO($,H)))hY(Q,`missing type "${J.join(",")}" for keyword "${Y}"`)}}}function QO(Q,$){return Q.includes($)||$==="number"&&Q.includes("integer")}function IG(Q,$){return Q.includes($)||$==="integer"&&Q.includes("number")}function $O(Q,$){let W=[];for(let Y of Q.dataTypes)if(IG($,Y))W.push(Y);else if($.includes("integer")&&Y==="number")W.push("integer");Q.dataTypes=W}function hY(Q,$){let W=Q.schemaEnv.baseId+Q.errSchemaPath;$+=` at "${W}" (strictTypes)`,(0,X6.checkStrictMode)(Q,$,Q.opts.strictTypes)}class fY{constructor(Q,$,W){if((0,e9.validateKeywordUsage)(Q,$,W),this.gen=Q.gen,this.allErrors=Q.allErrors,this.keyword=W,this.data=Q.data,this.schema=Q.schema[W],this.$data=$.$data&&Q.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,X6.schemaRefOrVal)(Q,this.schema,W,this.$data),this.schemaType=$.schemaType,this.parentSchema=Q.schema,this.params={},this.it=Q,this.def=$,this.$data)this.schemaCode=Q.gen.const("vSchema",ZG(this.$data,Q));else if(this.schemaCode=this.schemaValue,!(0,e9.validSchemaType)(this.schema,$.schemaType,$.allowUndefined))throw Error(`${W} value must be ${JSON.stringify($.schemaType)}`);if("code"in $?$.trackErrors:$.errors!==!1)this.errsCount=Q.gen.const("_errs",m.default.errors)}result(Q,$,W){this.failResult((0,y.not)(Q),$,W)}failResult(Q,$,W){if(this.gen.if(Q),W)W();else this.error();if($){if(this.gen.else(),$(),this.allErrors)this.gen.endIf()}else if(this.allErrors)this.gen.endIf();else this.gen.else()}pass(Q,$){this.failResult((0,y.not)(Q),void 0,$)}fail(Q){if(Q===void 0){if(this.error(),!this.allErrors)this.gen.if(!1);return}if(this.gen.if(Q),this.error(),this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(Q){if(!this.$data)return this.fail(Q);let{schemaCode:$}=this;this.fail(y._`${$} !== undefined && (${(0,y.or)(this.invalid$data(),Q)})`)}error(Q,$,W){if($){this.setParams($),this._error(Q,W),this.setParams({});return}this._error(Q,W)}_error(Q,$){(Q?s9.reportExtraError:s9.reportError)(this,this.def.error,$)}$dataError(){(0,s9.reportError)(this,this.def.$dataError||s9.keyword$DataError)}reset(){if(this.errsCount===void 0)throw Error('add "trackErrors" to keyword definition');(0,s9.resetErrorsCount)(this.gen,this.errsCount)}ok(Q){if(!this.allErrors)this.gen.if(Q)}setParams(Q,$){if($)Object.assign(this.params,Q);else this.params=Q}block$data(Q,$,W=y.nil){this.gen.block(()=>{this.check$data(Q,W),$()})}check$data(Q=y.nil,$=y.nil){if(!this.$data)return;let{gen:W,schemaCode:Y,schemaType:X,def:J}=this;if(W.if((0,y.or)(y._`${Y} === undefined`,$)),Q!==y.nil)W.assign(Q,!0);if(X.length||J.validateSchema){if(W.elseIf(this.invalid$data()),this.$dataError(),Q!==y.nil)W.assign(Q,!1)}W.else()}invalid$data(){let{gen:Q,schemaCode:$,schemaType:W,def:Y,it:X}=this;return(0,y.or)(J(),H());function J(){if(W.length){if(!($ instanceof y.Name))throw Error("ajv implementation error");let G=Array.isArray(W)?W:[W];return y._`${(0,c5.checkDataTypes)(G,$,X.opts.strictNumbers,c5.DataType.Wrong)}`}return y.nil}function H(){if(Y.validateSchema){let G=Q.scopeValue("validate$data",{ref:Y.validateSchema});return y._`!${G}(${$})`}return y.nil}}subschema(Q,$){let W=(0,yY.getSubschema)(this.it,Q);(0,yY.extendSubschemaData)(W,this.it,Q),(0,yY.extendSubschemaMode)(W,Q);let Y={...this.it,...W,items:void 0,props:void 0};return mw(Y,$),Y}mergeEvaluated(Q,$){let{it:W,gen:Y}=this;if(!W.opts.unevaluated)return;if(W.props!==!0&&Q.props!==void 0)W.props=X6.mergeEvaluated.props(Y,Q.props,W.props,$);if(W.items!==!0&&Q.items!==void 0)W.items=X6.mergeEvaluated.items(Y,Q.items,W.items,$)}mergeValidEvaluated(Q,$){let{it:W,gen:Y}=this;if(W.opts.unevaluated&&(W.props!==!0||W.items!==!0))return Y.if($,()=>this.mergeEvaluated(Q,y.Name)),!0}}_6.KeywordCxt=fY;function SG(Q,$,W,Y){let X=new fY(Q,W,$);if("code"in W)W.code(X,Y);else if(X.$data&&W.validate)(0,e9.funcKeywordCode)(X,W);else if("macro"in W)(0,e9.macroKeywordCode)(X,W);else if(W.compile||W.validate)(0,e9.funcKeywordCode)(X,W)}var WO=/^\/(?:[^~]|~0|~1)*$/,YO=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ZG(Q,{dataLevel:$,dataNames:W,dataPathArr:Y}){let X,J;if(Q==="")return m.default.rootData;if(Q[0]==="/"){if(!WO.test(Q))throw Error(`Invalid JSON-pointer: ${Q}`);X=Q,J=m.default.rootData}else{let K=YO.exec(Q);if(!K)throw Error(`Invalid JSON-pointer: ${Q}`);let F=+K[1];if(X=K[2],X==="#"){if(F>=$)throw Error(B("property/index",F));return Y[$-F]}if(F>$)throw Error(B("data",F));if(J=W[$-F],!X)return J}let H=J,G=X.split("/");for(let K of G)if(K)J=y._`${J}${(0,y.getProperty)((0,X6.unescapeJsonPointer)(K))}`,H=y._`${H} && ${J}`;return H;function B(K,F){return`Cannot access ${K} ${F} levels up, current level is ${$}`}}_6.getData=ZG});var p5=b((uY)=>{Object.defineProperty(uY,"__esModule",{value:!0});class CG extends Error{constructor(Q){super("validation failed");this.errors=Q,this.ajv=this.validation=!0}}uY.default=CG});var $Q=b((mY)=>{Object.defineProperty(mY,"__esModule",{value:!0});var lY=t9();class bG extends Error{constructor(Q,$,W,Y){super(Y||`can't resolve reference ${W} from id ${$}`);this.missingRef=(0,lY.resolveUrl)(Q,$,W),this.missingSchema=(0,lY.normalizeId)((0,lY.getFullPath)(Q,this.missingRef))}}mY.default=bG});var i5=b((j1)=>{Object.defineProperty(j1,"__esModule",{value:!0});j1.resolveSchema=j1.getCompilingSchema=j1.resolveRef=j1.compileSchema=j1.SchemaEnv=void 0;var x1=i(),XO=p5(),W8=Y6(),y1=t9(),vG=G0(),JO=QQ();class WQ{constructor(Q){var $;this.refs={},this.dynamicAnchors={};let W;if(typeof Q.schema=="object")W=Q.schema;this.schema=Q.schema,this.schemaId=Q.schemaId,this.root=Q.root||this,this.baseId=($=Q.baseId)!==null&&$!==void 0?$:(0,y1.normalizeId)(W===null||W===void 0?void 0:W[Q.schemaId||"$id"]),this.schemaPath=Q.schemaPath,this.localRefs=Q.localRefs,this.meta=Q.meta,this.$async=W===null||W===void 0?void 0:W.$async,this.refs={}}}j1.SchemaEnv=WQ;function pY(Q){let $=kG.call(this,Q);if($)return $;let W=(0,y1.getFullPath)(this.opts.uriResolver,Q.root.baseId),{es5:Y,lines:X}=this.opts.code,{ownProperties:J}=this.opts,H=new x1.CodeGen(this.scope,{es5:Y,lines:X,ownProperties:J}),G;if(Q.$async)G=H.scopeValue("Error",{ref:XO.default,code:x1._`require("ajv/dist/runtime/validation_error").default`});let B=H.scopeName("validate");Q.validateName=B;let K={gen:H,allErrors:this.opts.allErrors,data:W8.default.data,parentData:W8.default.parentData,parentDataProperty:W8.default.parentDataProperty,dataNames:[W8.default.data],dataPathArr:[x1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:H.scopeValue("schema",this.opts.code.source===!0?{ref:Q.schema,code:(0,x1.stringify)(Q.schema)}:{ref:Q.schema}),validateName:B,ValidationError:G,schema:Q.schema,schemaEnv:Q,rootId:W,baseId:Q.baseId||W,schemaPath:x1.nil,errSchemaPath:Q.schemaPath||(this.opts.jtd?"":"#"),errorPath:x1._`""`,opts:this.opts,self:this},F;try{this._compilations.add(Q),(0,JO.validateFunctionCode)(K),H.optimize(this.opts.code.optimize);let q=H.toString();if(F=`${H.scopeRefs(W8.default.scope)}return ${q}`,this.opts.code.process)F=this.opts.code.process(F,Q);let V=Function(`${W8.default.self}`,`${W8.default.scope}`,F)(this,this.scope.get());if(this.scope.value(B,{ref:V}),V.errors=null,V.schema=Q.schema,V.schemaEnv=Q,Q.$async)V.$async=!0;if(this.opts.code.source===!0)V.source={validateName:B,validateCode:q,scopeValues:H._values};if(this.opts.unevaluated){let{props:U,items:z}=K;if(V.evaluated={props:U instanceof x1.Name?void 0:U,items:z instanceof x1.Name?void 0:z,dynamicProps:U instanceof x1.Name,dynamicItems:z instanceof x1.Name},V.source)V.source.evaluated=(0,x1.stringify)(V.evaluated)}return Q.validate=V,Q}catch(q){if(delete Q.validate,delete Q.validateName,F)this.logger.error("Error compiling schema, function code:",F);throw q}finally{this._compilations.delete(Q)}}j1.compileSchema=pY;function HO(Q,$,W){var Y;W=(0,y1.resolveUrl)(this.opts.uriResolver,$,W);let X=Q.refs[W];if(X)return X;let J=KO.call(this,Q,W);if(J===void 0){let H=(Y=Q.localRefs)===null||Y===void 0?void 0:Y[W],{schemaId:G}=this.opts;if(H)J=new WQ({schema:H,schemaId:G,root:Q,baseId:$})}if(J===void 0)return;return Q.refs[W]=GO.call(this,J)}j1.resolveRef=HO;function GO(Q){if((0,y1.inlineRef)(Q.schema,this.opts.inlineRefs))return Q.schema;return Q.validate?Q:pY.call(this,Q)}function kG(Q){for(let $ of this._compilations)if(BO($,Q))return $}j1.getCompilingSchema=kG;function BO(Q,$){return Q.schema===$.schema&&Q.root===$.root&&Q.baseId===$.baseId}function KO(Q,$){let W;while(typeof(W=this.refs[$])=="string")$=W;return W||this.schemas[$]||d5.call(this,Q,$)}function d5(Q,$){let W=this.opts.uriResolver.parse($),Y=(0,y1._getFullPath)(this.opts.uriResolver,W),X=(0,y1.getFullPath)(this.opts.uriResolver,Q.baseId,void 0);if(Object.keys(Q.schema).length>0&&Y===X)return cY.call(this,W,Q);let J=(0,y1.normalizeId)(Y),H=this.refs[J]||this.schemas[J];if(typeof H=="string"){let G=d5.call(this,Q,H);if(typeof(G===null||G===void 0?void 0:G.schema)!=="object")return;return cY.call(this,W,G)}if(typeof(H===null||H===void 0?void 0:H.schema)!=="object")return;if(!H.validate)pY.call(this,H);if(J===(0,y1.normalizeId)($)){let{schema:G}=H,{schemaId:B}=this.opts,K=G[B];if(K)X=(0,y1.resolveUrl)(this.opts.uriResolver,X,K);return new WQ({schema:G,schemaId:B,root:Q,baseId:X})}return cY.call(this,W,H)}j1.resolveSchema=d5;var FO=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function cY(Q,{baseId:$,schema:W,root:Y}){var X;if(((X=Q.fragment)===null||X===void 0?void 0:X[0])!=="/")return;for(let G of Q.fragment.slice(1).split("/")){if(typeof W==="boolean")return;let B=W[(0,vG.unescapeFragment)(G)];if(B===void 0)return;W=B;let K=typeof W==="object"&&W[this.opts.schemaId];if(!FO.has(G)&&K)$=(0,y1.resolveUrl)(this.opts.uriResolver,$,K)}let J;if(typeof W!="boolean"&&W.$ref&&!(0,vG.schemaHasRulesButRef)(W,this.RULES)){let G=(0,y1.resolveUrl)(this.opts.uriResolver,$,W.$ref);J=d5.call(this,Y,G)}let{schemaId:H}=this.opts;if(J=J||new WQ({schema:W,schemaId:H,root:Y,baseId:$}),J.schema!==J.root.schema)return J;return}});var TG=b((IZ,LO)=>{LO.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var iY=b((SZ,gG)=>{var qO=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),xG=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function dY(Q){let $="",W=0,Y=0;for(Y=0;Y<Q.length;Y++){if(W=Q[Y].charCodeAt(0),W===48)continue;if(!(W>=48&&W<=57||W>=65&&W<=70||W>=97&&W<=102))return"";$+=Q[Y];break}for(Y+=1;Y<Q.length;Y++){if(W=Q[Y].charCodeAt(0),!(W>=48&&W<=57||W>=65&&W<=70||W>=97&&W<=102))return"";$+=Q[Y]}return $}var VO=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function _G(Q){return Q.length=0,!0}function UO(Q,$,W){if(Q.length){let Y=dY(Q);if(Y!=="")$.push(Y);else return W.error=!0,!1;Q.length=0}return!0}function AO(Q){let $=0,W={error:!1,address:"",zone:""},Y=[],X=[],J=!1,H=!1,G=UO;for(let B=0;B<Q.length;B++){let K=Q[B];if(K==="["||K==="]")continue;if(K===":"){if(J===!0)H=!0;if(!G(X,Y,W))break;if(++$>7){W.error=!0;break}if(B>0&&Q[B-1]===":")J=!0;Y.push(":");continue}else if(K==="%"){if(!G(X,Y,W))break;G=_G}else{X.push(K);continue}}if(X.length)if(G===_G)W.zone=X.join("");else if(H)Y.push(X.join(""));else Y.push(dY(X));return W.address=Y.join(""),W}function yG(Q){if(zO(Q,":")<2)return{host:Q,isIPV6:!1};let $=AO(Q);if(!$.error){let{address:W,address:Y}=$;if($.zone)W+="%"+$.zone,Y+="%25"+$.zone;return{host:W,isIPV6:!0,escapedHost:Y}}else return{host:Q,isIPV6:!1}}function zO(Q,$){let W=0;for(let Y=0;Y<Q.length;Y++)if(Q[Y]===$)W++;return W}function wO(Q){let $=Q,W=[],Y=-1,X=0;while(X=$.length){if(X===1)if($===".")break;else if($==="/"){W.push("/");break}else{W.push($);break}else if(X===2){if($[0]==="."){if($[1]===".")break;else if($[1]==="/"){$=$.slice(2);continue}}else if($[0]==="/"){if($[1]==="."||$[1]==="/"){W.push("/");break}}}else if(X===3){if($==="/.."){if(W.length!==0)W.pop();W.push("/");break}}if($[0]==="."){if($[1]==="."){if($[2]==="/"){$=$.slice(3);continue}}else if($[1]==="/"){$=$.slice(2);continue}}else if($[0]==="/"){if($[1]==="."){if($[2]==="/"){$=$.slice(2);continue}else if($[2]==="."){if($[3]==="/"){if($=$.slice(3),W.length!==0)W.pop();continue}}}}if((Y=$.indexOf("/",1))===-1){W.push($);break}else W.push($.slice(0,Y)),$=$.slice(Y)}return W.join("")}function OO(Q,$){let W=$!==!0?escape:unescape;if(Q.scheme!==void 0)Q.scheme=W(Q.scheme);if(Q.userinfo!==void 0)Q.userinfo=W(Q.userinfo);if(Q.host!==void 0)Q.host=W(Q.host);if(Q.path!==void 0)Q.path=W(Q.path);if(Q.query!==void 0)Q.query=W(Q.query);if(Q.fragment!==void 0)Q.fragment=W(Q.fragment);return Q}function NO(Q){let $=[];if(Q.userinfo!==void 0)$.push(Q.userinfo),$.push("@");if(Q.host!==void 0){let W=unescape(Q.host);if(!xG(W)){let Y=yG(W);if(Y.isIPV6===!0)W=`[${Y.escapedHost}]`;else W=Q.host}$.push(W)}if(typeof Q.port==="number"||typeof Q.port==="string")$.push(":"),$.push(String(Q.port));return $.length?$.join(""):void 0}gG.exports={nonSimpleDomain:VO,recomposeAuthority:NO,normalizeComponentEncoding:OO,removeDotSegments:wO,isIPv4:xG,isUUID:qO,normalizeIPv6:yG,stringArrayToHexStripped:dY}});var mG=b((ZZ,lG)=>{var{isUUID:MO}=iY(),jO=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,DO=["http","https","ws","wss","urn","urn:uuid"];function EO(Q){return DO.indexOf(Q)!==-1}function nY(Q){if(Q.secure===!0)return!0;else if(Q.secure===!1)return!1;else if(Q.scheme)return Q.scheme.length===3&&(Q.scheme[0]==="w"||Q.scheme[0]==="W")&&(Q.scheme[1]==="s"||Q.scheme[1]==="S")&&(Q.scheme[2]==="s"||Q.scheme[2]==="S");else return!1}function hG(Q){if(!Q.host)Q.error=Q.error||"HTTP URIs must have a host.";return Q}function fG(Q){let $=String(Q.scheme).toLowerCase()==="https";if(Q.port===($?443:80)||Q.port==="")Q.port=void 0;if(!Q.path)Q.path="/";return Q}function RO(Q){return Q.secure=nY(Q),Q.resourceName=(Q.path||"/")+(Q.query?"?"+Q.query:""),Q.path=void 0,Q.query=void 0,Q}function PO(Q){if(Q.port===(nY(Q)?443:80)||Q.port==="")Q.port=void 0;if(typeof Q.secure==="boolean")Q.scheme=Q.secure?"wss":"ws",Q.secure=void 0;if(Q.resourceName){let[$,W]=Q.resourceName.split("?");Q.path=$&&$!=="/"?$:void 0,Q.query=W,Q.resourceName=void 0}return Q.fragment=void 0,Q}function IO(Q,$){if(!Q.path)return Q.error="URN can not be parsed",Q;let W=Q.path.match(jO);if(W){let Y=$.scheme||Q.scheme||"urn";Q.nid=W[1].toLowerCase(),Q.nss=W[2];let X=`${Y}:${$.nid||Q.nid}`,J=rY(X);if(Q.path=void 0,J)Q=J.parse(Q,$)}else Q.error=Q.error||"URN can not be parsed.";return Q}function SO(Q,$){if(Q.nid===void 0)throw Error("URN without nid cannot be serialized");let W=$.scheme||Q.scheme||"urn",Y=Q.nid.toLowerCase(),X=`${W}:${$.nid||Y}`,J=rY(X);if(J)Q=J.serialize(Q,$);let H=Q,G=Q.nss;return H.path=`${Y||$.nid}:${G}`,$.skipEscape=!0,H}function ZO(Q,$){let W=Q;if(W.uuid=W.nss,W.nss=void 0,!$.tolerant&&(!W.uuid||!MO(W.uuid)))W.error=W.error||"UUID is not valid.";return W}function CO(Q){let $=Q;return $.nss=(Q.uuid||"").toLowerCase(),$}var uG={scheme:"http",domainHost:!0,parse:hG,serialize:fG},bO={scheme:"https",domainHost:uG.domainHost,parse:hG,serialize:fG},n5={scheme:"ws",domainHost:!0,parse:RO,serialize:PO},vO={scheme:"wss",domainHost:n5.domainHost,parse:n5.parse,serialize:n5.serialize},kO={scheme:"urn",parse:IO,serialize:SO,skipNormalize:!0},TO={scheme:"urn:uuid",parse:ZO,serialize:CO,skipNormalize:!0},r5={http:uG,https:bO,ws:n5,wss:vO,urn:kO,"urn:uuid":TO};Object.setPrototypeOf(r5,null);function rY(Q){return Q&&(r5[Q]||r5[Q.toLowerCase()])||void 0}lG.exports={wsIsSecure:nY,SCHEMES:r5,isValidSchemeName:EO,getSchemeHandler:rY}});var dG=b((CZ,a5)=>{var{normalizeIPv6:_O,removeDotSegments:YQ,recomposeAuthority:xO,normalizeComponentEncoding:o5,isIPv4:yO,nonSimpleDomain:gO}=iY(),{SCHEMES:hO,getSchemeHandler:cG}=mG();function fO(Q,$){if(typeof Q==="string")Q=r1(J6(Q,$),$);else if(typeof Q==="object")Q=J6(r1(Q,$),$);return Q}function uO(Q,$,W){let Y=W?Object.assign({scheme:"null"},W):{scheme:"null"},X=pG(J6(Q,Y),J6($,Y),Y,!0);return Y.skipEscape=!0,r1(X,Y)}function pG(Q,$,W,Y){let X={};if(!Y)Q=J6(r1(Q,W),W),$=J6(r1($,W),W);if(W=W||{},!W.tolerant&&$.scheme)X.scheme=$.scheme,X.userinfo=$.userinfo,X.host=$.host,X.port=$.port,X.path=YQ($.path||""),X.query=$.query;else{if($.userinfo!==void 0||$.host!==void 0||$.port!==void 0)X.userinfo=$.userinfo,X.host=$.host,X.port=$.port,X.path=YQ($.path||""),X.query=$.query;else{if(!$.path)if(X.path=Q.path,$.query!==void 0)X.query=$.query;else X.query=Q.query;else{if($.path[0]==="/")X.path=YQ($.path);else{if((Q.userinfo!==void 0||Q.host!==void 0||Q.port!==void 0)&&!Q.path)X.path="/"+$.path;else if(!Q.path)X.path=$.path;else X.path=Q.path.slice(0,Q.path.lastIndexOf("/")+1)+$.path;X.path=YQ(X.path)}X.query=$.query}X.userinfo=Q.userinfo,X.host=Q.host,X.port=Q.port}X.scheme=Q.scheme}return X.fragment=$.fragment,X}function lO(Q,$,W){if(typeof Q==="string")Q=unescape(Q),Q=r1(o5(J6(Q,W),!0),{...W,skipEscape:!0});else if(typeof Q==="object")Q=r1(o5(Q,!0),{...W,skipEscape:!0});if(typeof $==="string")$=unescape($),$=r1(o5(J6($,W),!0),{...W,skipEscape:!0});else if(typeof $==="object")$=r1(o5($,!0),{...W,skipEscape:!0});return Q.toLowerCase()===$.toLowerCase()}function r1(Q,$){let W={host:Q.host,scheme:Q.scheme,userinfo:Q.userinfo,port:Q.port,path:Q.path,query:Q.query,nid:Q.nid,nss:Q.nss,uuid:Q.uuid,fragment:Q.fragment,reference:Q.reference,resourceName:Q.resourceName,secure:Q.secure,error:""},Y=Object.assign({},$),X=[],J=cG(Y.scheme||W.scheme);if(J&&J.serialize)J.serialize(W,Y);if(W.path!==void 0)if(!Y.skipEscape){if(W.path=escape(W.path),W.scheme!==void 0)W.path=W.path.split("%3A").join(":")}else W.path=unescape(W.path);if(Y.reference!=="suffix"&&W.scheme)X.push(W.scheme,":");let H=xO(W);if(H!==void 0){if(Y.reference!=="suffix")X.push("//");if(X.push(H),W.path&&W.path[0]!=="/")X.push("/")}if(W.path!==void 0){let G=W.path;if(!Y.absolutePath&&(!J||!J.absolutePath))G=YQ(G);if(H===void 0&&G[0]==="/"&&G[1]==="/")G="/%2F"+G.slice(2);X.push(G)}if(W.query!==void 0)X.push("?",W.query);if(W.fragment!==void 0)X.push("#",W.fragment);return X.join("")}var mO=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function J6(Q,$){let W=Object.assign({},$),Y={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},X=!1;if(W.reference==="suffix")if(W.scheme)Q=W.scheme+":"+Q;else Q="//"+Q;let J=Q.match(mO);if(J){if(Y.scheme=J[1],Y.userinfo=J[3],Y.host=J[4],Y.port=parseInt(J[5],10),Y.path=J[6]||"",Y.query=J[7],Y.fragment=J[8],isNaN(Y.port))Y.port=J[5];if(Y.host)if(yO(Y.host)===!1){let B=_O(Y.host);Y.host=B.host.toLowerCase(),X=B.isIPV6}else X=!0;if(Y.scheme===void 0&&Y.userinfo===void 0&&Y.host===void 0&&Y.port===void 0&&Y.query===void 0&&!Y.path)Y.reference="same-document";else if(Y.scheme===void 0)Y.reference="relative";else if(Y.fragment===void 0)Y.reference="absolute";else Y.reference="uri";if(W.reference&&W.reference!=="suffix"&&W.reference!==Y.reference)Y.error=Y.error||"URI is not a "+W.reference+" reference.";let H=cG(W.scheme||Y.scheme);if(!W.unicodeSupport&&(!H||!H.unicodeSupport)){if(Y.host&&(W.domainHost||H&&H.domainHost)&&X===!1&&gO(Y.host))try{Y.host=URL.domainToASCII(Y.host.toLowerCase())}catch(G){Y.error=Y.error||"Host's domain name can not be converted to ASCII: "+G}}if(!H||H&&!H.skipNormalize){if(Q.indexOf("%")!==-1){if(Y.scheme!==void 0)Y.scheme=unescape(Y.scheme);if(Y.host!==void 0)Y.host=unescape(Y.host)}if(Y.path)Y.path=escape(unescape(Y.path));if(Y.fragment)Y.fragment=encodeURI(decodeURIComponent(Y.fragment))}if(H&&H.parse)H.parse(Y,W)}else Y.error=Y.error||"URI can not be parsed.";return Y}var oY={SCHEMES:hO,normalize:fO,resolve:uO,resolveComponent:pG,equal:lO,serialize:r1,parse:J6};a5.exports=oY;a5.exports.default=oY;a5.exports.fastUri=oY});var nG=b((aY)=>{Object.defineProperty(aY,"__esModule",{value:!0});var iG=dG();iG.code='require("ajv/dist/runtime/uri").default';aY.default=iG});var $B=b((u0)=>{Object.defineProperty(u0,"__esModule",{value:!0});u0.CodeGen=u0.Name=u0.nil=u0.stringify=u0.str=u0._=u0.KeywordCxt=void 0;var cO=QQ();Object.defineProperty(u0,"KeywordCxt",{enumerable:!0,get:function(){return cO.KeywordCxt}});var a8=i();Object.defineProperty(u0,"_",{enumerable:!0,get:function(){return a8._}});Object.defineProperty(u0,"str",{enumerable:!0,get:function(){return a8.str}});Object.defineProperty(u0,"stringify",{enumerable:!0,get:function(){return a8.stringify}});Object.defineProperty(u0,"nil",{enumerable:!0,get:function(){return a8.nil}});Object.defineProperty(u0,"Name",{enumerable:!0,get:function(){return a8.Name}});Object.defineProperty(u0,"CodeGen",{enumerable:!0,get:function(){return a8.CodeGen}});var pO=p5(),sG=$Q(),dO=IY(),XQ=i5(),iO=i(),JQ=t9(),t5=a9(),sY=G0(),rG=TG(),nO=nG(),eG=(Q,$)=>new RegExp(Q,$);eG.code="new RegExp";var rO=["removeAdditional","useDefaults","coerceTypes"],oO=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),aO={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},tO={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},oG=200;function sO(Q){var $,W,Y,X,J,H,G,B,K,F,q,A,V,U,z,w,O,D,j,S,C,K0,b0,f1,q6;let u1=Q.strict,U9=($=Q.code)===null||$===void 0?void 0:$.optimize,V6=U9===!0||U9===void 0?1:U9||0,E0=(Y=(W=Q.code)===null||W===void 0?void 0:W.regExp)!==null&&Y!==void 0?Y:eG,F1=(X=Q.uriResolver)!==null&&X!==void 0?X:nO.default;return{strictSchema:(H=(J=Q.strictSchema)!==null&&J!==void 0?J:u1)!==null&&H!==void 0?H:!0,strictNumbers:(B=(G=Q.strictNumbers)!==null&&G!==void 0?G:u1)!==null&&B!==void 0?B:!0,strictTypes:(F=(K=Q.strictTypes)!==null&&K!==void 0?K:u1)!==null&&F!==void 0?F:"log",strictTuples:(A=(q=Q.strictTuples)!==null&&q!==void 0?q:u1)!==null&&A!==void 0?A:"log",strictRequired:(U=(V=Q.strictRequired)!==null&&V!==void 0?V:u1)!==null&&U!==void 0?U:!1,code:Q.code?{...Q.code,optimize:V6,regExp:E0}:{optimize:V6,regExp:E0},loopRequired:(z=Q.loopRequired)!==null&&z!==void 0?z:oG,loopEnum:(w=Q.loopEnum)!==null&&w!==void 0?w:oG,meta:(O=Q.meta)!==null&&O!==void 0?O:!0,messages:(D=Q.messages)!==null&&D!==void 0?D:!0,inlineRefs:(j=Q.inlineRefs)!==null&&j!==void 0?j:!0,schemaId:(S=Q.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(C=Q.addUsedSchema)!==null&&C!==void 0?C:!0,validateSchema:(K0=Q.validateSchema)!==null&&K0!==void 0?K0:!0,validateFormats:(b0=Q.validateFormats)!==null&&b0!==void 0?b0:!0,unicodeRegExp:(f1=Q.unicodeRegExp)!==null&&f1!==void 0?f1:!0,int32range:(q6=Q.int32range)!==null&&q6!==void 0?q6:!0,uriResolver:F1}}class s5{constructor(Q={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Q=this.opts={...Q,...sO(Q)};let{es5:$,lines:W}=this.opts.code;this.scope=new iO.ValueScope({scope:{},prefixes:oO,es5:$,lines:W}),this.logger=XN(Q.logger);let Y=Q.validateFormats;if(Q.validateFormats=!1,this.RULES=(0,dO.getRules)(),aG.call(this,aO,Q,"NOT SUPPORTED"),aG.call(this,tO,Q,"DEPRECATED","warn"),this._metaOpts=WN.call(this),Q.formats)QN.call(this);if(this._addVocabularies(),this._addDefaultMetaSchema(),Q.keywords)$N.call(this,Q.keywords);if(typeof Q.meta=="object")this.addMetaSchema(Q.meta);eO.call(this),Q.validateFormats=Y}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:Q,meta:$,schemaId:W}=this.opts,Y=rG;if(W==="id")Y={...rG},Y.id=Y.$id,delete Y.$id;if($&&Q)this.addMetaSchema(Y,Y[W],!1)}defaultMeta(){let{meta:Q,schemaId:$}=this.opts;return this.opts.defaultMeta=typeof Q=="object"?Q[$]||Q:void 0}validate(Q,$){let W;if(typeof Q=="string"){if(W=this.getSchema(Q),!W)throw Error(`no schema with key or ref "${Q}"`)}else W=this.compile(Q);let Y=W($);if(!("$async"in W))this.errors=W.errors;return Y}compile(Q,$){let W=this._addSchema(Q,$);return W.validate||this._compileSchemaEnv(W)}compileAsync(Q,$){if(typeof this.opts.loadSchema!="function")throw Error("options.loadSchema should be a function");let{loadSchema:W}=this.opts;return Y.call(this,Q,$);async function Y(K,F){await X.call(this,K.$schema);let q=this._addSchema(K,F);return q.validate||J.call(this,q)}async function X(K){if(K&&!this.getSchema(K))await Y.call(this,{$ref:K},!0)}async function J(K){try{return this._compileSchemaEnv(K)}catch(F){if(!(F instanceof sG.default))throw F;return H.call(this,F),await G.call(this,F.missingSchema),J.call(this,K)}}function H({missingSchema:K,missingRef:F}){if(this.refs[K])throw Error(`AnySchema ${K} is loaded but ${F} cannot be resolved`)}async function G(K){let F=await B.call(this,K);if(!this.refs[K])await X.call(this,F.$schema);if(!this.refs[K])this.addSchema(F,K,$)}async function B(K){let F=this._loading[K];if(F)return F;try{return await(this._loading[K]=W(K))}finally{delete this._loading[K]}}}addSchema(Q,$,W,Y=this.opts.validateSchema){if(Array.isArray(Q)){for(let J of Q)this.addSchema(J,void 0,W,Y);return this}let X;if(typeof Q==="object"){let{schemaId:J}=this.opts;if(X=Q[J],X!==void 0&&typeof X!="string")throw Error(`schema ${J} must be string`)}return $=(0,JQ.normalizeId)($||X),this._checkUnique($),this.schemas[$]=this._addSchema(Q,W,$,Y,!0),this}addMetaSchema(Q,$,W=this.opts.validateSchema){return this.addSchema(Q,$,!0,W),this}validateSchema(Q,$){if(typeof Q=="boolean")return!0;let W;if(W=Q.$schema,W!==void 0&&typeof W!="string")throw Error("$schema must be a string");if(W=W||this.opts.defaultMeta||this.defaultMeta(),!W)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let Y=this.validate(W,Q);if(!Y&&$){let X="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(X);else throw Error(X)}return Y}getSchema(Q){let $;while(typeof($=tG.call(this,Q))=="string")Q=$;if($===void 0){let{schemaId:W}=this.opts,Y=new XQ.SchemaEnv({schema:{},schemaId:W});if($=XQ.resolveSchema.call(this,Y,Q),!$)return;this.refs[Q]=$}return $.validate||this._compileSchemaEnv($)}removeSchema(Q){if(Q instanceof RegExp)return this._removeAllSchemas(this.schemas,Q),this._removeAllSchemas(this.refs,Q),this;switch(typeof Q){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let $=tG.call(this,Q);if(typeof $=="object")this._cache.delete($.schema);return delete this.schemas[Q],delete this.refs[Q],this}case"object":{let $=Q;this._cache.delete($);let W=Q[this.opts.schemaId];if(W)W=(0,JQ.normalizeId)(W),delete this.schemas[W],delete this.refs[W];return this}default:throw Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Q){for(let $ of Q)this.addKeyword($);return this}addKeyword(Q,$){let W;if(typeof Q=="string"){if(W=Q,typeof $=="object")this.logger.warn("these parameters are deprecated, see docs for addKeyword"),$.keyword=W}else if(typeof Q=="object"&&$===void 0){if($=Q,W=$.keyword,Array.isArray(W)&&!W.length)throw Error("addKeywords: keyword must be string or non-empty array")}else throw Error("invalid addKeywords parameters");if(HN.call(this,W,$),!$)return(0,sY.eachItem)(W,(X)=>tY.call(this,X)),this;BN.call(this,$);let Y={...$,type:(0,t5.getJSONTypes)($.type),schemaType:(0,t5.getJSONTypes)($.schemaType)};return(0,sY.eachItem)(W,Y.type.length===0?(X)=>tY.call(this,X,Y):(X)=>Y.type.forEach((J)=>tY.call(this,X,Y,J))),this}getKeyword(Q){let $=this.RULES.all[Q];return typeof $=="object"?$.definition:!!$}removeKeyword(Q){let{RULES:$}=this;delete $.keywords[Q],delete $.all[Q];for(let W of $.rules){let Y=W.rules.findIndex((X)=>X.keyword===Q);if(Y>=0)W.rules.splice(Y,1)}return this}addFormat(Q,$){if(typeof $=="string")$=new RegExp($);return this.formats[Q]=$,this}errorsText(Q=this.errors,{separator:$=", ",dataVar:W="data"}={}){if(!Q||Q.length===0)return"No errors";return Q.map((Y)=>`${W}${Y.instancePath} ${Y.message}`).reduce((Y,X)=>Y+$+X)}$dataMetaSchema(Q,$){let W=this.RULES.all;Q=JSON.parse(JSON.stringify(Q));for(let Y of $){let X=Y.split("/").slice(1),J=Q;for(let H of X)J=J[H];for(let H in W){let G=W[H];if(typeof G!="object")continue;let{$data:B}=G.definition,K=J[H];if(B&&K)J[H]=QB(K)}}return Q}_removeAllSchemas(Q,$){for(let W in Q){let Y=Q[W];if(!$||$.test(W)){if(typeof Y=="string")delete Q[W];else if(Y&&!Y.meta)this._cache.delete(Y.schema),delete Q[W]}}}_addSchema(Q,$,W,Y=this.opts.validateSchema,X=this.opts.addUsedSchema){let J,{schemaId:H}=this.opts;if(typeof Q=="object")J=Q[H];else if(this.opts.jtd)throw Error("schema must be object");else if(typeof Q!="boolean")throw Error("schema must be object or boolean");let G=this._cache.get(Q);if(G!==void 0)return G;W=(0,JQ.normalizeId)(J||W);let B=JQ.getSchemaRefs.call(this,Q,W);if(G=new XQ.SchemaEnv({schema:Q,schemaId:H,meta:$,baseId:W,localRefs:B}),this._cache.set(G.schema,G),X&&!W.startsWith("#")){if(W)this._checkUnique(W);this.refs[W]=G}if(Y)this.validateSchema(Q,!0);return G}_checkUnique(Q){if(this.schemas[Q]||this.refs[Q])throw Error(`schema with key or id "${Q}" already exists`)}_compileSchemaEnv(Q){if(Q.meta)this._compileMetaSchema(Q);else XQ.compileSchema.call(this,Q);if(!Q.validate)throw Error("ajv implementation error");return Q.validate}_compileMetaSchema(Q){let $=this.opts;this.opts=this._metaOpts;try{XQ.compileSchema.call(this,Q)}finally{this.opts=$}}}s5.ValidationError=pO.default;s5.MissingRefError=sG.default;u0.default=s5;function aG(Q,$,W,Y="error"){for(let X in Q){let J=X;if(J in $)this.logger[Y](`${W}: option ${X}. ${Q[J]}`)}}function tG(Q){return Q=(0,JQ.normalizeId)(Q),this.schemas[Q]||this.refs[Q]}function eO(){let Q=this.opts.schemas;if(!Q)return;if(Array.isArray(Q))this.addSchema(Q);else for(let $ in Q)this.addSchema(Q[$],$)}function QN(){for(let Q in this.opts.formats){let $=this.opts.formats[Q];if($)this.addFormat(Q,$)}}function $N(Q){if(Array.isArray(Q)){this.addVocabulary(Q);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let $ in Q){let W=Q[$];if(!W.keyword)W.keyword=$;this.addKeyword(W)}}function WN(){let Q={...this.opts};for(let $ of rO)delete Q[$];return Q}var YN={log(){},warn(){},error(){}};function XN(Q){if(Q===!1)return YN;if(Q===void 0)return console;if(Q.log&&Q.warn&&Q.error)return Q;throw Error("logger must implement log, warn and error methods")}var JN=/^[a-z_$][a-z0-9_$:-]*$/i;function HN(Q,$){let{RULES:W}=this;if((0,sY.eachItem)(Q,(Y)=>{if(W.keywords[Y])throw Error(`Keyword ${Y} is already defined`);if(!JN.test(Y))throw Error(`Keyword ${Y} has invalid name`)}),!$)return;if($.$data&&!(("code"in $)||("validate"in $)))throw Error('$data keyword must have "code" or "validate" function')}function tY(Q,$,W){var Y;let X=$===null||$===void 0?void 0:$.post;if(W&&X)throw Error('keyword with "post" flag cannot have "type"');let{RULES:J}=this,H=X?J.post:J.rules.find(({type:B})=>B===W);if(!H)H={type:W,rules:[]},J.rules.push(H);if(J.keywords[Q]=!0,!$)return;let G={keyword:Q,definition:{...$,type:(0,t5.getJSONTypes)($.type),schemaType:(0,t5.getJSONTypes)($.schemaType)}};if($.before)GN.call(this,H,G,$.before);else H.rules.push(G);J.all[Q]=G,(Y=$.implements)===null||Y===void 0||Y.forEach((B)=>this.addKeyword(B))}function GN(Q,$,W){let Y=Q.rules.findIndex((X)=>X.keyword===W);if(Y>=0)Q.rules.splice(Y,0,$);else Q.rules.push($),this.logger.warn(`rule ${W} is not defined`)}function BN(Q){let{metaSchema:$}=Q;if($===void 0)return;if(Q.$data&&this.opts.$data)$=QB($);Q.validateSchema=this.compile($,!0)}var KN={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function QB(Q){return{anyOf:[Q,KN]}}});var WB=b((eY)=>{Object.defineProperty(eY,"__esModule",{value:!0});var FN={keyword:"id",code(){throw Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};eY.default=FN});var HB=b((Y8)=>{Object.defineProperty(Y8,"__esModule",{value:!0});Y8.callRef=Y8.getValidate=void 0;var LN=$Q(),YB=M1(),B1=i(),t8=Y6(),XB=i5(),e5=G0(),qN={keyword:"$ref",schemaType:"string",code(Q){let{gen:$,schema:W,it:Y}=Q,{baseId:X,schemaEnv:J,validateName:H,opts:G,self:B}=Y,{root:K}=J;if((W==="#"||W==="#/")&&X===K.baseId)return q();let F=XB.resolveRef.call(B,K,X,W);if(F===void 0)throw new LN.default(Y.opts.uriResolver,X,W);if(F instanceof XB.SchemaEnv)return A(F);return V(F);function q(){if(J===K)return Q4(Q,H,J,J.$async);let U=$.scopeValue("root",{ref:K});return Q4(Q,B1._`${U}.validate`,K,K.$async)}function A(U){let z=JB(Q,U);Q4(Q,z,U,U.$async)}function V(U){let z=$.scopeValue("schema",G.code.source===!0?{ref:U,code:(0,B1.stringify)(U)}:{ref:U}),w=$.name("valid"),O=Q.subschema({schema:U,dataTypes:[],schemaPath:B1.nil,topSchemaRef:z,errSchemaPath:W},w);Q.mergeEvaluated(O),Q.ok(w)}}};function JB(Q,$){let{gen:W}=Q;return $.validate?W.scopeValue("validate",{ref:$.validate}):B1._`${W.scopeValue("wrapper",{ref:$})}.validate`}Y8.getValidate=JB;function Q4(Q,$,W,Y){let{gen:X,it:J}=Q,{allErrors:H,schemaEnv:G,opts:B}=J,K=B.passContext?t8.default.this:B1.nil;if(Y)F();else q();function F(){if(!G.$async)throw Error("async schema referenced by sync schema");let U=X.let("valid");X.try(()=>{if(X.code(B1._`await ${(0,YB.callValidateCode)(Q,$,K)}`),V($),!H)X.assign(U,!0)},(z)=>{if(X.if(B1._`!(${z} instanceof ${J.ValidationError})`,()=>X.throw(z)),A(z),!H)X.assign(U,!1)}),Q.ok(U)}function q(){Q.result((0,YB.callValidateCode)(Q,$,K),()=>V($),()=>A($))}function A(U){let z=B1._`${U}.errors`;X.assign(t8.default.vErrors,B1._`${t8.default.vErrors} === null ? ${z} : ${t8.default.vErrors}.concat(${z})`),X.assign(t8.default.errors,B1._`${t8.default.vErrors}.length`)}function V(U){var z;if(!J.opts.unevaluated)return;let w=(z=W===null||W===void 0?void 0:W.validate)===null||z===void 0?void 0:z.evaluated;if(J.props!==!0)if(w&&!w.dynamicProps){if(w.props!==void 0)J.props=e5.mergeEvaluated.props(X,w.props,J.props)}else{let O=X.var("props",B1._`${U}.evaluated.props`);J.props=e5.mergeEvaluated.props(X,O,J.props,B1.Name)}if(J.items!==!0)if(w&&!w.dynamicItems){if(w.items!==void 0)J.items=e5.mergeEvaluated.items(X,w.items,J.items)}else{let O=X.var("items",B1._`${U}.evaluated.items`);J.items=e5.mergeEvaluated.items(X,O,J.items,B1.Name)}}}Y8.callRef=Q4;Y8.default=qN});var GB=b((Q7)=>{Object.defineProperty(Q7,"__esModule",{value:!0});var VN=WB(),UN=HB(),AN=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",VN.default,UN.default];Q7.default=AN});var BB=b(($7)=>{Object.defineProperty($7,"__esModule",{value:!0});var $4=i(),x6=$4.operators,W4={maximum:{okStr:"<=",ok:x6.LTE,fail:x6.GT},minimum:{okStr:">=",ok:x6.GTE,fail:x6.LT},exclusiveMaximum:{okStr:"<",ok:x6.LT,fail:x6.GTE},exclusiveMinimum:{okStr:">",ok:x6.GT,fail:x6.LTE}},zN={message:({keyword:Q,schemaCode:$})=>$4.str`must be ${W4[Q].okStr} ${$}`,params:({keyword:Q,schemaCode:$})=>$4._`{comparison: ${W4[Q].okStr}, limit: ${$}}`},wN={keyword:Object.keys(W4),type:"number",schemaType:"number",$data:!0,error:zN,code(Q){let{keyword:$,data:W,schemaCode:Y}=Q;Q.fail$data($4._`${W} ${W4[$].fail} ${Y} || isNaN(${W})`)}};$7.default=wN});var KB=b((W7)=>{Object.defineProperty(W7,"__esModule",{value:!0});var HQ=i(),ON={message:({schemaCode:Q})=>HQ.str`must be multiple of ${Q}`,params:({schemaCode:Q})=>HQ._`{multipleOf: ${Q}}`},NN={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:ON,code(Q){let{gen:$,data:W,schemaCode:Y,it:X}=Q,J=X.opts.multipleOfPrecision,H=$.let("res"),G=J?HQ._`Math.abs(Math.round(${H}) - ${H}) > 1e-${J}`:HQ._`${H} !== parseInt(${H})`;Q.fail$data(HQ._`(${Y} === 0 || (${H} = ${W}/${Y}, ${G}))`)}};W7.default=NN});var LB=b((Y7)=>{Object.defineProperty(Y7,"__esModule",{value:!0});function FB(Q){let $=Q.length,W=0,Y=0,X;while(Y<$)if(W++,X=Q.charCodeAt(Y++),X>=55296&&X<=56319&&Y<$){if(X=Q.charCodeAt(Y),(X&64512)===56320)Y++}return W}Y7.default=FB;FB.code='require("ajv/dist/runtime/ucs2length").default'});var qB=b((X7)=>{Object.defineProperty(X7,"__esModule",{value:!0});var X8=i(),MN=G0(),jN=LB(),DN={message({keyword:Q,schemaCode:$}){let W=Q==="maxLength"?"more":"fewer";return X8.str`must NOT have ${W} than ${$} characters`},params:({schemaCode:Q})=>X8._`{limit: ${Q}}`},EN={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:DN,code(Q){let{keyword:$,data:W,schemaCode:Y,it:X}=Q,J=$==="maxLength"?X8.operators.GT:X8.operators.LT,H=X.opts.unicode===!1?X8._`${W}.length`:X8._`${(0,MN.useFunc)(Q.gen,jN.default)}(${W})`;Q.fail$data(X8._`${H} ${J} ${Y}`)}};X7.default=EN});var VB=b((J7)=>{Object.defineProperty(J7,"__esModule",{value:!0});var RN=M1(),Y4=i(),PN={message:({schemaCode:Q})=>Y4.str`must match pattern "${Q}"`,params:({schemaCode:Q})=>Y4._`{pattern: ${Q}}`},IN={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:PN,code(Q){let{data:$,$data:W,schema:Y,schemaCode:X,it:J}=Q,H=J.opts.unicodeRegExp?"u":"",G=W?Y4._`(new RegExp(${X}, ${H}))`:(0,RN.usePattern)(Q,Y);Q.fail$data(Y4._`!${G}.test(${$})`)}};J7.default=IN});var UB=b((H7)=>{Object.defineProperty(H7,"__esModule",{value:!0});var GQ=i(),SN={message({keyword:Q,schemaCode:$}){let W=Q==="maxProperties"?"more":"fewer";return GQ.str`must NOT have ${W} than ${$} properties`},params:({schemaCode:Q})=>GQ._`{limit: ${Q}}`},ZN={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:SN,code(Q){let{keyword:$,data:W,schemaCode:Y}=Q,X=$==="maxProperties"?GQ.operators.GT:GQ.operators.LT;Q.fail$data(GQ._`Object.keys(${W}).length ${X} ${Y}`)}};H7.default=ZN});var AB=b((G7)=>{Object.defineProperty(G7,"__esModule",{value:!0});var BQ=M1(),KQ=i(),CN=G0(),bN={message:({params:{missingProperty:Q}})=>KQ.str`must have required property '${Q}'`,params:({params:{missingProperty:Q}})=>KQ._`{missingProperty: ${Q}}`},vN={keyword:"required",type:"object",schemaType:"array",$data:!0,error:bN,code(Q){let{gen:$,schema:W,schemaCode:Y,data:X,$data:J,it:H}=Q,{opts:G}=H;if(!J&&W.length===0)return;let B=W.length>=G.loopRequired;if(H.allErrors)K();else F();if(G.strictRequired){let V=Q.parentSchema.properties,{definedProperties:U}=Q.it;for(let z of W)if((V===null||V===void 0?void 0:V[z])===void 0&&!U.has(z)){let w=H.schemaEnv.baseId+H.errSchemaPath,O=`required property "${z}" is not defined at "${w}" (strictRequired)`;(0,CN.checkStrictMode)(H,O,H.opts.strictRequired)}}function K(){if(B||J)Q.block$data(KQ.nil,q);else for(let V of W)(0,BQ.checkReportMissingProp)(Q,V)}function F(){let V=$.let("missing");if(B||J){let U=$.let("valid",!0);Q.block$data(U,()=>A(V,U)),Q.ok(U)}else $.if((0,BQ.checkMissingProp)(Q,W,V)),(0,BQ.reportMissingProp)(Q,V),$.else()}function q(){$.forOf("prop",Y,(V)=>{Q.setParams({missingProperty:V}),$.if((0,BQ.noPropertyInData)($,X,V,G.ownProperties),()=>Q.error())})}function A(V,U){Q.setParams({missingProperty:V}),$.forOf(V,Y,()=>{$.assign(U,(0,BQ.propertyInData)($,X,V,G.ownProperties)),$.if((0,KQ.not)(U),()=>{Q.error(),$.break()})},KQ.nil)}}};G7.default=vN});var zB=b((B7)=>{Object.defineProperty(B7,"__esModule",{value:!0});var FQ=i(),kN={message({keyword:Q,schemaCode:$}){let W=Q==="maxItems"?"more":"fewer";return FQ.str`must NOT have ${W} than ${$} items`},params:({schemaCode:Q})=>FQ._`{limit: ${Q}}`},TN={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:kN,code(Q){let{keyword:$,data:W,schemaCode:Y}=Q,X=$==="maxItems"?FQ.operators.GT:FQ.operators.LT;Q.fail$data(FQ._`${W}.length ${X} ${Y}`)}};B7.default=TN});var X4=b((K7)=>{Object.defineProperty(K7,"__esModule",{value:!0});var wB=_Y();wB.code='require("ajv/dist/runtime/equal").default';K7.default=wB});var OB=b((L7)=>{Object.defineProperty(L7,"__esModule",{value:!0});var F7=a9(),l0=i(),_N=G0(),xN=X4(),yN={message:({params:{i:Q,j:$}})=>l0.str`must NOT have duplicate items (items ## ${$} and ${Q} are identical)`,params:({params:{i:Q,j:$}})=>l0._`{i: ${Q}, j: ${$}}`},gN={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:yN,code(Q){let{gen:$,data:W,$data:Y,schema:X,parentSchema:J,schemaCode:H,it:G}=Q;if(!Y&&!X)return;let B=$.let("valid"),K=J.items?(0,F7.getSchemaTypes)(J.items):[];Q.block$data(B,F,l0._`${H} === false`),Q.ok(B);function F(){let U=$.let("i",l0._`${W}.length`),z=$.let("j");Q.setParams({i:U,j:z}),$.assign(B,!0),$.if(l0._`${U} > 1`,()=>(q()?A:V)(U,z))}function q(){return K.length>0&&!K.some((U)=>U==="object"||U==="array")}function A(U,z){let w=$.name("item"),O=(0,F7.checkDataTypes)(K,w,G.opts.strictNumbers,F7.DataType.Wrong),D=$.const("indices",l0._`{}`);$.for(l0._`;${U}--;`,()=>{if($.let(w,l0._`${W}[${U}]`),$.if(O,l0._`continue`),K.length>1)$.if(l0._`typeof ${w} == "string"`,l0._`${w} += "_"`);$.if(l0._`typeof ${D}[${w}] == "number"`,()=>{$.assign(z,l0._`${D}[${w}]`),Q.error(),$.assign(B,!1).break()}).code(l0._`${D}[${w}] = ${U}`)})}function V(U,z){let w=(0,_N.useFunc)($,xN.default),O=$.name("outer");$.label(O).for(l0._`;${U}--;`,()=>$.for(l0._`${z} = ${U}; ${z}--;`,()=>$.if(l0._`${w}(${W}[${U}], ${W}[${z}])`,()=>{Q.error(),$.assign(B,!1).break(O)})))}}};L7.default=gN});var NB=b((V7)=>{Object.defineProperty(V7,"__esModule",{value:!0});var q7=i(),hN=G0(),fN=X4(),uN={message:"must be equal to constant",params:({schemaCode:Q})=>q7._`{allowedValue: ${Q}}`},lN={keyword:"const",$data:!0,error:uN,code(Q){let{gen:$,data:W,$data:Y,schemaCode:X,schema:J}=Q;if(Y||J&&typeof J=="object")Q.fail$data(q7._`!${(0,hN.useFunc)($,fN.default)}(${W}, ${X})`);else Q.fail(q7._`${J} !== ${W}`)}};V7.default=lN});var MB=b((U7)=>{Object.defineProperty(U7,"__esModule",{value:!0});var LQ=i(),mN=G0(),cN=X4(),pN={message:"must be equal to one of the allowed values",params:({schemaCode:Q})=>LQ._`{allowedValues: ${Q}}`},dN={keyword:"enum",schemaType:"array",$data:!0,error:pN,code(Q){let{gen:$,data:W,$data:Y,schema:X,schemaCode:J,it:H}=Q;if(!Y&&X.length===0)throw Error("enum must have non-empty array");let G=X.length>=H.opts.loopEnum,B,K=()=>B!==null&&B!==void 0?B:B=(0,mN.useFunc)($,cN.default),F;if(G||Y)F=$.let("valid"),Q.block$data(F,q);else{if(!Array.isArray(X))throw Error("ajv implementation error");let V=$.const("vSchema",J);F=(0,LQ.or)(...X.map((U,z)=>A(V,z)))}Q.pass(F);function q(){$.assign(F,!1),$.forOf("v",J,(V)=>$.if(LQ._`${K()}(${W}, ${V})`,()=>$.assign(F,!0).break()))}function A(V,U){let z=X[U];return typeof z==="object"&&z!==null?LQ._`${K()}(${W}, ${V}[${U}])`:LQ._`${W} === ${z}`}}};U7.default=dN});var jB=b((A7)=>{Object.defineProperty(A7,"__esModule",{value:!0});var iN=BB(),nN=KB(),rN=qB(),oN=VB(),aN=UB(),tN=AB(),sN=zB(),eN=OB(),QM=NB(),$M=MB(),WM=[iN.default,nN.default,rN.default,oN.default,aN.default,tN.default,sN.default,eN.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},QM.default,$M.default];A7.default=WM});var w7=b((qQ)=>{Object.defineProperty(qQ,"__esModule",{value:!0});qQ.validateAdditionalItems=void 0;var J8=i(),z7=G0(),YM={message:({params:{len:Q}})=>J8.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>J8._`{limit: ${Q}}`},XM={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:YM,code(Q){let{parentSchema:$,it:W}=Q,{items:Y}=$;if(!Array.isArray(Y)){(0,z7.checkStrictMode)(W,'"additionalItems" is ignored when "items" is not an array of schemas');return}DB(Q,Y)}};function DB(Q,$){let{gen:W,schema:Y,data:X,keyword:J,it:H}=Q;H.items=!0;let G=W.const("len",J8._`${X}.length`);if(Y===!1)Q.setParams({len:$.length}),Q.pass(J8._`${G} <= ${$.length}`);else if(typeof Y=="object"&&!(0,z7.alwaysValidSchema)(H,Y)){let K=W.var("valid",J8._`${G} <= ${$.length}`);W.if((0,J8.not)(K),()=>B(K)),Q.ok(K)}function B(K){W.forRange("i",$.length,G,(F)=>{if(Q.subschema({keyword:J,dataProp:F,dataPropType:z7.Type.Num},K),!H.allErrors)W.if((0,J8.not)(K),()=>W.break())})}}qQ.validateAdditionalItems=DB;qQ.default=XM});var O7=b((VQ)=>{Object.defineProperty(VQ,"__esModule",{value:!0});VQ.validateTuple=void 0;var EB=i(),J4=G0(),JM=M1(),HM={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(Q){let{schema:$,it:W}=Q;if(Array.isArray($))return RB(Q,"additionalItems",$);if(W.items=!0,(0,J4.alwaysValidSchema)(W,$))return;Q.ok((0,JM.validateArray)(Q))}};function RB(Q,$,W=Q.schema){let{gen:Y,parentSchema:X,data:J,keyword:H,it:G}=Q;if(F(X),G.opts.unevaluated&&W.length&&G.items!==!0)G.items=J4.mergeEvaluated.items(Y,W.length,G.items);let B=Y.name("valid"),K=Y.const("len",EB._`${J}.length`);W.forEach((q,A)=>{if((0,J4.alwaysValidSchema)(G,q))return;Y.if(EB._`${K} > ${A}`,()=>Q.subschema({keyword:H,schemaProp:A,dataProp:A},B)),Q.ok(B)});function F(q){let{opts:A,errSchemaPath:V}=G,U=W.length,z=U===q.minItems&&(U===q.maxItems||q[$]===!1);if(A.strictTuples&&!z){let w=`"${H}" is ${U}-tuple, but minItems or maxItems/${$} are not specified or different at path "${V}"`;(0,J4.checkStrictMode)(G,w,A.strictTuples)}}}VQ.validateTuple=RB;VQ.default=HM});var PB=b((N7)=>{Object.defineProperty(N7,"__esModule",{value:!0});var GM=O7(),BM={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:(Q)=>(0,GM.validateTuple)(Q,"items")};N7.default=BM});var SB=b((M7)=>{Object.defineProperty(M7,"__esModule",{value:!0});var IB=i(),KM=G0(),FM=M1(),LM=w7(),qM={message:({params:{len:Q}})=>IB.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>IB._`{limit: ${Q}}`},VM={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:qM,code(Q){let{schema:$,parentSchema:W,it:Y}=Q,{prefixItems:X}=W;if(Y.items=!0,(0,KM.alwaysValidSchema)(Y,$))return;if(X)(0,LM.validateAdditionalItems)(Q,X);else Q.ok((0,FM.validateArray)(Q))}};M7.default=VM});var ZB=b((j7)=>{Object.defineProperty(j7,"__esModule",{value:!0});var D1=i(),H4=G0(),UM={message:({params:{min:Q,max:$}})=>$===void 0?D1.str`must contain at least ${Q} valid item(s)`:D1.str`must contain at least ${Q} and no more than ${$} valid item(s)`,params:({params:{min:Q,max:$}})=>$===void 0?D1._`{minContains: ${Q}}`:D1._`{minContains: ${Q}, maxContains: ${$}}`},AM={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:UM,code(Q){let{gen:$,schema:W,parentSchema:Y,data:X,it:J}=Q,H,G,{minContains:B,maxContains:K}=Y;if(J.opts.next)H=B===void 0?1:B,G=K;else H=1;let F=$.const("len",D1._`${X}.length`);if(Q.setParams({min:H,max:G}),G===void 0&&H===0){(0,H4.checkStrictMode)(J,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(G!==void 0&&H>G){(0,H4.checkStrictMode)(J,'"minContains" > "maxContains" is always invalid'),Q.fail();return}if((0,H4.alwaysValidSchema)(J,W)){let z=D1._`${F} >= ${H}`;if(G!==void 0)z=D1._`${z} && ${F} <= ${G}`;Q.pass(z);return}J.items=!0;let q=$.name("valid");if(G===void 0&&H===1)V(q,()=>$.if(q,()=>$.break()));else if(H===0){if($.let(q,!0),G!==void 0)$.if(D1._`${X}.length > 0`,A)}else $.let(q,!1),A();Q.result(q,()=>Q.reset());function A(){let z=$.name("_valid"),w=$.let("count",0);V(z,()=>$.if(z,()=>U(w)))}function V(z,w){$.forRange("i",0,F,(O)=>{Q.subschema({keyword:"contains",dataProp:O,dataPropType:H4.Type.Num,compositeRule:!0},z),w()})}function U(z){if($.code(D1._`${z}++`),G===void 0)$.if(D1._`${z} >= ${H}`,()=>$.assign(q,!0).break());else if($.if(D1._`${z} > ${G}`,()=>$.assign(q,!1).break()),H===1)$.assign(q,!0);else $.if(D1._`${z} >= ${H}`,()=>$.assign(q,!0))}}};j7.default=AM});var vB=b((o1)=>{Object.defineProperty(o1,"__esModule",{value:!0});o1.validateSchemaDeps=o1.validatePropertyDeps=o1.error=void 0;var D7=i(),zM=G0(),UQ=M1();o1.error={message:({params:{property:Q,depsCount:$,deps:W}})=>{let Y=$===1?"property":"properties";return D7.str`must have ${Y} ${W} when property ${Q} is present`},params:({params:{property:Q,depsCount:$,deps:W,missingProperty:Y}})=>D7._`{property: ${Q},
    missingProperty: ${Y},
    depsCount: ${$},
    deps: ${W}}`};var wM={keyword:"dependencies",type:"object",schemaType:"object",error:o1.error,code(Q){let[$,W]=OM(Q);CB(Q,$),bB(Q,W)}};function OM({schema:Q}){let $={},W={};for(let Y in Q){if(Y==="__proto__")continue;let X=Array.isArray(Q[Y])?$:W;X[Y]=Q[Y]}return[$,W]}function CB(Q,$=Q.schema){let{gen:W,data:Y,it:X}=Q;if(Object.keys($).length===0)return;let J=W.let("missing");for(let H in $){let G=$[H];if(G.length===0)continue;let B=(0,UQ.propertyInData)(W,Y,H,X.opts.ownProperties);if(Q.setParams({property:H,depsCount:G.length,deps:G.join(", ")}),X.allErrors)W.if(B,()=>{for(let K of G)(0,UQ.checkReportMissingProp)(Q,K)});else W.if(D7._`${B} && (${(0,UQ.checkMissingProp)(Q,G,J)})`),(0,UQ.reportMissingProp)(Q,J),W.else()}}o1.validatePropertyDeps=CB;function bB(Q,$=Q.schema){let{gen:W,data:Y,keyword:X,it:J}=Q,H=W.name("valid");for(let G in $){if((0,zM.alwaysValidSchema)(J,$[G]))continue;W.if((0,UQ.propertyInData)(W,Y,G,J.opts.ownProperties),()=>{let B=Q.subschema({keyword:X,schemaProp:G},H);Q.mergeValidEvaluated(B,H)},()=>W.var(H,!0)),Q.ok(H)}}o1.validateSchemaDeps=bB;o1.default=wM});var TB=b((E7)=>{Object.defineProperty(E7,"__esModule",{value:!0});var kB=i(),NM=G0(),MM={message:"property name must be valid",params:({params:Q})=>kB._`{propertyName: ${Q.propertyName}}`},jM={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:MM,code(Q){let{gen:$,schema:W,data:Y,it:X}=Q;if((0,NM.alwaysValidSchema)(X,W))return;let J=$.name("valid");$.forIn("key",Y,(H)=>{Q.setParams({propertyName:H}),Q.subschema({keyword:"propertyNames",data:H,dataTypes:["string"],propertyName:H,compositeRule:!0},J),$.if((0,kB.not)(J),()=>{if(Q.error(!0),!X.allErrors)$.break()})}),Q.ok(J)}};E7.default=jM});var P7=b((R7)=>{Object.defineProperty(R7,"__esModule",{value:!0});var G4=M1(),g1=i(),DM=Y6(),B4=G0(),EM={message:"must NOT have additional properties",params:({params:Q})=>g1._`{additionalProperty: ${Q.additionalProperty}}`},RM={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:EM,code(Q){let{gen:$,schema:W,parentSchema:Y,data:X,errsCount:J,it:H}=Q;if(!J)throw Error("ajv implementation error");let{allErrors:G,opts:B}=H;if(H.props=!0,B.removeAdditional!=="all"&&(0,B4.alwaysValidSchema)(H,W))return;let K=(0,G4.allSchemaProperties)(Y.properties),F=(0,G4.allSchemaProperties)(Y.patternProperties);q(),Q.ok(g1._`${J} === ${DM.default.errors}`);function q(){$.forIn("key",X,(w)=>{if(!K.length&&!F.length)U(w);else $.if(A(w),()=>U(w))})}function A(w){let O;if(K.length>8){let D=(0,B4.schemaRefOrVal)(H,Y.properties,"properties");O=(0,G4.isOwnProperty)($,D,w)}else if(K.length)O=(0,g1.or)(...K.map((D)=>g1._`${w} === ${D}`));else O=g1.nil;if(F.length)O=(0,g1.or)(O,...F.map((D)=>g1._`${(0,G4.usePattern)(Q,D)}.test(${w})`));return(0,g1.not)(O)}function V(w){$.code(g1._`delete ${X}[${w}]`)}function U(w){if(B.removeAdditional==="all"||B.removeAdditional&&W===!1){V(w);return}if(W===!1){if(Q.setParams({additionalProperty:w}),Q.error(),!G)$.break();return}if(typeof W=="object"&&!(0,B4.alwaysValidSchema)(H,W)){let O=$.name("valid");if(B.removeAdditional==="failing")z(w,O,!1),$.if((0,g1.not)(O),()=>{Q.reset(),V(w)});else if(z(w,O),!G)$.if((0,g1.not)(O),()=>$.break())}}function z(w,O,D){let j={keyword:"additionalProperties",dataProp:w,dataPropType:B4.Type.Str};if(D===!1)Object.assign(j,{compositeRule:!0,createErrors:!1,allErrors:!1});Q.subschema(j,O)}}};R7.default=RM});var yB=b((S7)=>{Object.defineProperty(S7,"__esModule",{value:!0});var PM=QQ(),_B=M1(),I7=G0(),xB=P7(),IM={keyword:"properties",type:"object",schemaType:"object",code(Q){let{gen:$,schema:W,parentSchema:Y,data:X,it:J}=Q;if(J.opts.removeAdditional==="all"&&Y.additionalProperties===void 0)xB.default.code(new PM.KeywordCxt(J,xB.default,"additionalProperties"));let H=(0,_B.allSchemaProperties)(W);for(let q of H)J.definedProperties.add(q);if(J.opts.unevaluated&&H.length&&J.props!==!0)J.props=I7.mergeEvaluated.props($,(0,I7.toHash)(H),J.props);let G=H.filter((q)=>!(0,I7.alwaysValidSchema)(J,W[q]));if(G.length===0)return;let B=$.name("valid");for(let q of G){if(K(q))F(q);else{if($.if((0,_B.propertyInData)($,X,q,J.opts.ownProperties)),F(q),!J.allErrors)$.else().var(B,!0);$.endIf()}Q.it.definedProperties.add(q),Q.ok(B)}function K(q){return J.opts.useDefaults&&!J.compositeRule&&W[q].default!==void 0}function F(q){Q.subschema({keyword:"properties",schemaProp:q,dataProp:q},B)}}};S7.default=IM});var uB=b((Z7)=>{Object.defineProperty(Z7,"__esModule",{value:!0});var gB=M1(),K4=i(),hB=G0(),fB=G0(),SM={keyword:"patternProperties",type:"object",schemaType:"object",code(Q){let{gen:$,schema:W,data:Y,parentSchema:X,it:J}=Q,{opts:H}=J,G=(0,gB.allSchemaProperties)(W),B=G.filter((z)=>(0,hB.alwaysValidSchema)(J,W[z]));if(G.length===0||B.length===G.length&&(!J.opts.unevaluated||J.props===!0))return;let K=H.strictSchema&&!H.allowMatchingProperties&&X.properties,F=$.name("valid");if(J.props!==!0&&!(J.props instanceof K4.Name))J.props=(0,fB.evaluatedPropsToName)($,J.props);let{props:q}=J;A();function A(){for(let z of G){if(K)V(z);if(J.allErrors)U(z);else $.var(F,!0),U(z),$.if(F)}}function V(z){for(let w in K)if(new RegExp(z).test(w))(0,hB.checkStrictMode)(J,`property ${w} matches pattern ${z} (use allowMatchingProperties)`)}function U(z){$.forIn("key",Y,(w)=>{$.if(K4._`${(0,gB.usePattern)(Q,z)}.test(${w})`,()=>{let O=B.includes(z);if(!O)Q.subschema({keyword:"patternProperties",schemaProp:z,dataProp:w,dataPropType:fB.Type.Str},F);if(J.opts.unevaluated&&q!==!0)$.assign(K4._`${q}[${w}]`,!0);else if(!O&&!J.allErrors)$.if((0,K4.not)(F),()=>$.break())})})}}};Z7.default=SM});var lB=b((C7)=>{Object.defineProperty(C7,"__esModule",{value:!0});var ZM=G0(),CM={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(Q){let{gen:$,schema:W,it:Y}=Q;if((0,ZM.alwaysValidSchema)(Y,W)){Q.fail();return}let X=$.name("valid");Q.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},X),Q.failResult(X,()=>Q.reset(),()=>Q.error())},error:{message:"must NOT be valid"}};C7.default=CM});var mB=b((b7)=>{Object.defineProperty(b7,"__esModule",{value:!0});var bM=M1(),vM={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:bM.validateUnion,error:{message:"must match a schema in anyOf"}};b7.default=vM});var cB=b((v7)=>{Object.defineProperty(v7,"__esModule",{value:!0});var F4=i(),kM=G0(),TM={message:"must match exactly one schema in oneOf",params:({params:Q})=>F4._`{passingSchemas: ${Q.passing}}`},_M={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:TM,code(Q){let{gen:$,schema:W,parentSchema:Y,it:X}=Q;if(!Array.isArray(W))throw Error("ajv implementation error");if(X.opts.discriminator&&Y.discriminator)return;let J=W,H=$.let("valid",!1),G=$.let("passing",null),B=$.name("_valid");Q.setParams({passing:G}),$.block(K),Q.result(H,()=>Q.reset(),()=>Q.error(!0));function K(){J.forEach((F,q)=>{let A;if((0,kM.alwaysValidSchema)(X,F))$.var(B,!0);else A=Q.subschema({keyword:"oneOf",schemaProp:q,compositeRule:!0},B);if(q>0)$.if(F4._`${B} && ${H}`).assign(H,!1).assign(G,F4._`[${G}, ${q}]`).else();$.if(B,()=>{if($.assign(H,!0),$.assign(G,q),A)Q.mergeEvaluated(A,F4.Name)})})}}};v7.default=_M});var pB=b((k7)=>{Object.defineProperty(k7,"__esModule",{value:!0});var xM=G0(),yM={keyword:"allOf",schemaType:"array",code(Q){let{gen:$,schema:W,it:Y}=Q;if(!Array.isArray(W))throw Error("ajv implementation error");let X=$.name("valid");W.forEach((J,H)=>{if((0,xM.alwaysValidSchema)(Y,J))return;let G=Q.subschema({keyword:"allOf",schemaProp:H},X);Q.ok(X),Q.mergeEvaluated(G)})}};k7.default=yM});var nB=b((T7)=>{Object.defineProperty(T7,"__esModule",{value:!0});var L4=i(),iB=G0(),gM={message:({params:Q})=>L4.str`must match "${Q.ifClause}" schema`,params:({params:Q})=>L4._`{failingKeyword: ${Q.ifClause}}`},hM={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:gM,code(Q){let{gen:$,parentSchema:W,it:Y}=Q;if(W.then===void 0&&W.else===void 0)(0,iB.checkStrictMode)(Y,'"if" without "then" and "else" is ignored');let X=dB(Y,"then"),J=dB(Y,"else");if(!X&&!J)return;let H=$.let("valid",!0),G=$.name("_valid");if(B(),Q.reset(),X&&J){let F=$.let("ifClause");Q.setParams({ifClause:F}),$.if(G,K("then",F),K("else",F))}else if(X)$.if(G,K("then"));else $.if((0,L4.not)(G),K("else"));Q.pass(H,()=>Q.error(!0));function B(){let F=Q.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},G);Q.mergeEvaluated(F)}function K(F,q){return()=>{let A=Q.subschema({keyword:F},G);if($.assign(H,G),Q.mergeValidEvaluated(A,H),q)$.assign(q,L4._`${F}`);else Q.setParams({ifClause:F})}}}};function dB(Q,$){let W=Q.schema[$];return W!==void 0&&!(0,iB.alwaysValidSchema)(Q,W)}T7.default=hM});var rB=b((_7)=>{Object.defineProperty(_7,"__esModule",{value:!0});var fM=G0(),uM={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:Q,parentSchema:$,it:W}){if($.if===void 0)(0,fM.checkStrictMode)(W,`"${Q}" without "if" is ignored`)}};_7.default=uM});var oB=b((x7)=>{Object.defineProperty(x7,"__esModule",{value:!0});var lM=w7(),mM=PB(),cM=O7(),pM=SB(),dM=ZB(),iM=vB(),nM=TB(),rM=P7(),oM=yB(),aM=uB(),tM=lB(),sM=mB(),eM=cB(),Qj=pB(),$j=nB(),Wj=rB();function Yj(Q=!1){let $=[tM.default,sM.default,eM.default,Qj.default,$j.default,Wj.default,nM.default,rM.default,iM.default,oM.default,aM.default];if(Q)$.push(mM.default,pM.default);else $.push(lM.default,cM.default);return $.push(dM.default),$}x7.default=Yj});var aB=b((y7)=>{Object.defineProperty(y7,"__esModule",{value:!0});var Z0=i(),Xj={message:({schemaCode:Q})=>Z0.str`must match format "${Q}"`,params:({schemaCode:Q})=>Z0._`{format: ${Q}}`},Jj={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Xj,code(Q,$){let{gen:W,data:Y,$data:X,schema:J,schemaCode:H,it:G}=Q,{opts:B,errSchemaPath:K,schemaEnv:F,self:q}=G;if(!B.validateFormats)return;if(X)A();else V();function A(){let U=W.scopeValue("formats",{ref:q.formats,code:B.code.formats}),z=W.const("fDef",Z0._`${U}[${H}]`),w=W.let("fType"),O=W.let("format");W.if(Z0._`typeof ${z} == "object" && !(${z} instanceof RegExp)`,()=>W.assign(w,Z0._`${z}.type || "string"`).assign(O,Z0._`${z}.validate`),()=>W.assign(w,Z0._`"string"`).assign(O,z)),Q.fail$data((0,Z0.or)(D(),j()));function D(){if(B.strictSchema===!1)return Z0.nil;return Z0._`${H} && !${O}`}function j(){let S=F.$async?Z0._`(${z}.async ? await ${O}(${Y}) : ${O}(${Y}))`:Z0._`${O}(${Y})`,C=Z0._`(typeof ${O} == "function" ? ${S} : ${O}.test(${Y}))`;return Z0._`${O} && ${O} !== true && ${w} === ${$} && !${C}`}}function V(){let U=q.formats[J];if(!U){D();return}if(U===!0)return;let[z,w,O]=j(U);if(z===$)Q.pass(S());function D(){if(B.strictSchema===!1){q.logger.warn(C());return}throw Error(C());function C(){return`unknown format "${J}" ignored in schema at path "${K}"`}}function j(C){let K0=C instanceof RegExp?(0,Z0.regexpCode)(C):B.code.formats?Z0._`${B.code.formats}${(0,Z0.getProperty)(J)}`:void 0,b0=W.scopeValue("formats",{key:J,ref:C,code:K0});if(typeof C=="object"&&!(C instanceof RegExp))return[C.type||"string",C.validate,Z0._`${b0}.validate`];return["string",C,b0]}function S(){if(typeof U=="object"&&!(U instanceof RegExp)&&U.async){if(!F.$async)throw Error("async format in sync schema");return Z0._`await ${O}(${Y})`}return typeof w=="function"?Z0._`${O}(${Y})`:Z0._`${O}.test(${Y})`}}}};y7.default=Jj});var tB=b((g7)=>{Object.defineProperty(g7,"__esModule",{value:!0});var Hj=aB(),Gj=[Hj.default];g7.default=Gj});var sB=b((s8)=>{Object.defineProperty(s8,"__esModule",{value:!0});s8.contentVocabulary=s8.metadataVocabulary=void 0;s8.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];s8.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var QK=b((h7)=>{Object.defineProperty(h7,"__esModule",{value:!0});var Bj=GB(),Kj=jB(),Fj=oB(),Lj=tB(),eB=sB(),qj=[Bj.default,Kj.default,(0,Fj.default)(),Lj.default,eB.metadataVocabulary,eB.contentVocabulary];h7.default=qj});var WK=b((q4)=>{Object.defineProperty(q4,"__esModule",{value:!0});q4.DiscrError=void 0;var $K;(function(Q){Q.Tag="tag",Q.Mapping="mapping"})($K||(q4.DiscrError=$K={}))});var XK=b((u7)=>{Object.defineProperty(u7,"__esModule",{value:!0});var e8=i(),f7=WK(),YK=i5(),Vj=$Q(),Uj=G0(),Aj={message:({params:{discrError:Q,tagName:$}})=>Q===f7.DiscrError.Tag?`tag "${$}" must be string`:`value of tag "${$}" must be in oneOf`,params:({params:{discrError:Q,tag:$,tagName:W}})=>e8._`{error: ${Q}, tag: ${W}, tagValue: ${$}}`},zj={keyword:"discriminator",type:"object",schemaType:"object",error:Aj,code(Q){let{gen:$,data:W,schema:Y,parentSchema:X,it:J}=Q,{oneOf:H}=X;if(!J.opts.discriminator)throw Error("discriminator: requires discriminator option");let G=Y.propertyName;if(typeof G!="string")throw Error("discriminator: requires propertyName");if(Y.mapping)throw Error("discriminator: mapping is not supported");if(!H)throw Error("discriminator: requires oneOf keyword");let B=$.let("valid",!1),K=$.const("tag",e8._`${W}${(0,e8.getProperty)(G)}`);$.if(e8._`typeof ${K} == "string"`,()=>F(),()=>Q.error(!1,{discrError:f7.DiscrError.Tag,tag:K,tagName:G})),Q.ok(B);function F(){let V=A();$.if(!1);for(let U in V)$.elseIf(e8._`${K} === ${U}`),$.assign(B,q(V[U]));$.else(),Q.error(!1,{discrError:f7.DiscrError.Mapping,tag:K,tagName:G}),$.endIf()}function q(V){let U=$.name("valid"),z=Q.subschema({keyword:"oneOf",schemaProp:V},U);return Q.mergeEvaluated(z,e8.Name),U}function A(){var V;let U={},z=O(X),w=!0;for(let S=0;S<H.length;S++){let C=H[S];if((C===null||C===void 0?void 0:C.$ref)&&!(0,Uj.schemaHasRulesButRef)(C,J.self.RULES)){let b0=C.$ref;if(C=YK.resolveRef.call(J.self,J.schemaEnv.root,J.baseId,b0),C instanceof YK.SchemaEnv)C=C.schema;if(C===void 0)throw new Vj.default(J.opts.uriResolver,J.baseId,b0)}let K0=(V=C===null||C===void 0?void 0:C.properties)===null||V===void 0?void 0:V[G];if(typeof K0!="object")throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${G}"`);w=w&&(z||O(C)),D(K0,S)}if(!w)throw Error(`discriminator: "${G}" must be required`);return U;function O({required:S}){return Array.isArray(S)&&S.includes(G)}function D(S,C){if(S.const)j(S.const,C);else if(S.enum)for(let K0 of S.enum)j(K0,C);else throw Error(`discriminator: "properties/${G}" must have "const" or "enum"`)}function j(S,C){if(typeof S!="string"||S in U)throw Error(`discriminator: "${G}" values must be unique strings`);U[S]=C}}}};u7.default=zj});var JK=b((wC,wj)=>{wj.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var m7=b((O0,l7)=>{Object.defineProperty(O0,"__esModule",{value:!0});O0.MissingRefError=O0.ValidationError=O0.CodeGen=O0.Name=O0.nil=O0.stringify=O0.str=O0._=O0.KeywordCxt=O0.Ajv=void 0;var Oj=$B(),Nj=QK(),Mj=XK(),HK=JK(),jj=["/properties"],V4="http://json-schema.org/draft-07/schema";class AQ extends Oj.default{_addVocabularies(){if(super._addVocabularies(),Nj.default.forEach((Q)=>this.addVocabulary(Q)),this.opts.discriminator)this.addKeyword(Mj.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let Q=this.opts.$data?this.$dataMetaSchema(HK,jj):HK;this.addMetaSchema(Q,V4,!1),this.refs["http://json-schema.org/schema"]=V4}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(V4)?V4:void 0)}}O0.Ajv=AQ;l7.exports=O0=AQ;l7.exports.Ajv=AQ;Object.defineProperty(O0,"__esModule",{value:!0});O0.default=AQ;var Dj=QQ();Object.defineProperty(O0,"KeywordCxt",{enumerable:!0,get:function(){return Dj.KeywordCxt}});var Q9=i();Object.defineProperty(O0,"_",{enumerable:!0,get:function(){return Q9._}});Object.defineProperty(O0,"str",{enumerable:!0,get:function(){return Q9.str}});Object.defineProperty(O0,"stringify",{enumerable:!0,get:function(){return Q9.stringify}});Object.defineProperty(O0,"nil",{enumerable:!0,get:function(){return Q9.nil}});Object.defineProperty(O0,"Name",{enumerable:!0,get:function(){return Q9.Name}});Object.defineProperty(O0,"CodeGen",{enumerable:!0,get:function(){return Q9.CodeGen}});var Ej=p5();Object.defineProperty(O0,"ValidationError",{enumerable:!0,get:function(){return Ej.default}});var Rj=$Q();Object.defineProperty(O0,"MissingRefError",{enumerable:!0,get:function(){return Rj.default}})});var UK=b((t1)=>{Object.defineProperty(t1,"__esModule",{value:!0});t1.formatNames=t1.fastFormats=t1.fullFormats=void 0;function a1(Q,$){return{validate:Q,compare:$}}t1.fullFormats={date:a1(FK,i7),time:a1(p7(!0),n7),"date-time":a1(GK(!0),qK),"iso-time":a1(p7(),LK),"iso-date-time":a1(GK(),VK),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:bj,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:gj,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:vj,int32:{type:"number",validate:_j},int64:{type:"number",validate:xj},float:{type:"number",validate:KK},double:{type:"number",validate:KK},password:!0,binary:!0};t1.fastFormats={...t1.fullFormats,date:a1(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,i7),time:a1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,n7),"date-time":a1(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,qK),"iso-time":a1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,LK),"iso-date-time":a1(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,VK),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};t1.formatNames=Object.keys(t1.fullFormats);function Pj(Q){return Q%4===0&&(Q%100!==0||Q%400===0)}var Ij=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Sj=[0,31,28,31,30,31,30,31,31,30,31,30,31];function FK(Q){let $=Ij.exec(Q);if(!$)return!1;let W=+$[1],Y=+$[2],X=+$[3];return Y>=1&&Y<=12&&X>=1&&X<=(Y===2&&Pj(W)?29:Sj[Y])}function i7(Q,$){if(!(Q&&$))return;if(Q>$)return 1;if(Q<$)return-1;return 0}var c7=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function p7(Q){return function(W){let Y=c7.exec(W);if(!Y)return!1;let X=+Y[1],J=+Y[2],H=+Y[3],G=Y[4],B=Y[5]==="-"?-1:1,K=+(Y[6]||0),F=+(Y[7]||0);if(K>23||F>59||Q&&!G)return!1;if(X<=23&&J<=59&&H<60)return!0;let q=J-F*B,A=X-K*B-(q<0?1:0);return(A===23||A===-1)&&(q===59||q===-1)&&H<61}}function n7(Q,$){if(!(Q&&$))return;let W=new Date("2020-01-01T"+Q).valueOf(),Y=new Date("2020-01-01T"+$).valueOf();if(!(W&&Y))return;return W-Y}function LK(Q,$){if(!(Q&&$))return;let W=c7.exec(Q),Y=c7.exec($);if(!(W&&Y))return;if(Q=W[1]+W[2]+W[3],$=Y[1]+Y[2]+Y[3],Q>$)return 1;if(Q<$)return-1;return 0}var d7=/t|\s/i;function GK(Q){let $=p7(Q);return function(Y){let X=Y.split(d7);return X.length===2&&FK(X[0])&&$(X[1])}}function qK(Q,$){if(!(Q&&$))return;let W=new Date(Q).valueOf(),Y=new Date($).valueOf();if(!(W&&Y))return;return W-Y}function VK(Q,$){if(!(Q&&$))return;let[W,Y]=Q.split(d7),[X,J]=$.split(d7),H=i7(W,X);if(H===void 0)return;return H||n7(Y,J)}var Zj=/\/|:/,Cj=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function bj(Q){return Zj.test(Q)&&Cj.test(Q)}var BK=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function vj(Q){return BK.lastIndex=0,BK.test(Q)}var kj=-2147483648,Tj=2147483647;function _j(Q){return Number.isInteger(Q)&&Q<=Tj&&Q>=kj}function xj(Q){return Number.isInteger(Q)}function KK(){return!0}var yj=/[^\\]\\Z/;function gj(Q){if(yj.test(Q))return!1;try{return new RegExp(Q),!0}catch($){return!1}}});var AK=b(($9)=>{Object.defineProperty($9,"__esModule",{value:!0});$9.formatLimitDefinition=void 0;var hj=m7(),h1=i(),y6=h1.operators,U4={formatMaximum:{okStr:"<=",ok:y6.LTE,fail:y6.GT},formatMinimum:{okStr:">=",ok:y6.GTE,fail:y6.LT},formatExclusiveMaximum:{okStr:"<",ok:y6.LT,fail:y6.GTE},formatExclusiveMinimum:{okStr:">",ok:y6.GT,fail:y6.LTE}},fj={message:({keyword:Q,schemaCode:$})=>h1.str`should be ${U4[Q].okStr} ${$}`,params:({keyword:Q,schemaCode:$})=>h1._`{comparison: ${U4[Q].okStr}, limit: ${$}}`};$9.formatLimitDefinition={keyword:Object.keys(U4),type:"string",schemaType:"string",$data:!0,error:fj,code(Q){let{gen:$,data:W,schemaCode:Y,keyword:X,it:J}=Q,{opts:H,self:G}=J;if(!H.validateFormats)return;let B=new hj.KeywordCxt(J,G.RULES.all.format.definition,"format");if(B.$data)K();else F();function K(){let A=$.scopeValue("formats",{ref:G.formats,code:H.code.formats}),V=$.const("fmt",h1._`${A}[${B.schemaCode}]`);Q.fail$data((0,h1.or)(h1._`typeof ${V} != "object"`,h1._`${V} instanceof RegExp`,h1._`typeof ${V}.compare != "function"`,q(V)))}function F(){let A=B.schema,V=G.formats[A];if(!V||V===!0)return;if(typeof V!="object"||V instanceof RegExp||typeof V.compare!="function")throw Error(`"${X}": format "${A}" does not define "compare" function`);let U=$.scopeValue("formats",{key:A,ref:V,code:H.code.formats?h1._`${H.code.formats}${(0,h1.getProperty)(A)}`:void 0});Q.fail$data(q(U))}function q(A){return h1._`${A}.compare(${W}, ${Y}) ${U4[X].fail} 0`}},dependencies:["format"]};var uj=(Q)=>{return Q.addKeyword($9.formatLimitDefinition),Q};$9.default=uj});var NK=b((zQ,OK)=>{Object.defineProperty(zQ,"__esModule",{value:!0});var W9=UK(),lj=AK(),r7=i(),zK=new r7.Name("fullFormats"),mj=new r7.Name("fastFormats"),o7=(Q,$={keywords:!0})=>{if(Array.isArray($))return wK(Q,$,W9.fullFormats,zK),Q;let[W,Y]=$.mode==="fast"?[W9.fastFormats,mj]:[W9.fullFormats,zK],X=$.formats||W9.formatNames;if(wK(Q,X,W,Y),$.keywords)(0,lj.default)(Q);return Q};o7.get=(Q,$="full")=>{let Y=($==="fast"?W9.fastFormats:W9.fullFormats)[Q];if(!Y)throw Error(`Unknown format "${Q}"`);return Y};function wK(Q,$,W,Y){var X,J;(X=(J=Q.opts.code).formats)!==null&&X!==void 0||(J.formats=r7._`require("ajv-formats/dist/formats").${Y}`);for(let H of $)Q.addFormat(H,W[H])}OK.exports=zQ=o7;Object.defineProperty(zQ,"__esModule",{value:!0});zQ.default=o7});var IX="1.5.0";var w8=IX,d="stable",k="experimental";var L={};C4(L,{void:()=>fL,util:()=>t,unknown:()=>gL,union:()=>mL,undefined:()=>_L,tuple:()=>dL,transformer:()=>$q,symbol:()=>TL,string:()=>xX,strictObject:()=>lL,setErrorMap:()=>XL,set:()=>rL,record:()=>iL,quotelessJson:()=>WL,promise:()=>Qq,preprocess:()=>Xq,pipeline:()=>Jq,ostring:()=>Hq,optional:()=>Wq,onumber:()=>Gq,oboolean:()=>Bq,objectUtil:()=>b4,object:()=>T4,number:()=>yX,nullable:()=>Yq,null:()=>xL,never:()=>hL,nativeEnum:()=>eL,nan:()=>bL,map:()=>nL,makeIssue:()=>z9,literal:()=>tL,lazy:()=>aL,late:()=>ZL,isValid:()=>U6,isDirty:()=>TQ,isAsync:()=>N8,isAborted:()=>kQ,intersection:()=>pL,instanceof:()=>CL,getParsedType:()=>m1,getErrorMap:()=>O8,function:()=>oL,enum:()=>sL,effect:()=>$q,discriminatedUnion:()=>cL,defaultErrorMap:()=>s1,datetimeRegex:()=>kX,date:()=>kL,custom:()=>_X,coerce:()=>Kq,boolean:()=>gX,bigint:()=>vL,array:()=>uL,any:()=>yL,addIssueToContext:()=>Z,ZodVoid:()=>O9,ZodUnknown:()=>A6,ZodUnion:()=>P8,ZodUndefined:()=>E8,ZodType:()=>r,ZodTuple:()=>p1,ZodTransformer:()=>C1,ZodSymbol:()=>w9,ZodString:()=>I1,ZodSet:()=>p6,ZodSchema:()=>r,ZodRecord:()=>N9,ZodReadonly:()=>k8,ZodPromise:()=>d6,ZodPipeline:()=>D9,ZodParsedType:()=>I,ZodOptional:()=>L1,ZodObject:()=>R0,ZodNumber:()=>z6,ZodNullable:()=>Q6,ZodNull:()=>R8,ZodNever:()=>c1,ZodNativeEnum:()=>C8,ZodNaN:()=>j9,ZodMap:()=>M9,ZodLiteral:()=>Z8,ZodLazy:()=>S8,ZodIssueCode:()=>R,ZodIntersection:()=>I8,ZodFunction:()=>j8,ZodFirstPartyTypeKind:()=>P,ZodError:()=>Y1,ZodEnum:()=>O6,ZodEffects:()=>C1,ZodDiscriminatedUnion:()=>_Q,ZodDefault:()=>b8,ZodDate:()=>m6,ZodCatch:()=>v8,ZodBranded:()=>xQ,ZodBoolean:()=>D8,ZodBigInt:()=>w6,ZodArray:()=>S1,ZodAny:()=>c6,Schema:()=>r,ParseStatus:()=>x0,OK:()=>c0,NEVER:()=>Fq,INVALID:()=>h,EMPTY_PATH:()=>JL,DIRTY:()=>l6,BRAND:()=>SL});var t;(function(Q){Q.assertEqual=(X)=>{};function $(X){}Q.assertIs=$;function W(X){throw Error()}Q.assertNever=W,Q.arrayToEnum=(X)=>{let J={};for(let H of X)J[H]=H;return J},Q.getValidEnumValues=(X)=>{let J=Q.objectKeys(X).filter((G)=>typeof X[X[G]]!=="number"),H={};for(let G of J)H[G]=X[G];return Q.objectValues(H)},Q.objectValues=(X)=>{return Q.objectKeys(X).map(function(J){return X[J]})},Q.objectKeys=typeof Object.keys==="function"?(X)=>Object.keys(X):(X)=>{let J=[];for(let H in X)if(Object.prototype.hasOwnProperty.call(X,H))J.push(H);return J},Q.find=(X,J)=>{for(let H of X)if(J(H))return H;return},Q.isInteger=typeof Number.isInteger==="function"?(X)=>Number.isInteger(X):(X)=>typeof X==="number"&&Number.isFinite(X)&&Math.floor(X)===X;function Y(X,J=" | "){return X.map((H)=>typeof H==="string"?`'${H}'`:H).join(J)}Q.joinValues=Y,Q.jsonStringifyReplacer=(X,J)=>{if(typeof J==="bigint")return J.toString();return J}})(t||(t={}));var b4;(function(Q){Q.mergeShapes=($,W)=>{return{...$,...W}}})(b4||(b4={}));var I=t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),m1=(Q)=>{switch(typeof Q){case"undefined":return I.undefined;case"string":return I.string;case"number":return Number.isNaN(Q)?I.nan:I.number;case"boolean":return I.boolean;case"function":return I.function;case"bigint":return I.bigint;case"symbol":return I.symbol;case"object":if(Array.isArray(Q))return I.array;if(Q===null)return I.null;if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return I.promise;if(typeof Map<"u"&&Q instanceof Map)return I.map;if(typeof Set<"u"&&Q instanceof Set)return I.set;if(typeof Date<"u"&&Q instanceof Date)return I.date;return I.object;default:return I.unknown}};var R=t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),WL=(Q)=>{return JSON.stringify(Q,null,2).replace(/"([^"]+)":/g,"$1:")};class Y1 extends Error{get errors(){return this.issues}constructor(Q){super();this.issues=[],this.addIssue=(W)=>{this.issues=[...this.issues,W]},this.addIssues=(W=[])=>{this.issues=[...this.issues,...W]};let $=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,$);else this.__proto__=$;this.name="ZodError",this.issues=Q}format(Q){let $=Q||function(X){return X.message},W={_errors:[]},Y=(X)=>{for(let J of X.issues)if(J.code==="invalid_union")J.unionErrors.map(Y);else if(J.code==="invalid_return_type")Y(J.returnTypeError);else if(J.code==="invalid_arguments")Y(J.argumentsError);else if(J.path.length===0)W._errors.push($(J));else{let H=W,G=0;while(G<J.path.length){let B=J.path[G];if(G!==J.path.length-1)H[B]=H[B]||{_errors:[]};else H[B]=H[B]||{_errors:[]},H[B]._errors.push($(J));H=H[B],G++}}};return Y(this),W}static assert(Q){if(!(Q instanceof Y1))throw Error(`Not a ZodError: ${Q}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,t.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(Q=($)=>$.message){let $={},W=[];for(let Y of this.issues)if(Y.path.length>0){let X=Y.path[0];$[X]=$[X]||[],$[X].push(Q(Y))}else W.push(Q(Y));return{formErrors:W,fieldErrors:$}}get formErrors(){return this.flatten()}}Y1.create=(Q)=>{return new Y1(Q)};var YL=(Q,$)=>{let W;switch(Q.code){case R.invalid_type:if(Q.received===I.undefined)W="Required";else W=`Expected ${Q.expected}, received ${Q.received}`;break;case R.invalid_literal:W=`Invalid literal value, expected ${JSON.stringify(Q.expected,t.jsonStringifyReplacer)}`;break;case R.unrecognized_keys:W=`Unrecognized key(s) in object: ${t.joinValues(Q.keys,", ")}`;break;case R.invalid_union:W="Invalid input";break;case R.invalid_union_discriminator:W=`Invalid discriminator value. Expected ${t.joinValues(Q.options)}`;break;case R.invalid_enum_value:W=`Invalid enum value. Expected ${t.joinValues(Q.options)}, received '${Q.received}'`;break;case R.invalid_arguments:W="Invalid function arguments";break;case R.invalid_return_type:W="Invalid function return type";break;case R.invalid_date:W="Invalid date";break;case R.invalid_string:if(typeof Q.validation==="object")if("includes"in Q.validation){if(W=`Invalid input: must include "${Q.validation.includes}"`,typeof Q.validation.position==="number")W=`${W} at one or more positions greater than or equal to ${Q.validation.position}`}else if("startsWith"in Q.validation)W=`Invalid input: must start with "${Q.validation.startsWith}"`;else if("endsWith"in Q.validation)W=`Invalid input: must end with "${Q.validation.endsWith}"`;else t.assertNever(Q.validation);else if(Q.validation!=="regex")W=`Invalid ${Q.validation}`;else W="Invalid";break;case R.too_small:if(Q.type==="array")W=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at least":"more than"} ${Q.minimum} element(s)`;else if(Q.type==="string")W=`String must contain ${Q.exact?"exactly":Q.inclusive?"at least":"over"} ${Q.minimum} character(s)`;else if(Q.type==="number")W=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="bigint")W=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="date")W=`Date must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(Q.minimum))}`;else W="Invalid input";break;case R.too_big:if(Q.type==="array")W=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at most":"less than"} ${Q.maximum} element(s)`;else if(Q.type==="string")W=`String must contain ${Q.exact?"exactly":Q.inclusive?"at most":"under"} ${Q.maximum} character(s)`;else if(Q.type==="number")W=`Number must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="bigint")W=`BigInt must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="date")W=`Date must be ${Q.exact?"exactly":Q.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(Q.maximum))}`;else W="Invalid input";break;case R.custom:W="Invalid input";break;case R.invalid_intersection_types:W="Intersection results could not be merged";break;case R.not_multiple_of:W=`Number must be a multiple of ${Q.multipleOf}`;break;case R.not_finite:W="Number must be finite";break;default:W=$.defaultError,t.assertNever(Q)}return{message:W}},s1=YL;var SX=s1;function XL(Q){SX=Q}function O8(){return SX}var z9=(Q)=>{let{data:$,path:W,errorMaps:Y,issueData:X}=Q,J=[...W,...X.path||[]],H={...X,path:J};if(X.message!==void 0)return{...X,path:J,message:X.message};let G="",B=Y.filter((K)=>!!K).slice().reverse();for(let K of B)G=K(H,{data:$,defaultError:G}).message;return{...X,path:J,message:G}},JL=[];function Z(Q,$){let W=O8(),Y=z9({issueData:$,data:Q.data,path:Q.path,errorMaps:[Q.common.contextualErrorMap,Q.schemaErrorMap,W,W===s1?void 0:s1].filter((X)=>!!X)});Q.common.issues.push(Y)}class x0{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray(Q,$){let W=[];for(let Y of $){if(Y.status==="aborted")return h;if(Y.status==="dirty")Q.dirty();W.push(Y.value)}return{status:Q.value,value:W}}static async mergeObjectAsync(Q,$){let W=[];for(let Y of $){let X=await Y.key,J=await Y.value;W.push({key:X,value:J})}return x0.mergeObjectSync(Q,W)}static mergeObjectSync(Q,$){let W={};for(let Y of $){let{key:X,value:J}=Y;if(X.status==="aborted")return h;if(J.status==="aborted")return h;if(X.status==="dirty")Q.dirty();if(J.status==="dirty")Q.dirty();if(X.value!=="__proto__"&&(typeof J.value<"u"||Y.alwaysSet))W[X.value]=J.value}return{status:Q.value,value:W}}}var h=Object.freeze({status:"aborted"}),l6=(Q)=>({status:"dirty",value:Q}),c0=(Q)=>({status:"valid",value:Q}),kQ=(Q)=>Q.status==="aborted",TQ=(Q)=>Q.status==="dirty",U6=(Q)=>Q.status==="valid",N8=(Q)=>typeof Promise<"u"&&Q instanceof Promise;var T;(function(Q){Q.errToObj=($)=>typeof $==="string"?{message:$}:$||{},Q.toString=($)=>typeof $==="string"?$:$?.message})(T||(T={}));class Z1{constructor(Q,$,W,Y){this._cachedPath=[],this.parent=Q,this.data=$,this._path=W,this._key=Y}get path(){if(!this._cachedPath.length)if(Array.isArray(this._key))this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var ZX=(Q,$)=>{if(U6($))return{success:!0,data:$.value};else{if(!Q.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let W=new Y1(Q.common.issues);return this._error=W,this._error}}}};function c(Q){if(!Q)return{};let{errorMap:$,invalid_type_error:W,required_error:Y,description:X}=Q;if($&&(W||Y))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if($)return{errorMap:$,description:X};return{errorMap:(H,G)=>{let{message:B}=Q;if(H.code==="invalid_enum_value")return{message:B??G.defaultError};if(typeof G.data>"u")return{message:B??Y??G.defaultError};if(H.code!=="invalid_type")return{message:G.defaultError};return{message:B??W??G.defaultError}},description:X}}class r{get description(){return this._def.description}_getType(Q){return m1(Q.data)}_getOrReturnCtx(Q,$){return $||{common:Q.parent.common,data:Q.data,parsedType:m1(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}_processInputParams(Q){return{status:new x0,ctx:{common:Q.parent.common,data:Q.data,parsedType:m1(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}}_parseSync(Q){let $=this._parse(Q);if(N8($))throw Error("Synchronous parse encountered promise.");return $}_parseAsync(Q){let $=this._parse(Q);return Promise.resolve($)}parse(Q,$){let W=this.safeParse(Q,$);if(W.success)return W.data;throw W.error}safeParse(Q,$){let W={common:{issues:[],async:$?.async??!1,contextualErrorMap:$?.errorMap},path:$?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:m1(Q)},Y=this._parseSync({data:Q,path:W.path,parent:W});return ZX(W,Y)}"~validate"(Q){let $={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:m1(Q)};if(!this["~standard"].async)try{let W=this._parseSync({data:Q,path:[],parent:$});return U6(W)?{value:W.value}:{issues:$.common.issues}}catch(W){if(W?.message?.toLowerCase()?.includes("encountered"))this["~standard"].async=!0;$.common={issues:[],async:!0}}return this._parseAsync({data:Q,path:[],parent:$}).then((W)=>U6(W)?{value:W.value}:{issues:$.common.issues})}async parseAsync(Q,$){let W=await this.safeParseAsync(Q,$);if(W.success)return W.data;throw W.error}async safeParseAsync(Q,$){let W={common:{issues:[],contextualErrorMap:$?.errorMap,async:!0},path:$?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:m1(Q)},Y=this._parse({data:Q,path:W.path,parent:W}),X=await(N8(Y)?Y:Promise.resolve(Y));return ZX(W,X)}refine(Q,$){let W=(Y)=>{if(typeof $==="string"||typeof $>"u")return{message:$};else if(typeof $==="function")return $(Y);else return $};return this._refinement((Y,X)=>{let J=Q(Y),H=()=>X.addIssue({code:R.custom,...W(Y)});if(typeof Promise<"u"&&J instanceof Promise)return J.then((G)=>{if(!G)return H(),!1;else return!0});if(!J)return H(),!1;else return!0})}refinement(Q,$){return this._refinement((W,Y)=>{if(!Q(W))return Y.addIssue(typeof $==="function"?$(W,Y):$),!1;else return!0})}_refinement(Q){return new C1({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:Q}})}superRefine(Q){return this._refinement(Q)}constructor(Q){this.spa=this.safeParseAsync,this._def=Q,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:($)=>this["~validate"]($)}}optional(){return L1.create(this,this._def)}nullable(){return Q6.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return S1.create(this)}promise(){return d6.create(this,this._def)}or(Q){return P8.create([this,Q],this._def)}and(Q){return I8.create(this,Q,this._def)}transform(Q){return new C1({...c(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:Q}})}default(Q){let $=typeof Q==="function"?Q:()=>Q;return new b8({...c(this._def),innerType:this,defaultValue:$,typeName:P.ZodDefault})}brand(){return new xQ({typeName:P.ZodBranded,type:this,...c(this._def)})}catch(Q){let $=typeof Q==="function"?Q:()=>Q;return new v8({...c(this._def),innerType:this,catchValue:$,typeName:P.ZodCatch})}describe(Q){return new this.constructor({...this._def,description:Q})}pipe(Q){return D9.create(this,Q)}readonly(){return k8.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var HL=/^c[^\s-]{8,}$/i,GL=/^[0-9a-z]+$/,BL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,KL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,FL=/^[a-z0-9_-]{21}$/i,LL=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,qL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,VL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,UL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",v4,AL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,zL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,wL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,OL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,NL=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ML=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,bX="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",jL=new RegExp(`^${bX}$`);function vX(Q){let $="[0-5]\\d";if(Q.precision)$=`${$}\\.\\d{${Q.precision}}`;else if(Q.precision==null)$=`${$}(\\.\\d+)?`;let W=Q.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${$})${W}`}function DL(Q){return new RegExp(`^${vX(Q)}$`)}function kX(Q){let $=`${bX}T${vX(Q)}`,W=[];if(W.push(Q.local?"Z?":"Z"),Q.offset)W.push("([+-]\\d{2}:?\\d{2})");return $=`${$}(${W.join("|")})`,new RegExp(`^${$}$`)}function EL(Q,$){if(($==="v4"||!$)&&AL.test(Q))return!0;if(($==="v6"||!$)&&wL.test(Q))return!0;return!1}function RL(Q,$){if(!LL.test(Q))return!1;try{let[W]=Q.split(".");if(!W)return!1;let Y=W.replace(/-/g,"+").replace(/_/g,"/").padEnd(W.length+(4-W.length%4)%4,"="),X=JSON.parse(atob(Y));if(typeof X!=="object"||X===null)return!1;if("typ"in X&&X?.typ!=="JWT")return!1;if(!X.alg)return!1;if($&&X.alg!==$)return!1;return!0}catch{return!1}}function PL(Q,$){if(($==="v4"||!$)&&zL.test(Q))return!0;if(($==="v6"||!$)&&OL.test(Q))return!0;return!1}class I1 extends r{_parse(Q){if(this._def.coerce)Q.data=String(Q.data);if(this._getType(Q)!==I.string){let X=this._getOrReturnCtx(Q);return Z(X,{code:R.invalid_type,expected:I.string,received:X.parsedType}),h}let W=new x0,Y=void 0;for(let X of this._def.checks)if(X.kind==="min"){if(Q.data.length<X.value)Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.too_small,minimum:X.value,type:"string",inclusive:!0,exact:!1,message:X.message}),W.dirty()}else if(X.kind==="max"){if(Q.data.length>X.value)Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.too_big,maximum:X.value,type:"string",inclusive:!0,exact:!1,message:X.message}),W.dirty()}else if(X.kind==="length"){let J=Q.data.length>X.value,H=Q.data.length<X.value;if(J||H){if(Y=this._getOrReturnCtx(Q,Y),J)Z(Y,{code:R.too_big,maximum:X.value,type:"string",inclusive:!0,exact:!0,message:X.message});else if(H)Z(Y,{code:R.too_small,minimum:X.value,type:"string",inclusive:!0,exact:!0,message:X.message});W.dirty()}}else if(X.kind==="email"){if(!VL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"email",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="emoji"){if(!v4)v4=new RegExp(UL,"u");if(!v4.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"emoji",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="uuid"){if(!KL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"uuid",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="nanoid"){if(!FL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"nanoid",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="cuid"){if(!HL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"cuid",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="cuid2"){if(!GL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"cuid2",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="ulid"){if(!BL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"ulid",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="url")try{new URL(Q.data)}catch{Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"url",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="regex"){if(X.regex.lastIndex=0,!X.regex.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"regex",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="trim")Q.data=Q.data.trim();else if(X.kind==="includes"){if(!Q.data.includes(X.value,X.position))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:{includes:X.value,position:X.position},message:X.message}),W.dirty()}else if(X.kind==="toLowerCase")Q.data=Q.data.toLowerCase();else if(X.kind==="toUpperCase")Q.data=Q.data.toUpperCase();else if(X.kind==="startsWith"){if(!Q.data.startsWith(X.value))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:{startsWith:X.value},message:X.message}),W.dirty()}else if(X.kind==="endsWith"){if(!Q.data.endsWith(X.value))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:{endsWith:X.value},message:X.message}),W.dirty()}else if(X.kind==="datetime"){if(!kX(X).test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:"datetime",message:X.message}),W.dirty()}else if(X.kind==="date"){if(!jL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:"date",message:X.message}),W.dirty()}else if(X.kind==="time"){if(!DL(X).test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.invalid_string,validation:"time",message:X.message}),W.dirty()}else if(X.kind==="duration"){if(!qL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"duration",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="ip"){if(!EL(Q.data,X.version))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"ip",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="jwt"){if(!RL(Q.data,X.alg))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"jwt",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="cidr"){if(!PL(Q.data,X.version))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"cidr",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="base64"){if(!NL.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"base64",code:R.invalid_string,message:X.message}),W.dirty()}else if(X.kind==="base64url"){if(!ML.test(Q.data))Y=this._getOrReturnCtx(Q,Y),Z(Y,{validation:"base64url",code:R.invalid_string,message:X.message}),W.dirty()}else t.assertNever(X);return{status:W.value,value:Q.data}}_regex(Q,$,W){return this.refinement((Y)=>Q.test(Y),{validation:$,code:R.invalid_string,...T.errToObj(W)})}_addCheck(Q){return new I1({...this._def,checks:[...this._def.checks,Q]})}email(Q){return this._addCheck({kind:"email",...T.errToObj(Q)})}url(Q){return this._addCheck({kind:"url",...T.errToObj(Q)})}emoji(Q){return this._addCheck({kind:"emoji",...T.errToObj(Q)})}uuid(Q){return this._addCheck({kind:"uuid",...T.errToObj(Q)})}nanoid(Q){return this._addCheck({kind:"nanoid",...T.errToObj(Q)})}cuid(Q){return this._addCheck({kind:"cuid",...T.errToObj(Q)})}cuid2(Q){return this._addCheck({kind:"cuid2",...T.errToObj(Q)})}ulid(Q){return this._addCheck({kind:"ulid",...T.errToObj(Q)})}base64(Q){return this._addCheck({kind:"base64",...T.errToObj(Q)})}base64url(Q){return this._addCheck({kind:"base64url",...T.errToObj(Q)})}jwt(Q){return this._addCheck({kind:"jwt",...T.errToObj(Q)})}ip(Q){return this._addCheck({kind:"ip",...T.errToObj(Q)})}cidr(Q){return this._addCheck({kind:"cidr",...T.errToObj(Q)})}datetime(Q){if(typeof Q==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:Q});return this._addCheck({kind:"datetime",precision:typeof Q?.precision>"u"?null:Q?.precision,offset:Q?.offset??!1,local:Q?.local??!1,...T.errToObj(Q?.message)})}date(Q){return this._addCheck({kind:"date",message:Q})}time(Q){if(typeof Q==="string")return this._addCheck({kind:"time",precision:null,message:Q});return this._addCheck({kind:"time",precision:typeof Q?.precision>"u"?null:Q?.precision,...T.errToObj(Q?.message)})}duration(Q){return this._addCheck({kind:"duration",...T.errToObj(Q)})}regex(Q,$){return this._addCheck({kind:"regex",regex:Q,...T.errToObj($)})}includes(Q,$){return this._addCheck({kind:"includes",value:Q,position:$?.position,...T.errToObj($?.message)})}startsWith(Q,$){return this._addCheck({kind:"startsWith",value:Q,...T.errToObj($)})}endsWith(Q,$){return this._addCheck({kind:"endsWith",value:Q,...T.errToObj($)})}min(Q,$){return this._addCheck({kind:"min",value:Q,...T.errToObj($)})}max(Q,$){return this._addCheck({kind:"max",value:Q,...T.errToObj($)})}length(Q,$){return this._addCheck({kind:"length",value:Q,...T.errToObj($)})}nonempty(Q){return this.min(1,T.errToObj(Q))}trim(){return new I1({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new I1({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new I1({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((Q)=>Q.kind==="datetime")}get isDate(){return!!this._def.checks.find((Q)=>Q.kind==="date")}get isTime(){return!!this._def.checks.find((Q)=>Q.kind==="time")}get isDuration(){return!!this._def.checks.find((Q)=>Q.kind==="duration")}get isEmail(){return!!this._def.checks.find((Q)=>Q.kind==="email")}get isURL(){return!!this._def.checks.find((Q)=>Q.kind==="url")}get isEmoji(){return!!this._def.checks.find((Q)=>Q.kind==="emoji")}get isUUID(){return!!this._def.checks.find((Q)=>Q.kind==="uuid")}get isNANOID(){return!!this._def.checks.find((Q)=>Q.kind==="nanoid")}get isCUID(){return!!this._def.checks.find((Q)=>Q.kind==="cuid")}get isCUID2(){return!!this._def.checks.find((Q)=>Q.kind==="cuid2")}get isULID(){return!!this._def.checks.find((Q)=>Q.kind==="ulid")}get isIP(){return!!this._def.checks.find((Q)=>Q.kind==="ip")}get isCIDR(){return!!this._def.checks.find((Q)=>Q.kind==="cidr")}get isBase64(){return!!this._def.checks.find((Q)=>Q.kind==="base64")}get isBase64url(){return!!this._def.checks.find((Q)=>Q.kind==="base64url")}get minLength(){let Q=null;for(let $ of this._def.checks)if($.kind==="min"){if(Q===null||$.value>Q)Q=$.value}return Q}get maxLength(){let Q=null;for(let $ of this._def.checks)if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Q}}I1.create=(Q)=>{return new I1({checks:[],typeName:P.ZodString,coerce:Q?.coerce??!1,...c(Q)})};function IL(Q,$){let W=(Q.toString().split(".")[1]||"").length,Y=($.toString().split(".")[1]||"").length,X=W>Y?W:Y,J=Number.parseInt(Q.toFixed(X).replace(".","")),H=Number.parseInt($.toFixed(X).replace(".",""));return J%H/10**X}class z6 extends r{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(Q){if(this._def.coerce)Q.data=Number(Q.data);if(this._getType(Q)!==I.number){let X=this._getOrReturnCtx(Q);return Z(X,{code:R.invalid_type,expected:I.number,received:X.parsedType}),h}let W=void 0,Y=new x0;for(let X of this._def.checks)if(X.kind==="int"){if(!t.isInteger(Q.data))W=this._getOrReturnCtx(Q,W),Z(W,{code:R.invalid_type,expected:"integer",received:"float",message:X.message}),Y.dirty()}else if(X.kind==="min"){if(X.inclusive?Q.data<X.value:Q.data<=X.value)W=this._getOrReturnCtx(Q,W),Z(W,{code:R.too_small,minimum:X.value,type:"number",inclusive:X.inclusive,exact:!1,message:X.message}),Y.dirty()}else if(X.kind==="max"){if(X.inclusive?Q.data>X.value:Q.data>=X.value)W=this._getOrReturnCtx(Q,W),Z(W,{code:R.too_big,maximum:X.value,type:"number",inclusive:X.inclusive,exact:!1,message:X.message}),Y.dirty()}else if(X.kind==="multipleOf"){if(IL(Q.data,X.value)!==0)W=this._getOrReturnCtx(Q,W),Z(W,{code:R.not_multiple_of,multipleOf:X.value,message:X.message}),Y.dirty()}else if(X.kind==="finite"){if(!Number.isFinite(Q.data))W=this._getOrReturnCtx(Q,W),Z(W,{code:R.not_finite,message:X.message}),Y.dirty()}else t.assertNever(X);return{status:Y.value,value:Q.data}}gte(Q,$){return this.setLimit("min",Q,!0,T.toString($))}gt(Q,$){return this.setLimit("min",Q,!1,T.toString($))}lte(Q,$){return this.setLimit("max",Q,!0,T.toString($))}lt(Q,$){return this.setLimit("max",Q,!1,T.toString($))}setLimit(Q,$,W,Y){return new z6({...this._def,checks:[...this._def.checks,{kind:Q,value:$,inclusive:W,message:T.toString(Y)}]})}_addCheck(Q){return new z6({...this._def,checks:[...this._def.checks,Q]})}int(Q){return this._addCheck({kind:"int",message:T.toString(Q)})}positive(Q){return this._addCheck({kind:"min",value:0,inclusive:!1,message:T.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:0,inclusive:!1,message:T.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:0,inclusive:!0,message:T.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:0,inclusive:!0,message:T.toString(Q)})}multipleOf(Q,$){return this._addCheck({kind:"multipleOf",value:Q,message:T.toString($)})}finite(Q){return this._addCheck({kind:"finite",message:T.toString(Q)})}safe(Q){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:T.toString(Q)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:T.toString(Q)})}get minValue(){let Q=null;for(let $ of this._def.checks)if($.kind==="min"){if(Q===null||$.value>Q)Q=$.value}return Q}get maxValue(){let Q=null;for(let $ of this._def.checks)if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Q}get isInt(){return!!this._def.checks.find((Q)=>Q.kind==="int"||Q.kind==="multipleOf"&&t.isInteger(Q.value))}get isFinite(){let Q=null,$=null;for(let W of this._def.checks)if(W.kind==="finite"||W.kind==="int"||W.kind==="multipleOf")return!0;else if(W.kind==="min"){if($===null||W.value>$)$=W.value}else if(W.kind==="max"){if(Q===null||W.value<Q)Q=W.value}return Number.isFinite($)&&Number.isFinite(Q)}}z6.create=(Q)=>{return new z6({checks:[],typeName:P.ZodNumber,coerce:Q?.coerce||!1,...c(Q)})};class w6 extends r{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse(Q){if(this._def.coerce)try{Q.data=BigInt(Q.data)}catch{return this._getInvalidInput(Q)}if(this._getType(Q)!==I.bigint)return this._getInvalidInput(Q);let W=void 0,Y=new x0;for(let X of this._def.checks)if(X.kind==="min"){if(X.inclusive?Q.data<X.value:Q.data<=X.value)W=this._getOrReturnCtx(Q,W),Z(W,{code:R.too_small,type:"bigint",minimum:X.value,inclusive:X.inclusive,message:X.message}),Y.dirty()}else if(X.kind==="max"){if(X.inclusive?Q.data>X.value:Q.data>=X.value)W=this._getOrReturnCtx(Q,W),Z(W,{code:R.too_big,type:"bigint",maximum:X.value,inclusive:X.inclusive,message:X.message}),Y.dirty()}else if(X.kind==="multipleOf"){if(Q.data%X.value!==BigInt(0))W=this._getOrReturnCtx(Q,W),Z(W,{code:R.not_multiple_of,multipleOf:X.value,message:X.message}),Y.dirty()}else t.assertNever(X);return{status:Y.value,value:Q.data}}_getInvalidInput(Q){let $=this._getOrReturnCtx(Q);return Z($,{code:R.invalid_type,expected:I.bigint,received:$.parsedType}),h}gte(Q,$){return this.setLimit("min",Q,!0,T.toString($))}gt(Q,$){return this.setLimit("min",Q,!1,T.toString($))}lte(Q,$){return this.setLimit("max",Q,!0,T.toString($))}lt(Q,$){return this.setLimit("max",Q,!1,T.toString($))}setLimit(Q,$,W,Y){return new w6({...this._def,checks:[...this._def.checks,{kind:Q,value:$,inclusive:W,message:T.toString(Y)}]})}_addCheck(Q){return new w6({...this._def,checks:[...this._def.checks,Q]})}positive(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:T.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:T.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:T.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:T.toString(Q)})}multipleOf(Q,$){return this._addCheck({kind:"multipleOf",value:Q,message:T.toString($)})}get minValue(){let Q=null;for(let $ of this._def.checks)if($.kind==="min"){if(Q===null||$.value>Q)Q=$.value}return Q}get maxValue(){let Q=null;for(let $ of this._def.checks)if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Q}}w6.create=(Q)=>{return new w6({checks:[],typeName:P.ZodBigInt,coerce:Q?.coerce??!1,...c(Q)})};class D8 extends r{_parse(Q){if(this._def.coerce)Q.data=Boolean(Q.data);if(this._getType(Q)!==I.boolean){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.boolean,received:W.parsedType}),h}return c0(Q.data)}}D8.create=(Q)=>{return new D8({typeName:P.ZodBoolean,coerce:Q?.coerce||!1,...c(Q)})};class m6 extends r{_parse(Q){if(this._def.coerce)Q.data=new Date(Q.data);if(this._getType(Q)!==I.date){let X=this._getOrReturnCtx(Q);return Z(X,{code:R.invalid_type,expected:I.date,received:X.parsedType}),h}if(Number.isNaN(Q.data.getTime())){let X=this._getOrReturnCtx(Q);return Z(X,{code:R.invalid_date}),h}let W=new x0,Y=void 0;for(let X of this._def.checks)if(X.kind==="min"){if(Q.data.getTime()<X.value)Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.too_small,message:X.message,inclusive:!0,exact:!1,minimum:X.value,type:"date"}),W.dirty()}else if(X.kind==="max"){if(Q.data.getTime()>X.value)Y=this._getOrReturnCtx(Q,Y),Z(Y,{code:R.too_big,message:X.message,inclusive:!0,exact:!1,maximum:X.value,type:"date"}),W.dirty()}else t.assertNever(X);return{status:W.value,value:new Date(Q.data.getTime())}}_addCheck(Q){return new m6({...this._def,checks:[...this._def.checks,Q]})}min(Q,$){return this._addCheck({kind:"min",value:Q.getTime(),message:T.toString($)})}max(Q,$){return this._addCheck({kind:"max",value:Q.getTime(),message:T.toString($)})}get minDate(){let Q=null;for(let $ of this._def.checks)if($.kind==="min"){if(Q===null||$.value>Q)Q=$.value}return Q!=null?new Date(Q):null}get maxDate(){let Q=null;for(let $ of this._def.checks)if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Q!=null?new Date(Q):null}}m6.create=(Q)=>{return new m6({checks:[],coerce:Q?.coerce||!1,typeName:P.ZodDate,...c(Q)})};class w9 extends r{_parse(Q){if(this._getType(Q)!==I.symbol){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.symbol,received:W.parsedType}),h}return c0(Q.data)}}w9.create=(Q)=>{return new w9({typeName:P.ZodSymbol,...c(Q)})};class E8 extends r{_parse(Q){if(this._getType(Q)!==I.undefined){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.undefined,received:W.parsedType}),h}return c0(Q.data)}}E8.create=(Q)=>{return new E8({typeName:P.ZodUndefined,...c(Q)})};class R8 extends r{_parse(Q){if(this._getType(Q)!==I.null){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.null,received:W.parsedType}),h}return c0(Q.data)}}R8.create=(Q)=>{return new R8({typeName:P.ZodNull,...c(Q)})};class c6 extends r{constructor(){super(...arguments);this._any=!0}_parse(Q){return c0(Q.data)}}c6.create=(Q)=>{return new c6({typeName:P.ZodAny,...c(Q)})};class A6 extends r{constructor(){super(...arguments);this._unknown=!0}_parse(Q){return c0(Q.data)}}A6.create=(Q)=>{return new A6({typeName:P.ZodUnknown,...c(Q)})};class c1 extends r{_parse(Q){let $=this._getOrReturnCtx(Q);return Z($,{code:R.invalid_type,expected:I.never,received:$.parsedType}),h}}c1.create=(Q)=>{return new c1({typeName:P.ZodNever,...c(Q)})};class O9 extends r{_parse(Q){if(this._getType(Q)!==I.undefined){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.void,received:W.parsedType}),h}return c0(Q.data)}}O9.create=(Q)=>{return new O9({typeName:P.ZodVoid,...c(Q)})};class S1 extends r{_parse(Q){let{ctx:$,status:W}=this._processInputParams(Q),Y=this._def;if($.parsedType!==I.array)return Z($,{code:R.invalid_type,expected:I.array,received:$.parsedType}),h;if(Y.exactLength!==null){let J=$.data.length>Y.exactLength.value,H=$.data.length<Y.exactLength.value;if(J||H)Z($,{code:J?R.too_big:R.too_small,minimum:H?Y.exactLength.value:void 0,maximum:J?Y.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:Y.exactLength.message}),W.dirty()}if(Y.minLength!==null){if($.data.length<Y.minLength.value)Z($,{code:R.too_small,minimum:Y.minLength.value,type:"array",inclusive:!0,exact:!1,message:Y.minLength.message}),W.dirty()}if(Y.maxLength!==null){if($.data.length>Y.maxLength.value)Z($,{code:R.too_big,maximum:Y.maxLength.value,type:"array",inclusive:!0,exact:!1,message:Y.maxLength.message}),W.dirty()}if($.common.async)return Promise.all([...$.data].map((J,H)=>{return Y.type._parseAsync(new Z1($,J,$.path,H))})).then((J)=>{return x0.mergeArray(W,J)});let X=[...$.data].map((J,H)=>{return Y.type._parseSync(new Z1($,J,$.path,H))});return x0.mergeArray(W,X)}get element(){return this._def.type}min(Q,$){return new S1({...this._def,minLength:{value:Q,message:T.toString($)}})}max(Q,$){return new S1({...this._def,maxLength:{value:Q,message:T.toString($)}})}length(Q,$){return new S1({...this._def,exactLength:{value:Q,message:T.toString($)}})}nonempty(Q){return this.min(1,Q)}}S1.create=(Q,$)=>{return new S1({type:Q,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...c($)})};function M8(Q){if(Q instanceof R0){let $={};for(let W in Q.shape){let Y=Q.shape[W];$[W]=L1.create(M8(Y))}return new R0({...Q._def,shape:()=>$})}else if(Q instanceof S1)return new S1({...Q._def,type:M8(Q.element)});else if(Q instanceof L1)return L1.create(M8(Q.unwrap()));else if(Q instanceof Q6)return Q6.create(M8(Q.unwrap()));else if(Q instanceof p1)return p1.create(Q.items.map(($)=>M8($)));else return Q}class R0 extends r{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let Q=this._def.shape(),$=t.objectKeys(Q);return this._cached={shape:Q,keys:$},this._cached}_parse(Q){if(this._getType(Q)!==I.object){let B=this._getOrReturnCtx(Q);return Z(B,{code:R.invalid_type,expected:I.object,received:B.parsedType}),h}let{status:W,ctx:Y}=this._processInputParams(Q),{shape:X,keys:J}=this._getCached(),H=[];if(!(this._def.catchall instanceof c1&&this._def.unknownKeys==="strip")){for(let B in Y.data)if(!J.includes(B))H.push(B)}let G=[];for(let B of J){let K=X[B],F=Y.data[B];G.push({key:{status:"valid",value:B},value:K._parse(new Z1(Y,F,Y.path,B)),alwaysSet:B in Y.data})}if(this._def.catchall instanceof c1){let B=this._def.unknownKeys;if(B==="passthrough")for(let K of H)G.push({key:{status:"valid",value:K},value:{status:"valid",value:Y.data[K]}});else if(B==="strict"){if(H.length>0)Z(Y,{code:R.unrecognized_keys,keys:H}),W.dirty()}else if(B==="strip");else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let B=this._def.catchall;for(let K of H){let F=Y.data[K];G.push({key:{status:"valid",value:K},value:B._parse(new Z1(Y,F,Y.path,K)),alwaysSet:K in Y.data})}}if(Y.common.async)return Promise.resolve().then(async()=>{let B=[];for(let K of G){let F=await K.key,q=await K.value;B.push({key:F,value:q,alwaysSet:K.alwaysSet})}return B}).then((B)=>{return x0.mergeObjectSync(W,B)});else return x0.mergeObjectSync(W,G)}get shape(){return this._def.shape()}strict(Q){return T.errToObj,new R0({...this._def,unknownKeys:"strict",...Q!==void 0?{errorMap:($,W)=>{let Y=this._def.errorMap?.($,W).message??W.defaultError;if($.code==="unrecognized_keys")return{message:T.errToObj(Q).message??Y};return{message:Y}}}:{}})}strip(){return new R0({...this._def,unknownKeys:"strip"})}passthrough(){return new R0({...this._def,unknownKeys:"passthrough"})}extend(Q){return new R0({...this._def,shape:()=>({...this._def.shape(),...Q})})}merge(Q){return new R0({unknownKeys:Q._def.unknownKeys,catchall:Q._def.catchall,shape:()=>({...this._def.shape(),...Q._def.shape()}),typeName:P.ZodObject})}setKey(Q,$){return this.augment({[Q]:$})}catchall(Q){return new R0({...this._def,catchall:Q})}pick(Q){let $={};for(let W of t.objectKeys(Q))if(Q[W]&&this.shape[W])$[W]=this.shape[W];return new R0({...this._def,shape:()=>$})}omit(Q){let $={};for(let W of t.objectKeys(this.shape))if(!Q[W])$[W]=this.shape[W];return new R0({...this._def,shape:()=>$})}deepPartial(){return M8(this)}partial(Q){let $={};for(let W of t.objectKeys(this.shape)){let Y=this.shape[W];if(Q&&!Q[W])$[W]=Y;else $[W]=Y.optional()}return new R0({...this._def,shape:()=>$})}required(Q){let $={};for(let W of t.objectKeys(this.shape))if(Q&&!Q[W])$[W]=this.shape[W];else{let X=this.shape[W];while(X instanceof L1)X=X._def.innerType;$[W]=X}return new R0({...this._def,shape:()=>$})}keyof(){return TX(t.objectKeys(this.shape))}}R0.create=(Q,$)=>{return new R0({shape:()=>Q,unknownKeys:"strip",catchall:c1.create(),typeName:P.ZodObject,...c($)})};R0.strictCreate=(Q,$)=>{return new R0({shape:()=>Q,unknownKeys:"strict",catchall:c1.create(),typeName:P.ZodObject,...c($)})};R0.lazycreate=(Q,$)=>{return new R0({shape:Q,unknownKeys:"strip",catchall:c1.create(),typeName:P.ZodObject,...c($)})};class P8 extends r{_parse(Q){let{ctx:$}=this._processInputParams(Q),W=this._def.options;function Y(X){for(let H of X)if(H.result.status==="valid")return H.result;for(let H of X)if(H.result.status==="dirty")return $.common.issues.push(...H.ctx.common.issues),H.result;let J=X.map((H)=>new Y1(H.ctx.common.issues));return Z($,{code:R.invalid_union,unionErrors:J}),h}if($.common.async)return Promise.all(W.map(async(X)=>{let J={...$,common:{...$.common,issues:[]},parent:null};return{result:await X._parseAsync({data:$.data,path:$.path,parent:J}),ctx:J}})).then(Y);else{let X=void 0,J=[];for(let G of W){let B={...$,common:{...$.common,issues:[]},parent:null},K=G._parseSync({data:$.data,path:$.path,parent:B});if(K.status==="valid")return K;else if(K.status==="dirty"&&!X)X={result:K,ctx:B};if(B.common.issues.length)J.push(B.common.issues)}if(X)return $.common.issues.push(...X.ctx.common.issues),X.result;let H=J.map((G)=>new Y1(G));return Z($,{code:R.invalid_union,unionErrors:H}),h}}get options(){return this._def.options}}P8.create=(Q,$)=>{return new P8({options:Q,typeName:P.ZodUnion,...c($)})};var e1=(Q)=>{if(Q instanceof S8)return e1(Q.schema);else if(Q instanceof C1)return e1(Q.innerType());else if(Q instanceof Z8)return[Q.value];else if(Q instanceof O6)return Q.options;else if(Q instanceof C8)return t.objectValues(Q.enum);else if(Q instanceof b8)return e1(Q._def.innerType);else if(Q instanceof E8)return[void 0];else if(Q instanceof R8)return[null];else if(Q instanceof L1)return[void 0,...e1(Q.unwrap())];else if(Q instanceof Q6)return[null,...e1(Q.unwrap())];else if(Q instanceof xQ)return e1(Q.unwrap());else if(Q instanceof k8)return e1(Q.unwrap());else if(Q instanceof v8)return e1(Q._def.innerType);else return[]};class _Q extends r{_parse(Q){let{ctx:$}=this._processInputParams(Q);if($.parsedType!==I.object)return Z($,{code:R.invalid_type,expected:I.object,received:$.parsedType}),h;let W=this.discriminator,Y=$.data[W],X=this.optionsMap.get(Y);if(!X)return Z($,{code:R.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[W]}),h;if($.common.async)return X._parseAsync({data:$.data,path:$.path,parent:$});else return X._parseSync({data:$.data,path:$.path,parent:$})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(Q,$,W){let Y=new Map;for(let X of $){let J=e1(X.shape[Q]);if(!J.length)throw Error(`A discriminator value for key \`${Q}\` could not be extracted from all schema options`);for(let H of J){if(Y.has(H))throw Error(`Discriminator property ${String(Q)} has duplicate value ${String(H)}`);Y.set(H,X)}}return new _Q({typeName:P.ZodDiscriminatedUnion,discriminator:Q,options:$,optionsMap:Y,...c(W)})}}function k4(Q,$){let W=m1(Q),Y=m1($);if(Q===$)return{valid:!0,data:Q};else if(W===I.object&&Y===I.object){let X=t.objectKeys($),J=t.objectKeys(Q).filter((G)=>X.indexOf(G)!==-1),H={...Q,...$};for(let G of J){let B=k4(Q[G],$[G]);if(!B.valid)return{valid:!1};H[G]=B.data}return{valid:!0,data:H}}else if(W===I.array&&Y===I.array){if(Q.length!==$.length)return{valid:!1};let X=[];for(let J=0;J<Q.length;J++){let H=Q[J],G=$[J],B=k4(H,G);if(!B.valid)return{valid:!1};X.push(B.data)}return{valid:!0,data:X}}else if(W===I.date&&Y===I.date&&+Q===+$)return{valid:!0,data:Q};else return{valid:!1}}class I8 extends r{_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q),Y=(X,J)=>{if(kQ(X)||kQ(J))return h;let H=k4(X.value,J.value);if(!H.valid)return Z(W,{code:R.invalid_intersection_types}),h;if(TQ(X)||TQ(J))$.dirty();return{status:$.value,value:H.data}};if(W.common.async)return Promise.all([this._def.left._parseAsync({data:W.data,path:W.path,parent:W}),this._def.right._parseAsync({data:W.data,path:W.path,parent:W})]).then(([X,J])=>Y(X,J));else return Y(this._def.left._parseSync({data:W.data,path:W.path,parent:W}),this._def.right._parseSync({data:W.data,path:W.path,parent:W}))}}I8.create=(Q,$,W)=>{return new I8({left:Q,right:$,typeName:P.ZodIntersection,...c(W)})};class p1 extends r{_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q);if(W.parsedType!==I.array)return Z(W,{code:R.invalid_type,expected:I.array,received:W.parsedType}),h;if(W.data.length<this._def.items.length)return Z(W,{code:R.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),h;if(!this._def.rest&&W.data.length>this._def.items.length)Z(W,{code:R.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),$.dirty();let X=[...W.data].map((J,H)=>{let G=this._def.items[H]||this._def.rest;if(!G)return null;return G._parse(new Z1(W,J,W.path,H))}).filter((J)=>!!J);if(W.common.async)return Promise.all(X).then((J)=>{return x0.mergeArray($,J)});else return x0.mergeArray($,X)}get items(){return this._def.items}rest(Q){return new p1({...this._def,rest:Q})}}p1.create=(Q,$)=>{if(!Array.isArray(Q))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new p1({items:Q,typeName:P.ZodTuple,rest:null,...c($)})};class N9 extends r{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q);if(W.parsedType!==I.object)return Z(W,{code:R.invalid_type,expected:I.object,received:W.parsedType}),h;let Y=[],X=this._def.keyType,J=this._def.valueType;for(let H in W.data)Y.push({key:X._parse(new Z1(W,H,W.path,H)),value:J._parse(new Z1(W,W.data[H],W.path,H)),alwaysSet:H in W.data});if(W.common.async)return x0.mergeObjectAsync($,Y);else return x0.mergeObjectSync($,Y)}get element(){return this._def.valueType}static create(Q,$,W){if($ instanceof r)return new N9({keyType:Q,valueType:$,typeName:P.ZodRecord,...c(W)});return new N9({keyType:I1.create(),valueType:Q,typeName:P.ZodRecord,...c($)})}}class M9 extends r{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q);if(W.parsedType!==I.map)return Z(W,{code:R.invalid_type,expected:I.map,received:W.parsedType}),h;let Y=this._def.keyType,X=this._def.valueType,J=[...W.data.entries()].map(([H,G],B)=>{return{key:Y._parse(new Z1(W,H,W.path,[B,"key"])),value:X._parse(new Z1(W,G,W.path,[B,"value"]))}});if(W.common.async){let H=new Map;return Promise.resolve().then(async()=>{for(let G of J){let B=await G.key,K=await G.value;if(B.status==="aborted"||K.status==="aborted")return h;if(B.status==="dirty"||K.status==="dirty")$.dirty();H.set(B.value,K.value)}return{status:$.value,value:H}})}else{let H=new Map;for(let G of J){let{key:B,value:K}=G;if(B.status==="aborted"||K.status==="aborted")return h;if(B.status==="dirty"||K.status==="dirty")$.dirty();H.set(B.value,K.value)}return{status:$.value,value:H}}}}M9.create=(Q,$,W)=>{return new M9({valueType:$,keyType:Q,typeName:P.ZodMap,...c(W)})};class p6 extends r{_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q);if(W.parsedType!==I.set)return Z(W,{code:R.invalid_type,expected:I.set,received:W.parsedType}),h;let Y=this._def;if(Y.minSize!==null){if(W.data.size<Y.minSize.value)Z(W,{code:R.too_small,minimum:Y.minSize.value,type:"set",inclusive:!0,exact:!1,message:Y.minSize.message}),$.dirty()}if(Y.maxSize!==null){if(W.data.size>Y.maxSize.value)Z(W,{code:R.too_big,maximum:Y.maxSize.value,type:"set",inclusive:!0,exact:!1,message:Y.maxSize.message}),$.dirty()}let X=this._def.valueType;function J(G){let B=new Set;for(let K of G){if(K.status==="aborted")return h;if(K.status==="dirty")$.dirty();B.add(K.value)}return{status:$.value,value:B}}let H=[...W.data.values()].map((G,B)=>X._parse(new Z1(W,G,W.path,B)));if(W.common.async)return Promise.all(H).then((G)=>J(G));else return J(H)}min(Q,$){return new p6({...this._def,minSize:{value:Q,message:T.toString($)}})}max(Q,$){return new p6({...this._def,maxSize:{value:Q,message:T.toString($)}})}size(Q,$){return this.min(Q,$).max(Q,$)}nonempty(Q){return this.min(1,Q)}}p6.create=(Q,$)=>{return new p6({valueType:Q,minSize:null,maxSize:null,typeName:P.ZodSet,...c($)})};class j8 extends r{constructor(){super(...arguments);this.validate=this.implement}_parse(Q){let{ctx:$}=this._processInputParams(Q);if($.parsedType!==I.function)return Z($,{code:R.invalid_type,expected:I.function,received:$.parsedType}),h;function W(H,G){return z9({data:H,path:$.path,errorMaps:[$.common.contextualErrorMap,$.schemaErrorMap,O8(),s1].filter((B)=>!!B),issueData:{code:R.invalid_arguments,argumentsError:G}})}function Y(H,G){return z9({data:H,path:$.path,errorMaps:[$.common.contextualErrorMap,$.schemaErrorMap,O8(),s1].filter((B)=>!!B),issueData:{code:R.invalid_return_type,returnTypeError:G}})}let X={errorMap:$.common.contextualErrorMap},J=$.data;if(this._def.returns instanceof d6){let H=this;return c0(async function(...G){let B=new Y1([]),K=await H._def.args.parseAsync(G,X).catch((A)=>{throw B.addIssue(W(G,A)),B}),F=await Reflect.apply(J,this,K);return await H._def.returns._def.type.parseAsync(F,X).catch((A)=>{throw B.addIssue(Y(F,A)),B})})}else{let H=this;return c0(function(...G){let B=H._def.args.safeParse(G,X);if(!B.success)throw new Y1([W(G,B.error)]);let K=Reflect.apply(J,this,B.data),F=H._def.returns.safeParse(K,X);if(!F.success)throw new Y1([Y(K,F.error)]);return F.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...Q){return new j8({...this._def,args:p1.create(Q).rest(A6.create())})}returns(Q){return new j8({...this._def,returns:Q})}implement(Q){return this.parse(Q)}strictImplement(Q){return this.parse(Q)}static create(Q,$,W){return new j8({args:Q?Q:p1.create([]).rest(A6.create()),returns:$||A6.create(),typeName:P.ZodFunction,...c(W)})}}class S8 extends r{get schema(){return this._def.getter()}_parse(Q){let{ctx:$}=this._processInputParams(Q);return this._def.getter()._parse({data:$.data,path:$.path,parent:$})}}S8.create=(Q,$)=>{return new S8({getter:Q,typeName:P.ZodLazy,...c($)})};class Z8 extends r{_parse(Q){if(Q.data!==this._def.value){let $=this._getOrReturnCtx(Q);return Z($,{received:$.data,code:R.invalid_literal,expected:this._def.value}),h}return{status:"valid",value:Q.data}}get value(){return this._def.value}}Z8.create=(Q,$)=>{return new Z8({value:Q,typeName:P.ZodLiteral,...c($)})};function TX(Q,$){return new O6({values:Q,typeName:P.ZodEnum,...c($)})}class O6 extends r{_parse(Q){if(typeof Q.data!=="string"){let $=this._getOrReturnCtx(Q),W=this._def.values;return Z($,{expected:t.joinValues(W),received:$.parsedType,code:R.invalid_type}),h}if(!this._cache)this._cache=new Set(this._def.values);if(!this._cache.has(Q.data)){let $=this._getOrReturnCtx(Q),W=this._def.values;return Z($,{received:$.data,code:R.invalid_enum_value,options:W}),h}return c0(Q.data)}get options(){return this._def.values}get enum(){let Q={};for(let $ of this._def.values)Q[$]=$;return Q}get Values(){let Q={};for(let $ of this._def.values)Q[$]=$;return Q}get Enum(){let Q={};for(let $ of this._def.values)Q[$]=$;return Q}extract(Q,$=this._def){return O6.create(Q,{...this._def,...$})}exclude(Q,$=this._def){return O6.create(this.options.filter((W)=>!Q.includes(W)),{...this._def,...$})}}O6.create=TX;class C8 extends r{_parse(Q){let $=t.getValidEnumValues(this._def.values),W=this._getOrReturnCtx(Q);if(W.parsedType!==I.string&&W.parsedType!==I.number){let Y=t.objectValues($);return Z(W,{expected:t.joinValues(Y),received:W.parsedType,code:R.invalid_type}),h}if(!this._cache)this._cache=new Set(t.getValidEnumValues(this._def.values));if(!this._cache.has(Q.data)){let Y=t.objectValues($);return Z(W,{received:W.data,code:R.invalid_enum_value,options:Y}),h}return c0(Q.data)}get enum(){return this._def.values}}C8.create=(Q,$)=>{return new C8({values:Q,typeName:P.ZodNativeEnum,...c($)})};class d6 extends r{unwrap(){return this._def.type}_parse(Q){let{ctx:$}=this._processInputParams(Q);if($.parsedType!==I.promise&&$.common.async===!1)return Z($,{code:R.invalid_type,expected:I.promise,received:$.parsedType}),h;let W=$.parsedType===I.promise?$.data:Promise.resolve($.data);return c0(W.then((Y)=>{return this._def.type.parseAsync(Y,{path:$.path,errorMap:$.common.contextualErrorMap})}))}}d6.create=(Q,$)=>{return new d6({type:Q,typeName:P.ZodPromise,...c($)})};class C1 extends r{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q),Y=this._def.effect||null,X={addIssue:(J)=>{if(Z(W,J),J.fatal)$.abort();else $.dirty()},get path(){return W.path}};if(X.addIssue=X.addIssue.bind(X),Y.type==="preprocess"){let J=Y.transform(W.data,X);if(W.common.async)return Promise.resolve(J).then(async(H)=>{if($.value==="aborted")return h;let G=await this._def.schema._parseAsync({data:H,path:W.path,parent:W});if(G.status==="aborted")return h;if(G.status==="dirty")return l6(G.value);if($.value==="dirty")return l6(G.value);return G});else{if($.value==="aborted")return h;let H=this._def.schema._parseSync({data:J,path:W.path,parent:W});if(H.status==="aborted")return h;if(H.status==="dirty")return l6(H.value);if($.value==="dirty")return l6(H.value);return H}}if(Y.type==="refinement"){let J=(H)=>{let G=Y.refinement(H,X);if(W.common.async)return Promise.resolve(G);if(G instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return H};if(W.common.async===!1){let H=this._def.schema._parseSync({data:W.data,path:W.path,parent:W});if(H.status==="aborted")return h;if(H.status==="dirty")$.dirty();return J(H.value),{status:$.value,value:H.value}}else return this._def.schema._parseAsync({data:W.data,path:W.path,parent:W}).then((H)=>{if(H.status==="aborted")return h;if(H.status==="dirty")$.dirty();return J(H.value).then(()=>{return{status:$.value,value:H.value}})})}if(Y.type==="transform")if(W.common.async===!1){let J=this._def.schema._parseSync({data:W.data,path:W.path,parent:W});if(!U6(J))return h;let H=Y.transform(J.value,X);if(H instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:$.value,value:H}}else return this._def.schema._parseAsync({data:W.data,path:W.path,parent:W}).then((J)=>{if(!U6(J))return h;return Promise.resolve(Y.transform(J.value,X)).then((H)=>({status:$.value,value:H}))});t.assertNever(Y)}}C1.create=(Q,$,W)=>{return new C1({schema:Q,typeName:P.ZodEffects,effect:$,...c(W)})};C1.createWithPreprocess=(Q,$,W)=>{return new C1({schema:$,effect:{type:"preprocess",transform:Q},typeName:P.ZodEffects,...c(W)})};class L1 extends r{_parse(Q){if(this._getType(Q)===I.undefined)return c0(void 0);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}L1.create=(Q,$)=>{return new L1({innerType:Q,typeName:P.ZodOptional,...c($)})};class Q6 extends r{_parse(Q){if(this._getType(Q)===I.null)return c0(null);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}Q6.create=(Q,$)=>{return new Q6({innerType:Q,typeName:P.ZodNullable,...c($)})};class b8 extends r{_parse(Q){let{ctx:$}=this._processInputParams(Q),W=$.data;if($.parsedType===I.undefined)W=this._def.defaultValue();return this._def.innerType._parse({data:W,path:$.path,parent:$})}removeDefault(){return this._def.innerType}}b8.create=(Q,$)=>{return new b8({innerType:Q,typeName:P.ZodDefault,defaultValue:typeof $.default==="function"?$.default:()=>$.default,...c($)})};class v8 extends r{_parse(Q){let{ctx:$}=this._processInputParams(Q),W={...$,common:{...$.common,issues:[]}},Y=this._def.innerType._parse({data:W.data,path:W.path,parent:{...W}});if(N8(Y))return Y.then((X)=>{return{status:"valid",value:X.status==="valid"?X.value:this._def.catchValue({get error(){return new Y1(W.common.issues)},input:W.data})}});else return{status:"valid",value:Y.status==="valid"?Y.value:this._def.catchValue({get error(){return new Y1(W.common.issues)},input:W.data})}}removeCatch(){return this._def.innerType}}v8.create=(Q,$)=>{return new v8({innerType:Q,typeName:P.ZodCatch,catchValue:typeof $.catch==="function"?$.catch:()=>$.catch,...c($)})};class j9 extends r{_parse(Q){if(this._getType(Q)!==I.nan){let W=this._getOrReturnCtx(Q);return Z(W,{code:R.invalid_type,expected:I.nan,received:W.parsedType}),h}return{status:"valid",value:Q.data}}}j9.create=(Q)=>{return new j9({typeName:P.ZodNaN,...c(Q)})};var SL=Symbol("zod_brand");class xQ extends r{_parse(Q){let{ctx:$}=this._processInputParams(Q),W=$.data;return this._def.type._parse({data:W,path:$.path,parent:$})}unwrap(){return this._def.type}}class D9 extends r{_parse(Q){let{status:$,ctx:W}=this._processInputParams(Q);if(W.common.async)return(async()=>{let X=await this._def.in._parseAsync({data:W.data,path:W.path,parent:W});if(X.status==="aborted")return h;if(X.status==="dirty")return $.dirty(),l6(X.value);else return this._def.out._parseAsync({data:X.value,path:W.path,parent:W})})();else{let Y=this._def.in._parseSync({data:W.data,path:W.path,parent:W});if(Y.status==="aborted")return h;if(Y.status==="dirty")return $.dirty(),{status:"dirty",value:Y.value};else return this._def.out._parseSync({data:Y.value,path:W.path,parent:W})}}static create(Q,$){return new D9({in:Q,out:$,typeName:P.ZodPipeline})}}class k8 extends r{_parse(Q){let $=this._def.innerType._parse(Q),W=(Y)=>{if(U6(Y))Y.value=Object.freeze(Y.value);return Y};return N8($)?$.then((Y)=>W(Y)):W($)}unwrap(){return this._def.innerType}}k8.create=(Q,$)=>{return new k8({innerType:Q,typeName:P.ZodReadonly,...c($)})};function CX(Q,$){let W=typeof Q==="function"?Q($):typeof Q==="string"?{message:Q}:Q;return typeof W==="string"?{message:W}:W}function _X(Q,$={},W){if(Q)return c6.create().superRefine((Y,X)=>{let J=Q(Y);if(J instanceof Promise)return J.then((H)=>{if(!H){let G=CX($,Y),B=G.fatal??W??!0;X.addIssue({code:"custom",...G,fatal:B})}});if(!J){let H=CX($,Y),G=H.fatal??W??!0;X.addIssue({code:"custom",...H,fatal:G})}return});return c6.create()}var ZL={object:R0.lazycreate},P;(function(Q){Q.ZodString="ZodString",Q.ZodNumber="ZodNumber",Q.ZodNaN="ZodNaN",Q.ZodBigInt="ZodBigInt",Q.ZodBoolean="ZodBoolean",Q.ZodDate="ZodDate",Q.ZodSymbol="ZodSymbol",Q.ZodUndefined="ZodUndefined",Q.ZodNull="ZodNull",Q.ZodAny="ZodAny",Q.ZodUnknown="ZodUnknown",Q.ZodNever="ZodNever",Q.ZodVoid="ZodVoid",Q.ZodArray="ZodArray",Q.ZodObject="ZodObject",Q.ZodUnion="ZodUnion",Q.ZodDiscriminatedUnion="ZodDiscriminatedUnion",Q.ZodIntersection="ZodIntersection",Q.ZodTuple="ZodTuple",Q.ZodRecord="ZodRecord",Q.ZodMap="ZodMap",Q.ZodSet="ZodSet",Q.ZodFunction="ZodFunction",Q.ZodLazy="ZodLazy",Q.ZodLiteral="ZodLiteral",Q.ZodEnum="ZodEnum",Q.ZodEffects="ZodEffects",Q.ZodNativeEnum="ZodNativeEnum",Q.ZodOptional="ZodOptional",Q.ZodNullable="ZodNullable",Q.ZodDefault="ZodDefault",Q.ZodCatch="ZodCatch",Q.ZodPromise="ZodPromise",Q.ZodBranded="ZodBranded",Q.ZodPipeline="ZodPipeline",Q.ZodReadonly="ZodReadonly"})(P||(P={}));var CL=(Q,$={message:`Input not instance of ${Q.name}`})=>_X((W)=>W instanceof Q,$),xX=I1.create,yX=z6.create,bL=j9.create,vL=w6.create,gX=D8.create,kL=m6.create,TL=w9.create,_L=E8.create,xL=R8.create,yL=c6.create,gL=A6.create,hL=c1.create,fL=O9.create,uL=S1.create,T4=R0.create,lL=R0.strictCreate,mL=P8.create,cL=_Q.create,pL=I8.create,dL=p1.create,iL=N9.create,nL=M9.create,rL=p6.create,oL=j8.create,aL=S8.create,tL=Z8.create,sL=O6.create,eL=C8.create,Qq=d6.create,$q=C1.create,Wq=L1.create,Yq=Q6.create,Xq=C1.createWithPreprocess,Jq=D9.create,Hq=()=>xX().optional(),Gq=()=>yX().optional(),Bq=()=>gX().optional(),Kq={string:(Q)=>I1.create({...Q,coerce:!0}),number:(Q)=>z6.create({...Q,coerce:!0}),boolean:(Q)=>D8.create({...Q,coerce:!0}),bigint:(Q)=>w6.create({...Q,coerce:!0}),date:(Q)=>m6.create({...Q,coerce:!0})};var Fq=h;var Lq=Object.freeze({status:"aborted"});function M(Q,$,W){function Y(G,B){var K;Object.defineProperty(G,"_zod",{value:G._zod??{},enumerable:!1}),(K=G._zod).traits??(K.traits=new Set),G._zod.traits.add(Q),$(G,B);for(let F in H.prototype)if(!(F in G))Object.defineProperty(G,F,{value:H.prototype[F].bind(G)});G._zod.constr=H,G._zod.def=B}let X=W?.Parent??Object;class J extends X{}Object.defineProperty(J,"name",{value:Q});function H(G){var B;let K=W?.Parent?new J:this;Y(K,G),(B=K._zod).deferred??(B.deferred=[]);for(let F of K._zod.deferred)F();return K}return Object.defineProperty(H,"init",{value:Y}),Object.defineProperty(H,Symbol.hasInstance,{value:(G)=>{if(W?.Parent&&G instanceof W.Parent)return!0;return G?._zod?.traits?.has(Q)}}),Object.defineProperty(H,"name",{value:Q}),H}var qq=Symbol("zod_brand");class N6 extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}var yQ={};function q1(Q){if(Q)Object.assign(yQ,Q);return yQ}var s={};C4(s,{unwrapMessage:()=>E9,stringifyPrimitive:()=>fQ,required:()=>Cq,randomString:()=>Mq,propertyKeyTypes:()=>f4,promiseAllObject:()=>Nq,primitiveTypes:()=>hX,prefixIssues:()=>d1,pick:()=>Rq,partial:()=>Zq,optionalKeys:()=>u4,omit:()=>Pq,numKeys:()=>jq,nullish:()=>I9,normalizeParams:()=>f,merge:()=>Sq,jsonStringifyReplacer:()=>x4,joinValues:()=>gQ,issue:()=>m4,isPlainObject:()=>_8,isObject:()=>T8,getSizableOrigin:()=>uX,getParsedType:()=>Dq,getLengthableOrigin:()=>Z9,getEnumValues:()=>R9,getElementAtPath:()=>Oq,floatSafeRemainder:()=>y4,finalizeIssue:()=>b1,extend:()=>Iq,escapeRegex:()=>M6,esc:()=>i6,defineLazy:()=>U0,createTransparentProxy:()=>Eq,clone:()=>V1,cleanRegex:()=>S9,cleanEnum:()=>bq,captureStackTrace:()=>hQ,cached:()=>P9,assignProp:()=>g4,assertNotEqual:()=>Uq,assertNever:()=>zq,assertIs:()=>Aq,assertEqual:()=>Vq,assert:()=>wq,allowsEval:()=>h4,aborted:()=>n6,NUMBER_FORMAT_RANGES:()=>l4,Class:()=>lX,BIGINT_FORMAT_RANGES:()=>fX});function Vq(Q){return Q}function Uq(Q){return Q}function Aq(Q){}function zq(Q){throw Error()}function wq(Q){}function R9(Q){let $=Object.values(Q).filter((Y)=>typeof Y==="number");return Object.entries(Q).filter(([Y,X])=>$.indexOf(+Y)===-1).map(([Y,X])=>X)}function gQ(Q,$="|"){return Q.map((W)=>fQ(W)).join($)}function x4(Q,$){if(typeof $==="bigint")return $.toString();return $}function P9(Q){return{get value(){{let W=Q();return Object.defineProperty(this,"value",{value:W}),W}throw Error("cached value already set")}}}function I9(Q){return Q===null||Q===void 0}function S9(Q){let $=Q.startsWith("^")?1:0,W=Q.endsWith("$")?Q.length-1:Q.length;return Q.slice($,W)}function y4(Q,$){let W=(Q.toString().split(".")[1]||"").length,Y=($.toString().split(".")[1]||"").length,X=W>Y?W:Y,J=Number.parseInt(Q.toFixed(X).replace(".","")),H=Number.parseInt($.toFixed(X).replace(".",""));return J%H/10**X}function U0(Q,$,W){Object.defineProperty(Q,$,{get(){{let X=W();return Q[$]=X,X}throw Error("cached value already set")},set(X){Object.defineProperty(Q,$,{value:X})},configurable:!0})}function g4(Q,$,W){Object.defineProperty(Q,$,{value:W,writable:!0,enumerable:!0,configurable:!0})}function Oq(Q,$){if(!$)return Q;return $.reduce((W,Y)=>W?.[Y],Q)}function Nq(Q){let $=Object.keys(Q),W=$.map((Y)=>Q[Y]);return Promise.all(W).then((Y)=>{let X={};for(let J=0;J<$.length;J++)X[$[J]]=Y[J];return X})}function Mq(Q=10){let W="";for(let Y=0;Y<Q;Y++)W+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)];return W}function i6(Q){return JSON.stringify(Q)}var hQ=Error.captureStackTrace?Error.captureStackTrace:(...Q)=>{};function T8(Q){return typeof Q==="object"&&Q!==null&&!Array.isArray(Q)}var h4=P9(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(Q){return!1}});function _8(Q){if(T8(Q)===!1)return!1;let $=Q.constructor;if($===void 0)return!0;let W=$.prototype;if(T8(W)===!1)return!1;if(Object.prototype.hasOwnProperty.call(W,"isPrototypeOf")===!1)return!1;return!0}function jq(Q){let $=0;for(let W in Q)if(Object.prototype.hasOwnProperty.call(Q,W))$++;return $}var Dq=(Q)=>{let $=typeof Q;switch($){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(Q)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return"promise";if(typeof Map<"u"&&Q instanceof Map)return"map";if(typeof Set<"u"&&Q instanceof Set)return"set";if(typeof Date<"u"&&Q instanceof Date)return"date";if(typeof File<"u"&&Q instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${$}`)}},f4=new Set(["string","number","symbol"]),hX=new Set(["string","number","bigint","boolean","symbol","undefined"]);function M6(Q){return Q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function V1(Q,$,W){let Y=new Q._zod.constr($??Q._zod.def);if(!$||W?.parent)Y._zod.parent=Q;return Y}function f(Q){let $=Q;if(!$)return{};if(typeof $==="string")return{error:()=>$};if($?.message!==void 0){if($?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");$.error=$.message}if(delete $.message,typeof $.error==="string")return{...$,error:()=>$.error};return $}function Eq(Q){let $;return new Proxy({},{get(W,Y,X){return $??($=Q()),Reflect.get($,Y,X)},set(W,Y,X,J){return $??($=Q()),Reflect.set($,Y,X,J)},has(W,Y){return $??($=Q()),Reflect.has($,Y)},deleteProperty(W,Y){return $??($=Q()),Reflect.deleteProperty($,Y)},ownKeys(W){return $??($=Q()),Reflect.ownKeys($)},getOwnPropertyDescriptor(W,Y){return $??($=Q()),Reflect.getOwnPropertyDescriptor($,Y)},defineProperty(W,Y,X){return $??($=Q()),Reflect.defineProperty($,Y,X)}})}function fQ(Q){if(typeof Q==="bigint")return Q.toString()+"n";if(typeof Q==="string")return`"${Q}"`;return`${Q}`}function u4(Q){return Object.keys(Q).filter(($)=>{return Q[$]._zod.optin==="optional"&&Q[$]._zod.optout==="optional"})}var l4={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-340282346638528860000000000000000000000,340282346638528860000000000000000000000],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},fX={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Rq(Q,$){let W={},Y=Q._zod.def;for(let X in $){if(!(X in Y.shape))throw Error(`Unrecognized key: "${X}"`);if(!$[X])continue;W[X]=Y.shape[X]}return V1(Q,{...Q._zod.def,shape:W,checks:[]})}function Pq(Q,$){let W={...Q._zod.def.shape},Y=Q._zod.def;for(let X in $){if(!(X in Y.shape))throw Error(`Unrecognized key: "${X}"`);if(!$[X])continue;delete W[X]}return V1(Q,{...Q._zod.def,shape:W,checks:[]})}function Iq(Q,$){if(!_8($))throw Error("Invalid input to extend: expected a plain object");let W={...Q._zod.def,get shape(){let Y={...Q._zod.def.shape,...$};return g4(this,"shape",Y),Y},checks:[]};return V1(Q,W)}function Sq(Q,$){return V1(Q,{...Q._zod.def,get shape(){let W={...Q._zod.def.shape,...$._zod.def.shape};return g4(this,"shape",W),W},catchall:$._zod.def.catchall,checks:[]})}function Zq(Q,$,W){let Y=$._zod.def.shape,X={...Y};if(W)for(let J in W){if(!(J in Y))throw Error(`Unrecognized key: "${J}"`);if(!W[J])continue;X[J]=Q?new Q({type:"optional",innerType:Y[J]}):Y[J]}else for(let J in Y)X[J]=Q?new Q({type:"optional",innerType:Y[J]}):Y[J];return V1($,{...$._zod.def,shape:X,checks:[]})}function Cq(Q,$,W){let Y=$._zod.def.shape,X={...Y};if(W)for(let J in W){if(!(J in X))throw Error(`Unrecognized key: "${J}"`);if(!W[J])continue;X[J]=new Q({type:"nonoptional",innerType:Y[J]})}else for(let J in Y)X[J]=new Q({type:"nonoptional",innerType:Y[J]});return V1($,{...$._zod.def,shape:X,checks:[]})}function n6(Q,$=0){for(let W=$;W<Q.issues.length;W++)if(Q.issues[W]?.continue!==!0)return!0;return!1}function d1(Q,$){return $.map((W)=>{var Y;return(Y=W).path??(Y.path=[]),W.path.unshift(Q),W})}function E9(Q){return typeof Q==="string"?Q:Q?.message}function b1(Q,$,W){let Y={...Q,path:Q.path??[]};if(!Q.message){let X=E9(Q.inst?._zod.def?.error?.(Q))??E9($?.error?.(Q))??E9(W.customError?.(Q))??E9(W.localeError?.(Q))??"Invalid input";Y.message=X}if(delete Y.inst,delete Y.continue,!$?.reportInput)delete Y.input;return Y}function uX(Q){if(Q instanceof Set)return"set";if(Q instanceof Map)return"map";if(Q instanceof File)return"file";return"unknown"}function Z9(Q){if(Array.isArray(Q))return"array";if(typeof Q==="string")return"string";return"unknown"}function m4(...Q){let[$,W,Y]=Q;if(typeof $==="string")return{message:$,code:"custom",input:W,inst:Y};return{...$}}function bq(Q){return Object.entries(Q).filter(([$,W])=>{return Number.isNaN(Number.parseInt($,10))}).map(($)=>$[1])}class lX{constructor(...Q){}}var mX=(Q,$)=>{Q.name="$ZodError",Object.defineProperty(Q,"_zod",{value:Q._zod,enumerable:!1}),Object.defineProperty(Q,"issues",{value:$,enumerable:!1}),Object.defineProperty(Q,"message",{get(){return JSON.stringify($,x4,2)},enumerable:!0}),Object.defineProperty(Q,"toString",{value:()=>Q.message,enumerable:!1})},uQ=M("$ZodError",mX),C9=M("$ZodError",mX,{Parent:Error});function c4(Q,$=(W)=>W.message){let W={},Y=[];for(let X of Q.issues)if(X.path.length>0)W[X.path[0]]=W[X.path[0]]||[],W[X.path[0]].push($(X));else Y.push($(X));return{formErrors:Y,fieldErrors:W}}function p4(Q,$){let W=$||function(J){return J.message},Y={_errors:[]},X=(J)=>{for(let H of J.issues)if(H.code==="invalid_union"&&H.errors.length)H.errors.map((G)=>X({issues:G}));else if(H.code==="invalid_key")X({issues:H.issues});else if(H.code==="invalid_element")X({issues:H.issues});else if(H.path.length===0)Y._errors.push(W(H));else{let G=Y,B=0;while(B<H.path.length){let K=H.path[B];if(B!==H.path.length-1)G[K]=G[K]||{_errors:[]};else G[K]=G[K]||{_errors:[]},G[K]._errors.push(W(H));G=G[K],B++}}};return X(Q),Y}var d4=(Q)=>($,W,Y,X)=>{let J=Y?Object.assign(Y,{async:!1}):{async:!1},H=$._zod.run({value:W,issues:[]},J);if(H instanceof Promise)throw new N6;if(H.issues.length){let G=new(X?.Err??Q)(H.issues.map((B)=>b1(B,J,q1())));throw hQ(G,X?.callee),G}return H.value},i4=d4(C9),n4=(Q)=>async($,W,Y,X)=>{let J=Y?Object.assign(Y,{async:!0}):{async:!0},H=$._zod.run({value:W,issues:[]},J);if(H instanceof Promise)H=await H;if(H.issues.length){let G=new(X?.Err??Q)(H.issues.map((B)=>b1(B,J,q1())));throw hQ(G,X?.callee),G}return H.value},r4=n4(C9),o4=(Q)=>($,W,Y)=>{let X=Y?{...Y,async:!1}:{async:!1},J=$._zod.run({value:W,issues:[]},X);if(J instanceof Promise)throw new N6;return J.issues.length?{success:!1,error:new(Q??uQ)(J.issues.map((H)=>b1(H,X,q1())))}:{success:!0,data:J.value}},r6=o4(C9),a4=(Q)=>async($,W,Y)=>{let X=Y?Object.assign(Y,{async:!0}):{async:!0},J=$._zod.run({value:W,issues:[]},X);if(J instanceof Promise)J=await J;return J.issues.length?{success:!1,error:new Q(J.issues.map((H)=>b1(H,X,q1())))}:{success:!0,data:J.value}},o6=a4(C9);var cX=/^[cC][^\s-]{8,}$/,pX=/^[0-9a-z]+$/,dX=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,iX=/^[0-9a-vA-V]{20}$/,nX=/^[A-Za-z0-9]{27}$/,rX=/^[a-zA-Z0-9_-]{21}$/,oX=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var aX=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,t4=(Q)=>{if(!Q)return/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;return new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${Q}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`)};var tX=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;function sX(){return new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}var eX=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,QJ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,$J=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,WJ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,YJ=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,s4=/^[A-Za-z0-9_-]*$/,XJ=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var JJ=/^\+(?:[0-9]){6,14}[0-9]$/,HJ="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",GJ=new RegExp(`^${HJ}$`);function BJ(Q){return typeof Q.precision==="number"?Q.precision===-1?"(?:[01]\\d|2[0-3]):[0-5]\\d":Q.precision===0?"(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d":`(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d\\.\\d{${Q.precision}}`:"(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?"}function KJ(Q){return new RegExp(`^${BJ(Q)}$`)}function FJ(Q){let $=BJ({precision:Q.precision}),W=["Z"];if(Q.local)W.push("");if(Q.offset)W.push("([+-]\\d{2}:\\d{2})");let Y=`${$}(?:${W.join("|")})`;return new RegExp(`^${HJ}T(?:${Y})$`)}var LJ=(Q)=>{let $=Q?`[\\s\\S]{${Q?.minimum??0},${Q?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${$}$`)};var qJ=/^\d+$/,VJ=/^-?\d+(?:\.\d+)?/i,UJ=/true|false/i,AJ=/null/i;var zJ=/^[^A-Z]*$/,wJ=/^[^a-z]*$/;var y0=M("$ZodCheck",(Q,$)=>{var W;Q._zod??(Q._zod={}),Q._zod.def=$,(W=Q._zod).onattach??(W.onattach=[])}),OJ={number:"number",bigint:"bigint",object:"date"},e4=M("$ZodCheckLessThan",(Q,$)=>{y0.init(Q,$);let W=OJ[typeof $.value];Q._zod.onattach.push((Y)=>{let X=Y._zod.bag,J=($.inclusive?X.maximum:X.exclusiveMaximum)??Number.POSITIVE_INFINITY;if($.value<J)if($.inclusive)X.maximum=$.value;else X.exclusiveMaximum=$.value}),Q._zod.check=(Y)=>{if($.inclusive?Y.value<=$.value:Y.value<$.value)return;Y.issues.push({origin:W,code:"too_big",maximum:$.value,input:Y.value,inclusive:$.inclusive,inst:Q,continue:!$.abort})}}),Q$=M("$ZodCheckGreaterThan",(Q,$)=>{y0.init(Q,$);let W=OJ[typeof $.value];Q._zod.onattach.push((Y)=>{let X=Y._zod.bag,J=($.inclusive?X.minimum:X.exclusiveMinimum)??Number.NEGATIVE_INFINITY;if($.value>J)if($.inclusive)X.minimum=$.value;else X.exclusiveMinimum=$.value}),Q._zod.check=(Y)=>{if($.inclusive?Y.value>=$.value:Y.value>$.value)return;Y.issues.push({origin:W,code:"too_small",minimum:$.value,input:Y.value,inclusive:$.inclusive,inst:Q,continue:!$.abort})}}),NJ=M("$ZodCheckMultipleOf",(Q,$)=>{y0.init(Q,$),Q._zod.onattach.push((W)=>{var Y;(Y=W._zod.bag).multipleOf??(Y.multipleOf=$.value)}),Q._zod.check=(W)=>{if(typeof W.value!==typeof $.value)throw Error("Cannot mix number and bigint in multiple_of check.");if(typeof W.value==="bigint"?W.value%$.value===BigInt(0):y4(W.value,$.value)===0)return;W.issues.push({origin:typeof W.value,code:"not_multiple_of",divisor:$.value,input:W.value,inst:Q,continue:!$.abort})}}),MJ=M("$ZodCheckNumberFormat",(Q,$)=>{y0.init(Q,$),$.format=$.format||"float64";let W=$.format?.includes("int"),Y=W?"int":"number",[X,J]=l4[$.format];Q._zod.onattach.push((H)=>{let G=H._zod.bag;if(G.format=$.format,G.minimum=X,G.maximum=J,W)G.pattern=qJ}),Q._zod.check=(H)=>{let G=H.value;if(W){if(!Number.isInteger(G)){H.issues.push({expected:Y,format:$.format,code:"invalid_type",input:G,inst:Q});return}if(!Number.isSafeInteger(G)){if(G>0)H.issues.push({input:G,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!$.abort});else H.issues.push({input:G,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!$.abort});return}}if(G<X)H.issues.push({origin:"number",input:G,code:"too_small",minimum:X,inclusive:!0,inst:Q,continue:!$.abort});if(G>J)H.issues.push({origin:"number",input:G,code:"too_big",maximum:J,inst:Q})}});var jJ=M("$ZodCheckMaxLength",(Q,$)=>{var W;y0.init(Q,$),(W=Q._zod.def).when??(W.when=(Y)=>{let X=Y.value;return!I9(X)&&X.length!==void 0}),Q._zod.onattach.push((Y)=>{let X=Y._zod.bag.maximum??Number.POSITIVE_INFINITY;if($.maximum<X)Y._zod.bag.maximum=$.maximum}),Q._zod.check=(Y)=>{let X=Y.value;if(X.length<=$.maximum)return;let H=Z9(X);Y.issues.push({origin:H,code:"too_big",maximum:$.maximum,inclusive:!0,input:X,inst:Q,continue:!$.abort})}}),DJ=M("$ZodCheckMinLength",(Q,$)=>{var W;y0.init(Q,$),(W=Q._zod.def).when??(W.when=(Y)=>{let X=Y.value;return!I9(X)&&X.length!==void 0}),Q._zod.onattach.push((Y)=>{let X=Y._zod.bag.minimum??Number.NEGATIVE_INFINITY;if($.minimum>X)Y._zod.bag.minimum=$.minimum}),Q._zod.check=(Y)=>{let X=Y.value;if(X.length>=$.minimum)return;let H=Z9(X);Y.issues.push({origin:H,code:"too_small",minimum:$.minimum,inclusive:!0,input:X,inst:Q,continue:!$.abort})}}),EJ=M("$ZodCheckLengthEquals",(Q,$)=>{var W;y0.init(Q,$),(W=Q._zod.def).when??(W.when=(Y)=>{let X=Y.value;return!I9(X)&&X.length!==void 0}),Q._zod.onattach.push((Y)=>{let X=Y._zod.bag;X.minimum=$.length,X.maximum=$.length,X.length=$.length}),Q._zod.check=(Y)=>{let X=Y.value,J=X.length;if(J===$.length)return;let H=Z9(X),G=J>$.length;Y.issues.push({origin:H,...G?{code:"too_big",maximum:$.length}:{code:"too_small",minimum:$.length},inclusive:!0,exact:!0,input:Y.value,inst:Q,continue:!$.abort})}}),b9=M("$ZodCheckStringFormat",(Q,$)=>{var W,Y;if(y0.init(Q,$),Q._zod.onattach.push((X)=>{let J=X._zod.bag;if(J.format=$.format,$.pattern)J.patterns??(J.patterns=new Set),J.patterns.add($.pattern)}),$.pattern)(W=Q._zod).check??(W.check=(X)=>{if($.pattern.lastIndex=0,$.pattern.test(X.value))return;X.issues.push({origin:"string",code:"invalid_format",format:$.format,input:X.value,...$.pattern?{pattern:$.pattern.toString()}:{},inst:Q,continue:!$.abort})});else(Y=Q._zod).check??(Y.check=()=>{})}),RJ=M("$ZodCheckRegex",(Q,$)=>{b9.init(Q,$),Q._zod.check=(W)=>{if($.pattern.lastIndex=0,$.pattern.test(W.value))return;W.issues.push({origin:"string",code:"invalid_format",format:"regex",input:W.value,pattern:$.pattern.toString(),inst:Q,continue:!$.abort})}}),PJ=M("$ZodCheckLowerCase",(Q,$)=>{$.pattern??($.pattern=zJ),b9.init(Q,$)}),IJ=M("$ZodCheckUpperCase",(Q,$)=>{$.pattern??($.pattern=wJ),b9.init(Q,$)}),SJ=M("$ZodCheckIncludes",(Q,$)=>{y0.init(Q,$);let W=M6($.includes),Y=new RegExp(typeof $.position==="number"?`^.{${$.position}}${W}`:W);$.pattern=Y,Q._zod.onattach.push((X)=>{let J=X._zod.bag;J.patterns??(J.patterns=new Set),J.patterns.add(Y)}),Q._zod.check=(X)=>{if(X.value.includes($.includes,$.position))return;X.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:$.includes,input:X.value,inst:Q,continue:!$.abort})}}),ZJ=M("$ZodCheckStartsWith",(Q,$)=>{y0.init(Q,$);let W=new RegExp(`^${M6($.prefix)}.*`);$.pattern??($.pattern=W),Q._zod.onattach.push((Y)=>{let X=Y._zod.bag;X.patterns??(X.patterns=new Set),X.patterns.add(W)}),Q._zod.check=(Y)=>{if(Y.value.startsWith($.prefix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:$.prefix,input:Y.value,inst:Q,continue:!$.abort})}}),CJ=M("$ZodCheckEndsWith",(Q,$)=>{y0.init(Q,$);let W=new RegExp(`.*${M6($.suffix)}$`);$.pattern??($.pattern=W),Q._zod.onattach.push((Y)=>{let X=Y._zod.bag;X.patterns??(X.patterns=new Set),X.patterns.add(W)}),Q._zod.check=(Y)=>{if(Y.value.endsWith($.suffix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:$.suffix,input:Y.value,inst:Q,continue:!$.abort})}});var bJ=M("$ZodCheckOverwrite",(Q,$)=>{y0.init(Q,$),Q._zod.check=(W)=>{W.value=$.tx(W.value)}});class $${constructor(Q=[]){if(this.content=[],this.indent=0,this)this.args=Q}indented(Q){this.indent+=1,Q(this),this.indent-=1}write(Q){if(typeof Q==="function"){Q(this,{execution:"sync"}),Q(this,{execution:"async"});return}let W=Q.split(`
`).filter((J)=>J),Y=Math.min(...W.map((J)=>J.length-J.trimStart().length)),X=W.map((J)=>J.slice(Y)).map((J)=>" ".repeat(this.indent*2)+J);for(let J of X)this.content.push(J)}compile(){let Q=Function,$=this?.args,Y=[...(this?.content??[""]).map((X)=>`  ${X}`)];return new Q(...$,Y.join(`
`))}}var kJ={major:4,minor:0,patch:0};var L0=M("$ZodType",(Q,$)=>{var W;Q??(Q={}),Q._zod.def=$,Q._zod.bag=Q._zod.bag||{},Q._zod.version=kJ;let Y=[...Q._zod.def.checks??[]];if(Q._zod.traits.has("$ZodCheck"))Y.unshift(Q);for(let X of Y)for(let J of X._zod.onattach)J(Q);if(Y.length===0)(W=Q._zod).deferred??(W.deferred=[]),Q._zod.deferred?.push(()=>{Q._zod.run=Q._zod.parse});else{let X=(J,H,G)=>{let B=n6(J),K;for(let F of H){if(F._zod.def.when){if(!F._zod.def.when(J))continue}else if(B)continue;let q=J.issues.length,A=F._zod.check(J);if(A instanceof Promise&&G?.async===!1)throw new N6;if(K||A instanceof Promise)K=(K??Promise.resolve()).then(async()=>{if(await A,J.issues.length===q)return;if(!B)B=n6(J,q)});else{if(J.issues.length===q)continue;if(!B)B=n6(J,q)}}if(K)return K.then(()=>{return J});return J};Q._zod.run=(J,H)=>{let G=Q._zod.parse(J,H);if(G instanceof Promise){if(H.async===!1)throw new N6;return G.then((B)=>X(B,Y,H))}return X(G,Y,H)}}Q["~standard"]={validate:(X)=>{try{let J=r6(Q,X);return J.success?{value:J.data}:{issues:J.error?.issues}}catch(J){return o6(Q,X).then((H)=>H.success?{value:H.data}:{issues:H.error?.issues})}},vendor:"zod",version:1}}),v9=M("$ZodString",(Q,$)=>{L0.init(Q,$),Q._zod.pattern=[...Q?._zod.bag?.patterns??[]].pop()??LJ(Q._zod.bag),Q._zod.parse=(W,Y)=>{if($.coerce)try{W.value=String(W.value)}catch(X){}if(typeof W.value==="string")return W;return W.issues.push({expected:"string",code:"invalid_type",input:W.value,inst:Q}),W}}),A0=M("$ZodStringFormat",(Q,$)=>{b9.init(Q,$),v9.init(Q,$)}),Y$=M("$ZodGUID",(Q,$)=>{$.pattern??($.pattern=aX),A0.init(Q,$)}),X$=M("$ZodUUID",(Q,$)=>{if($.version){let Y={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[$.version];if(Y===void 0)throw Error(`Invalid UUID version: "${$.version}"`);$.pattern??($.pattern=t4(Y))}else $.pattern??($.pattern=t4());A0.init(Q,$)}),J$=M("$ZodEmail",(Q,$)=>{$.pattern??($.pattern=tX),A0.init(Q,$)}),H$=M("$ZodURL",(Q,$)=>{A0.init(Q,$),Q._zod.check=(W)=>{try{let Y=W.value,X=new URL(Y),J=X.href;if($.hostname){if($.hostname.lastIndex=0,!$.hostname.test(X.hostname))W.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:XJ.source,input:W.value,inst:Q,continue:!$.abort})}if($.protocol){if($.protocol.lastIndex=0,!$.protocol.test(X.protocol.endsWith(":")?X.protocol.slice(0,-1):X.protocol))W.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:$.protocol.source,input:W.value,inst:Q,continue:!$.abort})}if(!Y.endsWith("/")&&J.endsWith("/"))W.value=J.slice(0,-1);else W.value=J;return}catch(Y){W.issues.push({code:"invalid_format",format:"url",input:W.value,inst:Q,continue:!$.abort})}}}),G$=M("$ZodEmoji",(Q,$)=>{$.pattern??($.pattern=sX()),A0.init(Q,$)}),B$=M("$ZodNanoID",(Q,$)=>{$.pattern??($.pattern=rX),A0.init(Q,$)}),K$=M("$ZodCUID",(Q,$)=>{$.pattern??($.pattern=cX),A0.init(Q,$)}),F$=M("$ZodCUID2",(Q,$)=>{$.pattern??($.pattern=pX),A0.init(Q,$)}),L$=M("$ZodULID",(Q,$)=>{$.pattern??($.pattern=dX),A0.init(Q,$)}),q$=M("$ZodXID",(Q,$)=>{$.pattern??($.pattern=iX),A0.init(Q,$)}),V$=M("$ZodKSUID",(Q,$)=>{$.pattern??($.pattern=nX),A0.init(Q,$)}),mJ=M("$ZodISODateTime",(Q,$)=>{$.pattern??($.pattern=FJ($)),A0.init(Q,$)}),cJ=M("$ZodISODate",(Q,$)=>{$.pattern??($.pattern=GJ),A0.init(Q,$)}),pJ=M("$ZodISOTime",(Q,$)=>{$.pattern??($.pattern=KJ($)),A0.init(Q,$)}),dJ=M("$ZodISODuration",(Q,$)=>{$.pattern??($.pattern=oX),A0.init(Q,$)}),U$=M("$ZodIPv4",(Q,$)=>{$.pattern??($.pattern=eX),A0.init(Q,$),Q._zod.onattach.push((W)=>{let Y=W._zod.bag;Y.format="ipv4"})}),A$=M("$ZodIPv6",(Q,$)=>{$.pattern??($.pattern=QJ),A0.init(Q,$),Q._zod.onattach.push((W)=>{let Y=W._zod.bag;Y.format="ipv6"}),Q._zod.check=(W)=>{try{new URL(`http://[${W.value}]`)}catch{W.issues.push({code:"invalid_format",format:"ipv6",input:W.value,inst:Q,continue:!$.abort})}}}),z$=M("$ZodCIDRv4",(Q,$)=>{$.pattern??($.pattern=$J),A0.init(Q,$)}),w$=M("$ZodCIDRv6",(Q,$)=>{$.pattern??($.pattern=WJ),A0.init(Q,$),Q._zod.check=(W)=>{let[Y,X]=W.value.split("/");try{if(!X)throw Error();let J=Number(X);if(`${J}`!==X)throw Error();if(J<0||J>128)throw Error();new URL(`http://[${Y}]`)}catch{W.issues.push({code:"invalid_format",format:"cidrv6",input:W.value,inst:Q,continue:!$.abort})}}});function iJ(Q){if(Q==="")return!0;if(Q.length%4!==0)return!1;try{return atob(Q),!0}catch{return!1}}var O$=M("$ZodBase64",(Q,$)=>{$.pattern??($.pattern=YJ),A0.init(Q,$),Q._zod.onattach.push((W)=>{W._zod.bag.contentEncoding="base64"}),Q._zod.check=(W)=>{if(iJ(W.value))return;W.issues.push({code:"invalid_format",format:"base64",input:W.value,inst:Q,continue:!$.abort})}});function kq(Q){if(!s4.test(Q))return!1;let $=Q.replace(/[-_]/g,(Y)=>Y==="-"?"+":"/"),W=$.padEnd(Math.ceil($.length/4)*4,"=");return iJ(W)}var N$=M("$ZodBase64URL",(Q,$)=>{$.pattern??($.pattern=s4),A0.init(Q,$),Q._zod.onattach.push((W)=>{W._zod.bag.contentEncoding="base64url"}),Q._zod.check=(W)=>{if(kq(W.value))return;W.issues.push({code:"invalid_format",format:"base64url",input:W.value,inst:Q,continue:!$.abort})}}),M$=M("$ZodE164",(Q,$)=>{$.pattern??($.pattern=JJ),A0.init(Q,$)});function Tq(Q,$=null){try{let W=Q.split(".");if(W.length!==3)return!1;let[Y]=W;if(!Y)return!1;let X=JSON.parse(atob(Y));if("typ"in X&&X?.typ!=="JWT")return!1;if(!X.alg)return!1;if($&&(!("alg"in X)||X.alg!==$))return!1;return!0}catch{return!1}}var j$=M("$ZodJWT",(Q,$)=>{A0.init(Q,$),Q._zod.check=(W)=>{if(Tq(W.value,$.alg))return;W.issues.push({code:"invalid_format",format:"jwt",input:W.value,inst:Q,continue:!$.abort})}});var cQ=M("$ZodNumber",(Q,$)=>{L0.init(Q,$),Q._zod.pattern=Q._zod.bag.pattern??VJ,Q._zod.parse=(W,Y)=>{if($.coerce)try{W.value=Number(W.value)}catch(H){}let X=W.value;if(typeof X==="number"&&!Number.isNaN(X)&&Number.isFinite(X))return W;let J=typeof X==="number"?Number.isNaN(X)?"NaN":!Number.isFinite(X)?"Infinity":void 0:void 0;return W.issues.push({expected:"number",code:"invalid_type",input:X,inst:Q,...J?{received:J}:{}}),W}}),D$=M("$ZodNumber",(Q,$)=>{MJ.init(Q,$),cQ.init(Q,$)}),E$=M("$ZodBoolean",(Q,$)=>{L0.init(Q,$),Q._zod.pattern=UJ,Q._zod.parse=(W,Y)=>{if($.coerce)try{W.value=Boolean(W.value)}catch(J){}let X=W.value;if(typeof X==="boolean")return W;return W.issues.push({expected:"boolean",code:"invalid_type",input:X,inst:Q}),W}});var R$=M("$ZodNull",(Q,$)=>{L0.init(Q,$),Q._zod.pattern=AJ,Q._zod.values=new Set([null]),Q._zod.parse=(W,Y)=>{let X=W.value;if(X===null)return W;return W.issues.push({expected:"null",code:"invalid_type",input:X,inst:Q}),W}});var P$=M("$ZodUnknown",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W)=>W}),I$=M("$ZodNever",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W,Y)=>{return W.issues.push({expected:"never",code:"invalid_type",input:W.value,inst:Q}),W}});function TJ(Q,$,W){if(Q.issues.length)$.issues.push(...d1(W,Q.issues));$.value[W]=Q.value}var S$=M("$ZodArray",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W,Y)=>{let X=W.value;if(!Array.isArray(X))return W.issues.push({expected:"array",code:"invalid_type",input:X,inst:Q}),W;W.value=Array(X.length);let J=[];for(let H=0;H<X.length;H++){let G=X[H],B=$.element._zod.run({value:G,issues:[]},Y);if(B instanceof Promise)J.push(B.then((K)=>TJ(K,W,H)));else TJ(B,W,H)}if(J.length)return Promise.all(J).then(()=>W);return W}});function mQ(Q,$,W){if(Q.issues.length)$.issues.push(...d1(W,Q.issues));$.value[W]=Q.value}function _J(Q,$,W,Y){if(Q.issues.length)if(Y[W]===void 0)if(W in Y)$.value[W]=void 0;else $.value[W]=Q.value;else $.issues.push(...d1(W,Q.issues));else if(Q.value===void 0){if(W in Y)$.value[W]=void 0}else $.value[W]=Q.value}var pQ=M("$ZodObject",(Q,$)=>{L0.init(Q,$);let W=P9(()=>{let q=Object.keys($.shape);for(let V of q)if(!($.shape[V]instanceof L0))throw Error(`Invalid element at key "${V}": expected a Zod schema`);let A=u4($.shape);return{shape:$.shape,keys:q,keySet:new Set(q),numKeys:q.length,optionalKeys:new Set(A)}});U0(Q._zod,"propValues",()=>{let q=$.shape,A={};for(let V in q){let U=q[V]._zod;if(U.values){A[V]??(A[V]=new Set);for(let z of U.values)A[V].add(z)}}return A});let Y=(q)=>{let A=new $$(["shape","payload","ctx"]),V=W.value,U=(D)=>{let j=i6(D);return`shape[${j}]._zod.run({ value: input[${j}], issues: [] }, ctx)`};A.write("const input = payload.value;");let z=Object.create(null),w=0;for(let D of V.keys)z[D]=`key_${w++}`;A.write("const newResult = {}");for(let D of V.keys)if(V.optionalKeys.has(D)){let j=z[D];A.write(`const ${j} = ${U(D)};`);let S=i6(D);A.write(`
        if (${j}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${j}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${j}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${j}.value;
        }
        `)}else{let j=z[D];A.write(`const ${j} = ${U(D)};`),A.write(`
          if (${j}.issues.length) payload.issues = payload.issues.concat(${j}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${i6(D)}, ...iss.path] : [${i6(D)}]
          })));`),A.write(`newResult[${i6(D)}] = ${j}.value`)}A.write("payload.value = newResult;"),A.write("return payload;");let O=A.compile();return(D,j)=>O(q,D,j)},X,J=T8,H=!yQ.jitless,B=H&&h4.value,K=$.catchall,F;Q._zod.parse=(q,A)=>{F??(F=W.value);let V=q.value;if(!J(V))return q.issues.push({expected:"object",code:"invalid_type",input:V,inst:Q}),q;let U=[];if(H&&B&&A?.async===!1&&A.jitless!==!0){if(!X)X=Y($.shape);q=X(q,A)}else{q.value={};let j=F.shape;for(let S of F.keys){let C=j[S],K0=C._zod.run({value:V[S],issues:[]},A),b0=C._zod.optin==="optional"&&C._zod.optout==="optional";if(K0 instanceof Promise)U.push(K0.then((f1)=>b0?_J(f1,q,S,V):mQ(f1,q,S)));else if(b0)_J(K0,q,S,V);else mQ(K0,q,S)}}if(!K)return U.length?Promise.all(U).then(()=>q):q;let z=[],w=F.keySet,O=K._zod,D=O.def.type;for(let j of Object.keys(V)){if(w.has(j))continue;if(D==="never"){z.push(j);continue}let S=O.run({value:V[j],issues:[]},A);if(S instanceof Promise)U.push(S.then((C)=>mQ(C,q,j)));else mQ(S,q,j)}if(z.length)q.issues.push({code:"unrecognized_keys",keys:z,input:V,inst:Q});if(!U.length)return q;return Promise.all(U).then(()=>{return q})}});function xJ(Q,$,W,Y){for(let X of Q)if(X.issues.length===0)return $.value=X.value,$;return $.issues.push({code:"invalid_union",input:$.value,inst:W,errors:Q.map((X)=>X.issues.map((J)=>b1(J,Y,q1())))}),$}var dQ=M("$ZodUnion",(Q,$)=>{L0.init(Q,$),U0(Q._zod,"optin",()=>$.options.some((W)=>W._zod.optin==="optional")?"optional":void 0),U0(Q._zod,"optout",()=>$.options.some((W)=>W._zod.optout==="optional")?"optional":void 0),U0(Q._zod,"values",()=>{if($.options.every((W)=>W._zod.values))return new Set($.options.flatMap((W)=>Array.from(W._zod.values)));return}),U0(Q._zod,"pattern",()=>{if($.options.every((W)=>W._zod.pattern)){let W=$.options.map((Y)=>Y._zod.pattern);return new RegExp(`^(${W.map((Y)=>S9(Y.source)).join("|")})$`)}return}),Q._zod.parse=(W,Y)=>{let X=!1,J=[];for(let H of $.options){let G=H._zod.run({value:W.value,issues:[]},Y);if(G instanceof Promise)J.push(G),X=!0;else{if(G.issues.length===0)return G;J.push(G)}}if(!X)return xJ(J,W,Q,Y);return Promise.all(J).then((H)=>{return xJ(H,W,Q,Y)})}}),Z$=M("$ZodDiscriminatedUnion",(Q,$)=>{dQ.init(Q,$);let W=Q._zod.parse;U0(Q._zod,"propValues",()=>{let X={};for(let J of $.options){let H=J._zod.propValues;if(!H||Object.keys(H).length===0)throw Error(`Invalid discriminated union option at index "${$.options.indexOf(J)}"`);for(let[G,B]of Object.entries(H)){if(!X[G])X[G]=new Set;for(let K of B)X[G].add(K)}}return X});let Y=P9(()=>{let X=$.options,J=new Map;for(let H of X){let G=H._zod.propValues[$.discriminator];if(!G||G.size===0)throw Error(`Invalid discriminated union option at index "${$.options.indexOf(H)}"`);for(let B of G){if(J.has(B))throw Error(`Duplicate discriminator value "${String(B)}"`);J.set(B,H)}}return J});Q._zod.parse=(X,J)=>{let H=X.value;if(!T8(H))return X.issues.push({code:"invalid_type",expected:"object",input:H,inst:Q}),X;let G=Y.value.get(H?.[$.discriminator]);if(G)return G._zod.run(X,J);if($.unionFallback)return W(X,J);return X.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:H,path:[$.discriminator],inst:Q}),X}}),C$=M("$ZodIntersection",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W,Y)=>{let X=W.value,J=$.left._zod.run({value:X,issues:[]},Y),H=$.right._zod.run({value:X,issues:[]},Y);if(J instanceof Promise||H instanceof Promise)return Promise.all([J,H]).then(([B,K])=>{return yJ(W,B,K)});return yJ(W,J,H)}});function W$(Q,$){if(Q===$)return{valid:!0,data:Q};if(Q instanceof Date&&$ instanceof Date&&+Q===+$)return{valid:!0,data:Q};if(_8(Q)&&_8($)){let W=Object.keys($),Y=Object.keys(Q).filter((J)=>W.indexOf(J)!==-1),X={...Q,...$};for(let J of Y){let H=W$(Q[J],$[J]);if(!H.valid)return{valid:!1,mergeErrorPath:[J,...H.mergeErrorPath]};X[J]=H.data}return{valid:!0,data:X}}if(Array.isArray(Q)&&Array.isArray($)){if(Q.length!==$.length)return{valid:!1,mergeErrorPath:[]};let W=[];for(let Y=0;Y<Q.length;Y++){let X=Q[Y],J=$[Y],H=W$(X,J);if(!H.valid)return{valid:!1,mergeErrorPath:[Y,...H.mergeErrorPath]};W.push(H.data)}return{valid:!0,data:W}}return{valid:!1,mergeErrorPath:[]}}function yJ(Q,$,W){if($.issues.length)Q.issues.push(...$.issues);if(W.issues.length)Q.issues.push(...W.issues);if(n6(Q))return Q;let Y=W$($.value,W.value);if(!Y.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(Y.mergeErrorPath)}`);return Q.value=Y.data,Q}var b$=M("$ZodRecord",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W,Y)=>{let X=W.value;if(!_8(X))return W.issues.push({expected:"record",code:"invalid_type",input:X,inst:Q}),W;let J=[];if($.keyType._zod.values){let H=$.keyType._zod.values;W.value={};for(let B of H)if(typeof B==="string"||typeof B==="number"||typeof B==="symbol"){let K=$.valueType._zod.run({value:X[B],issues:[]},Y);if(K instanceof Promise)J.push(K.then((F)=>{if(F.issues.length)W.issues.push(...d1(B,F.issues));W.value[B]=F.value}));else{if(K.issues.length)W.issues.push(...d1(B,K.issues));W.value[B]=K.value}}let G;for(let B in X)if(!H.has(B))G=G??[],G.push(B);if(G&&G.length>0)W.issues.push({code:"unrecognized_keys",input:X,inst:Q,keys:G})}else{W.value={};for(let H of Reflect.ownKeys(X)){if(H==="__proto__")continue;let G=$.keyType._zod.run({value:H,issues:[]},Y);if(G instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(G.issues.length){W.issues.push({origin:"record",code:"invalid_key",issues:G.issues.map((K)=>b1(K,Y,q1())),input:H,path:[H],inst:Q}),W.value[G.value]=G.value;continue}let B=$.valueType._zod.run({value:X[H],issues:[]},Y);if(B instanceof Promise)J.push(B.then((K)=>{if(K.issues.length)W.issues.push(...d1(H,K.issues));W.value[G.value]=K.value}));else{if(B.issues.length)W.issues.push(...d1(H,B.issues));W.value[G.value]=B.value}}}if(J.length)return Promise.all(J).then(()=>W);return W}});var v$=M("$ZodEnum",(Q,$)=>{L0.init(Q,$);let W=R9($.entries);Q._zod.values=new Set(W),Q._zod.pattern=new RegExp(`^(${W.filter((Y)=>f4.has(typeof Y)).map((Y)=>typeof Y==="string"?M6(Y):Y.toString()).join("|")})$`),Q._zod.parse=(Y,X)=>{let J=Y.value;if(Q._zod.values.has(J))return Y;return Y.issues.push({code:"invalid_value",values:W,input:J,inst:Q}),Y}}),k$=M("$ZodLiteral",(Q,$)=>{L0.init(Q,$),Q._zod.values=new Set($.values),Q._zod.pattern=new RegExp(`^(${$.values.map((W)=>typeof W==="string"?M6(W):W?W.toString():String(W)).join("|")})$`),Q._zod.parse=(W,Y)=>{let X=W.value;if(Q._zod.values.has(X))return W;return W.issues.push({code:"invalid_value",values:$.values,input:X,inst:Q}),W}});var T$=M("$ZodTransform",(Q,$)=>{L0.init(Q,$),Q._zod.parse=(W,Y)=>{let X=$.transform(W.value,W);if(Y.async)return(X instanceof Promise?X:Promise.resolve(X)).then((H)=>{return W.value=H,W});if(X instanceof Promise)throw new N6;return W.value=X,W}}),_$=M("$ZodOptional",(Q,$)=>{L0.init(Q,$),Q._zod.optin="optional",Q._zod.optout="optional",U0(Q._zod,"values",()=>{return $.innerType._zod.values?new Set([...$.innerType._zod.values,void 0]):void 0}),U0(Q._zod,"pattern",()=>{let W=$.innerType._zod.pattern;return W?new RegExp(`^(${S9(W.source)})?$`):void 0}),Q._zod.parse=(W,Y)=>{if($.innerType._zod.optin==="optional")return $.innerType._zod.run(W,Y);if(W.value===void 0)return W;return $.innerType._zod.run(W,Y)}}),x$=M("$ZodNullable",(Q,$)=>{L0.init(Q,$),U0(Q._zod,"optin",()=>$.innerType._zod.optin),U0(Q._zod,"optout",()=>$.innerType._zod.optout),U0(Q._zod,"pattern",()=>{let W=$.innerType._zod.pattern;return W?new RegExp(`^(${S9(W.source)}|null)$`):void 0}),U0(Q._zod,"values",()=>{return $.innerType._zod.values?new Set([...$.innerType._zod.values,null]):void 0}),Q._zod.parse=(W,Y)=>{if(W.value===null)return W;return $.innerType._zod.run(W,Y)}}),y$=M("$ZodDefault",(Q,$)=>{L0.init(Q,$),Q._zod.optin="optional",U0(Q._zod,"values",()=>$.innerType._zod.values),Q._zod.parse=(W,Y)=>{if(W.value===void 0)return W.value=$.defaultValue,W;let X=$.innerType._zod.run(W,Y);if(X instanceof Promise)return X.then((J)=>gJ(J,$));return gJ(X,$)}});function gJ(Q,$){if(Q.value===void 0)Q.value=$.defaultValue;return Q}var g$=M("$ZodPrefault",(Q,$)=>{L0.init(Q,$),Q._zod.optin="optional",U0(Q._zod,"values",()=>$.innerType._zod.values),Q._zod.parse=(W,Y)=>{if(W.value===void 0)W.value=$.defaultValue;return $.innerType._zod.run(W,Y)}}),h$=M("$ZodNonOptional",(Q,$)=>{L0.init(Q,$),U0(Q._zod,"values",()=>{let W=$.innerType._zod.values;return W?new Set([...W].filter((Y)=>Y!==void 0)):void 0}),Q._zod.parse=(W,Y)=>{let X=$.innerType._zod.run(W,Y);if(X instanceof Promise)return X.then((J)=>hJ(J,Q));return hJ(X,Q)}});function hJ(Q,$){if(!Q.issues.length&&Q.value===void 0)Q.issues.push({code:"invalid_type",expected:"nonoptional",input:Q.value,inst:$});return Q}var f$=M("$ZodCatch",(Q,$)=>{L0.init(Q,$),Q._zod.optin="optional",U0(Q._zod,"optout",()=>$.innerType._zod.optout),U0(Q._zod,"values",()=>$.innerType._zod.values),Q._zod.parse=(W,Y)=>{let X=$.innerType._zod.run(W,Y);if(X instanceof Promise)return X.then((J)=>{if(W.value=J.value,J.issues.length)W.value=$.catchValue({...W,error:{issues:J.issues.map((H)=>b1(H,Y,q1()))},input:W.value}),W.issues=[];return W});if(W.value=X.value,X.issues.length)W.value=$.catchValue({...W,error:{issues:X.issues.map((J)=>b1(J,Y,q1()))},input:W.value}),W.issues=[];return W}});var u$=M("$ZodPipe",(Q,$)=>{L0.init(Q,$),U0(Q._zod,"values",()=>$.in._zod.values),U0(Q._zod,"optin",()=>$.in._zod.optin),U0(Q._zod,"optout",()=>$.out._zod.optout),Q._zod.parse=(W,Y)=>{let X=$.in._zod.run(W,Y);if(X instanceof Promise)return X.then((J)=>fJ(J,$,Y));return fJ(X,$,Y)}});function fJ(Q,$,W){if(n6(Q))return Q;return $.out._zod.run({value:Q.value,issues:Q.issues},W)}var l$=M("$ZodReadonly",(Q,$)=>{L0.init(Q,$),U0(Q._zod,"propValues",()=>$.innerType._zod.propValues),U0(Q._zod,"values",()=>$.innerType._zod.values),U0(Q._zod,"optin",()=>$.innerType._zod.optin),U0(Q._zod,"optout",()=>$.innerType._zod.optout),Q._zod.parse=(W,Y)=>{let X=$.innerType._zod.run(W,Y);if(X instanceof Promise)return X.then(uJ);return uJ(X)}});function uJ(Q){return Q.value=Object.freeze(Q.value),Q}var m$=M("$ZodCustom",(Q,$)=>{y0.init(Q,$),L0.init(Q,$),Q._zod.parse=(W,Y)=>{return W},Q._zod.check=(W)=>{let Y=W.value,X=$.fn(Y);if(X instanceof Promise)return X.then((J)=>lJ(J,W,Y,Q));lJ(X,W,Y,Q);return}});function lJ(Q,$,W,Y){if(!Q){let X={code:"custom",input:W,inst:Y,path:[...Y._zod.def.path??[]],continue:!Y._zod.def.abort};if(Y._zod.def.params)X.params=Y._zod.def.params;$.issues.push(m4(X))}}var _q=(Q)=>{let $=typeof Q;switch($){case"number":return Number.isNaN(Q)?"NaN":"number";case"object":{if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Object.getPrototypeOf(Q)!==Object.prototype&&Q.constructor)return Q.constructor.name}}return $},xq=()=>{let Q={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function $(Y){return Q[Y]??null}let W={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Invalid input: expected ${Y.expected}, received ${_q(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Invalid input: expected ${fQ(Y.values[0])}`;return`Invalid option: expected one of ${gQ(Y.values,"|")}`;case"too_big":{let X=Y.inclusive?"<=":"<",J=$(Y.origin);if(J)return`Too big: expected ${Y.origin??"value"} to have ${X}${Y.maximum.toString()} ${J.unit??"elements"}`;return`Too big: expected ${Y.origin??"value"} to be ${X}${Y.maximum.toString()}`}case"too_small":{let X=Y.inclusive?">=":">",J=$(Y.origin);if(J)return`Too small: expected ${Y.origin} to have ${X}${Y.minimum.toString()} ${J.unit}`;return`Too small: expected ${Y.origin} to be ${X}${Y.minimum.toString()}`}case"invalid_format":{let X=Y;if(X.format==="starts_with")return`Invalid string: must start with "${X.prefix}"`;if(X.format==="ends_with")return`Invalid string: must end with "${X.suffix}"`;if(X.format==="includes")return`Invalid string: must include "${X.includes}"`;if(X.format==="regex")return`Invalid string: must match pattern ${X.pattern}`;return`Invalid ${W[X.format]??Y.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${Y.divisor}`;case"unrecognized_keys":return`Unrecognized key${Y.keys.length>1?"s":""}: ${gQ(Y.keys,", ")}`;case"invalid_key":return`Invalid key in ${Y.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${Y.origin}`;default:return"Invalid input"}}};function c$(){return{localeError:xq()}}var yq=Symbol("ZodOutput"),gq=Symbol("ZodInput");class iQ{constructor(){this._map=new Map,this._idmap=new Map}add(Q,...$){let W=$[0];if(this._map.set(Q,W),W&&typeof W==="object"&&"id"in W){if(this._idmap.has(W.id))throw Error(`ID ${W.id} already exists in the registry`);this._idmap.set(W.id,Q)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(Q){let $=this._map.get(Q);if($&&typeof $==="object"&&"id"in $)this._idmap.delete($.id);return this._map.delete(Q),this}get(Q){let $=Q._zod.parent;if($){let W={...this.get($)??{}};return delete W.id,{...W,...this._map.get(Q)}}return this._map.get(Q)}has(Q){return this._map.has(Q)}}function nJ(){return new iQ}var j6=nJ();function p$(Q,$){return new Q({type:"string",...f($)})}function d$(Q,$){return new Q({type:"string",format:"email",check:"string_format",abort:!1,...f($)})}function nQ(Q,$){return new Q({type:"string",format:"guid",check:"string_format",abort:!1,...f($)})}function i$(Q,$){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,...f($)})}function n$(Q,$){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...f($)})}function r$(Q,$){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...f($)})}function o$(Q,$){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...f($)})}function a$(Q,$){return new Q({type:"string",format:"url",check:"string_format",abort:!1,...f($)})}function t$(Q,$){return new Q({type:"string",format:"emoji",check:"string_format",abort:!1,...f($)})}function s$(Q,$){return new Q({type:"string",format:"nanoid",check:"string_format",abort:!1,...f($)})}function e$(Q,$){return new Q({type:"string",format:"cuid",check:"string_format",abort:!1,...f($)})}function QW(Q,$){return new Q({type:"string",format:"cuid2",check:"string_format",abort:!1,...f($)})}function $W(Q,$){return new Q({type:"string",format:"ulid",check:"string_format",abort:!1,...f($)})}function WW(Q,$){return new Q({type:"string",format:"xid",check:"string_format",abort:!1,...f($)})}function YW(Q,$){return new Q({type:"string",format:"ksuid",check:"string_format",abort:!1,...f($)})}function XW(Q,$){return new Q({type:"string",format:"ipv4",check:"string_format",abort:!1,...f($)})}function JW(Q,$){return new Q({type:"string",format:"ipv6",check:"string_format",abort:!1,...f($)})}function HW(Q,$){return new Q({type:"string",format:"cidrv4",check:"string_format",abort:!1,...f($)})}function GW(Q,$){return new Q({type:"string",format:"cidrv6",check:"string_format",abort:!1,...f($)})}function BW(Q,$){return new Q({type:"string",format:"base64",check:"string_format",abort:!1,...f($)})}function KW(Q,$){return new Q({type:"string",format:"base64url",check:"string_format",abort:!1,...f($)})}function FW(Q,$){return new Q({type:"string",format:"e164",check:"string_format",abort:!1,...f($)})}function LW(Q,$){return new Q({type:"string",format:"jwt",check:"string_format",abort:!1,...f($)})}function rJ(Q,$){return new Q({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...f($)})}function oJ(Q,$){return new Q({type:"string",format:"date",check:"string_format",...f($)})}function aJ(Q,$){return new Q({type:"string",format:"time",check:"string_format",precision:null,...f($)})}function tJ(Q,$){return new Q({type:"string",format:"duration",check:"string_format",...f($)})}function qW(Q,$){return new Q({type:"number",checks:[],...f($)})}function VW(Q,$){return new Q({type:"number",check:"number_format",abort:!1,format:"safeint",...f($)})}function UW(Q,$){return new Q({type:"boolean",...f($)})}function AW(Q,$){return new Q({type:"null",...f($)})}function zW(Q){return new Q({type:"unknown"})}function wW(Q,$){return new Q({type:"never",...f($)})}function rQ(Q,$){return new e4({check:"less_than",...f($),value:Q,inclusive:!1})}function k9(Q,$){return new e4({check:"less_than",...f($),value:Q,inclusive:!0})}function oQ(Q,$){return new Q$({check:"greater_than",...f($),value:Q,inclusive:!1})}function T9(Q,$){return new Q$({check:"greater_than",...f($),value:Q,inclusive:!0})}function aQ(Q,$){return new NJ({check:"multiple_of",...f($),value:Q})}function tQ(Q,$){return new jJ({check:"max_length",...f($),maximum:Q})}function x8(Q,$){return new DJ({check:"min_length",...f($),minimum:Q})}function sQ(Q,$){return new EJ({check:"length_equals",...f($),length:Q})}function OW(Q,$){return new RJ({check:"string_format",format:"regex",...f($),pattern:Q})}function NW(Q){return new PJ({check:"string_format",format:"lowercase",...f(Q)})}function MW(Q){return new IJ({check:"string_format",format:"uppercase",...f(Q)})}function jW(Q,$){return new SJ({check:"string_format",format:"includes",...f($),includes:Q})}function DW(Q,$){return new ZJ({check:"string_format",format:"starts_with",...f($),prefix:Q})}function EW(Q,$){return new CJ({check:"string_format",format:"ends_with",...f($),suffix:Q})}function a6(Q){return new bJ({check:"overwrite",tx:Q})}function RW(Q){return a6(($)=>$.normalize(Q))}function PW(){return a6((Q)=>Q.trim())}function IW(){return a6((Q)=>Q.toLowerCase())}function SW(){return a6((Q)=>Q.toUpperCase())}function sJ(Q,$,W){return new Q({type:"array",element:$,...f(W)})}function ZW(Q,$,W){let Y=f(W);return Y.abort??(Y.abort=!0),new Q({type:"custom",check:"custom",fn:$,...Y})}function CW(Q,$,W){return new Q({type:"custom",check:"custom",fn:$,...f(W)})}class bW{constructor(Q){this.counter=0,this.metadataRegistry=Q?.metadata??j6,this.target=Q?.target??"draft-2020-12",this.unrepresentable=Q?.unrepresentable??"throw",this.override=Q?.override??(()=>{}),this.io=Q?.io??"output",this.seen=new Map}process(Q,$={path:[],schemaPath:[]}){var W;let Y=Q._zod.def,X={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},J=this.seen.get(Q);if(J){if(J.count++,$.schemaPath.includes(Q))J.cycle=$.path;return J.schema}let H={schema:{},count:1,cycle:void 0,path:$.path};this.seen.set(Q,H);let G=Q._zod.toJSONSchema?.();if(G)H.schema=G;else{let F={...$,schemaPath:[...$.schemaPath,Q],path:$.path},q=Q._zod.parent;if(q)H.ref=q,this.process(q,F),this.seen.get(q).isParent=!0;else{let A=H.schema;switch(Y.type){case"string":{let V=A;V.type="string";let{minimum:U,maximum:z,format:w,patterns:O,contentEncoding:D}=Q._zod.bag;if(typeof U==="number")V.minLength=U;if(typeof z==="number")V.maxLength=z;if(w){if(V.format=X[w]??w,V.format==="")delete V.format}if(D)V.contentEncoding=D;if(O&&O.size>0){let j=[...O];if(j.length===1)V.pattern=j[0].source;else if(j.length>1)H.schema.allOf=[...j.map((S)=>({...this.target==="draft-7"?{type:"string"}:{},pattern:S.source}))]}break}case"number":{let V=A,{minimum:U,maximum:z,format:w,multipleOf:O,exclusiveMaximum:D,exclusiveMinimum:j}=Q._zod.bag;if(typeof w==="string"&&w.includes("int"))V.type="integer";else V.type="number";if(typeof j==="number")V.exclusiveMinimum=j;if(typeof U==="number"){if(V.minimum=U,typeof j==="number")if(j>=U)delete V.minimum;else delete V.exclusiveMinimum}if(typeof D==="number")V.exclusiveMaximum=D;if(typeof z==="number"){if(V.maximum=z,typeof D==="number")if(D<=z)delete V.maximum;else delete V.exclusiveMaximum}if(typeof O==="number")V.multipleOf=O;break}case"boolean":{let V=A;V.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw Error("Symbols cannot be represented in JSON Schema");break}case"null":{A.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw Error("Void cannot be represented in JSON Schema");break}case"never":{A.not={};break}case"date":{if(this.unrepresentable==="throw")throw Error("Date cannot be represented in JSON Schema");break}case"array":{let V=A,{minimum:U,maximum:z}=Q._zod.bag;if(typeof U==="number")V.minItems=U;if(typeof z==="number")V.maxItems=z;V.type="array",V.items=this.process(Y.element,{...F,path:[...F.path,"items"]});break}case"object":{let V=A;V.type="object",V.properties={};let U=Y.shape;for(let O in U)V.properties[O]=this.process(U[O],{...F,path:[...F.path,"properties",O]});let z=new Set(Object.keys(U)),w=new Set([...z].filter((O)=>{let D=Y.shape[O]._zod;if(this.io==="input")return D.optin===void 0;else return D.optout===void 0}));if(w.size>0)V.required=Array.from(w);if(Y.catchall?._zod.def.type==="never")V.additionalProperties=!1;else if(!Y.catchall){if(this.io==="output")V.additionalProperties=!1}else if(Y.catchall)V.additionalProperties=this.process(Y.catchall,{...F,path:[...F.path,"additionalProperties"]});break}case"union":{let V=A;V.anyOf=Y.options.map((U,z)=>this.process(U,{...F,path:[...F.path,"anyOf",z]}));break}case"intersection":{let V=A,U=this.process(Y.left,{...F,path:[...F.path,"allOf",0]}),z=this.process(Y.right,{...F,path:[...F.path,"allOf",1]}),w=(D)=>("allOf"in D)&&Object.keys(D).length===1,O=[...w(U)?U.allOf:[U],...w(z)?z.allOf:[z]];V.allOf=O;break}case"tuple":{let V=A;V.type="array";let U=Y.items.map((O,D)=>this.process(O,{...F,path:[...F.path,"prefixItems",D]}));if(this.target==="draft-2020-12")V.prefixItems=U;else V.items=U;if(Y.rest){let O=this.process(Y.rest,{...F,path:[...F.path,"items"]});if(this.target==="draft-2020-12")V.items=O;else V.additionalItems=O}if(Y.rest)V.items=this.process(Y.rest,{...F,path:[...F.path,"items"]});let{minimum:z,maximum:w}=Q._zod.bag;if(typeof z==="number")V.minItems=z;if(typeof w==="number")V.maxItems=w;break}case"record":{let V=A;V.type="object",V.propertyNames=this.process(Y.keyType,{...F,path:[...F.path,"propertyNames"]}),V.additionalProperties=this.process(Y.valueType,{...F,path:[...F.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw Error("Set cannot be represented in JSON Schema");break}case"enum":{let V=A,U=R9(Y.entries);if(U.every((z)=>typeof z==="number"))V.type="number";if(U.every((z)=>typeof z==="string"))V.type="string";V.enum=U;break}case"literal":{let V=A,U=[];for(let z of Y.values)if(z===void 0){if(this.unrepresentable==="throw")throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof z==="bigint")if(this.unrepresentable==="throw")throw Error("BigInt literals cannot be represented in JSON Schema");else U.push(Number(z));else U.push(z);if(U.length===0);else if(U.length===1){let z=U[0];V.type=z===null?"null":typeof z,V.const=z}else{if(U.every((z)=>typeof z==="number"))V.type="number";if(U.every((z)=>typeof z==="string"))V.type="string";if(U.every((z)=>typeof z==="boolean"))V.type="string";if(U.every((z)=>z===null))V.type="null";V.enum=U}break}case"file":{let V=A,U={type:"string",format:"binary",contentEncoding:"binary"},{minimum:z,maximum:w,mime:O}=Q._zod.bag;if(z!==void 0)U.minLength=z;if(w!==void 0)U.maxLength=w;if(O)if(O.length===1)U.contentMediaType=O[0],Object.assign(V,U);else V.anyOf=O.map((D)=>{return{...U,contentMediaType:D}});else Object.assign(V,U);break}case"transform":{if(this.unrepresentable==="throw")throw Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let V=this.process(Y.innerType,F);A.anyOf=[V,{type:"null"}];break}case"nonoptional":{this.process(Y.innerType,F),H.ref=Y.innerType;break}case"success":{let V=A;V.type="boolean";break}case"default":{this.process(Y.innerType,F),H.ref=Y.innerType,A.default=JSON.parse(JSON.stringify(Y.defaultValue));break}case"prefault":{if(this.process(Y.innerType,F),H.ref=Y.innerType,this.io==="input")A._prefault=JSON.parse(JSON.stringify(Y.defaultValue));break}case"catch":{this.process(Y.innerType,F),H.ref=Y.innerType;let V;try{V=Y.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}A.default=V;break}case"nan":{if(this.unrepresentable==="throw")throw Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let V=A,U=Q._zod.pattern;if(!U)throw Error("Pattern not found in template literal");V.type="string",V.pattern=U.source;break}case"pipe":{let V=this.io==="input"?Y.in._zod.def.type==="transform"?Y.out:Y.in:Y.out;this.process(V,F),H.ref=V;break}case"readonly":{this.process(Y.innerType,F),H.ref=Y.innerType,A.readOnly=!0;break}case"promise":{this.process(Y.innerType,F),H.ref=Y.innerType;break}case"optional":{this.process(Y.innerType,F),H.ref=Y.innerType;break}case"lazy":{let V=Q._zod.innerType;this.process(V,F),H.ref=V;break}case"custom":{if(this.unrepresentable==="throw")throw Error("Custom types cannot be represented in JSON Schema");break}default:}}}let B=this.metadataRegistry.get(Q);if(B)Object.assign(H.schema,B);if(this.io==="input"&&k0(Q))delete H.schema.examples,delete H.schema.default;if(this.io==="input"&&H.schema._prefault)(W=H.schema).default??(W.default=H.schema._prefault);return delete H.schema._prefault,this.seen.get(Q).schema}emit(Q,$){let W={cycles:$?.cycles??"ref",reused:$?.reused??"inline",external:$?.external??void 0},Y=this.seen.get(Q);if(!Y)throw Error("Unprocessed schema. This is a bug in Zod.");let X=(K)=>{let F=this.target==="draft-2020-12"?"$defs":"definitions";if(W.external){let U=W.external.registry.get(K[0])?.id,z=W.external.uri??((O)=>O);if(U)return{ref:z(U)};let w=K[1].defId??K[1].schema.id??`schema${this.counter++}`;return K[1].defId=w,{defId:w,ref:`${z("__shared")}#/${F}/${w}`}}if(K[1]===Y)return{ref:"#"};let A=`${"#"}/${F}/`,V=K[1].schema.id??`__schema${this.counter++}`;return{defId:V,ref:A+V}},J=(K)=>{if(K[1].schema.$ref)return;let F=K[1],{ref:q,defId:A}=X(K);if(F.def={...F.schema},A)F.defId=A;let V=F.schema;for(let U in V)delete V[U];V.$ref=q};if(W.cycles==="throw")for(let K of this.seen.entries()){let F=K[1];if(F.cycle)throw Error(`Cycle detected: #/${F.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let K of this.seen.entries()){let F=K[1];if(Q===K[0]){J(K);continue}if(W.external){let A=W.external.registry.get(K[0])?.id;if(Q!==K[0]&&A){J(K);continue}}if(this.metadataRegistry.get(K[0])?.id){J(K);continue}if(F.cycle){J(K);continue}if(F.count>1){if(W.reused==="ref"){J(K);continue}}}let H=(K,F)=>{let q=this.seen.get(K),A=q.def??q.schema,V={...A};if(q.ref===null)return;let U=q.ref;if(q.ref=null,U){H(U,F);let z=this.seen.get(U).schema;if(z.$ref&&F.target==="draft-7")A.allOf=A.allOf??[],A.allOf.push(z);else Object.assign(A,z),Object.assign(A,V)}if(!q.isParent)this.override({zodSchema:K,jsonSchema:A,path:q.path??[]})};for(let K of[...this.seen.entries()].reverse())H(K[0],{target:this.target});let G={};if(this.target==="draft-2020-12")G.$schema="https://json-schema.org/draft/2020-12/schema";else if(this.target==="draft-7")G.$schema="http://json-schema.org/draft-07/schema#";else console.warn(`Invalid target: ${this.target}`);if(W.external?.uri){let K=W.external.registry.get(Q)?.id;if(!K)throw Error("Schema is missing an `id` property");G.$id=W.external.uri(K)}Object.assign(G,Y.def);let B=W.external?.defs??{};for(let K of this.seen.entries()){let F=K[1];if(F.def&&F.defId)B[F.defId]=F.def}if(W.external);else if(Object.keys(B).length>0)if(this.target==="draft-2020-12")G.$defs=B;else G.definitions=B;try{return JSON.parse(JSON.stringify(G))}catch(K){throw Error("Error converting schema to JSON.")}}}function vW(Q,$){if(Q instanceof iQ){let Y=new bW($),X={};for(let G of Q._idmap.entries()){let[B,K]=G;Y.process(K)}let J={},H={registry:Q,uri:$?.uri,defs:X};for(let G of Q._idmap.entries()){let[B,K]=G;J[B]=Y.emit(K,{...$,external:H})}if(Object.keys(X).length>0){let G=Y.target==="draft-2020-12"?"$defs":"definitions";J.__shared={[G]:X}}return{schemas:J}}let W=new bW($);return W.process(Q),W.emit(Q,$)}function k0(Q,$){let W=$??{seen:new Set};if(W.seen.has(Q))return!1;W.seen.add(Q);let X=Q._zod.def;switch(X.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return k0(X.element,W);case"object":{for(let J in X.shape)if(k0(X.shape[J],W))return!0;return!1}case"union":{for(let J of X.options)if(k0(J,W))return!0;return!1}case"intersection":return k0(X.left,W)||k0(X.right,W);case"tuple":{for(let J of X.items)if(k0(J,W))return!0;if(X.rest&&k0(X.rest,W))return!0;return!1}case"record":return k0(X.keyType,W)||k0(X.valueType,W);case"map":return k0(X.keyType,W)||k0(X.valueType,W);case"set":return k0(X.valueType,W);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return k0(X.innerType,W);case"lazy":return k0(X.getter(),W);case"default":return k0(X.innerType,W);case"prefault":return k0(X.innerType,W);case"custom":return!1;case"transform":return!0;case"pipe":return k0(X.in,W)||k0(X.out,W);case"success":return!1;case"catch":return!1;default:}throw Error(`Unknown schema type: ${X.type}`)}var OV=M("ZodMiniType",(Q,$)=>{if(!Q._zod)throw Error("Uninitialized schema in ZodMiniType.");L0.init(Q,$),Q.def=$,Q.parse=(W,Y)=>i4(Q,W,Y,{callee:Q.parse}),Q.safeParse=(W,Y)=>r6(Q,W,Y),Q.parseAsync=async(W,Y)=>r4(Q,W,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async(W,Y)=>o6(Q,W,Y),Q.check=(...W)=>{return Q.clone({...$,checks:[...$.checks??[],...W.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=(W,Y)=>V1(Q,W,Y),Q.brand=()=>Q,Q.register=(W,Y)=>{return W.add(Q,Y),Q}});var NV=M("ZodMiniObject",(Q,$)=>{pQ.init(Q,$),OV.init(Q,$),s.defineLazy(Q,"shape",()=>$.shape)});function kW(Q,$){let W={type:"object",get shape(){return s.assignProp(this,"shape",{...Q}),this.shape},...s.normalizeParams($)};return new NV(W)}function w1(Q){return!!Q._zod}function s6(Q){let $=Object.values(Q);if($.length===0)return kW({});let W=$.every(w1),Y=$.every((X)=>!w1(X));if(W)return kW(Q);if(Y)return T4(Q);throw Error("Mixed Zod versions detected in object shape.")}function D6(Q,$){if(w1(Q))return r6(Q,$);return Q.safeParse($)}async function eQ(Q,$){if(w1(Q))return await o6(Q,$);return await Q.safeParseAsync($)}function E6(Q){if(!Q)return;let $;if(w1(Q))$=Q._zod?.def?.shape;else $=Q.shape;if(!$)return;if(typeof $==="function")try{return $()}catch{return}return $}function y8(Q){if(!Q)return;if(typeof Q==="object"){let $=Q,W=Q;if(!$._def&&!W._zod){let Y=Object.values(Q);if(Y.length>0&&Y.every((X)=>typeof X==="object"&&X!==null&&(X._def!==void 0||X._zod!==void 0||typeof X.parse==="function")))return s6(Q)}}if(w1(Q)){let W=Q._zod?.def;if(W&&(W.type==="object"||W.shape!==void 0))return Q}else if(Q.shape!==void 0)return Q;return}function Q5(Q){if(Q&&typeof Q==="object"){if("message"in Q&&typeof Q.message==="string")return Q.message;if("issues"in Q&&Array.isArray(Q.issues)&&Q.issues.length>0){let $=Q.issues[0];if($&&typeof $==="object"&&"message"in $)return String($.message)}try{return JSON.stringify(Q)}catch{return String(Q)}}return String(Q)}function Q3(Q){return Q.description}function $3(Q){if(w1(Q))return Q._zod?.def?.type==="optional";let $=Q;if(typeof Q.isOptional==="function")return Q.isOptional();return $._def?.typeName==="ZodOptional"}function $5(Q){if(w1(Q)){let J=Q._zod?.def;if(J){if(J.value!==void 0)return J.value;if(Array.isArray(J.values)&&J.values.length>0)return J.values[0]}}let W=Q._def;if(W){if(W.value!==void 0)return W.value;if(Array.isArray(W.values)&&W.values.length>0)return W.values[0]}let Y=Q.value;if(Y!==void 0)return Y;return}var _9={};C4(_9,{time:()=>xW,duration:()=>yW,datetime:()=>TW,date:()=>_W,ZodISOTime:()=>X3,ZodISODuration:()=>J3,ZodISODateTime:()=>W3,ZodISODate:()=>Y3});var W3=M("ZodISODateTime",(Q,$)=>{mJ.init(Q,$),N0.init(Q,$)});function TW(Q){return rJ(W3,Q)}var Y3=M("ZodISODate",(Q,$)=>{cJ.init(Q,$),N0.init(Q,$)});function _W(Q){return oJ(Y3,Q)}var X3=M("ZodISOTime",(Q,$)=>{pJ.init(Q,$),N0.init(Q,$)});function xW(Q){return aJ(X3,Q)}var J3=M("ZodISODuration",(Q,$)=>{dJ.init(Q,$),N0.init(Q,$)});function yW(Q){return tJ(J3,Q)}var H3=(Q,$)=>{uQ.init(Q,$),Q.name="ZodError",Object.defineProperties(Q,{format:{value:(W)=>p4(Q,W)},flatten:{value:(W)=>c4(Q,W)},addIssue:{value:(W)=>Q.issues.push(W)},addIssues:{value:(W)=>Q.issues.push(...W)},isEmpty:{get(){return Q.issues.length===0}}})},TP=M("ZodError",H3),x9=M("ZodError",H3,{Parent:Error});var G3=d4(x9),B3=n4(x9),K3=o4(x9),F3=a4(x9);var I0=M("ZodType",(Q,$)=>{return L0.init(Q,$),Q.def=$,Object.defineProperty(Q,"_def",{value:$}),Q.check=(...W)=>{return Q.clone({...$,checks:[...$.checks??[],...W.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=(W,Y)=>V1(Q,W,Y),Q.brand=()=>Q,Q.register=(W,Y)=>{return W.add(Q,Y),Q},Q.parse=(W,Y)=>G3(Q,W,Y,{callee:Q.parse}),Q.safeParse=(W,Y)=>K3(Q,W,Y),Q.parseAsync=async(W,Y)=>B3(Q,W,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async(W,Y)=>F3(Q,W,Y),Q.spa=Q.safeParseAsync,Q.refine=(W,Y)=>Q.check(zU(W,Y)),Q.superRefine=(W)=>Q.check(wU(W)),Q.overwrite=(W)=>Q.check(a6(W)),Q.optional=()=>P0(Q),Q.nullable=()=>V3(Q),Q.nullish=()=>P0(V3(Q)),Q.nonoptional=(W)=>KU(Q,W),Q.array=()=>W0(Q),Q.or=(W)=>z0([Q,W]),Q.and=(W)=>Y5(Q,W),Q.transform=(W)=>hW(Q,O3(W)),Q.default=(W)=>HU(Q,W),Q.prefault=(W)=>BU(Q,W),Q.catch=(W)=>LU(Q,W),Q.pipe=(W)=>hW(Q,W),Q.readonly=()=>UU(Q),Q.describe=(W)=>{let Y=Q.clone();return j6.add(Y,{description:W}),Y},Object.defineProperty(Q,"description",{get(){return j6.get(Q)?.description},configurable:!0}),Q.meta=(...W)=>{if(W.length===0)return j6.get(Q);let Y=Q.clone();return j6.add(Y,W[0]),Y},Q.isOptional=()=>Q.safeParse(void 0).success,Q.isNullable=()=>Q.safeParse(null).success,Q}),U3=M("_ZodString",(Q,$)=>{v9.init(Q,$),I0.init(Q,$);let W=Q._zod.bag;Q.format=W.format??null,Q.minLength=W.minimum??null,Q.maxLength=W.maximum??null,Q.regex=(...Y)=>Q.check(OW(...Y)),Q.includes=(...Y)=>Q.check(jW(...Y)),Q.startsWith=(...Y)=>Q.check(DW(...Y)),Q.endsWith=(...Y)=>Q.check(EW(...Y)),Q.min=(...Y)=>Q.check(x8(...Y)),Q.max=(...Y)=>Q.check(tQ(...Y)),Q.length=(...Y)=>Q.check(sQ(...Y)),Q.nonempty=(...Y)=>Q.check(x8(1,...Y)),Q.lowercase=(Y)=>Q.check(NW(Y)),Q.uppercase=(Y)=>Q.check(MW(Y)),Q.trim=()=>Q.check(PW()),Q.normalize=(...Y)=>Q.check(RW(...Y)),Q.toLowerCase=()=>Q.check(IW()),Q.toUpperCase=()=>Q.check(SW())}),ZV=M("ZodString",(Q,$)=>{v9.init(Q,$),U3.init(Q,$),Q.email=(W)=>Q.check(d$(CV,W)),Q.url=(W)=>Q.check(a$(bV,W)),Q.jwt=(W)=>Q.check(LW(dV,W)),Q.emoji=(W)=>Q.check(t$(vV,W)),Q.guid=(W)=>Q.check(nQ(L3,W)),Q.uuid=(W)=>Q.check(i$(W5,W)),Q.uuidv4=(W)=>Q.check(n$(W5,W)),Q.uuidv6=(W)=>Q.check(r$(W5,W)),Q.uuidv7=(W)=>Q.check(o$(W5,W)),Q.nanoid=(W)=>Q.check(s$(kV,W)),Q.guid=(W)=>Q.check(nQ(L3,W)),Q.cuid=(W)=>Q.check(e$(TV,W)),Q.cuid2=(W)=>Q.check(QW(_V,W)),Q.ulid=(W)=>Q.check($W(xV,W)),Q.base64=(W)=>Q.check(BW(mV,W)),Q.base64url=(W)=>Q.check(KW(cV,W)),Q.xid=(W)=>Q.check(WW(yV,W)),Q.ksuid=(W)=>Q.check(YW(gV,W)),Q.ipv4=(W)=>Q.check(XW(hV,W)),Q.ipv6=(W)=>Q.check(JW(fV,W)),Q.cidrv4=(W)=>Q.check(HW(uV,W)),Q.cidrv6=(W)=>Q.check(GW(lV,W)),Q.e164=(W)=>Q.check(FW(pV,W)),Q.datetime=(W)=>Q.check(TW(W)),Q.date=(W)=>Q.check(_W(W)),Q.time=(W)=>Q.check(xW(W)),Q.duration=(W)=>Q.check(yW(W))});function N(Q){return p$(ZV,Q)}var N0=M("ZodStringFormat",(Q,$)=>{A0.init(Q,$),U3.init(Q,$)}),CV=M("ZodEmail",(Q,$)=>{J$.init(Q,$),N0.init(Q,$)});var L3=M("ZodGUID",(Q,$)=>{Y$.init(Q,$),N0.init(Q,$)});var W5=M("ZodUUID",(Q,$)=>{X$.init(Q,$),N0.init(Q,$)});var bV=M("ZodURL",(Q,$)=>{H$.init(Q,$),N0.init(Q,$)});var vV=M("ZodEmoji",(Q,$)=>{G$.init(Q,$),N0.init(Q,$)});var kV=M("ZodNanoID",(Q,$)=>{B$.init(Q,$),N0.init(Q,$)});var TV=M("ZodCUID",(Q,$)=>{K$.init(Q,$),N0.init(Q,$)});var _V=M("ZodCUID2",(Q,$)=>{F$.init(Q,$),N0.init(Q,$)});var xV=M("ZodULID",(Q,$)=>{L$.init(Q,$),N0.init(Q,$)});var yV=M("ZodXID",(Q,$)=>{q$.init(Q,$),N0.init(Q,$)});var gV=M("ZodKSUID",(Q,$)=>{V$.init(Q,$),N0.init(Q,$)});var hV=M("ZodIPv4",(Q,$)=>{U$.init(Q,$),N0.init(Q,$)});var fV=M("ZodIPv6",(Q,$)=>{A$.init(Q,$),N0.init(Q,$)});var uV=M("ZodCIDRv4",(Q,$)=>{z$.init(Q,$),N0.init(Q,$)});var lV=M("ZodCIDRv6",(Q,$)=>{w$.init(Q,$),N0.init(Q,$)});var mV=M("ZodBase64",(Q,$)=>{O$.init(Q,$),N0.init(Q,$)});var cV=M("ZodBase64URL",(Q,$)=>{N$.init(Q,$),N0.init(Q,$)});var pV=M("ZodE164",(Q,$)=>{M$.init(Q,$),N0.init(Q,$)});var dV=M("ZodJWT",(Q,$)=>{j$.init(Q,$),N0.init(Q,$)});var A3=M("ZodNumber",(Q,$)=>{cQ.init(Q,$),I0.init(Q,$),Q.gt=(Y,X)=>Q.check(oQ(Y,X)),Q.gte=(Y,X)=>Q.check(T9(Y,X)),Q.min=(Y,X)=>Q.check(T9(Y,X)),Q.lt=(Y,X)=>Q.check(rQ(Y,X)),Q.lte=(Y,X)=>Q.check(k9(Y,X)),Q.max=(Y,X)=>Q.check(k9(Y,X)),Q.int=(Y)=>Q.check(q3(Y)),Q.safe=(Y)=>Q.check(q3(Y)),Q.positive=(Y)=>Q.check(oQ(0,Y)),Q.nonnegative=(Y)=>Q.check(T9(0,Y)),Q.negative=(Y)=>Q.check(rQ(0,Y)),Q.nonpositive=(Y)=>Q.check(k9(0,Y)),Q.multipleOf=(Y,X)=>Q.check(aQ(Y,X)),Q.step=(Y,X)=>Q.check(aQ(Y,X)),Q.finite=()=>Q;let W=Q._zod.bag;Q.minValue=Math.max(W.minimum??Number.NEGATIVE_INFINITY,W.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,Q.maxValue=Math.min(W.maximum??Number.POSITIVE_INFINITY,W.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,Q.isInt=(W.format??"").includes("int")||Number.isSafeInteger(W.multipleOf??0.5),Q.isFinite=!0,Q.format=W.format??null});function F0(Q){return qW(A3,Q)}var iV=M("ZodNumberFormat",(Q,$)=>{D$.init(Q,$),A3.init(Q,$)});function q3(Q){return VW(iV,Q)}var nV=M("ZodBoolean",(Q,$)=>{E$.init(Q,$),I0.init(Q,$)});function _0(Q){return UW(nV,Q)}var rV=M("ZodNull",(Q,$)=>{R$.init(Q,$),I0.init(Q,$)});function fW(Q){return AW(rV,Q)}var oV=M("ZodUnknown",(Q,$)=>{P$.init(Q,$),I0.init(Q,$)});function M0(){return zW(oV)}var aV=M("ZodNever",(Q,$)=>{I$.init(Q,$),I0.init(Q,$)});function tV(Q){return wW(aV,Q)}var sV=M("ZodArray",(Q,$)=>{S$.init(Q,$),I0.init(Q,$),Q.element=$.element,Q.min=(W,Y)=>Q.check(x8(W,Y)),Q.nonempty=(W)=>Q.check(x8(1,W)),Q.max=(W,Y)=>Q.check(tQ(W,Y)),Q.length=(W,Y)=>Q.check(sQ(W,Y)),Q.unwrap=()=>Q.element});function W0(Q,$){return sJ(sV,Q,$)}var z3=M("ZodObject",(Q,$)=>{pQ.init(Q,$),I0.init(Q,$),s.defineLazy(Q,"shape",()=>$.shape),Q.keyof=()=>X1(Object.keys(Q._zod.def.shape)),Q.catchall=(W)=>Q.clone({...Q._zod.def,catchall:W}),Q.passthrough=()=>Q.clone({...Q._zod.def,catchall:M0()}),Q.loose=()=>Q.clone({...Q._zod.def,catchall:M0()}),Q.strict=()=>Q.clone({...Q._zod.def,catchall:tV()}),Q.strip=()=>Q.clone({...Q._zod.def,catchall:void 0}),Q.extend=(W)=>{return s.extend(Q,W)},Q.merge=(W)=>s.merge(Q,W),Q.pick=(W)=>s.pick(Q,W),Q.omit=(W)=>s.omit(Q,W),Q.partial=(...W)=>s.partial(N3,Q,W[0]),Q.required=(...W)=>s.required(M3,Q,W[0])});function v(Q,$){let W={type:"object",get shape(){return s.assignProp(this,"shape",{...Q}),this.shape},...s.normalizeParams($)};return new z3(W)}function a0(Q,$){return new z3({type:"object",get shape(){return s.assignProp(this,"shape",{...Q}),this.shape},catchall:M0(),...s.normalizeParams($)})}var w3=M("ZodUnion",(Q,$)=>{dQ.init(Q,$),I0.init(Q,$),Q.options=$.options});function z0(Q,$){return new w3({type:"union",options:Q,...s.normalizeParams($)})}var eV=M("ZodDiscriminatedUnion",(Q,$)=>{w3.init(Q,$),Z$.init(Q,$)});function uW(Q,$,W){return new eV({type:"union",options:$,discriminator:Q,...s.normalizeParams(W)})}var QU=M("ZodIntersection",(Q,$)=>{C$.init(Q,$),I0.init(Q,$)});function Y5(Q,$){return new QU({type:"intersection",left:Q,right:$})}var $U=M("ZodRecord",(Q,$)=>{b$.init(Q,$),I0.init(Q,$),Q.keyType=$.keyType,Q.valueType=$.valueType});function j0(Q,$,W){return new $U({type:"record",keyType:Q,valueType:$,...s.normalizeParams(W)})}var gW=M("ZodEnum",(Q,$)=>{v$.init(Q,$),I0.init(Q,$),Q.enum=$.entries,Q.options=Object.values($.entries);let W=new Set(Object.keys($.entries));Q.extract=(Y,X)=>{let J={};for(let H of Y)if(W.has(H))J[H]=$.entries[H];else throw Error(`Key ${H} not found in enum`);return new gW({...$,checks:[],...s.normalizeParams(X),entries:J})},Q.exclude=(Y,X)=>{let J={...$.entries};for(let H of Y)if(W.has(H))delete J[H];else throw Error(`Key ${H} not found in enum`);return new gW({...$,checks:[],...s.normalizeParams(X),entries:J})}});function X1(Q,$){let W=Array.isArray(Q)?Object.fromEntries(Q.map((Y)=>[Y,Y])):Q;return new gW({type:"enum",entries:W,...s.normalizeParams($)})}var WU=M("ZodLiteral",(Q,$)=>{k$.init(Q,$),I0.init(Q,$),Q.values=new Set($.values),Object.defineProperty(Q,"value",{get(){if($.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return $.values[0]}})});function x(Q,$){return new WU({type:"literal",values:Array.isArray(Q)?Q:[Q],...s.normalizeParams($)})}var YU=M("ZodTransform",(Q,$)=>{T$.init(Q,$),I0.init(Q,$),Q._zod.parse=(W,Y)=>{W.addIssue=(J)=>{if(typeof J==="string")W.issues.push(s.issue(J,W.value,$));else{let H=J;if(H.fatal)H.continue=!1;H.code??(H.code="custom"),H.input??(H.input=W.value),H.inst??(H.inst=Q),H.continue??(H.continue=!0),W.issues.push(s.issue(H))}};let X=$.transform(W.value,W);if(X instanceof Promise)return X.then((J)=>{return W.value=J,W});return W.value=X,W}});function O3(Q){return new YU({type:"transform",transform:Q})}var N3=M("ZodOptional",(Q,$)=>{_$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType});function P0(Q){return new N3({type:"optional",innerType:Q})}var XU=M("ZodNullable",(Q,$)=>{x$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType});function V3(Q){return new XU({type:"nullable",innerType:Q})}var JU=M("ZodDefault",(Q,$)=>{y$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType,Q.removeDefault=Q.unwrap});function HU(Q,$){return new JU({type:"default",innerType:Q,get defaultValue(){return typeof $==="function"?$():$}})}var GU=M("ZodPrefault",(Q,$)=>{g$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType});function BU(Q,$){return new GU({type:"prefault",innerType:Q,get defaultValue(){return typeof $==="function"?$():$}})}var M3=M("ZodNonOptional",(Q,$)=>{h$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType});function KU(Q,$){return new M3({type:"nonoptional",innerType:Q,...s.normalizeParams($)})}var FU=M("ZodCatch",(Q,$)=>{f$.init(Q,$),I0.init(Q,$),Q.unwrap=()=>Q._zod.def.innerType,Q.removeCatch=Q.unwrap});function LU(Q,$){return new FU({type:"catch",innerType:Q,catchValue:typeof $==="function"?$:()=>$})}var qU=M("ZodPipe",(Q,$)=>{u$.init(Q,$),I0.init(Q,$),Q.in=$.in,Q.out=$.out});function hW(Q,$){return new qU({type:"pipe",in:Q,out:$})}var VU=M("ZodReadonly",(Q,$)=>{l$.init(Q,$),I0.init(Q,$)});function UU(Q){return new VU({type:"readonly",innerType:Q})}var j3=M("ZodCustom",(Q,$)=>{m$.init(Q,$),I0.init(Q,$)});function AU(Q){let $=new y0({check:"custom"});return $._zod.check=Q,$}function D3(Q,$){return ZW(j3,Q??(()=>!0),$)}function zU(Q,$={}){return CW(j3,Q,$)}function wU(Q){let $=AU((W)=>{return W.addIssue=(Y)=>{if(typeof Y==="string")W.issues.push(s.issue(Y,W.value,$._zod.def));else{let X=Y;if(X.fatal)X.continue=!1;X.code??(X.code="custom"),X.input??(X.input=W.value),X.inst??(X.inst=$),X.continue??(X.continue=!$._zod.def.abort),W.issues.push(s.issue(X))}},Q(W.value,W)});return $}function lW(Q,$){return hW(O3(Q),$)}q1(c$());var mW="2025-11-25",E3="2025-03-26",y9=[mW,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],R6="io.modelcontextprotocol/related-task",J5="2.0",g0=D3((Q)=>Q!==null&&(typeof Q==="object"||typeof Q==="function")),R3=z0([N(),F0().int()]),P3=N(),nP=a0({ttl:z0([F0(),fW()]).optional(),pollInterval:F0().optional()}),OU=v({ttl:F0().optional()}),NU=v({taskId:N()}),cW=a0({progressToken:R3.optional(),[R6]:NU.optional()}),U1=v({_meta:cW.optional()}),g9=U1.extend({task:OU.optional()}),I3=(Q)=>g9.safeParse(Q).success,h0=v({method:N(),params:U1.loose().optional()}),O1=v({_meta:cW.optional()}),N1=v({method:N(),params:O1.loose().optional()}),f0=a0({_meta:cW.optional()}),H5=z0([N(),F0().int()]),S3=v({jsonrpc:x(J5),id:H5,...h0.shape}).strict(),P6=(Q)=>S3.safeParse(Q).success,Z3=v({jsonrpc:x(J5),...N1.shape}).strict(),C3=(Q)=>Z3.safeParse(Q).success,pW=v({jsonrpc:x(J5),id:H5,result:f0}).strict(),$6=(Q)=>pW.safeParse(Q).success;var g;(function(Q){Q[Q.ConnectionClosed=-32000]="ConnectionClosed",Q[Q.RequestTimeout=-32001]="RequestTimeout",Q[Q.ParseError=-32700]="ParseError",Q[Q.InvalidRequest=-32600]="InvalidRequest",Q[Q.MethodNotFound=-32601]="MethodNotFound",Q[Q.InvalidParams=-32602]="InvalidParams",Q[Q.InternalError=-32603]="InternalError",Q[Q.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(g||(g={}));var dW=v({jsonrpc:x(J5),id:H5.optional(),error:v({code:F0().int(),message:N(),data:M0().optional()})}).strict();var h8=(Q)=>dW.safeParse(Q).success;var iW=z0([S3,Z3,pW,dW]),rP=z0([pW,dW]),G5=f0.strict(),MU=O1.extend({requestId:H5.optional(),reason:N().optional()}),B5=N1.extend({method:x("notifications/cancelled"),params:MU}),jU=v({src:N(),mimeType:N().optional(),sizes:W0(N()).optional(),theme:X1(["light","dark"]).optional()}),h9=v({icons:W0(jU).optional()}),g8=v({name:N(),title:N().optional()}),b3=g8.extend({...g8.shape,...h9.shape,version:N(),websiteUrl:N().optional(),description:N().optional()}),DU=Y5(v({applyDefaults:_0().optional()}),j0(N(),M0())),EU=lW((Q)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q)){if(Object.keys(Q).length===0)return{form:{}}}return Q},Y5(v({form:DU.optional(),url:g0.optional()}),j0(N(),M0()).optional())),RU=a0({list:g0.optional(),cancel:g0.optional(),requests:a0({sampling:a0({createMessage:g0.optional()}).optional(),elicitation:a0({create:g0.optional()}).optional()}).optional()}),PU=a0({list:g0.optional(),cancel:g0.optional(),requests:a0({tools:a0({call:g0.optional()}).optional()}).optional()}),IU=v({experimental:j0(N(),g0).optional(),sampling:v({context:g0.optional(),tools:g0.optional()}).optional(),elicitation:EU.optional(),roots:v({listChanged:_0().optional()}).optional(),tasks:RU.optional()}),SU=U1.extend({protocolVersion:N(),capabilities:IU,clientInfo:b3}),K5=h0.extend({method:x("initialize"),params:SU}),nW=(Q)=>K5.safeParse(Q).success,ZU=v({experimental:j0(N(),g0).optional(),logging:g0.optional(),completions:g0.optional(),prompts:v({listChanged:_0().optional()}).optional(),resources:v({subscribe:_0().optional(),listChanged:_0().optional()}).optional(),tools:v({listChanged:_0().optional()}).optional(),tasks:PU.optional()}),CU=f0.extend({protocolVersion:N(),capabilities:ZU,serverInfo:b3,instructions:N().optional()}),rW=N1.extend({method:x("notifications/initialized"),params:O1.optional()});var F5=h0.extend({method:x("ping"),params:U1.optional()}),bU=v({progress:F0(),total:P0(F0()),message:P0(N())}),vU=v({...O1.shape,...bU.shape,progressToken:R3}),L5=N1.extend({method:x("notifications/progress"),params:vU}),kU=U1.extend({cursor:P3.optional()}),f9=h0.extend({params:kU.optional()}),u9=f0.extend({nextCursor:P3.optional()}),TU=X1(["working","input_required","completed","failed","cancelled"]),l9=v({taskId:N(),status:TU,ttl:z0([F0(),fW()]),createdAt:N(),lastUpdatedAt:N(),pollInterval:P0(F0()),statusMessage:P0(N())}),f8=f0.extend({task:l9}),_U=O1.merge(l9),m9=N1.extend({method:x("notifications/tasks/status"),params:_U}),q5=h0.extend({method:x("tasks/get"),params:U1.extend({taskId:N()})}),V5=f0.merge(l9),U5=h0.extend({method:x("tasks/result"),params:U1.extend({taskId:N()})}),oP=f0.loose(),A5=f9.extend({method:x("tasks/list")}),z5=u9.extend({tasks:W0(l9)}),w5=h0.extend({method:x("tasks/cancel"),params:U1.extend({taskId:N()})}),v3=f0.merge(l9),k3=v({uri:N(),mimeType:P0(N()),_meta:j0(N(),M0()).optional()}),T3=k3.extend({text:N()}),oW=N().refine((Q)=>{try{return atob(Q),!0}catch{return!1}},{message:"Invalid Base64 string"}),_3=k3.extend({blob:oW}),c9=X1(["user","assistant"]),u8=v({audience:W0(c9).optional(),priority:F0().min(0).max(1).optional(),lastModified:_9.datetime({offset:!0}).optional()}),x3=v({...g8.shape,...h9.shape,uri:N(),description:P0(N()),mimeType:P0(N()),annotations:u8.optional(),_meta:P0(a0({}))}),xU=v({...g8.shape,...h9.shape,uriTemplate:N(),description:P0(N()),mimeType:P0(N()),annotations:u8.optional(),_meta:P0(a0({}))}),O5=f9.extend({method:x("resources/list")}),yU=u9.extend({resources:W0(x3)}),N5=f9.extend({method:x("resources/templates/list")}),gU=u9.extend({resourceTemplates:W0(xU)}),aW=U1.extend({uri:N()}),hU=aW,M5=h0.extend({method:x("resources/read"),params:hU}),fU=f0.extend({contents:W0(z0([T3,_3]))}),uU=N1.extend({method:x("notifications/resources/list_changed"),params:O1.optional()}),lU=aW,mU=h0.extend({method:x("resources/subscribe"),params:lU}),cU=aW,pU=h0.extend({method:x("resources/unsubscribe"),params:cU}),dU=O1.extend({uri:N()}),iU=N1.extend({method:x("notifications/resources/updated"),params:dU}),nU=v({name:N(),description:P0(N()),required:P0(_0())}),rU=v({...g8.shape,...h9.shape,description:P0(N()),arguments:P0(W0(nU)),_meta:P0(a0({}))}),j5=f9.extend({method:x("prompts/list")}),oU=u9.extend({prompts:W0(rU)}),aU=U1.extend({name:N(),arguments:j0(N(),N()).optional()}),D5=h0.extend({method:x("prompts/get"),params:aU}),tW=v({type:x("text"),text:N(),annotations:u8.optional(),_meta:j0(N(),M0()).optional()}),sW=v({type:x("image"),data:oW,mimeType:N(),annotations:u8.optional(),_meta:j0(N(),M0()).optional()}),eW=v({type:x("audio"),data:oW,mimeType:N(),annotations:u8.optional(),_meta:j0(N(),M0()).optional()}),tU=v({type:x("tool_use"),name:N(),id:N(),input:j0(N(),M0()),_meta:j0(N(),M0()).optional()}),sU=v({type:x("resource"),resource:z0([T3,_3]),annotations:u8.optional(),_meta:j0(N(),M0()).optional()}),eU=x3.extend({type:x("resource_link")}),QY=z0([tW,sW,eW,eU,sU]),QA=v({role:c9,content:QY}),$A=f0.extend({description:N().optional(),messages:W0(QA)}),WA=N1.extend({method:x("notifications/prompts/list_changed"),params:O1.optional()}),YA=v({title:N().optional(),readOnlyHint:_0().optional(),destructiveHint:_0().optional(),idempotentHint:_0().optional(),openWorldHint:_0().optional()}),XA=v({taskSupport:X1(["required","optional","forbidden"]).optional()}),y3=v({...g8.shape,...h9.shape,description:N().optional(),inputSchema:v({type:x("object"),properties:j0(N(),g0).optional(),required:W0(N()).optional()}).catchall(M0()),outputSchema:v({type:x("object"),properties:j0(N(),g0).optional(),required:W0(N()).optional()}).catchall(M0()).optional(),annotations:YA.optional(),execution:XA.optional(),_meta:j0(N(),M0()).optional()}),E5=f9.extend({method:x("tools/list")}),JA=u9.extend({tools:W0(y3)}),R5=f0.extend({content:W0(QY).default([]),structuredContent:j0(N(),M0()).optional(),isError:_0().optional()}),aP=R5.or(f0.extend({toolResult:M0()})),HA=g9.extend({name:N(),arguments:j0(N(),M0()).optional()}),l8=h0.extend({method:x("tools/call"),params:HA}),GA=N1.extend({method:x("notifications/tools/list_changed"),params:O1.optional()}),tP=v({autoRefresh:_0().default(!0),debounceMs:F0().int().nonnegative().default(300)}),p9=X1(["debug","info","notice","warning","error","critical","alert","emergency"]),BA=U1.extend({level:p9}),$Y=h0.extend({method:x("logging/setLevel"),params:BA}),KA=O1.extend({level:p9,logger:N().optional(),data:M0()}),FA=N1.extend({method:x("notifications/message"),params:KA}),LA=v({name:N().optional()}),qA=v({hints:W0(LA).optional(),costPriority:F0().min(0).max(1).optional(),speedPriority:F0().min(0).max(1).optional(),intelligencePriority:F0().min(0).max(1).optional()}),VA=v({mode:X1(["auto","required","none"]).optional()}),UA=v({type:x("tool_result"),toolUseId:N().describe("The unique identifier for the corresponding tool call."),content:W0(QY).default([]),structuredContent:v({}).loose().optional(),isError:_0().optional(),_meta:j0(N(),M0()).optional()}),AA=uW("type",[tW,sW,eW]),X5=uW("type",[tW,sW,eW,tU,UA]),zA=v({role:c9,content:z0([X5,W0(X5)]),_meta:j0(N(),M0()).optional()}),wA=g9.extend({messages:W0(zA),modelPreferences:qA.optional(),systemPrompt:N().optional(),includeContext:X1(["none","thisServer","allServers"]).optional(),temperature:F0().optional(),maxTokens:F0().int(),stopSequences:W0(N()).optional(),metadata:g0.optional(),tools:W0(y3).optional(),toolChoice:VA.optional()}),OA=h0.extend({method:x("sampling/createMessage"),params:wA}),WY=f0.extend({model:N(),stopReason:P0(X1(["endTurn","stopSequence","maxTokens"]).or(N())),role:c9,content:AA}),YY=f0.extend({model:N(),stopReason:P0(X1(["endTurn","stopSequence","maxTokens","toolUse"]).or(N())),role:c9,content:z0([X5,W0(X5)])}),NA=v({type:x("boolean"),title:N().optional(),description:N().optional(),default:_0().optional()}),MA=v({type:x("string"),title:N().optional(),description:N().optional(),minLength:F0().optional(),maxLength:F0().optional(),format:X1(["email","uri","date","date-time"]).optional(),default:N().optional()}),jA=v({type:X1(["number","integer"]),title:N().optional(),description:N().optional(),minimum:F0().optional(),maximum:F0().optional(),default:F0().optional()}),DA=v({type:x("string"),title:N().optional(),description:N().optional(),enum:W0(N()),default:N().optional()}),EA=v({type:x("string"),title:N().optional(),description:N().optional(),oneOf:W0(v({const:N(),title:N()})),default:N().optional()}),RA=v({type:x("string"),title:N().optional(),description:N().optional(),enum:W0(N()),enumNames:W0(N()).optional(),default:N().optional()}),PA=z0([DA,EA]),IA=v({type:x("array"),title:N().optional(),description:N().optional(),minItems:F0().optional(),maxItems:F0().optional(),items:v({type:x("string"),enum:W0(N())}),default:W0(N()).optional()}),SA=v({type:x("array"),title:N().optional(),description:N().optional(),minItems:F0().optional(),maxItems:F0().optional(),items:v({anyOf:W0(v({const:N(),title:N()}))}),default:W0(N()).optional()}),ZA=z0([IA,SA]),CA=z0([RA,PA,ZA]),bA=z0([CA,NA,MA,jA]),vA=g9.extend({mode:x("form").optional(),message:N(),requestedSchema:v({type:x("object"),properties:j0(N(),bA),required:W0(N()).optional()})}),kA=g9.extend({mode:x("url"),message:N(),elicitationId:N(),url:N().url()}),TA=z0([vA,kA]),_A=h0.extend({method:x("elicitation/create"),params:TA}),xA=O1.extend({elicitationId:N()}),yA=N1.extend({method:x("notifications/elicitation/complete"),params:xA}),P5=f0.extend({action:X1(["accept","decline","cancel"]),content:lW((Q)=>Q===null?void 0:Q,j0(N(),z0([N(),F0(),_0(),W0(N())])).optional())}),gA=v({type:x("ref/resource"),uri:N()});var hA=v({type:x("ref/prompt"),name:N()}),fA=U1.extend({ref:z0([hA,gA]),argument:v({name:N(),value:N()}),context:v({arguments:j0(N(),N()).optional()}).optional()}),I5=h0.extend({method:x("completion/complete"),params:fA});function g3(Q){if(Q.params.ref.type!=="ref/prompt")throw TypeError(`Expected CompleteRequestPrompt, but got ${Q.params.ref.type}`)}function h3(Q){if(Q.params.ref.type!=="ref/resource")throw TypeError(`Expected CompleteRequestResourceTemplate, but got ${Q.params.ref.type}`)}var uA=f0.extend({completion:a0({values:W0(N()).max(100),total:P0(F0().int()),hasMore:P0(_0())})}),lA=v({uri:N().startsWith("file://"),name:N().optional(),_meta:j0(N(),M0()).optional()}),mA=h0.extend({method:x("roots/list"),params:U1.optional()}),XY=f0.extend({roots:W0(lA)}),cA=N1.extend({method:x("notifications/roots/list_changed"),params:O1.optional()}),sP=z0([F5,K5,I5,$Y,D5,j5,O5,N5,M5,mU,pU,l8,E5,q5,U5,A5,w5]),eP=z0([B5,L5,rW,cA,m9]),Q2=z0([G5,WY,YY,P5,XY,V5,z5,f8]),$2=z0([F5,OA,_A,mA,q5,U5,A5,w5]),W2=z0([B5,L5,FA,iU,uU,GA,WA,m9,yA]),Y2=z0([G5,CU,uA,$A,oU,yU,gU,fU,R5,JA,V5,z5,f8]);class _ extends Error{constructor(Q,$,W){super(`MCP error ${Q}: ${$}`);this.code=Q,this.data=W,this.name="McpError"}static fromError(Q,$,W){if(Q===g.UrlElicitationRequired&&W){let Y=W;if(Y.elicitations)return new f3(Y.elicitations,$)}return new _(Q,$,W)}}class f3 extends _{constructor(Q,$=`URL elicitation${Q.length>1?"s":""} required`){super(g.UrlElicitationRequired,$,{elicitations:Q})}get elicitations(){return this.data?.elicitations??[]}}function I6(Q){return Q==="completed"||Q==="failed"||Q==="cancelled"}var l3=Symbol("Let zodToJsonSchema decide on which parser to use");var u3={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},m3=(Q)=>typeof Q==="string"?{...u3,name:Q}:{...u3,...Q};var c3=(Q)=>{let $=m3(Q),W=$.name!==void 0?[...$.basePath,$.definitionPath,$.name]:$.basePath;return{...$,flags:{hasReferencedOpenAiAnyType:!1},currentPath:W,propertyPath:void 0,seen:new Map(Object.entries($.definitions).map(([Y,X])=>[X._def,{def:X._def,path:[...$.basePath,$.definitionPath,Y],jsonSchema:void 0}]))}};function JY(Q,$,W,Y){if(!Y?.errorMessages)return;if(W)Q.errorMessage={...Q.errorMessage,[$]:W}}function Y0(Q,$,W,Y,X){Q[$]=W,JY(Q,$,Y,X)}var S5=(Q,$)=>{let W=0;for(;W<Q.length&&W<$.length;W++)if(Q[W]!==$[W])break;return[(Q.length-W).toString(),...$.slice(W)].join("/")};function D0(Q){if(Q.target!=="openAi")return{};let $=[...Q.basePath,Q.definitionPath,Q.openAiAnyTypeName];return Q.flags.hasReferencedOpenAiAnyType=!0,{$ref:Q.$refStrategy==="relative"?S5($,Q.currentPath):$.join("/")}}function p3(Q,$){let W={type:"array"};if(Q.type?._def&&Q.type?._def?.typeName!==P.ZodAny)W.items=u(Q.type._def,{...$,currentPath:[...$.currentPath,"items"]});if(Q.minLength)Y0(W,"minItems",Q.minLength.value,Q.minLength.message,$);if(Q.maxLength)Y0(W,"maxItems",Q.maxLength.value,Q.maxLength.message,$);if(Q.exactLength)Y0(W,"minItems",Q.exactLength.value,Q.exactLength.message,$),Y0(W,"maxItems",Q.exactLength.value,Q.exactLength.message,$);return W}function d3(Q,$){let W={type:"integer",format:"int64"};if(!Q.checks)return W;for(let Y of Q.checks)switch(Y.kind){case"min":if($.target==="jsonSchema7")if(Y.inclusive)Y0(W,"minimum",Y.value,Y.message,$);else Y0(W,"exclusiveMinimum",Y.value,Y.message,$);else{if(!Y.inclusive)W.exclusiveMinimum=!0;Y0(W,"minimum",Y.value,Y.message,$)}break;case"max":if($.target==="jsonSchema7")if(Y.inclusive)Y0(W,"maximum",Y.value,Y.message,$);else Y0(W,"exclusiveMaximum",Y.value,Y.message,$);else{if(!Y.inclusive)W.exclusiveMaximum=!0;Y0(W,"maximum",Y.value,Y.message,$)}break;case"multipleOf":Y0(W,"multipleOf",Y.value,Y.message,$);break}return W}function i3(){return{type:"boolean"}}function Z5(Q,$){return u(Q.type._def,$)}var n3=(Q,$)=>{return u(Q.innerType._def,$)};function HY(Q,$,W){let Y=W??$.dateStrategy;if(Array.isArray(Y))return{anyOf:Y.map((X,J)=>HY(Q,$,X))};switch(Y){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return pA(Q,$)}}var pA=(Q,$)=>{let W={type:"integer",format:"unix-time"};if($.target==="openApi3")return W;for(let Y of Q.checks)switch(Y.kind){case"min":Y0(W,"minimum",Y.value,Y.message,$);break;case"max":Y0(W,"maximum",Y.value,Y.message,$);break}return W};function r3(Q,$){return{...u(Q.innerType._def,$),default:Q.defaultValue()}}function o3(Q,$){return $.effectStrategy==="input"?u(Q.schema._def,$):D0($)}function a3(Q){return{type:"string",enum:Array.from(Q.values)}}var dA=(Q)=>{if("type"in Q&&Q.type==="string")return!1;return"allOf"in Q};function t3(Q,$){let W=[u(Q.left._def,{...$,currentPath:[...$.currentPath,"allOf","0"]}),u(Q.right._def,{...$,currentPath:[...$.currentPath,"allOf","1"]})].filter((J)=>!!J),Y=$.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,X=[];return W.forEach((J)=>{if(dA(J)){if(X.push(...J.allOf),J.unevaluatedProperties===void 0)Y=void 0}else{let H=J;if("additionalProperties"in J&&J.additionalProperties===!1){let{additionalProperties:G,...B}=J;H=B}else Y=void 0;X.push(H)}}),X.length?{allOf:X,...Y}:void 0}function s3(Q,$){let W=typeof Q.value;if(W!=="bigint"&&W!=="number"&&W!=="boolean"&&W!=="string")return{type:Array.isArray(Q.value)?"array":"object"};if($.target==="openApi3")return{type:W==="bigint"?"integer":W,enum:[Q.value]};return{type:W==="bigint"?"integer":W,const:Q.value}}var GY=void 0,v1={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>{if(GY===void 0)GY=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u");return GY},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function C5(Q,$){let W={type:"string"};if(Q.checks)for(let Y of Q.checks)switch(Y.kind){case"min":Y0(W,"minLength",typeof W.minLength==="number"?Math.max(W.minLength,Y.value):Y.value,Y.message,$);break;case"max":Y0(W,"maxLength",typeof W.maxLength==="number"?Math.min(W.maxLength,Y.value):Y.value,Y.message,$);break;case"email":switch($.emailStrategy){case"format:email":k1(W,"email",Y.message,$);break;case"format:idn-email":k1(W,"idn-email",Y.message,$);break;case"pattern:zod":t0(W,v1.email,Y.message,$);break}break;case"url":k1(W,"uri",Y.message,$);break;case"uuid":k1(W,"uuid",Y.message,$);break;case"regex":t0(W,Y.regex,Y.message,$);break;case"cuid":t0(W,v1.cuid,Y.message,$);break;case"cuid2":t0(W,v1.cuid2,Y.message,$);break;case"startsWith":t0(W,RegExp(`^${BY(Y.value,$)}`),Y.message,$);break;case"endsWith":t0(W,RegExp(`${BY(Y.value,$)}$`),Y.message,$);break;case"datetime":k1(W,"date-time",Y.message,$);break;case"date":k1(W,"date",Y.message,$);break;case"time":k1(W,"time",Y.message,$);break;case"duration":k1(W,"duration",Y.message,$);break;case"length":Y0(W,"minLength",typeof W.minLength==="number"?Math.max(W.minLength,Y.value):Y.value,Y.message,$),Y0(W,"maxLength",typeof W.maxLength==="number"?Math.min(W.maxLength,Y.value):Y.value,Y.message,$);break;case"includes":{t0(W,RegExp(BY(Y.value,$)),Y.message,$);break}case"ip":{if(Y.version!=="v6")k1(W,"ipv4",Y.message,$);if(Y.version!=="v4")k1(W,"ipv6",Y.message,$);break}case"base64url":t0(W,v1.base64url,Y.message,$);break;case"jwt":t0(W,v1.jwt,Y.message,$);break;case"cidr":{if(Y.version!=="v6")t0(W,v1.ipv4Cidr,Y.message,$);if(Y.version!=="v4")t0(W,v1.ipv6Cidr,Y.message,$);break}case"emoji":t0(W,v1.emoji(),Y.message,$);break;case"ulid":{t0(W,v1.ulid,Y.message,$);break}case"base64":{switch($.base64Strategy){case"format:binary":{k1(W,"binary",Y.message,$);break}case"contentEncoding:base64":{Y0(W,"contentEncoding","base64",Y.message,$);break}case"pattern:zod":{t0(W,v1.base64,Y.message,$);break}}break}case"nanoid":t0(W,v1.nanoid,Y.message,$);case"toLowerCase":case"toUpperCase":case"trim":break;default:((X)=>{})(Y)}return W}function BY(Q,$){return $.patternStrategy==="escape"?nA(Q):Q}var iA=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function nA(Q){let $="";for(let W=0;W<Q.length;W++){if(!iA.has(Q[W]))$+="\\";$+=Q[W]}return $}function k1(Q,$,W,Y){if(Q.format||Q.anyOf?.some((X)=>X.format)){if(!Q.anyOf)Q.anyOf=[];if(Q.format){if(Q.anyOf.push({format:Q.format,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{format:Q.errorMessage.format}}}),delete Q.format,Q.errorMessage){if(delete Q.errorMessage.format,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.anyOf.push({format:$,...W&&Y.errorMessages&&{errorMessage:{format:W}}})}else Y0(Q,"format",$,W,Y)}function t0(Q,$,W,Y){if(Q.pattern||Q.allOf?.some((X)=>X.pattern)){if(!Q.allOf)Q.allOf=[];if(Q.pattern){if(Q.allOf.push({pattern:Q.pattern,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{pattern:Q.errorMessage.pattern}}}),delete Q.pattern,Q.errorMessage){if(delete Q.errorMessage.pattern,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.allOf.push({pattern:e3($,Y),...W&&Y.errorMessages&&{errorMessage:{pattern:W}}})}else Y0(Q,"pattern",e3($,Y),W,Y)}function e3(Q,$){if(!$.applyRegexFlags||!Q.flags)return Q.source;let W={i:Q.flags.includes("i"),m:Q.flags.includes("m"),s:Q.flags.includes("s")},Y=W.i?Q.source.toLowerCase():Q.source,X="",J=!1,H=!1,G=!1;for(let B=0;B<Y.length;B++){if(J){X+=Y[B],J=!1;continue}if(W.i){if(H){if(Y[B].match(/[a-z]/)){if(G)X+=Y[B],X+=`${Y[B-2]}-${Y[B]}`.toUpperCase(),G=!1;else if(Y[B+1]==="-"&&Y[B+2]?.match(/[a-z]/))X+=Y[B],G=!0;else X+=`${Y[B]}${Y[B].toUpperCase()}`;continue}}else if(Y[B].match(/[a-z]/)){X+=`[${Y[B]}${Y[B].toUpperCase()}]`;continue}}if(W.m){if(Y[B]==="^"){X+=`(^|(?<=[\r
]))`;continue}else if(Y[B]==="$"){X+=`($|(?=[\r
]))`;continue}}if(W.s&&Y[B]==="."){X+=H?`${Y[B]}\r
`:`[${Y[B]}\r
]`;continue}if(X+=Y[B],Y[B]==="\\")J=!0;else if(H&&Y[B]==="]")H=!1;else if(!H&&Y[B]==="[")H=!0}try{new RegExp(X)}catch{return console.warn(`Could not convert regex pattern at ${$.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),Q.source}return X}function b5(Q,$){if($.target==="openAi")console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.");if($.target==="openApi3"&&Q.keyType?._def.typeName===P.ZodEnum)return{type:"object",required:Q.keyType._def.values,properties:Q.keyType._def.values.reduce((Y,X)=>({...Y,[X]:u(Q.valueType._def,{...$,currentPath:[...$.currentPath,"properties",X]})??D0($)}),{}),additionalProperties:$.rejectedAdditionalProperties};let W={type:"object",additionalProperties:u(Q.valueType._def,{...$,currentPath:[...$.currentPath,"additionalProperties"]})??$.allowedAdditionalProperties};if($.target==="openApi3")return W;if(Q.keyType?._def.typeName===P.ZodString&&Q.keyType._def.checks?.length){let{type:Y,...X}=C5(Q.keyType._def,$);return{...W,propertyNames:X}}else if(Q.keyType?._def.typeName===P.ZodEnum)return{...W,propertyNames:{enum:Q.keyType._def.values}};else if(Q.keyType?._def.typeName===P.ZodBranded&&Q.keyType._def.type._def.typeName===P.ZodString&&Q.keyType._def.type._def.checks?.length){let{type:Y,...X}=Z5(Q.keyType._def,$);return{...W,propertyNames:X}}return W}function QH(Q,$){if($.mapStrategy==="record")return b5(Q,$);let W=u(Q.keyType._def,{...$,currentPath:[...$.currentPath,"items","items","0"]})||D0($),Y=u(Q.valueType._def,{...$,currentPath:[...$.currentPath,"items","items","1"]})||D0($);return{type:"array",maxItems:125,items:{type:"array",items:[W,Y],minItems:2,maxItems:2}}}function $H(Q){let $=Q.values,Y=Object.keys(Q.values).filter((J)=>{return typeof $[$[J]]!=="number"}).map((J)=>$[J]),X=Array.from(new Set(Y.map((J)=>typeof J)));return{type:X.length===1?X[0]==="string"?"string":"number":["string","number"],enum:Y}}function WH(Q){return Q.target==="openAi"?void 0:{not:D0({...Q,currentPath:[...Q.currentPath,"not"]})}}function YH(Q){return Q.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var d9={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function JH(Q,$){if($.target==="openApi3")return XH(Q,$);let W=Q.options instanceof Map?Array.from(Q.options.values()):Q.options;if(W.every((Y)=>(Y._def.typeName in d9)&&(!Y._def.checks||!Y._def.checks.length))){let Y=W.reduce((X,J)=>{let H=d9[J._def.typeName];return H&&!X.includes(H)?[...X,H]:X},[]);return{type:Y.length>1?Y:Y[0]}}else if(W.every((Y)=>Y._def.typeName==="ZodLiteral"&&!Y.description)){let Y=W.reduce((X,J)=>{let H=typeof J._def.value;switch(H){case"string":case"number":case"boolean":return[...X,H];case"bigint":return[...X,"integer"];case"object":if(J._def.value===null)return[...X,"null"];case"symbol":case"undefined":case"function":default:return X}},[]);if(Y.length===W.length){let X=Y.filter((J,H,G)=>G.indexOf(J)===H);return{type:X.length>1?X:X[0],enum:W.reduce((J,H)=>{return J.includes(H._def.value)?J:[...J,H._def.value]},[])}}}else if(W.every((Y)=>Y._def.typeName==="ZodEnum"))return{type:"string",enum:W.reduce((Y,X)=>[...Y,...X._def.values.filter((J)=>!Y.includes(J))],[])};return XH(Q,$)}var XH=(Q,$)=>{let W=(Q.options instanceof Map?Array.from(Q.options.values()):Q.options).map((Y,X)=>u(Y._def,{...$,currentPath:[...$.currentPath,"anyOf",`${X}`]})).filter((Y)=>!!Y&&(!$.strictUnions||typeof Y==="object"&&Object.keys(Y).length>0));return W.length?{anyOf:W}:void 0};function HH(Q,$){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(Q.innerType._def.typeName)&&(!Q.innerType._def.checks||!Q.innerType._def.checks.length)){if($.target==="openApi3")return{type:d9[Q.innerType._def.typeName],nullable:!0};return{type:[d9[Q.innerType._def.typeName],"null"]}}if($.target==="openApi3"){let Y=u(Q.innerType._def,{...$,currentPath:[...$.currentPath]});if(Y&&"$ref"in Y)return{allOf:[Y],nullable:!0};return Y&&{...Y,nullable:!0}}let W=u(Q.innerType._def,{...$,currentPath:[...$.currentPath,"anyOf","0"]});return W&&{anyOf:[W,{type:"null"}]}}function GH(Q,$){let W={type:"number"};if(!Q.checks)return W;for(let Y of Q.checks)switch(Y.kind){case"int":W.type="integer",JY(W,"type",Y.message,$);break;case"min":if($.target==="jsonSchema7")if(Y.inclusive)Y0(W,"minimum",Y.value,Y.message,$);else Y0(W,"exclusiveMinimum",Y.value,Y.message,$);else{if(!Y.inclusive)W.exclusiveMinimum=!0;Y0(W,"minimum",Y.value,Y.message,$)}break;case"max":if($.target==="jsonSchema7")if(Y.inclusive)Y0(W,"maximum",Y.value,Y.message,$);else Y0(W,"exclusiveMaximum",Y.value,Y.message,$);else{if(!Y.inclusive)W.exclusiveMaximum=!0;Y0(W,"maximum",Y.value,Y.message,$)}break;case"multipleOf":Y0(W,"multipleOf",Y.value,Y.message,$);break}return W}function BH(Q,$){let W=$.target==="openAi",Y={type:"object",properties:{}},X=[],J=Q.shape();for(let G in J){let B=J[G];if(B===void 0||B._def===void 0)continue;let K=oA(B);if(K&&W){if(B._def.typeName==="ZodOptional")B=B._def.innerType;if(!B.isNullable())B=B.nullable();K=!1}let F=u(B._def,{...$,currentPath:[...$.currentPath,"properties",G],propertyPath:[...$.currentPath,"properties",G]});if(F===void 0)continue;if(Y.properties[G]=F,!K)X.push(G)}if(X.length)Y.required=X;let H=rA(Q,$);if(H!==void 0)Y.additionalProperties=H;return Y}function rA(Q,$){if(Q.catchall._def.typeName!=="ZodNever")return u(Q.catchall._def,{...$,currentPath:[...$.currentPath,"additionalProperties"]});switch(Q.unknownKeys){case"passthrough":return $.allowedAdditionalProperties;case"strict":return $.rejectedAdditionalProperties;case"strip":return $.removeAdditionalStrategy==="strict"?$.allowedAdditionalProperties:$.rejectedAdditionalProperties}}function oA(Q){try{return Q.isOptional()}catch{return!0}}var KH=(Q,$)=>{if($.currentPath.toString()===$.propertyPath?.toString())return u(Q.innerType._def,$);let W=u(Q.innerType._def,{...$,currentPath:[...$.currentPath,"anyOf","1"]});return W?{anyOf:[{not:D0($)},W]}:D0($)};var FH=(Q,$)=>{if($.pipeStrategy==="input")return u(Q.in._def,$);else if($.pipeStrategy==="output")return u(Q.out._def,$);let W=u(Q.in._def,{...$,currentPath:[...$.currentPath,"allOf","0"]}),Y=u(Q.out._def,{...$,currentPath:[...$.currentPath,"allOf",W?"1":"0"]});return{allOf:[W,Y].filter((X)=>X!==void 0)}};function LH(Q,$){return u(Q.type._def,$)}function qH(Q,$){let Y={type:"array",uniqueItems:!0,items:u(Q.valueType._def,{...$,currentPath:[...$.currentPath,"items"]})};if(Q.minSize)Y0(Y,"minItems",Q.minSize.value,Q.minSize.message,$);if(Q.maxSize)Y0(Y,"maxItems",Q.maxSize.value,Q.maxSize.message,$);return Y}function VH(Q,$){if(Q.rest)return{type:"array",minItems:Q.items.length,items:Q.items.map((W,Y)=>u(W._def,{...$,currentPath:[...$.currentPath,"items",`${Y}`]})).reduce((W,Y)=>Y===void 0?W:[...W,Y],[]),additionalItems:u(Q.rest._def,{...$,currentPath:[...$.currentPath,"additionalItems"]})};else return{type:"array",minItems:Q.items.length,maxItems:Q.items.length,items:Q.items.map((W,Y)=>u(W._def,{...$,currentPath:[...$.currentPath,"items",`${Y}`]})).reduce((W,Y)=>Y===void 0?W:[...W,Y],[])}}function UH(Q){return{not:D0(Q)}}function AH(Q){return D0(Q)}var zH=(Q,$)=>{return u(Q.innerType._def,$)};var wH=(Q,$,W)=>{switch($){case P.ZodString:return C5(Q,W);case P.ZodNumber:return GH(Q,W);case P.ZodObject:return BH(Q,W);case P.ZodBigInt:return d3(Q,W);case P.ZodBoolean:return i3();case P.ZodDate:return HY(Q,W);case P.ZodUndefined:return UH(W);case P.ZodNull:return YH(W);case P.ZodArray:return p3(Q,W);case P.ZodUnion:case P.ZodDiscriminatedUnion:return JH(Q,W);case P.ZodIntersection:return t3(Q,W);case P.ZodTuple:return VH(Q,W);case P.ZodRecord:return b5(Q,W);case P.ZodLiteral:return s3(Q,W);case P.ZodEnum:return a3(Q);case P.ZodNativeEnum:return $H(Q);case P.ZodNullable:return HH(Q,W);case P.ZodOptional:return KH(Q,W);case P.ZodMap:return QH(Q,W);case P.ZodSet:return qH(Q,W);case P.ZodLazy:return()=>Q.getter()._def;case P.ZodPromise:return LH(Q,W);case P.ZodNaN:case P.ZodNever:return WH(W);case P.ZodEffects:return o3(Q,W);case P.ZodAny:return D0(W);case P.ZodUnknown:return AH(W);case P.ZodDefault:return r3(Q,W);case P.ZodBranded:return Z5(Q,W);case P.ZodReadonly:return zH(Q,W);case P.ZodCatch:return n3(Q,W);case P.ZodPipeline:return FH(Q,W);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return((Y)=>{return})($)}};function u(Q,$,W=!1){let Y=$.seen.get(Q);if($.override){let G=$.override?.(Q,$,Y,W);if(G!==l3)return G}if(Y&&!W){let G=aA(Y,$);if(G!==void 0)return G}let X={def:Q,path:$.currentPath,jsonSchema:void 0};$.seen.set(Q,X);let J=wH(Q,Q.typeName,$),H=typeof J==="function"?u(J(),$):J;if(H)tA(Q,$,H);if($.postProcess){let G=$.postProcess(H,Q,$);return X.jsonSchema=H,G}return X.jsonSchema=H,H}var aA=(Q,$)=>{switch($.$refStrategy){case"root":return{$ref:Q.path.join("/")};case"relative":return{$ref:S5($.currentPath,Q.path)};case"none":case"seen":{if(Q.path.length<$.currentPath.length&&Q.path.every((W,Y)=>$.currentPath[Y]===W))return console.warn(`Recursive reference detected at ${$.currentPath.join("/")}! Defaulting to any`),D0($);return $.$refStrategy==="seen"?D0($):void 0}}},tA=(Q,$,W)=>{if(Q.description){if(W.description=Q.description,$.markdownDescription)W.markdownDescription=Q.description}return W};var KY=(Q,$)=>{let W=c3($),Y=typeof $==="object"&&$.definitions?Object.entries($.definitions).reduce((B,[K,F])=>({...B,[K]:u(F._def,{...W,currentPath:[...W.basePath,W.definitionPath,K]},!0)??D0(W)}),{}):void 0,X=typeof $==="string"?$:$?.nameStrategy==="title"?void 0:$?.name,J=u(Q._def,X===void 0?W:{...W,currentPath:[...W.basePath,W.definitionPath,X]},!1)??D0(W),H=typeof $==="object"&&$.name!==void 0&&$.nameStrategy==="title"?$.name:void 0;if(H!==void 0)J.title=H;if(W.flags.hasReferencedOpenAiAnyType){if(!Y)Y={};if(!Y[W.openAiAnyTypeName])Y[W.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:W.$refStrategy==="relative"?"1":[...W.basePath,W.definitionPath,W.openAiAnyTypeName].join("/")}}}let G=X===void 0?Y?{...J,[W.definitionPath]:Y}:J:{$ref:[...W.$refStrategy==="relative"?[]:W.basePath,W.definitionPath,X].join("/"),[W.definitionPath]:{...Y,[X]:J}};if(W.target==="jsonSchema7")G.$schema="http://json-schema.org/draft-07/schema#";else if(W.target==="jsonSchema2019-09"||W.target==="openAi")G.$schema="https://json-schema.org/draft/2019-09/schema#";if(W.target==="openAi"&&(("anyOf"in G)||("oneOf"in G)||("allOf"in G)||("type"in G)&&Array.isArray(G.type)))console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.");return G};function sA(Q){if(!Q)return"draft-7";if(Q==="jsonSchema7"||Q==="draft-7")return"draft-7";if(Q==="jsonSchema2019-09"||Q==="draft-2020-12")return"draft-2020-12";return"draft-7"}function FY(Q,$){if(w1(Q))return vW(Q,{target:sA($?.target),io:$?.pipeStrategy??"input"});return KY(Q,{strictUnions:$?.strictUnions??!0,pipeStrategy:$?.pipeStrategy??"input"})}function LY(Q){let W=E6(Q)?.method;if(!W)throw Error("Schema is missing a method literal");let Y=$5(W);if(typeof Y!=="string")throw Error("Schema method literal must be a string");return Y}function qY(Q,$){let W=D6(Q,$);if(!W.success)throw W.error;return W.data}var eA=60000;class VY{constructor(Q){if(this._options=Q,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(B5,($)=>{this._oncancel($)}),this.setNotificationHandler(L5,($)=>{this._onprogress($)}),this.setRequestHandler(F5,($)=>({})),this._taskStore=Q?.taskStore,this._taskMessageQueue=Q?.taskMessageQueue,this._taskStore)this.setRequestHandler(q5,async($,W)=>{let Y=await this._taskStore.getTask($.params.taskId,W.sessionId);if(!Y)throw new _(g.InvalidParams,"Failed to retrieve task: Task not found");return{...Y}}),this.setRequestHandler(U5,async($,W)=>{let Y=async()=>{let X=$.params.taskId;if(this._taskMessageQueue){let H;while(H=await this._taskMessageQueue.dequeue(X,W.sessionId)){if(H.type==="response"||H.type==="error"){let G=H.message,B=G.id,K=this._requestResolvers.get(B);if(K)if(this._requestResolvers.delete(B),H.type==="response")K(G);else{let F=G,q=new _(F.error.code,F.error.message,F.error.data);K(q)}else{let F=H.type==="response"?"Response":"Error";this._onerror(Error(`${F} handler missing for request ${B}`))}continue}await this._transport?.send(H.message,{relatedRequestId:W.requestId})}}let J=await this._taskStore.getTask(X,W.sessionId);if(!J)throw new _(g.InvalidParams,`Task not found: ${X}`);if(!I6(J.status))return await this._waitForTaskUpdate(X,W.signal),await Y();if(I6(J.status)){let H=await this._taskStore.getTaskResult(X,W.sessionId);return this._clearTaskQueue(X),{...H,_meta:{...H._meta,[R6]:{taskId:X}}}}return await Y()};return await Y()}),this.setRequestHandler(A5,async($,W)=>{try{let{tasks:Y,nextCursor:X}=await this._taskStore.listTasks($.params?.cursor,W.sessionId);return{tasks:Y,nextCursor:X,_meta:{}}}catch(Y){throw new _(g.InvalidParams,`Failed to list tasks: ${Y instanceof Error?Y.message:String(Y)}`)}}),this.setRequestHandler(w5,async($,W)=>{try{let Y=await this._taskStore.getTask($.params.taskId,W.sessionId);if(!Y)throw new _(g.InvalidParams,`Task not found: ${$.params.taskId}`);if(I6(Y.status))throw new _(g.InvalidParams,`Cannot cancel task in terminal status: ${Y.status}`);await this._taskStore.updateTaskStatus($.params.taskId,"cancelled","Client cancelled task execution.",W.sessionId),this._clearTaskQueue($.params.taskId);let X=await this._taskStore.getTask($.params.taskId,W.sessionId);if(!X)throw new _(g.InvalidParams,`Task not found after cancellation: ${$.params.taskId}`);return{_meta:{},...X}}catch(Y){if(Y instanceof _)throw Y;throw new _(g.InvalidRequest,`Failed to cancel task: ${Y instanceof Error?Y.message:String(Y)}`)}})}async _oncancel(Q){if(!Q.params.requestId)return;this._requestHandlerAbortControllers.get(Q.params.requestId)?.abort(Q.params.reason)}_setupTimeout(Q,$,W,Y,X=!1){this._timeoutInfo.set(Q,{timeoutId:setTimeout(Y,$),startTime:Date.now(),timeout:$,maxTotalTimeout:W,resetTimeoutOnProgress:X,onTimeout:Y})}_resetTimeout(Q){let $=this._timeoutInfo.get(Q);if(!$)return!1;let W=Date.now()-$.startTime;if($.maxTotalTimeout&&W>=$.maxTotalTimeout)throw this._timeoutInfo.delete(Q),_.fromError(g.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:$.maxTotalTimeout,totalElapsed:W});return clearTimeout($.timeoutId),$.timeoutId=setTimeout($.onTimeout,$.timeout),!0}_cleanupTimeout(Q){let $=this._timeoutInfo.get(Q);if($)clearTimeout($.timeoutId),this._timeoutInfo.delete(Q)}async connect(Q){this._transport=Q;let $=this.transport?.onclose;this._transport.onclose=()=>{$?.(),this._onclose()};let W=this.transport?.onerror;this._transport.onerror=(X)=>{W?.(X),this._onerror(X)};let Y=this._transport?.onmessage;this._transport.onmessage=(X,J)=>{if(Y?.(X,J),$6(X)||h8(X))this._onresponse(X);else if(P6(X))this._onrequest(X,J);else if(C3(X))this._onnotification(X);else this._onerror(Error(`Unknown message type: ${JSON.stringify(X)}`))},await this._transport.start()}_onclose(){let Q=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let $=_.fromError(g.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let W of Q.values())W($)}_onerror(Q){this.onerror?.(Q)}_onnotification(Q){let $=this._notificationHandlers.get(Q.method)??this.fallbackNotificationHandler;if($===void 0)return;Promise.resolve().then(()=>$(Q)).catch((W)=>this._onerror(Error(`Uncaught error in notification handler: ${W}`)))}_onrequest(Q,$){let W=this._requestHandlers.get(Q.method)??this.fallbackRequestHandler,Y=this._transport,X=Q.params?._meta?.[R6]?.taskId;if(W===void 0){let K={jsonrpc:"2.0",id:Q.id,error:{code:g.MethodNotFound,message:"Method not found"}};if(X&&this._taskMessageQueue)this._enqueueTaskMessage(X,{type:"error",message:K,timestamp:Date.now()},Y?.sessionId).catch((F)=>this._onerror(Error(`Failed to enqueue error response: ${F}`)));else Y?.send(K).catch((F)=>this._onerror(Error(`Failed to send an error response: ${F}`)));return}let J=new AbortController;this._requestHandlerAbortControllers.set(Q.id,J);let H=I3(Q.params)?Q.params.task:void 0,G=this._taskStore?this.requestTaskStore(Q,Y?.sessionId):void 0,B={signal:J.signal,sessionId:Y?.sessionId,_meta:Q.params?._meta,sendNotification:async(K)=>{let F={relatedRequestId:Q.id};if(X)F.relatedTask={taskId:X};await this.notification(K,F)},sendRequest:async(K,F,q)=>{let A={...q,relatedRequestId:Q.id};if(X&&!A.relatedTask)A.relatedTask={taskId:X};let V=A.relatedTask?.taskId??X;if(V&&G)await G.updateTaskStatus(V,"input_required");return await this.request(K,F,A)},authInfo:$?.authInfo,requestId:Q.id,requestInfo:$?.requestInfo,taskId:X,taskStore:G,taskRequestedTtl:H?.ttl,closeSSEStream:$?.closeSSEStream,closeStandaloneSSEStream:$?.closeStandaloneSSEStream};Promise.resolve().then(()=>{if(H)this.assertTaskHandlerCapability(Q.method)}).then(()=>W(Q,B)).then(async(K)=>{if(J.signal.aborted)return;let F={result:K,jsonrpc:"2.0",id:Q.id};if(X&&this._taskMessageQueue)await this._enqueueTaskMessage(X,{type:"response",message:F,timestamp:Date.now()},Y?.sessionId);else await Y?.send(F)},async(K)=>{if(J.signal.aborted)return;let F={jsonrpc:"2.0",id:Q.id,error:{code:Number.isSafeInteger(K.code)?K.code:g.InternalError,message:K.message??"Internal error",...K.data!==void 0&&{data:K.data}}};if(X&&this._taskMessageQueue)await this._enqueueTaskMessage(X,{type:"error",message:F,timestamp:Date.now()},Y?.sessionId);else await Y?.send(F)}).catch((K)=>this._onerror(Error(`Failed to send response: ${K}`))).finally(()=>{this._requestHandlerAbortControllers.delete(Q.id)})}_onprogress(Q){let{progressToken:$,...W}=Q.params,Y=Number($),X=this._progressHandlers.get(Y);if(!X){this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(Q)}`));return}let J=this._responseHandlers.get(Y),H=this._timeoutInfo.get(Y);if(H&&J&&H.resetTimeoutOnProgress)try{this._resetTimeout(Y)}catch(G){this._responseHandlers.delete(Y),this._progressHandlers.delete(Y),this._cleanupTimeout(Y),J(G);return}X(W)}_onresponse(Q){let $=Number(Q.id),W=this._requestResolvers.get($);if(W){if(this._requestResolvers.delete($),$6(Q))W(Q);else{let J=new _(Q.error.code,Q.error.message,Q.error.data);W(J)}return}let Y=this._responseHandlers.get($);if(Y===void 0){this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(Q)}`));return}this._responseHandlers.delete($),this._cleanupTimeout($);let X=!1;if($6(Q)&&Q.result&&typeof Q.result==="object"){let J=Q.result;if(J.task&&typeof J.task==="object"){let H=J.task;if(typeof H.taskId==="string")X=!0,this._taskProgressTokens.set(H.taskId,$)}}if(!X)this._progressHandlers.delete($);if($6(Q))Y(Q);else{let J=_.fromError(Q.error.code,Q.error.message,Q.error.data);Y(J)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(Q,$,W){let{task:Y}=W??{};if(!Y){try{yield{type:"result",result:await this.request(Q,$,W)}}catch(J){yield{type:"error",error:J instanceof _?J:new _(g.InternalError,String(J))}}return}let X;try{let J=await this.request(Q,f8,W);if(J.task)X=J.task.taskId,yield{type:"taskCreated",task:J.task};else throw new _(g.InternalError,"Task creation did not return a task");while(!0){let H=await this.getTask({taskId:X},W);if(yield{type:"taskStatus",task:H},I6(H.status)){if(H.status==="completed")yield{type:"result",result:await this.getTaskResult({taskId:X},$,W)};else if(H.status==="failed")yield{type:"error",error:new _(g.InternalError,`Task ${X} failed`)};else if(H.status==="cancelled")yield{type:"error",error:new _(g.InternalError,`Task ${X} was cancelled`)};return}if(H.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:X},$,W)};return}let G=H.pollInterval??this._options?.defaultTaskPollInterval??1000;await new Promise((B)=>setTimeout(B,G)),W?.signal?.throwIfAborted()}}catch(J){yield{type:"error",error:J instanceof _?J:new _(g.InternalError,String(J))}}}request(Q,$,W){let{relatedRequestId:Y,resumptionToken:X,onresumptiontoken:J,task:H,relatedTask:G}=W??{};return new Promise((B,K)=>{let F=(O)=>{K(O)};if(!this._transport){F(Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{if(this.assertCapabilityForMethod(Q.method),H)this.assertTaskCapability(Q.method)}catch(O){F(O);return}W?.signal?.throwIfAborted();let q=this._requestMessageId++,A={...Q,jsonrpc:"2.0",id:q};if(W?.onprogress)this._progressHandlers.set(q,W.onprogress),A.params={...Q.params,_meta:{...Q.params?._meta||{},progressToken:q}};if(H)A.params={...A.params,task:H};if(G)A.params={...A.params,_meta:{...A.params?._meta||{},[R6]:G}};let V=(O)=>{this._responseHandlers.delete(q),this._progressHandlers.delete(q),this._cleanupTimeout(q),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:q,reason:String(O)}},{relatedRequestId:Y,resumptionToken:X,onresumptiontoken:J}).catch((j)=>this._onerror(Error(`Failed to send cancellation: ${j}`)));let D=O instanceof _?O:new _(g.RequestTimeout,String(O));K(D)};this._responseHandlers.set(q,(O)=>{if(W?.signal?.aborted)return;if(O instanceof Error)return K(O);try{let D=D6($,O.result);if(!D.success)K(D.error);else B(D.data)}catch(D){K(D)}}),W?.signal?.addEventListener("abort",()=>{V(W?.signal?.reason)});let U=W?.timeout??eA,z=()=>V(_.fromError(g.RequestTimeout,"Request timed out",{timeout:U}));this._setupTimeout(q,U,W?.maxTotalTimeout,z,W?.resetTimeoutOnProgress??!1);let w=G?.taskId;if(w){let O=(D)=>{let j=this._responseHandlers.get(q);if(j)j(D);else this._onerror(Error(`Response handler missing for side-channeled request ${q}`))};this._requestResolvers.set(q,O),this._enqueueTaskMessage(w,{type:"request",message:A,timestamp:Date.now()}).catch((D)=>{this._cleanupTimeout(q),K(D)})}else this._transport.send(A,{relatedRequestId:Y,resumptionToken:X,onresumptiontoken:J}).catch((O)=>{this._cleanupTimeout(q),K(O)})})}async getTask(Q,$){return this.request({method:"tasks/get",params:Q},V5,$)}async getTaskResult(Q,$,W){return this.request({method:"tasks/result",params:Q},$,W)}async listTasks(Q,$){return this.request({method:"tasks/list",params:Q},z5,$)}async cancelTask(Q,$){return this.request({method:"tasks/cancel",params:Q},v3,$)}async notification(Q,$){if(!this._transport)throw Error("Not connected");this.assertNotificationCapability(Q.method);let W=$?.relatedTask?.taskId;if(W){let H={...Q,jsonrpc:"2.0",params:{...Q.params,_meta:{...Q.params?._meta||{},[R6]:$.relatedTask}}};await this._enqueueTaskMessage(W,{type:"notification",message:H,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(Q.method)&&!Q.params&&!$?.relatedRequestId&&!$?.relatedTask){if(this._pendingDebouncedNotifications.has(Q.method))return;this._pendingDebouncedNotifications.add(Q.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(Q.method),!this._transport)return;let H={...Q,jsonrpc:"2.0"};if($?.relatedTask)H={...H,params:{...H.params,_meta:{...H.params?._meta||{},[R6]:$.relatedTask}}};this._transport?.send(H,$).catch((G)=>this._onerror(G))});return}let J={...Q,jsonrpc:"2.0"};if($?.relatedTask)J={...J,params:{...J.params,_meta:{...J.params?._meta||{},[R6]:$.relatedTask}}};await this._transport.send(J,$)}setRequestHandler(Q,$){let W=LY(Q);this.assertRequestHandlerCapability(W),this._requestHandlers.set(W,(Y,X)=>{let J=qY(Q,Y);return Promise.resolve($(J,X))})}removeRequestHandler(Q){this._requestHandlers.delete(Q)}assertCanSetRequestHandler(Q){if(this._requestHandlers.has(Q))throw Error(`A request handler for ${Q} already exists, which would be overridden`)}setNotificationHandler(Q,$){let W=LY(Q);this._notificationHandlers.set(W,(Y)=>{let X=qY(Q,Y);return Promise.resolve($(X))})}removeNotificationHandler(Q){this._notificationHandlers.delete(Q)}_cleanupTaskProgressHandler(Q){let $=this._taskProgressTokens.get(Q);if($!==void 0)this._progressHandlers.delete($),this._taskProgressTokens.delete(Q)}async _enqueueTaskMessage(Q,$,W){if(!this._taskStore||!this._taskMessageQueue)throw Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let Y=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(Q,$,W,Y)}async _clearTaskQueue(Q,$){if(this._taskMessageQueue){let W=await this._taskMessageQueue.dequeueAll(Q,$);for(let Y of W)if(Y.type==="request"&&P6(Y.message)){let X=Y.message.id,J=this._requestResolvers.get(X);if(J)J(new _(g.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(X);else this._onerror(Error(`Resolver missing for request ${X} during task ${Q} cleanup`))}}}async _waitForTaskUpdate(Q,$){let W=this._options?.defaultTaskPollInterval??1000;try{let Y=await this._taskStore?.getTask(Q);if(Y?.pollInterval)W=Y.pollInterval}catch{}return new Promise((Y,X)=>{if($.aborted){X(new _(g.InvalidRequest,"Request cancelled"));return}let J=setTimeout(Y,W);$.addEventListener("abort",()=>{clearTimeout(J),X(new _(g.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(Q,$){let W=this._taskStore;if(!W)throw Error("No task store configured");return{createTask:async(Y)=>{if(!Q)throw Error("No request provided");return await W.createTask(Y,Q.id,{method:Q.method,params:Q.params},$)},getTask:async(Y)=>{let X=await W.getTask(Y,$);if(!X)throw new _(g.InvalidParams,"Failed to retrieve task: Task not found");return X},storeTaskResult:async(Y,X,J)=>{await W.storeTaskResult(Y,X,J,$);let H=await W.getTask(Y,$);if(H){let G=m9.parse({method:"notifications/tasks/status",params:H});if(await this.notification(G),I6(H.status))this._cleanupTaskProgressHandler(Y)}},getTaskResult:(Y)=>{return W.getTaskResult(Y,$)},updateTaskStatus:async(Y,X,J)=>{let H=await W.getTask(Y,$);if(!H)throw new _(g.InvalidParams,`Task "${Y}" not found - it may have been cleaned up`);if(I6(H.status))throw new _(g.InvalidParams,`Cannot update task "${Y}" from terminal status "${H.status}" to "${X}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await W.updateTaskStatus(Y,X,J,$);let G=await W.getTask(Y,$);if(G){let B=m9.parse({method:"notifications/tasks/status",params:G});if(await this.notification(B),I6(G.status))this._cleanupTaskProgressHandler(Y)}},listTasks:(Y)=>{return W.listTasks(Y,$)}}}}function OH(Q){return Q!==null&&typeof Q==="object"&&!Array.isArray(Q)}function NH(Q,$){let W={...Q};for(let Y in $){let X=Y,J=$[X];if(J===void 0)continue;let H=W[X];if(OH(H)&&OH(J))W[X]={...H,...J};else W[X]=J}return W}var MK=PX(m7(),1),jK=PX(NK(),1);function cj(){let Q=new MK.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return jK.default(Q),Q}class a7{constructor(Q){this._ajv=Q??cj()}getValidator(Q){let $="$id"in Q&&typeof Q.$id==="string"?this._ajv.getSchema(Q.$id)??this._ajv.compile(Q):this._ajv.compile(Q);return(W)=>{if($(W))return{valid:!0,data:W,errorMessage:void 0};else return{valid:!1,data:void 0,errorMessage:this._ajv.errorsText($.errors)}}}}class t7{constructor(Q){this._server=Q}requestStream(Q,$,W){return this._server.requestStream(Q,$,W)}async getTask(Q,$){return this._server.getTask({taskId:Q},$)}async getTaskResult(Q,$,W){return this._server.getTaskResult({taskId:Q},$,W)}async listTasks(Q,$){return this._server.listTasks(Q?{cursor:Q}:void 0,$)}async cancelTask(Q,$){return this._server.cancelTask({taskId:Q},$)}}function DK(Q,$,W){if(!Q)throw Error(`${W} does not support task creation (required for ${$})`);switch($){case"tools/call":if(!Q.tools?.call)throw Error(`${W} does not support task creation for tools/call (required for ${$})`);break;default:break}}function EK(Q,$,W){if(!Q)throw Error(`${W} does not support task creation (required for ${$})`);switch($){case"sampling/createMessage":if(!Q.sampling?.createMessage)throw Error(`${W} does not support task creation for sampling/createMessage (required for ${$})`);break;case"elicitation/create":if(!Q.elicitation?.create)throw Error(`${W} does not support task creation for elicitation/create (required for ${$})`);break;default:break}}class s7 extends VY{constructor(Q,$){super($);if(this._serverInfo=Q,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(p9.options.map((W,Y)=>[W,Y])),this.isMessageIgnored=(W,Y)=>{let X=this._loggingLevels.get(Y);return X?this.LOG_LEVEL_SEVERITY.get(W)<this.LOG_LEVEL_SEVERITY.get(X):!1},this._capabilities=$?.capabilities??{},this._instructions=$?.instructions,this._jsonSchemaValidator=$?.jsonSchemaValidator??new a7,this.setRequestHandler(K5,(W)=>this._oninitialize(W)),this.setNotificationHandler(rW,()=>this.oninitialized?.()),this._capabilities.logging)this.setRequestHandler($Y,async(W,Y)=>{let X=Y.sessionId||Y.requestInfo?.headers["mcp-session-id"]||void 0,{level:J}=W.params,H=p9.safeParse(J);if(H.success)this._loggingLevels.set(X,H.data);return{}})}get experimental(){if(!this._experimental)this._experimental={tasks:new t7(this)};return this._experimental}registerCapabilities(Q){if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=NH(this._capabilities,Q)}setRequestHandler(Q,$){let Y=E6(Q)?.method;if(!Y)throw Error("Schema is missing a method literal");let X;if(w1(Y)){let H=Y;X=H._zod?.def?.value??H.value}else{let H=Y;X=H._def?.value??H.value}if(typeof X!=="string")throw Error("Schema method literal must be a string");if(X==="tools/call"){let H=async(G,B)=>{let K=D6(l8,G);if(!K.success){let V=K.error instanceof Error?K.error.message:String(K.error);throw new _(g.InvalidParams,`Invalid tools/call request: ${V}`)}let{params:F}=K.data,q=await Promise.resolve($(G,B));if(F.task){let V=D6(f8,q);if(!V.success){let U=V.error instanceof Error?V.error.message:String(V.error);throw new _(g.InvalidParams,`Invalid task creation result: ${U}`)}return V.data}let A=D6(R5,q);if(!A.success){let V=A.error instanceof Error?A.error.message:String(A.error);throw new _(g.InvalidParams,`Invalid tools/call result: ${V}`)}return A.data};return super.setRequestHandler(Q,H)}return super.setRequestHandler(Q,$)}assertCapabilityForMethod(Q){switch(Q){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw Error(`Client does not support sampling (required for ${Q})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw Error(`Client does not support elicitation (required for ${Q})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw Error(`Client does not support listing roots (required for ${Q})`);break;case"ping":break}}assertNotificationCapability(Q){switch(Q){case"notifications/message":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw Error(`Server does not support notifying about resources (required for ${Q})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw Error(`Server does not support notifying of tool list changes (required for ${Q})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw Error(`Server does not support notifying of prompt list changes (required for ${Q})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw Error(`Client does not support URL elicitation (required for ${Q})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(Q){if(!this._capabilities)return;switch(Q){case"completion/complete":if(!this._capabilities.completions)throw Error(`Server does not support completions (required for ${Q})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw Error(`Server does not support prompts (required for ${Q})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw Error(`Server does not support resources (required for ${Q})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw Error(`Server does not support tools (required for ${Q})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw Error(`Server does not support tasks capability (required for ${Q})`);break;case"ping":case"initialize":break}}assertTaskCapability(Q){EK(this._clientCapabilities?.tasks?.requests,Q,"Client")}assertTaskHandlerCapability(Q){if(!this._capabilities)return;DK(this._capabilities.tasks?.requests,Q,"Server")}async _oninitialize(Q){let $=Q.params.protocolVersion;return this._clientCapabilities=Q.params.capabilities,this._clientVersion=Q.params.clientInfo,{protocolVersion:y9.includes($)?$:mW,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},G5)}async createMessage(Q,$){if(Q.tools||Q.toolChoice){if(!this._clientCapabilities?.sampling?.tools)throw Error("Client does not support sampling tools capability.")}if(Q.messages.length>0){let W=Q.messages[Q.messages.length-1],Y=Array.isArray(W.content)?W.content:[W.content],X=Y.some((B)=>B.type==="tool_result"),J=Q.messages.length>1?Q.messages[Q.messages.length-2]:void 0,H=J?Array.isArray(J.content)?J.content:[J.content]:[],G=H.some((B)=>B.type==="tool_use");if(X){if(Y.some((B)=>B.type!=="tool_result"))throw Error("The last message must contain only tool_result content if any is present");if(!G)throw Error("tool_result blocks are not matching any tool_use from the previous message")}if(G){let B=new Set(H.filter((F)=>F.type==="tool_use").map((F)=>F.id)),K=new Set(Y.filter((F)=>F.type==="tool_result").map((F)=>F.toolUseId));if(B.size!==K.size||![...B].every((F)=>K.has(F)))throw Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}if(Q.tools)return this.request({method:"sampling/createMessage",params:Q},YY,$);return this.request({method:"sampling/createMessage",params:Q},WY,$)}async elicitInput(Q,$){switch(Q.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support url elicitation.");let Y=Q;return this.request({method:"elicitation/create",params:Y},P5,$)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw Error("Client does not support form elicitation.");let Y=Q.mode==="form"?Q:{...Q,mode:"form"},X=await this.request({method:"elicitation/create",params:Y},P5,$);if(X.action==="accept"&&X.content&&Y.requestedSchema)try{let H=this._jsonSchemaValidator.getValidator(Y.requestedSchema)(X.content);if(!H.valid)throw new _(g.InvalidParams,`Elicitation response content does not match requested schema: ${H.errorMessage}`)}catch(J){if(J instanceof _)throw J;throw new _(g.InternalError,`Error validating elicitation response: ${J instanceof Error?J.message:String(J)}`)}return X}}}createElicitationCompletionNotifier(Q,$){if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:Q}},$)}async listRoots(Q,$){return this.request({method:"roots/list",params:Q},XY,$)}async sendLoggingMessage(Q,$){if(this._capabilities.logging){if(!this.isMessageIgnored(Q.level,$))return this.notification({method:"notifications/message",params:Q})}}async sendResourceUpdated(Q){return this.notification({method:"notifications/resources/updated",params:Q})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}var PK=Symbol.for("mcp.completable");function e7(Q){return!!Q&&typeof Q==="object"&&PK in Q}function IK(Q){return Q[PK]?.complete}var RK;(function(Q){Q.Completable="McpCompletable"})(RK||(RK={}));class H6{static isTemplate(Q){return/\{[^}\s]+\}/.test(Q)}static validateLength(Q,$,W){if(Q.length>$)throw Error(`${W} exceeds maximum length of ${$} characters (got ${Q.length})`)}get variableNames(){return this.parts.flatMap((Q)=>typeof Q==="string"?[]:Q.names)}constructor(Q){H6.validateLength(Q,1e6,"Template"),this.template=Q,this.parts=this.parse(Q)}toString(){return this.template}parse(Q){let $=[],W="",Y=0,X=0;while(Y<Q.length)if(Q[Y]==="{"){if(W)$.push(W),W="";let J=Q.indexOf("}",Y);if(J===-1)throw Error("Unclosed template expression");if(X++,X>1e4)throw Error("Template contains too many expressions (max 10000)");let H=Q.slice(Y+1,J),G=this.getOperator(H),B=H.includes("*"),K=this.getNames(H),F=K[0];for(let q of K)H6.validateLength(q,1e6,"Variable name");$.push({name:F,operator:G,names:K,exploded:B}),Y=J+1}else W+=Q[Y],Y++;if(W)$.push(W);return $}getOperator(Q){return["+","#",".","/","?","&"].find((W)=>Q.startsWith(W))||""}getNames(Q){let $=this.getOperator(Q);return Q.slice($.length).split(",").map((W)=>W.replace("*","").trim()).filter((W)=>W.length>0)}encodeValue(Q,$){if(H6.validateLength(Q,1e6,"Variable value"),$==="+"||$==="#")return encodeURI(Q);return encodeURIComponent(Q)}expandPart(Q,$){if(Q.operator==="?"||Q.operator==="&"){let J=Q.names.map((G)=>{let B=$[G];if(B===void 0)return"";let K=Array.isArray(B)?B.map((F)=>this.encodeValue(F,Q.operator)).join(","):this.encodeValue(B.toString(),Q.operator);return`${G}=${K}`}).filter((G)=>G.length>0);if(J.length===0)return"";return(Q.operator==="?"?"?":"&")+J.join("&")}if(Q.names.length>1){let J=Q.names.map((H)=>$[H]).filter((H)=>H!==void 0);if(J.length===0)return"";return J.map((H)=>Array.isArray(H)?H[0]:H).join(",")}let W=$[Q.name];if(W===void 0)return"";let X=(Array.isArray(W)?W:[W]).map((J)=>this.encodeValue(J,Q.operator));switch(Q.operator){case"":return X.join(",");case"+":return X.join(",");case"#":return"#"+X.join(",");case".":return"."+X.join(".");case"/":return"/"+X.join("/");default:return X.join(",")}}expand(Q){let $="",W=!1;for(let Y of this.parts){if(typeof Y==="string"){$+=Y;continue}let X=this.expandPart(Y,Q);if(!X)continue;if((Y.operator==="?"||Y.operator==="&")&&W)$+=X.replace("?","&");else $+=X;if(Y.operator==="?"||Y.operator==="&")W=!0}return $}escapeRegExp(Q){return Q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}partToRegExp(Q){let $=[];for(let X of Q.names)H6.validateLength(X,1e6,"Variable name");if(Q.operator==="?"||Q.operator==="&"){for(let X=0;X<Q.names.length;X++){let J=Q.names[X],H=X===0?"\\"+Q.operator:"&";$.push({pattern:H+this.escapeRegExp(J)+"=([^&]+)",name:J})}return $}let W,Y=Q.name;switch(Q.operator){case"":W=Q.exploded?"([^/,]+(?:,[^/,]+)*)":"([^/,]+)";break;case"+":case"#":W="(.+)";break;case".":W="\\.([^/,]+)";break;case"/":W="/"+(Q.exploded?"([^/,]+(?:,[^/,]+)*)":"([^/,]+)");break;default:W="([^/]+)"}return $.push({pattern:W,name:Y}),$}match(Q){H6.validateLength(Q,1e6,"URI");let $="^",W=[];for(let H of this.parts)if(typeof H==="string")$+=this.escapeRegExp(H);else{let G=this.partToRegExp(H);for(let{pattern:B,name:K}of G)$+=B,W.push({name:K,exploded:H.exploded})}$+="$",H6.validateLength($,1e6,"Generated regex pattern");let Y=new RegExp($),X=Q.match(Y);if(!X)return null;let J={};for(let H=0;H<W.length;H++){let{name:G,exploded:B}=W[H],K=X[H+1],F=G.replace("*","");if(B&&K.includes(","))J[F]=K.split(",");else J[F]=K}return J}}var pj=/^[A-Za-z0-9._-]{1,128}$/;function dj(Q){let $=[];if(Q.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(Q.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${Q.length})`]};if(Q.includes(" "))$.push("Tool name contains spaces, which may cause parsing issues");if(Q.includes(","))$.push("Tool name contains commas, which may cause parsing issues");if(Q.startsWith("-")||Q.endsWith("-"))$.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts");if(Q.startsWith(".")||Q.endsWith("."))$.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts");if(!pj.test(Q)){let W=Q.split("").filter((Y)=>!/[A-Za-z0-9._-]/.test(Y)).filter((Y,X,J)=>J.indexOf(Y)===X);return $.push(`Tool name contains invalid characters: ${W.map((Y)=>`"${Y}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:$}}return{isValid:!0,warnings:$}}function ij(Q,$){if($.length>0){console.warn(`Tool name validation warning for "${Q}":`);for(let W of $)console.warn(`  - ${W}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function QX(Q){let $=dj(Q);return ij(Q,$.warnings),$.isValid}class $X{constructor(Q){this._mcpServer=Q}registerToolTask(Q,$,W){let Y={taskSupport:"required",...$.execution};if(Y.taskSupport==="forbidden")throw Error(`Cannot register task-based tool '${Q}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(Q,$.title,$.description,$.inputSchema,$.outputSchema,$.annotations,Y,$._meta,W)}}class YX{constructor(Q,$){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new s7(Q,$)}get experimental(){if(!this._experimental)this._experimental={tasks:new $X(this)};return this._experimental}async connect(Q){return await this.server.connect(Q)}async close(){await this.server.close()}setToolRequestHandlers(){if(this._toolHandlersInitialized)return;this.server.assertCanSetRequestHandler(g6(E5)),this.server.assertCanSetRequestHandler(g6(l8)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(E5,()=>({tools:Object.entries(this._registeredTools).filter(([,Q])=>Q.enabled).map(([Q,$])=>{let W={name:Q,title:$.title,description:$.description,inputSchema:(()=>{let Y=y8($.inputSchema);return Y?FY(Y,{strictUnions:!0,pipeStrategy:"input"}):nj})(),annotations:$.annotations,execution:$.execution,_meta:$._meta};if($.outputSchema){let Y=y8($.outputSchema);if(Y)W.outputSchema=FY(Y,{strictUnions:!0,pipeStrategy:"output"})}return W})})),this.server.setRequestHandler(l8,async(Q,$)=>{try{let W=this._registeredTools[Q.params.name];if(!W)throw new _(g.InvalidParams,`Tool ${Q.params.name} not found`);if(!W.enabled)throw new _(g.InvalidParams,`Tool ${Q.params.name} disabled`);let Y=!!Q.params.task,X=W.execution?.taskSupport,J="createTask"in W.handler;if((X==="required"||X==="optional")&&!J)throw new _(g.InternalError,`Tool ${Q.params.name} has taskSupport '${X}' but was not registered with registerToolTask`);if(X==="required"&&!Y)throw new _(g.MethodNotFound,`Tool ${Q.params.name} requires task augmentation (taskSupport: 'required')`);if(X==="optional"&&!Y&&J)return await this.handleAutomaticTaskPolling(W,Q,$);let H=await this.validateToolInput(W,Q.params.arguments,Q.params.name),G=await this.executeToolHandler(W,H,$);if(Y)return G;return await this.validateToolOutput(W,G,Q.params.name),G}catch(W){if(W instanceof _){if(W.code===g.UrlElicitationRequired)throw W}return this.createToolError(W instanceof Error?W.message:String(W))}}),this._toolHandlersInitialized=!0}createToolError(Q){return{content:[{type:"text",text:Q}],isError:!0}}async validateToolInput(Q,$,W){if(!Q.inputSchema)return;let X=y8(Q.inputSchema)??Q.inputSchema,J=await eQ(X,$);if(!J.success){let H="error"in J?J.error:"Unknown error",G=Q5(H);throw new _(g.InvalidParams,`Input validation error: Invalid arguments for tool ${W}: ${G}`)}return J.data}async validateToolOutput(Q,$,W){if(!Q.outputSchema)return;if(!("content"in $))return;if($.isError)return;if(!$.structuredContent)throw new _(g.InvalidParams,`Output validation error: Tool ${W} has an output schema but no structured content was provided`);let Y=y8(Q.outputSchema),X=await eQ(Y,$.structuredContent);if(!X.success){let J="error"in X?X.error:"Unknown error",H=Q5(J);throw new _(g.InvalidParams,`Output validation error: Invalid structured content for tool ${W}: ${H}`)}}async executeToolHandler(Q,$,W){let Y=Q.handler;if("createTask"in Y){if(!W.taskStore)throw Error("No task store provided.");let J={...W,taskStore:W.taskStore};if(Q.inputSchema)return await Promise.resolve(Y.createTask($,J));else return await Promise.resolve(Y.createTask(J))}if(Q.inputSchema)return await Promise.resolve(Y($,W));else return await Promise.resolve(Y(W))}async handleAutomaticTaskPolling(Q,$,W){if(!W.taskStore)throw Error("No task store provided for task-capable tool.");let Y=await this.validateToolInput(Q,$.params.arguments,$.params.name),X=Q.handler,J={...W,taskStore:W.taskStore},H=Y?await Promise.resolve(X.createTask(Y,J)):await Promise.resolve(X.createTask(J)),G=H.task.taskId,B=H.task,K=B.pollInterval??5000;while(B.status!=="completed"&&B.status!=="failed"&&B.status!=="cancelled"){await new Promise((q)=>setTimeout(q,K));let F=await W.taskStore.getTask(G);if(!F)throw new _(g.InternalError,`Task ${G} not found during polling`);B=F}return await W.taskStore.getTaskResult(G)}setCompletionRequestHandler(){if(this._completionHandlerInitialized)return;this.server.assertCanSetRequestHandler(g6(I5)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(I5,async(Q)=>{switch(Q.params.ref.type){case"ref/prompt":return g3(Q),this.handlePromptCompletion(Q,Q.params.ref);case"ref/resource":return h3(Q),this.handleResourceCompletion(Q,Q.params.ref);default:throw new _(g.InvalidParams,`Invalid completion reference: ${Q.params.ref}`)}}),this._completionHandlerInitialized=!0}async handlePromptCompletion(Q,$){let W=this._registeredPrompts[$.name];if(!W)throw new _(g.InvalidParams,`Prompt ${$.name} not found`);if(!W.enabled)throw new _(g.InvalidParams,`Prompt ${$.name} disabled`);if(!W.argsSchema)return wQ;let X=E6(W.argsSchema)?.[Q.params.argument.name];if(!e7(X))return wQ;let J=IK(X);if(!J)return wQ;let H=await J(Q.params.argument.value,Q.params.context);return ZK(H)}async handleResourceCompletion(Q,$){let W=Object.values(this._registeredResourceTemplates).find((J)=>J.resourceTemplate.uriTemplate.toString()===$.uri);if(!W){if(this._registeredResources[$.uri])return wQ;throw new _(g.InvalidParams,`Resource template ${Q.params.ref.uri} not found`)}let Y=W.resourceTemplate.completeCallback(Q.params.argument.name);if(!Y)return wQ;let X=await Y(Q.params.argument.value,Q.params.context);return ZK(X)}setResourceRequestHandlers(){if(this._resourceHandlersInitialized)return;this.server.assertCanSetRequestHandler(g6(O5)),this.server.assertCanSetRequestHandler(g6(N5)),this.server.assertCanSetRequestHandler(g6(M5)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(O5,async(Q,$)=>{let W=Object.entries(this._registeredResources).filter(([X,J])=>J.enabled).map(([X,J])=>({uri:X,name:J.name,...J.metadata})),Y=[];for(let X of Object.values(this._registeredResourceTemplates)){if(!X.resourceTemplate.listCallback)continue;let J=await X.resourceTemplate.listCallback($);for(let H of J.resources)Y.push({...X.metadata,...H})}return{resources:[...W,...Y]}}),this.server.setRequestHandler(N5,async()=>{return{resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([$,W])=>({name:$,uriTemplate:W.resourceTemplate.uriTemplate.toString(),...W.metadata}))}}),this.server.setRequestHandler(M5,async(Q,$)=>{let W=new URL(Q.params.uri),Y=this._registeredResources[W.toString()];if(Y){if(!Y.enabled)throw new _(g.InvalidParams,`Resource ${W} disabled`);return Y.readCallback(W,$)}for(let X of Object.values(this._registeredResourceTemplates)){let J=X.resourceTemplate.uriTemplate.match(W.toString());if(J)return X.readCallback(W,J,$)}throw new _(g.InvalidParams,`Resource ${W} not found`)}),this._resourceHandlersInitialized=!0}setPromptRequestHandlers(){if(this._promptHandlersInitialized)return;this.server.assertCanSetRequestHandler(g6(j5)),this.server.assertCanSetRequestHandler(g6(D5)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(j5,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,Q])=>Q.enabled).map(([Q,$])=>{return{name:Q,title:$.title,description:$.description,arguments:$.argsSchema?oj($.argsSchema):void 0}})})),this.server.setRequestHandler(D5,async(Q,$)=>{let W=this._registeredPrompts[Q.params.name];if(!W)throw new _(g.InvalidParams,`Prompt ${Q.params.name} not found`);if(!W.enabled)throw new _(g.InvalidParams,`Prompt ${Q.params.name} disabled`);if(W.argsSchema){let Y=y8(W.argsSchema),X=await eQ(Y,Q.params.arguments);if(!X.success){let G="error"in X?X.error:"Unknown error",B=Q5(G);throw new _(g.InvalidParams,`Invalid arguments for prompt ${Q.params.name}: ${B}`)}let J=X.data,H=W.callback;return await Promise.resolve(H(J,$))}else{let Y=W.callback;return await Promise.resolve(Y($))}}),this._promptHandlersInitialized=!0}resource(Q,$,...W){let Y;if(typeof W[0]==="object")Y=W.shift();let X=W[0];if(typeof $==="string"){if(this._registeredResources[$])throw Error(`Resource ${$} is already registered`);let J=this._createRegisteredResource(Q,void 0,$,Y,X);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let J=this._createRegisteredResourceTemplate(Q,void 0,$,Y,X);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}}registerResource(Q,$,W,Y){if(typeof $==="string"){if(this._registeredResources[$])throw Error(`Resource ${$} is already registered`);let X=this._createRegisteredResource(Q,W.title,$,W,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),X}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let X=this._createRegisteredResourceTemplate(Q,W.title,$,W,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),X}}_createRegisteredResource(Q,$,W,Y,X){let J={name:Q,title:$,metadata:Y,readCallback:X,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({uri:null}),update:(H)=>{if(typeof H.uri<"u"&&H.uri!==W){if(delete this._registeredResources[W],H.uri)this._registeredResources[H.uri]=J}if(typeof H.name<"u")J.name=H.name;if(typeof H.title<"u")J.title=H.title;if(typeof H.metadata<"u")J.metadata=H.metadata;if(typeof H.callback<"u")J.readCallback=H.callback;if(typeof H.enabled<"u")J.enabled=H.enabled;this.sendResourceListChanged()}};return this._registeredResources[W]=J,J}_createRegisteredResourceTemplate(Q,$,W,Y,X){let J={resourceTemplate:W,title:$,metadata:Y,readCallback:X,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({name:null}),update:(B)=>{if(typeof B.name<"u"&&B.name!==Q){if(delete this._registeredResourceTemplates[Q],B.name)this._registeredResourceTemplates[B.name]=J}if(typeof B.title<"u")J.title=B.title;if(typeof B.template<"u")J.resourceTemplate=B.template;if(typeof B.metadata<"u")J.metadata=B.metadata;if(typeof B.callback<"u")J.readCallback=B.callback;if(typeof B.enabled<"u")J.enabled=B.enabled;this.sendResourceListChanged()}};this._registeredResourceTemplates[Q]=J;let H=W.uriTemplate.variableNames;if(Array.isArray(H)&&H.some((B)=>!!W.completeCallback(B)))this.setCompletionRequestHandler();return J}_createRegisteredPrompt(Q,$,W,Y,X){let J={title:$,description:W,argsSchema:Y===void 0?void 0:s6(Y),callback:X,enabled:!0,disable:()=>J.update({enabled:!1}),enable:()=>J.update({enabled:!0}),remove:()=>J.update({name:null}),update:(H)=>{if(typeof H.name<"u"&&H.name!==Q){if(delete this._registeredPrompts[Q],H.name)this._registeredPrompts[H.name]=J}if(typeof H.title<"u")J.title=H.title;if(typeof H.description<"u")J.description=H.description;if(typeof H.argsSchema<"u")J.argsSchema=s6(H.argsSchema);if(typeof H.callback<"u")J.callback=H.callback;if(typeof H.enabled<"u")J.enabled=H.enabled;this.sendPromptListChanged()}};if(this._registeredPrompts[Q]=J,Y){if(Object.values(Y).some((G)=>{let B=G instanceof L1?G._def?.innerType:G;return e7(B)}))this.setCompletionRequestHandler()}return J}_createRegisteredTool(Q,$,W,Y,X,J,H,G,B){QX(Q);let K={title:$,description:W,inputSchema:SK(Y),outputSchema:SK(X),annotations:J,execution:H,_meta:G,handler:B,enabled:!0,disable:()=>K.update({enabled:!1}),enable:()=>K.update({enabled:!0}),remove:()=>K.update({name:null}),update:(F)=>{if(typeof F.name<"u"&&F.name!==Q){if(typeof F.name==="string")QX(F.name);if(delete this._registeredTools[Q],F.name)this._registeredTools[F.name]=K}if(typeof F.title<"u")K.title=F.title;if(typeof F.description<"u")K.description=F.description;if(typeof F.paramsSchema<"u")K.inputSchema=s6(F.paramsSchema);if(typeof F.outputSchema<"u")K.outputSchema=s6(F.outputSchema);if(typeof F.callback<"u")K.handler=F.callback;if(typeof F.annotations<"u")K.annotations=F.annotations;if(typeof F._meta<"u")K._meta=F._meta;if(typeof F.enabled<"u")K.enabled=F.enabled;this.sendToolListChanged()}};return this._registeredTools[Q]=K,this.setToolRequestHandlers(),this.sendToolListChanged(),K}tool(Q,...$){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let W,Y,X,J;if(typeof $[0]==="string")W=$.shift();if($.length>1){let G=$[0];if(WX(G)){if(Y=$.shift(),$.length>1&&typeof $[0]==="object"&&$[0]!==null&&!WX($[0]))J=$.shift()}else if(typeof G==="object"&&G!==null)J=$.shift()}let H=$[0];return this._createRegisteredTool(Q,void 0,W,Y,X,J,{taskSupport:"forbidden"},void 0,H)}registerTool(Q,$,W){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let{title:Y,description:X,inputSchema:J,outputSchema:H,annotations:G,_meta:B}=$;return this._createRegisteredTool(Q,Y,X,J,H,G,{taskSupport:"forbidden"},B,W)}prompt(Q,...$){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let W;if(typeof $[0]==="string")W=$.shift();let Y;if($.length>1)Y=$.shift();let X=$[0],J=this._createRegisteredPrompt(Q,void 0,W,Y,X);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),J}registerPrompt(Q,$,W){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let{title:Y,description:X,argsSchema:J}=$,H=this._createRegisteredPrompt(Q,Y,X,J,W);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),H}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(Q,$){return this.server.sendLoggingMessage(Q,$)}sendResourceListChanged(){if(this.isConnected())this.server.sendResourceListChanged()}sendToolListChanged(){if(this.isConnected())this.server.sendToolListChanged()}sendPromptListChanged(){if(this.isConnected())this.server.sendPromptListChanged()}}class A4{constructor(Q,$){this._callbacks=$,this._uriTemplate=typeof Q==="string"?new H6(Q):Q}get uriTemplate(){return this._uriTemplate}get listCallback(){return this._callbacks.list}completeCallback(Q){return this._callbacks.complete?.[Q]}}var nj={type:"object",properties:{}};function CK(Q){return Q!==null&&typeof Q==="object"&&"parse"in Q&&typeof Q.parse==="function"&&"safeParse"in Q&&typeof Q.safeParse==="function"}function rj(Q){return"_def"in Q||"_zod"in Q||CK(Q)}function WX(Q){if(typeof Q!=="object"||Q===null)return!1;if(rj(Q))return!1;if(Object.keys(Q).length===0)return!0;return Object.values(Q).some(CK)}function SK(Q){if(!Q)return;if(WX(Q))return s6(Q);return Q}function oj(Q){let $=E6(Q);if(!$)return[];return Object.entries($).map(([W,Y])=>{let X=Q3(Y),J=$3(Y);return{name:W,description:X,required:!J}})}function g6(Q){let W=E6(Q)?.method;if(!W)throw Error("Schema is missing a method literal");let Y=$5(W);if(typeof Y==="string")return Y;throw Error("Schema method literal must be a string")}function ZK(Q){return{completion:{values:Q.slice(0,100),total:Q.length,hasMore:Q.length>100}}}var wQ={completion:{values:[],hasMore:!1}};var XX=null;function OQ(){return new YX({name:"Blockbench MCP",version:w8})}function NQ(){if(!XX)XX=OQ();return XX}var rC=NQ();var H8={},G8={},Y9={},JX={};function bK(Q){let $=Q._def;if($.typeName==="ZodObject")return $.shape?.()??{};if($.typeName==="ZodEffects"&&$.schema)return bK($.schema);return{}}function E(Q,$,W="stable",Y=!0){if(H8[Q])throw Error(`Tool with name "${Q}" already exists.`);let X=bK($.parameters),J={title:$.annotations?.title??$.description,description:$.description,inputSchema:X,execute:$.execute,annotations:$.annotations};if(JX[Q]=J,Y){let H=NQ();H.registerTool.bind(H)(Q,{title:J.title,description:J.description,inputSchema:X},async(B,K)=>{let q={reportProgress:()=>{}},A=await $.execute(B,q);if(typeof A==="string")return{content:[{type:"text",text:A}]};if(A&&typeof A==="object"&&"content"in A)return A;return{content:[{type:"text",text:JSON.stringify(A)}]}})}return H8[Q]={name:Q,description:J.title,enabled:Y,status:W},H8[Q]}function vK(){return JX}function aj(){return Object.fromEntries(Object.entries(JX).filter(([Q])=>H8[Q]?.enabled))}function kK(Q){let $=aj(),W=Q;for(let[Y,X]of Object.entries($))W.registerTool(Y,{title:X.title,description:X.description,inputSchema:X.inputSchema},async(J,H)=>{let B={reportProgress:()=>{}},K=await X.execute(J,B);if(typeof K==="string")return{content:[{type:"text",text:K}]};if(K&&typeof K==="object"&&"content"in K)return K;return{content:[{type:"text",text:JSON.stringify(K)}]}})}var TK={};function Q1(Q,$){if(Y9[Q])throw Error(`Resource with name "${Q}" already exists.`);let W={name:Q,uriTemplate:$.uriTemplate,metadata:{title:$.title,description:$.description},listCallback:$.listCallback,readCallback:$.readCallback};TK[Q]=W;let Y=NQ();return Y.registerResource.bind(Y)(Q,new A4($.uriTemplate,{list:$.listCallback}),{title:$.title,description:$.description},async(J,H)=>{let G=Object.fromEntries(Object.entries(H).map(([B,K])=>{if(Array.isArray(K))return[B,K[0]??""];return[B,K]}));return $.readCallback(J,G)}),Y9[Q]={name:Q,description:$.description,uriTemplate:$.uriTemplate},Y9[Q]}function _K(Q){let $=Q;for(let[W,Y]of Object.entries(TK))$.registerResource(W,new A4(Y.uriTemplate,{list:Y.listCallback}),Y.metadata,async(X,J)=>{let H=Object.fromEntries(Object.entries(J).map(([G,B])=>{if(Array.isArray(B))return[G,B[0]??""];return[G,B]}));return Y.readCallback(X,H)})}var HX={};function h6(Q,$,W="stable",Y=!0){if(G8[Q])throw Error(`Prompt with name "${Q}" already exists.`);if(Y&&$.generate&&$.argsSchema){let X={name:Q,title:$.title||$.description,description:$.description,argsSchema:$.argsSchema.shape,generate:async(J)=>{return await $.generate(J)}};HX[Q]=X,NQ().registerPrompt(Q,{title:X.title,description:X.description,argsSchema:X.argsSchema},X.generate)}return G8[Q]={name:Q,arguments:$.argsSchema?.shape||{},description:$.description,enabled:Y,status:W},G8[Q]}function xK(){return HX}function yK(Q){let $=Q;for(let[W,Y]of Object.entries(HX))$.registerPrompt(W,{title:Y.title,description:Y.description,argsSchema:Y.argsSchema},Y.generate)}function X9(Q,$="image/png"){let W=typeof Q==="string"?Q:Q.url,Y=W;if(W.startsWith("data:")){let X=W.match(/^data:([^;]+);base64,(.+)$/);if(X)$=X[1]||$,Y=X[2]}return{content:[{type:"image",data:Y,mimeType:$}]}}function v0(Q){return(Project?.textures??Texture.all).find(({id:W,name:Y,uuid:X})=>W===Q||Y===Q||X===Q)||null}function n0(Q){let $=Group.all.find((W)=>W.name===Q);if(!$)throw Error(`Bone/group "${Q}" not found. Use the list_outline tool to see available groups and bones.`);return $}function B8(Q){let $=Mesh.all.find((W)=>W.uuid===Q||W.name===Q);if(!$)throw Error(`Mesh "${Q}" not found. Use the list_outline tool to see available meshes.`);return $}function A1(Q){let $=Outliner.elements.find((W)=>W.uuid===Q||W.name===Q)||Group.all.find((W)=>W.uuid===Q||W.name===Q);if(!$)throw Error(`Element "${Q}" not found. Use the list_outline tool to see available elements.`);return $}function r0(Q){let $=v0(Q);if(!$)throw Error(`Texture "${Q}" not found. Use the list_textures tool to see available textures.`);return $}function MQ(Q){let $=TextureGroup.all.find((W)=>W.uuid===Q||W.name===Q);if(!$)throw Error(`Material/texture group "${Q}" not found. Use the list_materials tool to see available materials.`);return $}function jQ(Q,$){let W=Q.find((Y)=>Y.pbr_channel===$);return W?{name:W.name,uuid:W.uuid,hasTexture:!0}:{hasTexture:!1}}function G6(Q){if(Q)return B8(Q);let $=Mesh.selected[0];if(!$)throw Error("No mesh selected and no mesh_id provided. Select a mesh or provide a mesh_id. Use the list_outline tool to see available meshes.");return $}function GX(Q){let $=Project;if(!$||Q!==void 0)$=ModelProject.all.find((X)=>X.name===Q||X.uuid===Q||X.selected);if(!$)throw Error("No project found in the Blockbench editor.");if(!$.selected)$.select();let W=Preview.selected;if(!W)throw Error("No preview available for the selected project.");let Y;if(Canvas.withoutGizmos(()=>{W.render(),Y=W.canvas.toDataURL()}),!Y)throw Error("Failed to capture preview screenshot.");return X9(Y,"image/png")}async function K8(){return new Promise((Q,$)=>{let W=!1,Y=setTimeout(()=>{if(!W)W=!0,$(Error("App screenshot timed out after 5 seconds."))},5000);Screencam.fullScreen({},(X)=>{if(!W)if(W=!0,clearTimeout(Y),X)Q(X9(X,"image/png"));else $(Error("Failed to capture app screenshot - no data returned."))})})}var gK=L.array(L.number()).length(2).describe("2D vector [x, y]."),n=L.array(L.number()).length(3).describe("3D vector [x, y, z]."),J9=L.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]),hK=L.enum(["normal","multiply","screen","overlay","soft_light","hard_light","color_dodge","color_burn","darken","lighten","difference","exclusion"]),tj=L.enum(["linear","catmullrom","bezier","step"]),F8=L.enum(["x","y","z"]),fK=F8.or(L.literal("all")),z4=L.enum(["rotation","position","scale"]),uK=L.enum(["select","add","remove","toggle"]),w4=L.enum(["square","circle"]),lK=L.enum(["0","1","2"]),f6=L.enum(["north","south","east","west","up","down"]),mK=L.enum(["unset","orthographic","perspective"]),cK=L.enum(["vertex","edge","face"]),pK=L.enum(["project","unwrap","cylinder","sphere"]),dK=L.enum(["color","color_connected","face","element","selected_elements","selection"]),iK=L.enum(["rectangle","rectangle_h","ellipse","ellipse_h"]),nK=L.enum(["copy","sample","pattern"]),BX=L.enum(["none","pressure","tilt"]),KX=L.enum(["color","normal","height","mer"]),rK=L.enum(["default","emissive","additive","layered"]),oK=L.enum(["auto","front","double"]),aK=L.enum(["once","loop","hold"]),tK=L.union([L.array(L.number().min(0).max(255)).length(4).describe("RGBA [R, G, B, A]"),L.string().regex(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/,"Hex color #RRGGBB or #RRGGBBAA"),L.string().regex(/^[a-z]{3,20}$/,"Named color")]),DQ=L.string().optional().describe("Color as hex string (e.g., #FF0000)."),EQ=L.object({start:L.number().describe("Start time in seconds."),end:L.number().describe("End time in seconds.")}),T0=L.string().describe("ID or name of the element."),K1=L.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),H9=L.string().describe("ID or name of the mesh."),m0=L.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),FX=L.string().describe("Texture ID or name."),G9=L.string().optional().describe("Animation UUID or name. If not provided, uses current animation."),B9=L.string().optional().describe("Group/bone ID or name."),RQ=L.string().describe("Name of the bone/group."),B6=L.string().optional().describe("ID or name of the cube. If not provided, uses selected cube."),sK=L.string().describe("ID or name of the cube."),LX=L.array(L.string()).optional().describe("Specific face keys. If not provided, uses all/selected faces."),u6=L.number().min(0).max(255).optional().describe("Opacity (0-255)."),PQ=L.number().min(1).max(100).optional().describe("Brush size."),O4=L.number().min(0).max(100).optional().describe("Brush softness percentage."),E1=L.object({x:L.number().describe("X coordinate."),y:L.number().describe("Y coordinate.")}),eK=L.enum(["-90","90","180"]),QF=L.enum(["left","right"]),$F=L.array(L.number()).length(3).describe("Stretch values [x, y, z]."),WF=L.array(L.number()).length(2).describe("Size [width, height]."),YF=L.object({name:L.string(),origin:n.optional().default([0,0,0]).describe("Pivot point of the cube."),from:n.optional().default([0,0,0]).describe("Starting point of the cube."),to:n.optional().default([1,1,1]).describe("Ending point of the cube."),rotation:n.optional().default([0,0,0]).describe("Rotation of the cube.")}),XF=L.object({name:L.string(),position:n.optional().default([0,0,0]).describe("Position of the mesh."),rotation:n.optional().default([0,0,0]).describe("Rotation of the mesh."),scale:n.optional().default([1,1,1]).describe("Scale of the mesh."),vertices:L.array(n.describe("Vertex coordinates in the mesh.")).optional().default([]).describe("Vertices of the mesh.")}),JF=L.object({time:L.number().describe("Time in seconds for the keyframe."),values:L.union([n,L.number()]).optional().describe("Values: [x,y,z] for position/rotation, number for uniform scale."),interpolation:tj.optional().default("linear").describe("Interpolation type for the keyframe."),bezier_handles:L.object({left_time:L.number().optional(),left_value:L.union([n,L.number()]).optional(),right_time:L.number().optional(),right_value:L.union([n,L.number()]).optional()}).optional().describe("Bezier handle positions for bezier interpolation.")}),HF=L.object({size:PQ,opacity:u6,softness:O4,shape:w4.optional().describe("Brush shape."),color:DQ.describe("Brush color as hex string."),blend_mode:J9.optional().describe("Brush blend mode.")}).optional().describe("Brush settings to apply.");var sj=L.object({project:L.string().optional().describe("Project name or UUID.")}),ej=L.object({}),QD=L.object({position:n.describe("Camera position."),target:n.optional().describe("Camera target position."),rotation:n.optional().describe("Camera rotation."),projection:mK.describe("Camera projection type.")}),K6=[{name:"capture_screenshot",description:"Returns the image data of the current view.",annotations:{title:"Capture Screenshot",readOnlyHint:!0},parameters:sj,status:d},{name:"capture_app_screenshot",description:"Returns the image data of the Blockbench app.",annotations:{title:"Capture App Screenshot",readOnlyHint:!0},parameters:ej,status:d},{name:"set_camera_angle",description:"Sets the camera angle to the specified value.",annotations:{title:"Set Camera Angle",destructiveHint:!0},parameters:QD,status:k}];function GF(){E(K6[0].name,{...K6[0],async execute({project:Q}){return GX(Q)}},K6[0].status),E(K6[1].name,{...K6[1],async execute(){return K8()}},K6[1].status),E(K6[2].name,{...K6[2],async execute(Q){let $=Preview.selected;if(!$)throw Error("No preview found in the Blockbench editor.");return $.loadAnglePreset({...Q}),GX()}},K6[2].status)}var $D=L.object({name:L.string().describe("Name of the animation"),loop:L.boolean().default(!1).describe("Whether the animation should loop"),animation_length:L.number().optional().describe("Length of the animation in seconds"),bones:L.record(L.array(L.object({time:L.number(),position:n.optional(),rotation:n.optional(),scale:L.union([n,L.number()]).optional()}))).describe("Keyframes for each bone"),particle_effects:L.record(L.string().describe("Effect name")).optional().describe("Particle effects with timestamps as keys")}),WD=L.object({animation_id:G9,action:L.enum(["create","delete","edit","select"]).describe("Action to perform on keyframes."),bone_name:RQ.describe("Name of the bone/group to manage keyframes for."),channel:z4.describe("Animation channel to modify."),keyframes:L.array(JF).describe("Keyframe data for the action.")}),YD=L.object({animation_id:G9,bone_name:RQ.describe("Name of the bone/group to modify curves for."),channel:z4.describe("Animation channel to modify."),axis:fK.default("all").describe("Axis to modify curves for."),action:L.enum(["smooth","linear","ease_in","ease_out","ease_in_out","stepped","custom"]).describe("Type of curve modification to apply."),keyframe_range:EQ.optional().describe("Time range to apply the curve modification. If not provided, applies to all keyframes."),custom_curve:L.object({control_point_1:L.array(L.number()).length(2).describe("First control point [time, value]."),control_point_2:L.array(L.number()).length(2).describe("Second control point [time, value].")}).optional().describe("Custom bezier curve control points (only for 'custom' action).")}),XD=L.object({action:L.enum(["create","parent","unparent","delete","rename","set_pivot","set_ik","mirror"]).describe("Action to perform on the bone structure."),bone_data:L.object({name:L.string().describe("Name of the bone."),parent:L.string().optional().describe("Parent bone name."),origin:n.optional().describe("Pivot point of the bone."),rotation:n.optional().describe("Initial rotation of the bone."),children:L.array(L.string()).optional().describe("Names of elements to add to this bone."),ik_enabled:L.boolean().optional().describe("Enable inverse kinematics for this bone."),ik_target:L.string().optional().describe("Target bone for IK chain."),mirror_axis:F8.optional().describe("Axis to mirror the bone across.")}).describe("Bone configuration data.")}),JD=L.object({action:L.enum(["play","pause","stop","set_time","set_length","set_fps","loop","select_range"]).describe("Timeline action to perform."),time:L.number().optional().describe("Time in seconds (for set_time action)."),length:L.number().optional().describe("Animation length in seconds (for set_length action)."),fps:L.number().min(1).max(120).optional().describe("Frames per second (for set_fps action)."),loop_mode:aK.optional().describe("Loop mode for the animation."),range:EQ.optional().describe("Time range for selection.")}),HD=L.object({selection:L.enum(["all","selected","range","pattern"]).default("selected").describe("Which keyframes to operate on."),range:EQ.optional().describe("Time range for keyframe selection."),pattern:L.object({interval:L.number().describe("Time interval between keyframes."),offset:L.number().optional().default(0).describe("Time offset for the pattern.")}).optional().describe("Pattern-based selection."),operation:L.enum(["offset","scale","reverse","mirror","smooth","bake"]).describe("Operation to perform on keyframes."),parameters:L.object({offset_time:L.number().optional().describe("Time offset to apply."),offset_values:n.optional().describe("Value offset to apply."),scale_factor:L.number().optional().describe("Scale factor for time or values."),scale_pivot:L.number().optional().describe("Pivot point for scaling."),mirror_axis:F8.optional().describe("Axis to mirror values across."),bake_interval:L.number().optional().describe("Interval for baking keyframes.")}).optional().describe("Operation-specific parameters.")}),GD=L.object({action:L.enum(["copy","paste","mirror_paste"]).describe("Copy or paste action."),source:L.object({animation:L.string().optional().describe("Source animation name or UUID."),bone:L.string().describe("Source bone name."),channels:L.array(z4).optional().default(["rotation","position","scale"]).describe("Channels to copy."),time_range:EQ.optional().describe("Time range to copy. If not provided, copies all keyframes.")}).optional().describe("Source data for copy operation."),target:L.object({animation:L.string().optional().describe("Target animation name or UUID."),bone:L.string().describe("Target bone name."),time_offset:L.number().optional().default(0).describe("Time offset for pasted keyframes."),mirror_axis:F8.optional().describe("Axis to mirror across for mirror_paste.")}).optional().describe("Target data for paste operation.")}),C0=[{name:"create_animation",description:"Creates a new animation with keyframes for bones.",annotations:{title:"Create Animation",destructiveHint:!0},parameters:$D,status:d},{name:"manage_keyframes",description:"Creates, deletes, or edits keyframes in the animation timeline for specific bones and channels.",annotations:{title:"Manage Keyframes",destructiveHint:!0},parameters:WD,status:k},{name:"animation_graph_editor",description:"Controls animation curves in the graph editor for fine-tuning animations.",annotations:{title:"Animation Graph Editor",destructiveHint:!0},parameters:YD,status:k},{name:"bone_rigging",description:"Creates and manipulates the bone structure (rig) of a model for animation.",annotations:{title:"Bone Rigging",destructiveHint:!0},parameters:XD,status:k},{name:"animation_timeline",description:"Controls the animation timeline, including playback, time scrubbing, and timeline settings.",annotations:{title:"Animation Timeline",destructiveHint:!0},parameters:JD,status:k},{name:"batch_keyframe_operations",description:"Performs batch operations on multiple keyframes at once.",annotations:{title:"Batch Keyframe Operations",destructiveHint:!0},parameters:HD,status:k},{name:"animation_copy_paste",description:"Copies and pastes animation data between bones or animations.",annotations:{title:"Animation Copy/Paste",destructiveHint:!0},parameters:GD,status:k}];function BF(){E(C0[0].name,{...C0[0],async execute({name:Q,loop:$,animation_length:W,bones:Y,particle_effects:X}){let J={loop:$,...W&&{animation_length:W},bones:Object.fromEntries(Object.entries(Y).map(([H,G])=>{let B=G.reduce((K,F)=>{let q=F.time.toString();if(F.position)(K.position??={})[q]=F.position;if(F.rotation)(K.rotation??={})[q]=F.rotation;if(F.scale)(K.scale??={})[q]=F.scale;return K},{});return[H,B]})),...X&&{particle_effects:X}};return Animator.loadFile({content:JSON.stringify({format_version:"1.8.0",animations:{[`animation.${Q}`]:J}})}),`Created animation "${Q}" with keyframes for ${Object.keys(Y).length} bones${X?` and ${Object.keys(X).length} particle effects`:""}`}},C0[0].status),E(C0[1].name,{...C0[1],async execute({animation_id:Q,action:$,bone_name:W,channel:Y,keyframes:X}){let J=Q?Animation.all.find((B)=>B.uuid===Q||B.name===Q):Animation.selected;if(!J)throw Error("No animation found or selected.");let H=n0(W),G=J.animators[H.uuid];if(!G)G=new BoneAnimator(H.uuid,J,W),J.animators[H.uuid]=G;switch(Undo.initEdit({animations:[J],keyframes:[]}),$){case"create":X.forEach((B)=>{let K=G.createKeyframe({time:B.time,channel:Y,values:B.values,interpolation:B.interpolation},B.time,Y,!1);if(B.interpolation==="bezier"&&B.bezier_handles){if(B.bezier_handles.left_time!==void 0)K.bezier_left_time=B.bezier_handles.left_time;if(B.bezier_handles.left_value)K.bezier_left_value=B.bezier_handles.left_value;if(B.bezier_handles.right_time!==void 0)K.bezier_right_time=B.bezier_handles.right_time;if(B.bezier_handles.right_value)K.bezier_right_value=B.bezier_handles.right_value}});break;case"delete":X.forEach((B)=>{let K=G[Y]?.find((F)=>Math.abs(F.time-B.time)<0.001);if(K)K.remove()});break;case"edit":X.forEach((B)=>{let K=G[Y]?.find((F)=>Math.abs(F.time-B.time)<0.001);if(K){if(B.values)K.set("values",B.values);if(B.interpolation)K.interpolation=B.interpolation;if(B.interpolation==="bezier"&&B.bezier_handles){if(B.bezier_handles.left_time!==void 0)K.bezier_left_time=B.bezier_handles.left_time;if(B.bezier_handles.left_value)K.bezier_left_value=B.bezier_handles.left_value;if(B.bezier_handles.right_time!==void 0)K.bezier_right_time=B.bezier_handles.right_time;if(B.bezier_handles.right_value)K.bezier_right_value=B.bezier_handles.right_value}}});break;case"select":Timeline.selected.empty(),X.forEach((B)=>{let K=G[Y]?.find((F)=>Math.abs(F.time-B.time)<0.001);if(K)K.select()});break}return Undo.finishEdit(`${$} keyframes`),Animator.preview(),`Successfully performed ${$} on ${X.length} keyframes for ${W}.${Y}`}},C0[1].status),E(C0[2].name,{...C0[2],async execute({animation_id:Q,bone_name:$,channel:W,axis:Y,action:X,keyframe_range:J,custom_curve:H}){let G=Q?Animation.all.find((q)=>q.uuid===Q||q.name===Q):Animation.selected;if(!G)throw Error("No animation found or selected.");let B=n0($),K=G.animators[B.uuid];if(!K||!K[W])throw Error(`No keyframes found for ${$}.${W}`);Undo.initEdit({animations:[G],keyframes:K[W]});let F=K[W].filter((q)=>{if(!J)return!0;return q.time>=J.start&&q.time<=J.end});return F.forEach((q,A)=>{switch(X){case"linear":q.interpolation="linear";break;case"stepped":q.interpolation="step";break;case"smooth":q.interpolation="catmullrom";break;case"ease_in":case"ease_out":case"ease_in_out":q.interpolation="bezier";let V=F[A+1];if(V){let U=V.time-q.time;if(q.bezier_left_time=0,q.bezier_right_time=U,X==="ease_in")q.bezier_right_time=U*0.6;else if(X==="ease_out")q.bezier_left_time=U*0.4;else q.bezier_left_time=U*0.3,q.bezier_right_time=U*0.7}break;case"custom":if(!H)throw Error("custom_curve is required for 'custom' action.");q.interpolation="bezier",q.bezier_left_time=H.control_point_1[0],q.bezier_left_value=[H.control_point_1[1],H.control_point_1[1],H.control_point_1[1]],q.bezier_right_time=H.control_point_2[0],q.bezier_right_value=[H.control_point_2[1],H.control_point_2[1],H.control_point_2[1]];break}}),Undo.finishEdit("Modify animation curves"),Animator.preview(),updateKeyframeSelection(),`Applied ${X} curve to ${F.length} keyframes in ${$}.${W}`}},C0[2].status),E(C0[3].name,{...C0[3],async execute({action:Q,bone_data:$}){Undo.initEdit({outliner:!0,elements:[],groups:[]});let W="";switch(Q){case"create":{let Y=new Group({name:$.name,origin:$.origin||[0,0,0],rotation:$.rotation||[0,0,0]}).init();if($.parent){let X=Group.all.find((J)=>J.name===$.parent);if(X)Y.addTo(X)}if($.children)$.children.forEach((X)=>{let J=Outliner.elements.find((H)=>H.name===X);if(J)J.addTo(Y)});if($.ik_enabled&&$.ik_target)Y.ik_enabled=!0,Y.ik_target=$.ik_target;W=`Created bone "${Y.name}" with UUID ${Y.uuid}`;break}case"parent":{let Y=n0($.name),X=$.parent?Group.all.find((J)=>J.name===$.parent):"root";Y.addTo(X),W=`Parented "${$.name}" to "${$.parent||"root"}"`;break}case"unparent":{n0($.name).addTo("root"),W=`Unparented "${$.name}"`;break}case"delete":{n0($.name).remove(),W=`Deleted bone "${$.name}"`;break}case"rename":{let Y=n0($.name),X=$.children?.[0]||"new_name";Y.name=X,W=`Renamed bone to "${X}"`;break}case"set_pivot":{let Y=n0($.name);if($.origin)Y.origin=$.origin;W=`Set pivot point for "${$.name}"`;break}case"set_ik":{let Y=n0($.name);if(Y.ik_enabled=$.ik_enabled||!1,$.ik_target)Y.ik_target=$.ik_target;W=`Updated IK settings for "${$.name}"`;break}case"mirror":{let Y=n0($.name),X=$.mirror_axis||"x",J=Y.duplicate(),H=X==="x"?0:X==="y"?1:2;J.origin[H]*=-1,J.name=Y.name.includes("left")?Y.name.replace("left","right"):Y.name.includes("right")?Y.name.replace("right","left"):Y.name+"_mirrored",W=`Mirrored bone "${$.name}" across ${X} axis`;break}}return Undo.finishEdit(`Bone rigging: ${Q}`),Canvas.updateAll(),W}},C0[3].status),E(C0[4].name,{...C0[4],async execute({action:Q,time:$,length:W,fps:Y,loop_mode:X,range:J}){if(!Animation.selected)throw Error("No animation selected.");let H="";switch(Q){case"play":Timeline.start(),H="Started animation playback";break;case"pause":Timeline.pause(),H="Paused animation playback";break;case"stop":Timeline.setTime(0),Timeline.pause(),H="Stopped animation playback";break;case"set_time":if($===void 0)throw Error("Time parameter required for set_time action.");Timeline.setTime($),H=`Set timeline to ${$} seconds`;break;case"set_length":if(W===void 0)throw Error("Length parameter required for set_length action.");Animation.selected.length=W,H=`Set animation length to ${W} seconds`;break;case"set_fps":if(Y===void 0)throw Error("FPS parameter required for set_fps action.");Animation.selected.snapping=Y,H=`Set animation FPS to ${Y}`;break;case"loop":if(X)Animation.selected.loop=X;H=`Set loop mode to ${X||Animation.selected.loop}`;break;case"select_range":if(!J)throw Error("Range parameter required for select_range action.");Timeline.keyframes.forEach((G)=>{if(G.time>=J.start&&G.time<=J.end)G.select();else G.selected=!1}),H=`Selected keyframes between ${J.start} and ${J.end} seconds`;break}return Animator.preview(),H}},C0[4].status),E(C0[5].name,{...C0[5],async execute({selection:Q,range:$,pattern:W,operation:Y,parameters:X={}}){if(!Animation.selected)throw Error("No animation selected.");let J=[];switch(Q){case"all":J=Timeline.keyframes;break;case"selected":J=Timeline.selected;break;case"range":if(!$)throw Error("Range required for range selection.");J=Timeline.keyframes.filter((H)=>H.time>=$.start&&H.time<=$.end);break;case"pattern":if(!W)throw Error("Pattern required for pattern selection.");J=Timeline.keyframes.filter((H)=>{let G=H.time-W.offset;return Math.abs(G%W.interval)<0.001});break}if(J.length===0)throw Error("No keyframes found matching selection criteria.");switch(Undo.initEdit({keyframes:J}),Y){case"offset":J.forEach((U)=>{if(X.offset_time!==void 0)U.time+=X.offset_time;if(X.offset_values){let z=U.getArray();U.set("values",[z[0]+X.offset_values[0],z[1]+X.offset_values[1],z[2]+X.offset_values[2]])}});break;case"scale":let H=X.scale_pivot||0,G=X.scale_factor||1;J.forEach((U)=>{U.time=H+(U.time-H)*G});break;case"reverse":let B=J.map((U)=>U.time),K=Math.min(...B),F=Math.max(...B);J.forEach((U)=>{U.time=F-(U.time-K)});break;case"mirror":if(!X.mirror_axis)throw Error("Mirror axis required for mirror operation.");let q=X.mirror_axis==="x"?0:X.mirror_axis==="y"?1:2;J.forEach((U)=>{let z=U.getArray();z[q]*=-1,U.set("values",z)});break;case"smooth":J.forEach((U)=>{U.interpolation="catmullrom"});break;case"bake":let A=X.bake_interval||1/Animation.selected.snapping;new Set(J.map((U)=>U.animator)).forEach((U)=>{["rotation","position","scale"].forEach((w)=>{let O=U[w];if(!O||O.length<2)return;let D=Math.min(...O.map((S)=>S.time)),j=Math.max(...O.map((S)=>S.time));for(let S=D;S<=j;S+=A)if(!O.find((C)=>Math.abs(C.time-S)<0.001))Timeline.time=S,U.fillValues(U.createKeyframe({time:S,channel:w,values:U.interpolate(w,!0)},S,w,!1),null,!1)})});break}return Undo.finishEdit(`Batch keyframe operation: ${Y}`),Animator.preview(),`Performed ${Y} on ${J.length} keyframes`}},C0[5].status),E(C0[6].name,{...C0[6],async execute({action:Q,source:$,target:W}){if(!global.animationClipboard)global.animationClipboard=null;switch(Q){case"copy":{if(!$)throw Error("Source data required for copy operation.");let Y=$.animation?Animation.all.find((G)=>G.uuid===$.animation||G.name===$.animation):Animation.selected;if(!Y)throw Error("Source animation not found.");let X=n0($.bone),J=Y.animators[X.uuid];if(!J)throw Error(`No animation data for bone "${$.bone}".`);let H={bone_name:$.bone,channels:{}};return $.channels.forEach((G)=>{if(!J[G])return;let B=J[G];if($.time_range)B=B.filter((K)=>K.time>=$.time_range.start&&K.time<=$.time_range.end);H.channels[G]=B.map((K)=>({time:K.time,values:K.getArray(),interpolation:K.interpolation,bezier_left_time:K.bezier_left_time,bezier_left_value:K.bezier_left_value,bezier_right_time:K.bezier_right_time,bezier_right_value:K.bezier_right_value}))}),global.animationClipboard=H,`Copied animation data from "${$.bone}" (${Object.keys(H.channels).join(", ")})`}case"paste":case"mirror_paste":{if(!W)throw Error("Target data required for paste operation.");if(!global.animationClipboard)throw Error("No animation data in clipboard. Copy first.");let Y=W.animation?Animation.all.find((K)=>K.uuid===W.animation||K.name===W.animation):Animation.selected;if(!Y)throw Error("Target animation not found.");let X=n0(W.bone),J=Y.animators[X.uuid];if(!J)J=new BoneAnimator(X.uuid,Y,W.bone),Y.animators[X.uuid]=J;Undo.initEdit({animations:[Y],keyframes:[]});let H=global.animationClipboard,G=Q==="mirror_paste"?W.mirror_axis||"x":null,B=G==="x"?0:G==="y"?1:G==="z"?2:-1;return Object.entries(H.channels).forEach(([K,F])=>{F.forEach((q)=>{let A=[...q.values];if(G&&(K==="rotation"||K==="position"))A[B]*=-1;let V=J.createKeyframe({time:q.time+(W.time_offset||0),channel:K,values:A,interpolation:q.interpolation},q.time+(W.time_offset||0),K,!1);if(q.interpolation==="bezier"){if(q.bezier_left_time!==void 0)V.bezier_left_time=q.bezier_left_time;if(q.bezier_left_value)V.bezier_left_value=q.bezier_left_value;if(q.bezier_right_time!==void 0)V.bezier_right_time=q.bezier_right_time;if(q.bezier_right_value)V.bezier_right_value=q.bezier_right_value}})}),Undo.finishEdit(`${Q} animation data`),Animator.preview(),`Pasted animation data to "${W.bone}"${G?` (mirrored on ${G} axis)`:""}`}}}},C0[6].status)}var BD=L.object({elements:L.array(YF).min(1).describe("Array of cubes to place."),texture:L.string().optional().describe("Texture ID or name to apply to the cube."),group:L.string().optional().describe("Group/bone to which the cube belongs."),faces:L.union([L.array(L.enum(["north","south","east","west","up","down"])).describe("Array of faces to apply the texture to."),L.boolean().optional().describe("Whether to apply the texture to all faces. Set to `true` to enable auto UV mapping."),L.array(L.object({face:L.enum(["north","south","east","west","up","down"]).describe("Face to apply the texture to."),uv:L.array(L.number()).length(4).describe("Custom UV mapping for the face.")})).describe("Array of faces with custom UV mapping.")]).optional().default(!0).describe("Faces to apply the texture to. Set to `true` to enable auto UV mapping.")}),KD=L.object({id:L.string().optional().describe("ID or name of the cube to modify. Defaults to selected, which could be more than one."),name:L.string().optional().describe("New name of the cube."),origin:L.array(L.number()).length(3).optional().describe("Pivot point of the cube."),from:L.array(L.number()).length(3).optional().describe("Starting point of the cube."),to:L.array(L.number()).length(3).optional().describe("Ending point of the cube."),rotation:L.array(L.number()).length(3).optional().describe("Rotation of the cube."),autouv:L.enum(["0","1","2"]).optional().describe("Auto UV setting. 0 = disabled, 1 = enabled, 2 = relative auto UV."),uv_offset:L.array(L.number()).length(2).optional().describe("UV offset for the texture."),mirror_uv:L.boolean().optional().describe("Whether to mirror the UVs."),shade:L.boolean().optional().describe("Whether to apply shading to the cube."),inflate:L.number().optional().describe("Inflation amount for the cube."),color:L.number().optional().describe("Single digit to represent a color from a palette."),visibility:L.boolean().optional().describe("Whether the cube is visible or not.")}),K9=[{name:"place_cube",description:"Places a cube of the given size at the specified position. Texture and group are optional.",annotations:{title:"Place Cube",destructiveHint:!0},parameters:BD,status:d},{name:"modify_cube",description:"Modifies the cube with the given ID. Auto UV setting: saved as an integer, where 0 means disabled, 1 means enabled, and 2 means relative auto UV (cube position affects UV)",annotations:{title:"Modify Cube",destructiveHint:!0},parameters:KD,status:d}];function KF(){E(K9[0].name,{...K9[0],async execute({elements:Q,texture:$,faces:W,group:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let X=Q.length,J=$?v0($):Texture.getDefault();if(!J)throw Error(`No texture found for "${$}".`);let H=getAllGroups(),G=Y==="root"?"root":H.find((F)=>F.name===Y||F.uuid===Y)??"root",B=W===!0||Array.isArray(W)&&W.every((F)=>typeof F==="string"),K=Q.map((F)=>{let q=new Cube({autouv:B?1:0,name:F.name,from:F.from,to:F.to,origin:F.origin,rotation:F.rotation}).init();if(q.addTo(G),!B&&Array.isArray(W))W.forEach(({face:A,uv:V})=>{q.faces[A].extend({uv:V})});else q.applyTexture(J,W!==!1?W:void 0),q.mapAutoUV();return q});return Undo.finishEdit("Agent placed cubes"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(K.map((F)=>`Added cube ${F.name} with ID ${F.uuid}`)))}},K9[0].status),E(K9[1].name,{...K9[1],async execute({id:Q,name:$,origin:W,from:Y,to:X,rotation:J,uv_offset:H,autouv:G,mirror_uv:B,shade:K,inflate:F,color:q,visibility:A}){let V;if(Q){if(V=(Cube.all??[]).filter((U)=>U.uuid===Q||U.name===Q),!V.length)throw Error(`Cube with ID "${Q}" not found. Use the list_outline tool to see available cubes.`)}else if(V=Cube.selected,!V.length)throw Error("No cube selected and no id provided. Select a cube or provide an id.");return Undo.initEdit({elements:Array.isArray(V)?V:[V],outliner:!0,collections:[]}),V.forEach((U)=>{let z=W??U.origin,w=Y??U.from,O=X??U.to,D=J??U.rotation,j=H??U.uv_offset;U.extend({name:$??U.name,origin:z,from:w,to:O,rotation:D,uv_offset:j,autouv:G?Number(G):U.autouv,mirror_uv:Boolean(B??U.mirror_uv),inflate:F??U.inflate,color:q??U.color,visibility:A??U.visibility,shade:K??U.shade})}),Undo.finishEdit("Agent modified cubes"),Canvas.updateAll(),`Modified cubes ${V.map((U)=>U.name).join(", ")} with IDs ${V.map((U)=>U.uuid).join(", ")}`}},K9[1].status)}var FD=L.object({id:T0.describe("ID or name of the element to remove.")}),LD=L.object({name:L.string(),origin:n,rotation:n,parent:L.string().optional().default("root"),visibility:L.boolean().optional().default(!0),autouv:lK.optional().default("0").describe("Auto UV setting. 0 = disabled, 1 = enabled, 2 = relative auto UV."),selected:L.boolean().optional().default(!1),shade:L.boolean().optional().default(!1)}),qD=L.object({}),VD=L.object({id:T0.describe("ID or name of the element to duplicate."),offset:n.optional().default([0,0,0]),newName:L.string().optional()}),UD=L.object({id:T0.describe("ID or name of the element to rename."),new_name:L.string().describe("New name to assign.")}),$1=[{name:"remove_element",description:"Removes the element with the given ID.",annotations:{title:"Remove Element",destructiveHint:!0},parameters:FD,status:k},{name:"add_group",description:"Adds a new group with the given name and options.",annotations:{title:"Add Group",destructiveHint:!0},parameters:LD,status:d},{name:"list_outline",description:"Returns a list of all groups and their children in the Blockbench editor.",annotations:{title:"List Outline",readOnlyHint:!0},parameters:qD,status:d},{name:"duplicate_element",description:"Duplicates a cube, mesh or group by ID or name.  You may offset the duplicate or assign a new name.",annotations:{title:"Duplicate Element",destructiveHint:!0},parameters:VD,status:k},{name:"rename_element",description:"Renames a cube, mesh or group by ID or name.",annotations:{title:"Rename Element",destructiveHint:!0},parameters:UD,status:k}];function FF(){E($1[0].name,{...$1[0],async execute({id:Q}){let $=A1(Q);return Undo.initEdit({elements:[],outliner:!0,collections:[]}),$.remove(),Undo.finishEdit("Agent removed element"),Canvas.updateAll(),`Removed element with ID ${Q}`}},$1[0].status),E($1[1].name,{...$1[1],async execute({name:Q,origin:$,rotation:W,parent:Y,visibility:X,autouv:J,selected:H,shade:G}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let B=new Group({name:Q,origin:$,rotation:W,autouv:Number(J),visibility:Boolean(X),selected:Boolean(H),shade:Boolean(G)}).init(),K=Y==="root"?"root":getAllGroups().find((F)=>F.name===Y||F.uuid===Y);return B.addTo(K),Undo.finishEdit("Agent added group"),Canvas.updateAll(),`Added group ${B.name} with ID ${B.uuid}`}},$1[1].status),E($1[2].name,{...$1[2],async execute(){let Q=Outliner.elements;return JSON.stringify(Q.map(($)=>{let{name:W,uuid:Y}=$;return{name:W,uuid:Y}}),null,2)}},$1[2].status),E($1[3].name,{...$1[3],async execute({id:Q,offset:$,newName:W}){let Y=A1(Q);function X(K,F){let q=new Cube({name:W||`${K.name}_copy`,from:K.from.map((A,V)=>A+$[V]),to:K.to.map((A,V)=>A+$[V]),origin:K.origin.map((A,V)=>A+$[V]),rotation:K.rotation,autouv:K.autouv,uv_offset:K.uv_offset,mirror_uv:K.mirror_uv,shade:K.shade,inflate:K.inflate,color:K.color,visibility:K.visibility}).init();return q.addTo(F),q}function J(K,F){let q=new Group({name:W||`${K.name}_copy`,origin:K.origin.map((A,V)=>A+$[V]),rotation:K.rotation,autouv:K.autouv,selected:K.selected,shade:K.shade,visibility:K.visibility}).init();return q.addTo(F),K.children.forEach((A)=>G(A,q)),q}function H(K,F){let q=new Mesh({name:W||`${K.name}_copy`,vertices:{},origin:K.origin.map((V,U)=>V+$[U]),rotation:K.rotation}).init(),A={};if(Object.entries(K.vertices).forEach(([V,U])=>{A[V]=q.addVertices([U[0]+$[0],U[1]+$[1],U[2]+$[2]])[0]}),K.faces.forEach((V)=>{q.addFaces(new MeshFace(q,{vertices:V.vertices.map((U)=>A[U]),uv:V.uv}))}),q.addTo(F),K.material)q.applyTexture(K.material);return q}function G(K,F){if(K instanceof Cube)return X(K,F);if(K instanceof Group)return J(K,F);if(K instanceof Mesh)return H(K,F);throw Error("Unsupported element type.")}Undo.initEdit({elements:[],outliner:!0,collections:[]});let B=G(Y,Y.parent??Outliner);return Undo.finishEdit("Agent duplicated element"),Canvas.updateAll(),`Duplicated "${Y.name}" as "${B.name}" (ID: ${B.uuid}).`}},$1[3].status),E($1[4].name,{...$1[4],async execute({id:Q,new_name:$}){let W=A1(Q);return Undo.initEdit({elements:[W],outliner:!0,collections:[]}),W.extend({name:$}),Undo.finishEdit("Agent renamed element"),Canvas.updateAll(),`Renamed element "${Q}" to "${$}".`}},$1[4].status)}var AD=L.object({geojson:L.string().describe("Path to the GeoJSON file or data URL, or the GeoJSON string itself.")}),qX=[{name:"from_geo_json",description:"Imports a model from a GeoJSON file.",annotations:{title:"Import GeoJSON",destructiveHint:!0},parameters:AD,status:d}];function LF(){E(qX[0].name,{...qX[0],async execute({geojson:Q}){if(!Q.startsWith("{")&&!Q.startsWith("[")){let $;try{$=new URL(Q)}catch{throw Error(`Invalid URL or file path: "${Q}". Expected a URL (http/https) or inline GeoJSON.`)}if($.protocol!=="http:"&&$.protocol!=="https:")throw Error(`Unsupported protocol "${$.protocol}". Only http: and https: URLs are allowed.`);let W=$.hostname.toLowerCase();if([].some((J)=>J.test(W)))throw Error(`Blocked request to address "${W}".`);let X=await fetch($.href);if(!X.ok)throw Error(`Failed to fetch GeoJSON from "${$.href}": ${X.status} ${X.statusText}`);Q=await X.text()}if(typeof Q!=="string")throw Error("Invalid GeoJSON input. Expected a string.");return Codecs.bedrock.parse(JSON.parse(Q),""),new Promise(($,W)=>{setTimeout(()=>{K8().then($).catch(W)},3000)})}},qX[0].status)}var zD=L.object({elements:L.array(XF).min(1).describe("Array of meshes to place."),texture:m0.describe("Texture ID or name to apply to the mesh."),group:B9.describe("Group/bone to which the mesh belongs.")}),wD=L.object({mesh_id:K1,distance:L.number().default(1).describe("Distance to extrude."),mode:L.enum(["faces","edges","vertices"]).default("faces").describe("What to extrude: faces, edges, or vertices.")}),OD=L.object({mesh_id:K1,cuts:L.number().min(1).max(10).default(1).describe("Number of subdivision cuts to make.")}),ND=L.object({elements:L.array(L.object({name:L.string().describe("Name of the sphere."),position:n.describe("Position of the sphere center."),diameter:L.number().min(1).max(64).default(16).describe("Diameter of the sphere."),sides:L.number().min(3).max(48).default(12).describe("Number of horizontal divisions (affects sphere quality)."),rotation:n.optional().default([0,0,0]).describe("Rotation of the sphere."),align_edges:L.boolean().optional().default(!0).describe("Whether to align edges for better geometry.")})).min(1).describe("Array of spheres to create."),texture:m0.describe("Texture ID or name to apply to the sphere."),group:B9.describe("Group/bone to which the sphere belongs.")}),MD=L.object({mesh_id:H9.describe("ID or name of the mesh to select elements from."),mode:cK.describe("Selection mode."),elements:L.array(L.union([L.string().describe("Vertex key, edge as 'vkey1-vkey2', or face key"),L.number().describe("Index of the element")])).optional().describe("Specific elements to select. If not provided, selects all."),action:uK.default("select").describe("Selection action: select (replace), add, remove, or toggle.")}),jD=L.object({mesh_id:K1,offset:n.describe("Offset to move vertices by [x, y, z]."),vertices:L.array(L.string()).optional().describe("Specific vertex keys to move. If not provided, moves all selected vertices.")}),DD=L.object({mesh_id:K1,mode:L.enum(["vertices","edges","faces"]).default("faces").describe("What to delete: vertices, edges, or faces."),keep_vertices:L.boolean().default(!1).describe("When deleting faces/edges, whether to keep the vertices.")}),ED=L.object({mesh_id:H9,threshold:L.number().min(0).max(10).default(0.1).describe("Maximum distance between vertices to merge."),selected_only:L.boolean().default(!0).describe("Whether to only merge selected vertices.")}),RD=L.object({mesh_id:K1,vertices:L.array(L.string()).min(3).max(4).describe("Vertex keys to create face from. Must be 3 or 4 vertices."),texture:m0.describe("Texture ID or name to apply to the new face.")}),PD=L.object({elements:L.array(L.object({name:L.string(),position:n,height:L.number().min(1).max(64).default(16),diameter:L.number().min(1).max(64).default(16),sides:L.number().min(3).max(64).default(12),rotation:n.optional().default([0,0,0]),capped:L.boolean().optional().default(!0)})).min(1),texture:m0,group:B9}),ID=L.object({mesh_id:H9.describe("ID or name of the mesh to cut."),points:L.array(L.object({position:n.describe("3D position of the cut point."),face:L.string().optional().describe("Face key to attach the point to.")})).min(2).describe("Points defining the cut path.")}),B0=[{name:"place_mesh",description:"Places a mesh at the specified position. Texture and group are optional.",annotations:{title:"Place Mesh",destructiveHint:!0},parameters:zD,status:k},{name:"extrude_mesh",description:"Extrudes selected faces or edges of a mesh.",annotations:{title:"Extrude Mesh",destructiveHint:!0},parameters:wD,status:k},{name:"subdivide_mesh",description:"Subdivides selected faces of a mesh to create more geometry.",annotations:{title:"Subdivide Mesh",destructiveHint:!0},parameters:OD,status:k},{name:"create_sphere",description:"Creates a sphere mesh at the specified position with the given parameters. The sphere is created as a mesh with vertices and faces using spherical coordinates.",annotations:{title:"Create Sphere",destructiveHint:!0},parameters:ND,status:d},{name:"select_mesh_elements",description:"Selects vertices, edges, or faces of a mesh for manipulation.",annotations:{title:"Select Mesh Elements",destructiveHint:!0},parameters:MD,status:k},{name:"move_mesh_vertices",description:"Moves selected vertices of a mesh by the specified offset.",annotations:{title:"Move Mesh Vertices",destructiveHint:!0},parameters:jD,status:k},{name:"delete_mesh_elements",description:"Deletes selected vertices, edges, or faces from a mesh.",annotations:{title:"Delete Mesh Elements",destructiveHint:!0},parameters:DD,status:k},{name:"merge_mesh_vertices",description:"Merges vertices that are within a specified distance of each other.",annotations:{title:"Merge Mesh Vertices",destructiveHint:!0},parameters:ED,status:k},{name:"create_mesh_face",description:"Creates a new face from selected vertices.",annotations:{title:"Create Mesh Face",destructiveHint:!0},parameters:RD,status:k},{name:"create_cylinder",description:"Creates one or more cylinder meshes with optional end caps.",annotations:{title:"Create Cylinder",destructiveHint:!0},parameters:PD,status:k},{name:"knife_tool",description:"Uses the knife tool to cut custom edges into mesh faces.",annotations:{title:"Knife Tool",destructiveHint:!0},parameters:ID,status:k}];function qF(){E(B0[0].name,{...B0[0],async execute({elements:Q,texture:$,group:W},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let X=Q.length,J=$?v0($):Texture.getDefault();if(!J)throw Error(`No texture found for "${$}".`);let H=getAllGroups(),G=W==="root"?"root":H.find((K)=>K.name===W||K.uuid===W)??"root",B=Q.map((K,F)=>{let q=new Mesh({name:K.name,vertices:{}}).init();return K.vertices.forEach((A)=>{q.addVertices(A)}),q.addTo(G),q.applyTexture(J),Y({progress:F,total:X}),q});return Undo.finishEdit("Agent placed meshes"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(B.map((K)=>`Added mesh ${K.name} with ID ${K.uuid}`)))}},B0[0].status),E(B0[1].name,{...B0[1],async execute({mesh_id:Q,distance:$,mode:W}){let Y=G6(Q),X=BarItems.extrude_mesh_selection;if(!X)throw Error(`Extrude tool for ${W} not found.`);return X.click({},$),`Extruded ${W} of mesh "${Y.name}" by ${$} units`}},B0[1].status),E(B0[2].name,{...B0[2],async execute({mesh_id:Q,cuts:$}){let W=G6(Q),Y=BarItems.loop_cut;if(!Y)throw Error("Loop cut tool not found.");return Y.click({},void 0,void 0,$),`Subdivided mesh "${W.name}" with ${$} cuts`}},B0[2].status),E(B0[3].name,{...B0[3],async execute({elements:Q,texture:$,group:W},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let X=Q.length,J=$?v0($):Texture.getDefault();if(!J)throw Error(`No texture found for "${$}".`);let H=getAllGroups(),G=W==="root"?"root":H.find((K)=>K.name===W||K.uuid===W)??"root",B=Q.map((K,F)=>{let q=new Mesh({name:K.name,vertices:{},origin:K.position,rotation:K.rotation||[0,0,0]}).init(),A=K.diameter/2,V=Math.round(K.sides/2)*2,[U]=q.addVertices([0,-A,0]),[z]=q.addVertices([0,A,0]),w=[],O=K.align_edges?0.5:0;for(let D=0;D<K.sides;D++){let j=Math.sin((D+O)/K.sides*Math.PI*2),S=Math.cos((D+O)/K.sides*Math.PI*2),C=[];for(let K0=1;K0<V/2;K0++){let b0=Math.sin(K0/V*Math.PI*2)*A,f1=j*b0,q6=Math.cos(K0/V*Math.PI*2)*A,u1=S*b0;C.push(...q.addVertices([f1,q6,u1]))}w.push(C)}for(let D=0;D<K.sides;D++){let j=w[D],S=w[D+1]||w[0];for(let C=0;C<V/2;C++){if(C==0){q.addFaces(new MeshFace(q,{vertices:[j[C],S[C],z],uv:{}}));continue}if(!j[C]){q.addFaces(new MeshFace(q,{vertices:[S[C-1],j[C-1],U],uv:{}}));continue}q.addFaces(new MeshFace(q,{vertices:[j[C],S[C],j[C-1],S[C-1]],uv:{}}))}}if(q.addTo(G),J)q.applyTexture(J);return Y({progress:F,total:X}),q});return Undo.finishEdit("Agent created spheres"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(B.map((K)=>`Added sphere ${K.name} with ID ${K.uuid}`)))}},B0[3].status),E(B0[4].name,{...B0[4],async execute({mesh_id:Q,mode:$,elements:W,action:Y}){let X=B8(Q);Undo.initEdit({elements:[X],selection:!0,collections:[]}),BarItems.selection_mode.set($);let J=Project?.mesh_selection[X.uuid]??{vertices:[],edges:[],faces:[]};if(Y==="select")J.vertices=[],J.edges.length=0,J.faces=[];if(!W||W.length===0){if($==="vertex")J.vertices=Object.keys(X.vertices);else if($==="face")J.faces=Object.keys(X.faces);else if($==="edge"){let H=[],G=new Set;for(let K in X.faces){let q=X.faces[K].getEdges();for(let[A,V]of q){let U=A<V?`${A}-${V}`:`${V}-${A}`;if(!G.has(U))G.add(U),H.push([A,V])}}let B=J.edges;B.length=0,B.push(...H)}}else W.forEach((H)=>{if($==="vertex"){let G=String(H);if(Y==="add"||Y==="select"){if(!J.vertices.includes(G))J.vertices.push(G)}else if(Y==="remove")J.vertices=J.vertices.filter((B)=>B!==G);else if(Y==="toggle")if(J.vertices.includes(G))J.vertices=J.vertices.filter((B)=>B!==G);else J.vertices.push(G)}else if($==="face"){let G=String(H);if(Y==="add"||Y==="select"){if(!J.faces.includes(G))J.faces.push(G)}else if(Y==="remove")J.faces=J.faces.filter((B)=>B!==G);else if(Y==="toggle")if(J.faces.includes(G))J.faces=J.faces.filter((B)=>B!==G);else J.faces.push(G)}else if($==="edge"){let G=String(H).split("-");if(G.length===2){let B=[G[0],G[1]],K=J.edges;if(Y==="add"||Y==="select")K.push(B);else if(Y==="remove"){let F=K.filter((q)=>!(q[0]===B[0]&&q[1]===B[1])&&!(q[0]===B[1]&&q[1]===B[0]));K.length=0,K.push(...F)}else if(Y==="toggle")if(K.some((q)=>q[0]===B[0]&&q[1]===B[1]||q[0]===B[1]&&q[1]===B[0])){let q=K.filter((A)=>!(A[0]===B[0]&&A[1]===B[1])&&!(A[0]===B[1]&&A[1]===B[0]));K.length=0,K.push(...q)}else K.push(B)}}});return X.select(),Canvas.updateView({elements:[X],selection:!0}),Undo.finishEdit("Select mesh elements"),JSON.stringify({mesh:X.name,mode:$,selected:{vertices:J.vertices.length,edges:J.edges.length,faces:J.faces.length}})}},B0[4].status),E(B0[5].name,{...B0[5],async execute({mesh_id:Q,offset:$,vertices:W}){let Y=G6(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let X=W||Y.getSelectedVertices();return X.forEach((J)=>{if(Y.vertices[J])Y.vertices[J][0]+=$[0],Y.vertices[J][1]+=$[1],Y.vertices[J][2]+=$[2]}),Y.preview_controller.updateGeometry(Y),Undo.finishEdit("Move mesh vertices"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Moved ${X.length} vertices of mesh "${Y.name}"`}},B0[5].status),E(B0[6].name,{...B0[6],async execute({mesh_id:Q,mode:$,keep_vertices:W}){let Y=G6(Q),X=BarItems.delete_mesh_selection;if(!X)throw Error("Delete mesh selection tool not found.");return X.click({},W),`Deleted selected ${$} from mesh "${Y.name}"`}},B0[6].status),E(B0[7].name,{...B0[7],async execute({mesh_id:Q,threshold:$,selected_only:W}){let Y=B8(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let X=W?Y.getSelectedVertices():Object.keys(Y.vertices),J=0,H={};for(let G=0;G<X.length;G++){let B=X[G];if(H[B])continue;for(let K=G+1;K<X.length;K++){let F=X[K];if(H[F])continue;let q=Y.vertices[B],A=Y.vertices[F];if(Math.sqrt((q[0]-A[0])**2+(q[1]-A[1])**2+(q[2]-A[2])**2)<=$)H[F]=B,J++}}return Object.entries(H).forEach(([G,B])=>{for(let K in Y.faces){let F=Y.faces[K],q=F.vertices.indexOf(G);if(q!==-1)F.vertices[q]=B,F.uv[B]=F.uv[G]||[0,0],delete F.uv[G]}delete Y.vertices[G]}),Y.preview_controller.updateGeometry(Y),Undo.finishEdit("Merge mesh vertices"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Merged ${J} vertices in mesh "${Y.name}"`}},B0[7].status),E(B0[8].name,{...B0[8],async execute({mesh_id:Q,vertices:$,texture:W}){let Y=G6(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let X=new MeshFace(Y,{vertices:$,texture:W?v0(W)?.uuid:void 0}),[J]=Y.addFaces(X);return UVEditor.setAutoSize(null,!0,[J]),Y.preview_controller.updateGeometry(Y),Y.preview_controller.updateUV(Y),Undo.finishEdit("Create mesh face"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Created face with ${$.length} vertices in mesh "${Y.name}"`}},B0[8].status),E(B0[9].name,{...B0[9],async execute({elements:Q,texture:$,group:W},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let X=Q.length,J=$?v0($):Texture.getDefault();if(!J)throw Error(`Texture "${$}" not found.`);let H=getAllGroups(),G=W==="root"?"root":H.find((K)=>K.name===W||K.uuid===W)??"root",B=Q.map((K,F)=>{let q=new Mesh({name:K.name,vertices:{},origin:K.position,rotation:K.rotation||[0,0,0]}).init(),A=K.diameter/2,V=K.height,U=Math.round(K.sides),z=q.addVertices([0,V/2,0])[0],w=q.addVertices([0,-V/2,0])[0],O=[],D=[];for(let j=0;j<U;j++){let S=j/U*Math.PI*2,C=Math.cos(S)*A,K0=Math.sin(S)*A;O.push(q.addVertices([C,V/2,K0])[0]),D.push(q.addVertices([C,-V/2,K0])[0])}for(let j=0;j<U;j++){let S=(j+1)%U;if(q.addFaces(new MeshFace(q,{vertices:[D[j],D[S],O[S],O[j]],uv:{}})),K.capped)q.addFaces(new MeshFace(q,{vertices:[O[j],O[S],z],uv:{}})),q.addFaces(new MeshFace(q,{vertices:[D[S],D[j],w],uv:{}}))}if(q.addTo(G),J)q.applyTexture(J);return Y({progress:F,total:X}),q});return Undo.finishEdit("Agent created cylinders"),Canvas.updateAll(),JSON.stringify(B.map((K)=>`Added cylinder ${K.name} (ID ${K.uuid})`))}},B0[9].status),E(B0[10].name,{...B0[10],async execute({mesh_id:Q,points:$}){let W=B8(Q);Undo.initEdit({elements:[W],element_aspects:{geometry:!0,uv:!0,faces:!0}});let Y=new KnifeToolContext(W);return $.forEach((X)=>{Y.points.push({position:new THREE.Vector3(...X.position),fkey:X.face,type:X.face?"face":"edge"})}),Y.apply(),Undo.finishEdit("Knife cut mesh"),Canvas.updateView({elements:[W],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Applied knife cut to mesh "${W.name}" with ${$.length} points`}},B0[10].status)}var SD=L.object({texture_id:m0,x:L.number().describe("X coordinate to start fill."),y:L.number().describe("Y coordinate to start fill."),color:DQ.describe("Fill color as hex string."),opacity:u6.describe("Fill opacity (0-255)."),tolerance:L.number().min(0).max(100).optional().describe("Color tolerance for fill."),fill_mode:dK.optional().default("color_connected").describe("Fill mode."),blend_mode:J9.optional().describe("Fill blend mode.")}),ZD=L.object({texture_id:m0,shape:iK.describe("Shape to draw. '_h' suffix means hollow."),start:E1.extend({x:L.number().describe("Start X coordinate."),y:L.number().describe("Start Y coordinate.")}),end:E1.extend({x:L.number().describe("End X coordinate."),y:L.number().describe("End Y coordinate.")}),color:DQ.describe("Shape color as hex string."),line_width:L.number().min(1).max(50).optional().describe("Line width for hollow shapes."),opacity:u6.describe("Shape opacity (0-255)."),blend_mode:J9.optional().describe("Shape blend mode.")}),CD=L.object({texture_id:m0,start:E1.extend({x:L.number().describe("Gradient start X coordinate."),y:L.number().describe("Gradient start Y coordinate.")}),end:E1.extend({x:L.number().describe("Gradient end X coordinate."),y:L.number().describe("Gradient end Y coordinate.")}),start_color:L.string().describe("Start color as hex string."),end_color:L.string().describe("End color as hex string."),opacity:u6.describe("Gradient opacity (0-255)."),blend_mode:J9.optional().describe("Gradient blend mode.")}),bD=L.object({texture_id:m0,x:L.number().describe("X coordinate to pick color from."),y:L.number().describe("Y coordinate to pick color from."),set_as_secondary:L.boolean().optional().default(!1).describe("Set as secondary color instead of primary."),pick_opacity:L.boolean().optional().default(!1).describe("Also pick and apply the pixel's opacity.")}),vD=L.object({texture_id:m0,source:E1.extend({x:L.number().describe("Source X coordinate to copy from."),y:L.number().describe("Source Y coordinate to copy from.")}),target:E1.extend({x:L.number().describe("Target X coordinate to paste to."),y:L.number().describe("Target Y coordinate to paste to.")}),brush_size:PQ.describe("Copy brush size."),opacity:u6.describe("Copy opacity (0-255)."),mode:nK.optional().default("copy").describe("Copy brush mode.")}),kD=L.object({texture_id:m0,coordinates:L.array(E1.extend({x:L.number().describe("X coordinate to erase at."),y:L.number().describe("Y coordinate to erase at.")})).describe("Array of coordinates to erase at."),brush_size:PQ.describe("Eraser brush size."),opacity:u6.describe("Eraser opacity (0-255)."),softness:O4.describe("Eraser softness percentage."),shape:w4.optional().describe("Eraser shape."),connect_strokes:L.boolean().optional().default(!0).describe("Whether to connect erase strokes with lines.")}),TD=L.object({mirror_painting:L.object({enabled:L.boolean().describe("Enable mirror painting."),axis:L.array(F8).optional().describe("Mirror axes."),texture:L.boolean().optional().describe("Enable texture mirroring."),texture_center:E1.extend({x:L.number().describe("X coordinate of texture mirror center."),y:L.number().describe("Y coordinate of texture mirror center.")}).optional().describe("Texture mirror center.")}).optional().describe("Mirror painting settings."),lock_alpha:L.boolean().optional().describe("Lock alpha channel while painting."),pixel_perfect:L.boolean().optional().describe("Enable pixel perfect drawing."),paint_side_restrict:L.boolean().optional().describe("Restrict painting to current face side."),color_erase_mode:L.boolean().optional().describe("Enable color erase mode."),brush_opacity_modifier:BX.optional().describe("Brush opacity modifier for stylus."),brush_size_modifier:BX.optional().describe("Brush size modifier for stylus."),paint_with_stylus_only:L.boolean().optional().describe("Only allow painting with stylus input."),pick_color_opacity:L.boolean().optional().describe("Pick opacity when using color picker."),pick_combined_color:L.boolean().optional().describe("Pick combined layer colors.")}),_D=L.object({texture_id:m0,coordinates:L.array(E1.extend({x:L.number().describe("X coordinate on texture."),y:L.number().describe("Y coordinate on texture.")})).describe("Array of coordinates to paint at."),brush_settings:HF,connect_strokes:L.boolean().optional().default(!0).describe("Whether to connect paint strokes with lines.")}),xD=L.object({name:L.string().describe("Name of the brush preset."),size:PQ,opacity:u6,softness:O4,shape:w4.optional().describe("Brush shape."),color:DQ.describe("Brush color as hex string."),blend_mode:J9.optional().describe("Brush blend mode."),pixel_perfect:L.boolean().optional().describe("Enable pixel perfect drawing.")}),yD=L.object({preset_name:L.string().describe("Name of the brush preset to load.")}),gD=L.object({action:L.enum(["select_rectangle","select_ellipse","select_all","clear_selection","invert_selection","expand_selection","contract_selection","feather_selection"]).describe("Selection action to perform."),texture_id:m0,coordinates:L.object({x1:L.number().describe("Start X coordinate."),y1:L.number().describe("Start Y coordinate."),x2:L.number().describe("End X coordinate."),y2:L.number().describe("End Y coordinate.")}).optional().describe("Selection area coordinates."),radius:L.number().optional().describe("Radius for expand/contract/feather operations."),mode:L.enum(["create","add","subtract","intersect"]).optional().default("create").describe("Selection mode.")}),hD=L.object({action:L.enum(["create_layer","delete_layer","duplicate_layer","merge_down","set_opacity","set_blend_mode","move_layer","rename_layer","flatten_layers"]).describe("Layer management action."),texture_id:m0,layer_name:L.string().optional().describe("Name of the layer."),opacity:L.number().min(0).max(100).optional().describe("Layer opacity percentage."),blend_mode:hK.optional().describe("Layer blend mode."),target_index:L.number().optional().describe("Target position for moving layers.")}),e=[{name:"paint_fill_tool",description:"Uses the fill/bucket tool to fill areas with color.",annotations:{title:"Paint Fill Tool",destructiveHint:!0},parameters:SD,status:k},{name:"draw_shape_tool",description:"Draws geometric shapes on textures.",annotations:{title:"Draw Shape Tool",destructiveHint:!0},parameters:ZD,status:k},{name:"gradient_tool",description:"Applies gradients to textures.",annotations:{title:"Gradient Tool",destructiveHint:!0},parameters:CD,status:k},{name:"color_picker_tool",description:"Picks colors from textures and sets them as the active color.",annotations:{title:"Color Picker Tool",readOnlyHint:!0},parameters:bD,status:k},{name:"copy_brush_tool",description:"Uses the copy/clone brush to copy texture areas.",annotations:{title:"Copy Brush Tool",destructiveHint:!0},parameters:vD,status:k},{name:"eraser_tool",description:"Erases parts of textures with customizable settings.",annotations:{title:"Eraser Tool",destructiveHint:!0},parameters:kD,status:k},{name:"paint_settings",description:"Configures paint mode settings and preferences.",annotations:{title:"Paint Settings",destructiveHint:!0},parameters:TD,status:k},{name:"paint_with_brush",description:"Paints on textures using the brush tool with customizable settings.",annotations:{title:"Paint with Brush",destructiveHint:!0},parameters:_D,status:k},{name:"create_brush_preset",description:"Creates a custom brush preset with specified settings.",annotations:{title:"Create Brush Preset",destructiveHint:!0},parameters:xD,status:k},{name:"load_brush_preset",description:"Loads and applies a brush preset by name.",annotations:{title:"Load Brush Preset",destructiveHint:!0},parameters:yD,status:k},{name:"texture_selection",description:"Creates, modifies, or manipulates texture selections for painting.",annotations:{title:"Texture Selection",destructiveHint:!0},parameters:gD,status:k},{name:"texture_layer_management",description:"Creates, manages, and manipulates texture layers.",annotations:{title:"Texture Layer Management",destructiveHint:!0},parameters:hD,status:k}];function VF(){E(e[0].name,{...e[0],async execute({texture_id:Q,x:$,y:W,color:Y,opacity:X,tolerance:J,fill_mode:H,blend_mode:G}){let B=Q?v0(Q):Texture.getDefault();if(!B)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[B],bitmap:!0}),Y)ColorPanel.set(Y);if(X!==void 0)BarItems.slider_brush_opacity.set(X);if(H)BarItems.fill_mode.set(H);if(G)BarItems.blend_mode.set(G);return BarItems.fill_tool.select(),Painter.startPaintTool(B,$,W,{},{shiftKey:!1}),Painter.stopPaintTool(),Undo.finishEdit("Fill tool"),Canvas.updateAll(),`Filled area at (${$}, ${W}) on texture "${B.name}"`}},e[0].status),E(e[1].name,{...e[1],async execute({texture_id:Q,shape:$,start:W,end:Y,color:X,line_width:J,opacity:H,blend_mode:G}){let B=Q?v0(Q):Texture.getDefault();if(!B)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[B],bitmap:!0}),X)ColorPanel.set(X);if(H!==void 0)BarItems.slider_brush_opacity.set(H);if(J!==void 0)BarItems.slider_brush_size.set(J);if(G)BarItems.blend_mode.set(G);return BarItems.draw_shape_type.set($),BarItems.draw_shape_tool.select(),Painter.startPaintTool(B,W.x,W.y,{},{shiftKey:!1}),Painter.useShapeTool(B,Y.x,Y.y,{}),Painter.stopPaintTool(),Undo.finishEdit("Draw shape"),Canvas.updateAll(),`Drew ${$} from (${W.x}, ${W.y}) to (${Y.x}, ${Y.y}) on texture "${B.name}"`}},e[1].status),E(e[2].name,{...e[2],async execute({texture_id:Q,start:$,end:W,start_color:Y,end_color:X,opacity:J,blend_mode:H}){let G=Q?v0(Q):Texture.getDefault();if(!G)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[G],bitmap:!0}),ColorPanel.set(Y),ColorPanel.set(X,!0),J!==void 0)BarItems.slider_brush_opacity.set(J);if(H)BarItems.blend_mode.set(H);return BarItems.gradient_tool.select(),Painter.startPaintTool(G,$.x,$.y,{},{shiftKey:!1}),Painter.useGradientTool(G,W.x,W.y,{}),Painter.stopPaintTool(),Undo.finishEdit("Apply gradient"),Canvas.updateAll(),`Applied gradient from (${$.x}, ${$.y}) to (${W.x}, ${W.y}) on texture "${G.name}"`}},e[2].status),E(e[3].name,{...e[3],async execute({texture_id:Q,x:$,y:W,set_as_secondary:Y,pick_opacity:X}){let J=Q?v0(Q):Texture.getDefault();if(!J)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");Painter.colorPicker(J,$,W,{button:Y?2:0});let H=ColorPanel.get();if(X){let G=Painter.getPixelColor(J.ctx,$,W),B=Math.floor(G.getAlpha()*255);for(let K in BarItems){let F=BarItems[K];if(F.tool_settings&&F.tool_settings.brush_opacity>=0)F.tool_settings.brush_opacity=B}return`Picked color ${H} with opacity ${B} from (${$}, ${W}) on texture "${J.name}"`}return`Picked color ${H} from (${$}, ${W}) on texture "${J.name}"`}},e[3].status),E(e[4].name,{...e[4],async execute({texture_id:Q,source:$,target:W,brush_size:Y,opacity:X,mode:J}){let H=Q?v0(Q):Texture.getDefault();if(!H)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[H],bitmap:!0}),Y!==void 0)BarItems.slider_brush_size.set(Y);if(X!==void 0)BarItems.slider_brush_opacity.set(X);if(J)BarItems.copy_brush_mode.set(J);return BarItems.copy_brush.select(),Painter.startPaintTool(H,$.x,$.y,{},{ctrlOrCmd:!0}),Painter.startPaintTool(H,W.x,W.y,{},{shiftKey:!1}),Painter.stopPaintTool(),Undo.finishEdit("Copy brush"),Canvas.updateAll(),`Copied from (${$.x}, ${$.y}) to (${W.x}, ${W.y}) on texture "${H.name}"`}},e[4].status),E(e[5].name,{...e[5],async execute({texture_id:Q,coordinates:$,brush_size:W,opacity:Y,softness:X,shape:J,connect_strokes:H}){let G=Q?v0(Q):Texture.getDefault();if(!G)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[G],bitmap:!0}),W!==void 0)BarItems.slider_brush_size.set(W);if(Y!==void 0)BarItems.slider_brush_opacity.set(Y);if(X!==void 0)BarItems.slider_brush_softness.set(X);if(J!==void 0)BarItems.brush_shape.set(J);BarItems.eraser.select();for(let B=0;B<$.length;B++){let K=$[B];if(B===0||!H)Painter.startPaintTool(G,K.x,K.y,{},{shiftKey:!1});else Painter.movePaintTool(G,K.x,K.y,{})}return Painter.stopPaintTool(),Undo.finishEdit("Erase texture"),Canvas.updateAll(),`Erased ${$.length} points on texture "${G.name}"`}},e[5].status),E(e[6].name,{...e[6],async execute({mirror_painting:Q,lock_alpha:$,pixel_perfect:W,paint_side_restrict:Y,color_erase_mode:X,brush_opacity_modifier:J,brush_size_modifier:H,paint_with_stylus_only:G,pick_color_opacity:B,pick_combined_color:K}){let F=[];if(Q!==void 0){if(BarItems.mirror_painting.set(Q.enabled),Painter.mirror_painting=Q.enabled,F.push(`Mirror painting: ${Q.enabled}`),Q.enabled&&(Q.axis||Q.texture||Q.texture_center)){let q=Painter.mirror_painting_options;if(Q.axis)Q.axis.forEach((A)=>{q[A]=!0});if(Q.texture!==void 0)q.texture=Q.texture;if(Q.texture_center)q.texture_center=[Q.texture_center.x,Q.texture_center.y];F.push("Mirror options updated")}}if($!==void 0)Painter.lock_alpha=$,F.push(`Lock alpha: ${$}`);if(W!==void 0)BarItems.pixel_perfect_drawing.set(W),F.push(`Pixel perfect: ${W}`);if(X!==void 0)BarItems.color_erase_mode.set(X),Painter.erase_mode=X,F.push(`Color erase mode: ${X}`);if(Y!==void 0)F.paint_side_restrict.value=Y,F.push(`Paint side restrict: ${Y}`);if(J!==void 0)F.brush_opacity_modifier.value=J,F.push(`Brush opacity modifier: ${J}`);if(H!==void 0)F.brush_size_modifier.value=H,F.push(`Brush size modifier: ${H}`);if(G!==void 0)F.paint_with_stylus_only.value=G,F.push(`Paint with stylus only: ${G}`);if(B!==void 0)F.pick_color_opacity.value=B,F.push(`Pick color opacity: ${B}`);if(K!==void 0)F.pick_combined_color.value=K,F.push(`Pick combined color: ${K}`);return`Updated paint settings: ${F.join(", ")}`}},e[6].status),E(e[7].name,{...e[7],async execute({texture_id:Q,coordinates:$,brush_settings:W,connect_strokes:Y}){let X=Q?v0(Q):Texture.getDefault();if(!X)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");Undo.initEdit({textures:[X],selected_texture:!0,bitmap:!0});let J=W?.color??"#000000",H=parseInt(J.slice(1,3),16),G=parseInt(J.slice(3,5),16),B=parseInt(J.slice(5,7),16),K=W?.opacity??255,F=W?.size??1,q=W?.softness??0,A=W?.shape??"square";return BarItems.slider_brush_size.value=F,BarItems.slider_brush_opacity.value=K,BarItems.slider_brush_softness.value=q,BarItems.brush_shape.value=A,ColorPanel.set(J),X.edit((V)=>{let U=V.getContext("2d");for(let z of $)if(A==="circle")Painter.editCircle(U,z.x,z.y,F,q,()=>({r:H,g:G,b:B,a:K}));else Painter.editSquare(U,z.x,z.y,F,q,()=>({r:H,g:G,b:B,a:K}))},{edit_name:"Paint with brush"}),Undo.finishEdit("Paint with brush"),Canvas.updateAll(),`Painted ${$.length} points on texture "${X.name}"`}},e[7].status),E(e[8].name,{...e[8],async execute({name:Q,size:$,opacity:W,softness:Y,shape:X,color:J,blend_mode:H,pixel_perfect:G}){let B={name:Q,size:$??null,opacity:W??null,softness:Y??null,shape:X||"square",color:J||null,blend_mode:H||"default",pixel_perfect:G||!1};return StateMemory.brush_presets.push(B),StateMemory.save("brush_presets"),`Created brush preset "${Q}" with settings: ${JSON.stringify(B)}`}},e[8].status),E(e[9].name,{...e[9],async execute({preset_name:Q}){let $=StateMemory.brush_presets.find((W)=>W.name===Q);if(!$)throw Error(`Brush preset "${Q}" not found.`);return Painter.loadBrushPreset($),`Loaded brush preset "${Q}"`}},e[9].status),E(e[10].name,{...e[10],async execute({action:Q,texture_id:$,coordinates:W,radius:Y,mode:X}){let J=$?v0($):Texture.getDefault();if(!J)throw Error($?`Texture with ID "${$}" not found.`:"No texture available.");Undo.initEdit({textures:[J],bitmap:!0});let H=J.selection;switch(Q){case"select_rectangle":if(!W)throw Error("Coordinates required for rectangle selection.");H.clear(),H.start_x=W.x1,H.start_y=W.y1,H.end_x=W.x2,H.end_y=W.y2,H.is_custom=!1;break;case"select_ellipse":if(!W)throw Error("Coordinates required for ellipse selection.");H.clear(),H.is_custom=!0;let G=(W.x1+W.x2)/2,B=(W.y1+W.y2)/2,K=Math.abs(W.x2-W.x1)/2,F=Math.abs(W.y2-W.y1)/2;for(let q=Math.floor(G-K);q<=Math.ceil(G+K);q++)for(let A=Math.floor(B-F);A<=Math.ceil(B+F);A++){let V=(q-G)/K,U=(A-B)/F;if(V*V+U*U<=1)H.set(q,A,!0)}break;case"select_all":H.selectAll();break;case"clear_selection":H.clear();break;case"invert_selection":H.invert();break;case"expand_selection":if(Y===void 0)throw Error("Radius required for expand selection.");H.expand(Y);break;case"contract_selection":if(Y===void 0)throw Error("Radius required for contract selection.");H.contract(Y);break;case"feather_selection":if(Y===void 0)throw Error("Radius required for feather selection.");H.feather(Y);break}return UVEditor.vue.updateTexture(),Undo.finishEdit("Texture selection"),`Applied ${Q} to texture "${J.name}"`}},e[10].status),E(e[11].name,{...e[11],async execute({action:Q,texture_id:$,layer_name:W,opacity:Y,blend_mode:X,target_index:J}){let H=$?v0($):Texture.selected;if(!H)throw Error($?`Texture with ID "${$}" not found.`:"No texture selected.");Undo.initEdit({textures:[H],layers:H.layers,bitmap:!0});let G="";switch(Q){case"create_layer":if(!H.layers_enabled)H.activateLayers(!0);let B=new TextureLayer({name:W||`Layer ${H.layers.length+1}`},H);B.setSize(H.width,H.height),B.addForEditing(),G=`Created layer "${B.name}"`;break;case"delete_layer":if(!TextureLayer.selected)throw Error("No layer selected.");let K=TextureLayer.selected;K.remove(),G=`Deleted layer "${K.name}"`;break;case"duplicate_layer":if(!TextureLayer.selected)throw Error("No layer selected.");let F=TextureLayer.selected,q=F.duplicate();q.name=`${F.name} copy`,G=`Duplicated layer "${q.name}"`;break;case"merge_down":if(!TextureLayer.selected)throw Error("No layer selected.");TextureLayer.selected.mergeDown(!0),G="Merged layer down";break;case"set_opacity":if(!TextureLayer.selected)throw Error("No layer selected.");if(Y===void 0)throw Error("Opacity value required.");TextureLayer.selected.opacity=Y/100,H.updateChangesAfterEdit(),G=`Set layer opacity to ${Y}%`;break;case"set_blend_mode":if(!TextureLayer.selected)throw Error("No layer selected.");if(!X)throw Error("Blend mode required.");TextureLayer.selected.blend_mode=X,H.updateChangesAfterEdit(),G=`Set layer blend mode to ${X}`;break;case"move_layer":if(!TextureLayer.selected)throw Error("No layer selected.");if(J===void 0)throw Error("Target index required.");let A=TextureLayer.selected;H.layers.remove(A),H.layers.splice(J,0,A),G=`Moved layer to position ${J}`;break;case"rename_layer":if(!TextureLayer.selected)throw Error("No layer selected.");if(!W)throw Error("New layer name required.");let V=TextureLayer.selected.name;TextureLayer.selected.name=W,G=`Renamed layer from "${V}" to "${W}"`;break;case"flatten_layers":if(!H.layers_enabled)throw Error("Texture has no layers to flatten.");H.flattenLayers(),G="Flattened all layers";break}return H.updateChangesAfterEdit(),Undo.finishEdit(`Layer management: ${Q}`),updateInterfacePanels(),G}},e[11].status)}var fD=L.object({name:L.string(),format:L.string().default("bedrock_block").describe("Project format ID from Blockbench's Formats registry.")}),VX=[{name:"create_project",description:"Creates a new project with the given name and project type.",annotations:{title:"Create Project",destructiveHint:!0,openWorldHint:!0},parameters:fD,status:d}];function UF(){E(VX[0].name,{...VX[0],async execute({name:Q,format:$}){if(!newProject(Formats[$]))throw Error("Failed to create project.");return Project.name=Q,`Created project with name "${Q}" (UUID: ${Project?.uuid}) and format "${$}".`}},VX[0].status)}var uD=L.object({name:L.string(),width:L.number().min(16).max(4096).default(16),height:L.number().min(16).max(4096).default(16),data:L.string().optional().describe("Path to the image file or data URL."),group:L.string().optional(),fill_color:tK.optional().describe("RGBA color to fill the texture, as tuple or HEX string."),layer_name:L.string().optional().describe("Name of the texture layer. Required if fill_color is set."),pbr_channel:KX.optional().describe("PBR channel to use for the texture. Color, normal, height, or Metalness/Emissive/Roughness (MER) map."),render_mode:rK.optional().default("default").describe("Render mode for the texture. Default, emissive, additive, or layered."),render_sides:oK.optional().default("auto").describe("Render sides for the texture. Auto, front, or double.")}).refine((Q)=>!(Q.data&&Q.fill_color),{message:"The 'data' and 'fill_color' properties cannot both be defined.",path:["data","fill_color"]}).refine((Q)=>!(Q.fill_color&&!Q.layer_name),{message:"The 'layer_name' property is required when 'fill_color' is set.",path:["layer_name","fill_color"]}).refine(({pbr_channel:Q,group:$})=>Q&&$||!Q,{message:"The 'group' property is required when 'pbr_channel' is set.",path:["group","pbr_channel"]}),lD=L.object({id:T0.describe("ID or name of the element to apply the texture to."),texture:FX.describe("ID or name of the texture to apply."),applyTo:L.enum(["all","blank","none"]).describe("Apply texture to element or group.").optional().default("blank")}),mD=L.object({name:L.string(),textures:L.array(L.string()).optional().describe("Array of texture IDs or names to add to the group."),is_material:L.boolean().optional().default(!0).describe("Whether the texture group is a PBR material or not.")}),cD=L.object({}),pD=L.object({texture:m0}),dD=L.object({name:L.string().describe("Name of the material."),color_texture:L.string().optional().describe("Texture ID/name for the color (albedo) channel."),normal_texture:L.string().optional().describe("Texture ID/name for the normal map channel."),height_texture:L.string().optional().describe("Texture ID/name for the height/displacement map channel."),mer_texture:L.string().optional().describe("Texture ID/name for the MER (Metalness/Emissive/Roughness) channel."),color_value:L.array(L.number().min(0).max(255)).length(4).optional().describe("Uniform RGBA color [R,G,B,A] when no color texture is provided."),mer_value:L.array(L.number().min(0).max(255)).length(3).optional().describe("Uniform MER values [Metalness, Emissive, Roughness] (0-255) when no MER texture is provided."),subsurface_value:L.number().min(0).max(255).optional().describe("Subsurface scattering value (0-255) for Bedrock 1.21.30+ materials.")}),iD=L.object({material:L.string().describe("Material name or UUID to configure."),color_texture:L.string().optional().describe("Texture ID/name for the color channel, or 'none' to use uniform color."),normal_texture:L.string().optional().describe("Texture ID/name for the normal map, or 'none' to remove."),height_texture:L.string().optional().describe("Texture ID/name for the height map, or 'none' to remove."),mer_texture:L.string().optional().describe("Texture ID/name for MER channel, or 'none' to use uniform values."),color_value:L.array(L.number().min(0).max(255)).length(4).optional().describe("Uniform RGBA color [R,G,B,A] when no color texture."),mer_value:L.array(L.number().min(0).max(255)).length(3).optional().describe("Uniform MER values [Metalness, Emissive, Roughness] (0-255)."),subsurface_value:L.number().min(0).max(255).optional().describe("Subsurface scattering value (0-255).")}),nD=L.object({}),rD=L.object({material:L.string().describe("Material name or UUID.")}),oD=L.object({path:L.string().describe("Path to the .texture_set.json file to import.")}),aD=L.object({material:L.string().describe("Material name or UUID."),texture:FX.describe("Texture name or UUID to assign."),channel:KX.describe("PBR channel to assign the texture to.")}),tD=L.object({material:L.string().describe("Material name or UUID to save.")}),Q0=[{name:"create_texture",description:"Creates a new texture with the given name and size.",annotations:{title:"Create Texture",destructiveHint:!0,openWorldHint:!0},parameters:uD,status:k},{name:"apply_texture",description:"Applies the given texture to the element with the specified ID.",annotations:{title:"Apply Texture",destructiveHint:!0},parameters:lD,status:d},{name:"add_texture_group",description:"Adds a new texture group with the given name.",annotations:{title:"Add Texture Group",destructiveHint:!0},parameters:mD,status:k},{name:"list_textures",description:"Returns a list of all textures in the Blockbench editor.",annotations:{title:"List Textures",readOnlyHint:!0},parameters:cD,status:d},{name:"get_texture",description:"Returns the image data of the given texture or default texture.",annotations:{title:"Get Texture",readOnlyHint:!0},parameters:pD,status:d},{name:"create_pbr_material",description:"Creates a new PBR material (texture group with is_material=true) and optionally assigns textures to PBR channels. Use this for Minecraft Bedrock resource packs or any format supporting PBR.",annotations:{title:"Create PBR Material",destructiveHint:!0},parameters:dD,status:k},{name:"configure_material",description:"Configures an existing PBR material's properties including channel assignments, uniform values, and subsurface scattering.",annotations:{title:"Configure Material",destructiveHint:!0},parameters:iD,status:k},{name:"list_materials",description:"Lists all PBR materials (texture groups with is_material=true) and their assigned textures per channel.",annotations:{title:"List Materials",readOnlyHint:!0},parameters:nD,status:d},{name:"get_material_info",description:"Gets detailed information about a PBR material including the compiled texture_set.json preview for Bedrock export.",annotations:{title:"Get Material Info",readOnlyHint:!0},parameters:rD,status:d},{name:"import_texture_set",description:"Imports a Minecraft Bedrock texture_set.json file and creates a PBR material with the associated textures.",annotations:{title:"Import Texture Set",destructiveHint:!0,openWorldHint:!0},parameters:oD,status:k},{name:"assign_texture_channel",description:"Assigns a texture to a specific PBR channel within a material.",annotations:{title:"Assign Texture Channel",destructiveHint:!0},parameters:aD,status:k},{name:"save_material_config",description:"Saves the material's texture_set.json file to disk (Bedrock format). Requires the color texture to have a valid file path.",annotations:{title:"Save Material Config",destructiveHint:!0,openWorldHint:!0},parameters:tD,status:k}];function AF(){E(Q0[0].name,{...Q0[0],async execute({name:Q,width:$,height:W,data:Y,pbr_channel:X,fill_color:J,group:H,layer_name:G}){Undo.initEdit({textures:[],collections:[]});let B=new Texture({name:Q,width:$,height:W,group:H,pbr_channel:X,internal:!0});if(Y){if(Y.startsWith("data:image/"))B.source=Y,B.width=$,B.height=W;else B=B.fromFile({name:Y.split(/[\/\\]/).pop()||Y,path:Y.replace(/^file:\/\//,"")});B.load(),B.fillParticle(),B.layers_enabled=!1}else{let{ctx:K}=B.getActiveCanvas();if(J){let F=Array.isArray(J)?tinycolor({r:Number(J[0]),g:Number(J[1]),b:Number(J[2]),a:Number(J[3]??255)}):tinycolor(J);K.fillStyle=F.toRgbString().toLowerCase(),K.fillRect(0,0,B.width,B.height)}else K.clearRect(0,0,B.width,B.height);B.updateSource(K.canvas.toDataURL("image/png",1)),B.updateLayerChanges(!0)}return B.add(),Undo.finishEdit("Agent created texture"),Canvas.updateAll(),X9({url:B.getDataURL()})}},Q0[0].status),E(Q0[1].name,{...Q0[1],async execute({applyTo:Q,id:$,texture:W}){let Y=A1($),X=W?r0(W):Texture.getDefault();if(!X)throw Error("No default texture available. Use the create_texture tool to create one first.");return Undo.initEdit({elements:[],outliner:!0,collections:[]}),X.select(),Texture.selected?.apply(Q==="none"?!1:Q==="all"?!0:"blank"),X.updateChangesAfterEdit(),Undo.finishEdit("Agent applied texture"),Canvas.updateAll(),`Applied texture ${X.name} to element with ID ${$}`}},Q0[1].status),E(Q0[2].name,{...Q0[2],async execute({name:Q,textures:$,is_material:W}){Undo.initEdit({elements:[],outliner:!0,collections:[],textures:[]});let Y=new TextureGroup({name:Q,is_material:W}).add();if($){let X=$.map((J)=>v0(J)).filter(Boolean);if(X.length===0)throw Error(`No textures found for "${$}".`);X.forEach((J)=>{J?.extend({group:Y.uuid})})}return Undo.finishEdit("Agent added texture group"),Canvas.updateAll(),`Added texture group ${Y.name} with ID ${Y.uuid}`}},Q0[2].status),E(Q0[3].name,{...Q0[3],async execute(){let Q=Project?.textures??Texture.all;return JSON.stringify(Q.map(($)=>({name:$.name,uuid:$.uuid,id:$.id,group:$.group})))}},Q0[3].status),E(Q0[4].name,{...Q0[4],async execute({texture:Q}){if(!Q){let W=Texture.getDefault();if(!W)throw Error("No default texture available. Use the create_texture tool to create one first, or specify a texture ID.");return X9({url:W.getDataURL()})}let $=r0(Q);return X9({url:$.getDataURL()})}},Q0[4].status),E(Q0[5].name,{...Q0[5],async execute({name:Q,color_texture:$,normal_texture:W,height_texture:Y,mer_texture:X,color_value:J,mer_value:H,subsurface_value:G}){let B=[];if($){let F=r0($);B.push(F)}if(W){let F=r0(W);B.push(F)}if(Y){let F=r0(Y);B.push(F)}if(X){let F=r0(X);B.push(F)}Undo.initEdit({texture_groups:[],textures:B});let K=new TextureGroup({name:Q,is_material:!0});if(J)K.material_config.color_value=J;if(H)K.material_config.mer_value=H;if(G!==void 0)K.material_config.subsurface_value=G;if(K.material_config.saved=!1,K.add(),$)r0($).extend({group:K.uuid,pbr_channel:"color"});if(W)r0(W).extend({group:K.uuid,pbr_channel:"normal"});if(Y)r0(Y).extend({group:K.uuid,pbr_channel:"height"});if(X)r0(X).extend({group:K.uuid,pbr_channel:"mer"});return K.updateMaterial(),Undo.finishEdit("Agent created PBR material"),Canvas.updateAll(),JSON.stringify({success:!0,material:{name:K.name,uuid:K.uuid,is_material:!0,channels:{color:$?!0:!!J,normal:!!W,height:!!Y,mer:X?!0:!!H}}})}},Q0[5].status),E(Q0[6].name,{...Q0[6],async execute({material:Q,color_texture:$,normal_texture:W,height_texture:Y,mer_texture:X,color_value:J,mer_value:H,subsurface_value:G}){let B=MQ(Q),K=B.getTextures();if(Undo.initEdit({texture_groups:[B],textures:K}),$==="none")K.filter((F)=>F.pbr_channel==="color").forEach((F)=>F.group="");else if($)K.filter((q)=>q.pbr_channel==="color").forEach((q)=>q.pbr_channel="color"),r0($).extend({group:B.uuid,pbr_channel:"color"});if(W==="none")K.filter((F)=>F.pbr_channel==="normal").forEach((F)=>F.group="");else if(W)r0(W).extend({group:B.uuid,pbr_channel:"normal"});if(Y==="none")K.filter((F)=>F.pbr_channel==="height").forEach((F)=>F.group="");else if(Y)r0(Y).extend({group:B.uuid,pbr_channel:"height"});if(X==="none")K.filter((F)=>F.pbr_channel==="mer").forEach((F)=>F.group="");else if(X)r0(X).extend({group:B.uuid,pbr_channel:"mer"});if(J)B.material_config.color_value=J;if(H)B.material_config.mer_value=H;if(G!==void 0)B.material_config.subsurface_value=G;return B.material_config.saved=!1,B.updateMaterial(),Undo.finishEdit("Agent configured material"),Canvas.updateAll(),`Configured material "${B.name}"`}},Q0[6].status),E(Q0[7].name,{...Q0[7],async execute(){let $=TextureGroup.all.filter((W)=>W.is_material).map((W)=>{let Y=W.getTextures();return{name:W.name,uuid:W.uuid,channels:{color:jQ(Y,"color"),normal:jQ(Y,"normal"),height:jQ(Y,"height"),mer:jQ(Y,"mer")},config:{color_value:W.material_config.color_value,mer_value:W.material_config.mer_value,subsurface_value:W.material_config.subsurface_value,saved:W.material_config.saved}}});return JSON.stringify($,null,2)}},Q0[7].status),E(Q0[8].name,{...Q0[8],async execute({material:Q}){let $=MQ(Q),W=$.getTextures(),Y=null;try{Y=$.material_config.compileForBedrock()}catch{}let X={name:$.name,uuid:$.uuid,is_material:$.is_material,textures:W.map((J)=>({name:J.name,uuid:J.uuid,pbr_channel:J.pbr_channel,width:J.width,height:J.height,render_mode:J.render_mode,render_sides:J.render_sides})),config:{color_value:$.material_config.color_value,mer_value:$.material_config.mer_value,subsurface_value:$.material_config.subsurface_value,saved:$.material_config.saved,file_path:$.material_config.getFilePath()},texture_set_json:Y};return JSON.stringify(X,null,2)}},Q0[8].status),E(Q0[9].name,{...Q0[9],async execute({path:Q}){if(!Q.endsWith(".texture_set.json"))throw Error("Path must end with '.texture_set.json'. Example: 'path/to/mytexture.texture_set.json'");if(!requireNativeModule("fs").existsSync(Q))throw Error(`File not found: ${Q}`);return importTextureSet({path:Q,name:Q.split(/[\/\\]/).pop()}),`Imported texture set from "${Q}". Check the textures panel for the new material.`}},Q0[9].status),E(Q0[10].name,{...Q0[10],async execute({material:Q,texture:$,channel:W}){let Y=MQ(Q),X=r0($);return Undo.initEdit({texture_groups:[Y],textures:[X]}),Y.getTextures().filter((H)=>H.pbr_channel===W&&H.uuid!==X.uuid).forEach((H)=>{H.pbr_channel="color"}),X.extend({group:Y.uuid,pbr_channel:W}),Y.material_config.saved=!1,Y.updateMaterial(),Undo.finishEdit("Agent assigned texture channel"),Canvas.updateAll(),`Assigned texture "${X.name}" to ${W} channel of material "${Y.name}"`}},Q0[10].status),E(Q0[11].name,{...Q0[11],async execute({material:Q}){let $=MQ(Q),W=$.material_config.getFilePath();if(!W)throw Error("Cannot save: Material needs a color texture with a valid file path. Save the color texture first, then try again.");return $.material_config.save(),`Saved material config to "${W}"`}},Q0[11].status)}var sD=L.object({action:L.string().describe("Action ID from Blockbench's BarItems registry."),confirmDialog:L.boolean().optional().default(!0).describe("Whether or not to automatically confirm any dialogs that appear as a result of the action."),confirmEvent:L.string().optional().describe("Stringified form of event arguments.")}),eD=L.object({code:L.string().refine((Q)=>!/console\.|\/\/|\/\*/.test(Q),{message:"Code must not include 'console.', '//' or '/* */' comments."}).describe("JavaScript code to evaluate. Do not pass `console` commands or comments.")}),QE=L.object({x:L.number(),y:L.number(),button:QF.optional().default("left").describe("Mouse button to use.")}),$E=L.object({to:E1,duration:L.number().optional().default(100).describe("Duration of the drag in milliseconds.")}).optional().describe("Drag options. If set, will perform a drag from position to 'to'."),WE=L.object({position:QE,drag:$E}),YE=L.object({values:L.string().describe("Stringified form of values to fill the dialog with."),confirm:L.boolean().optional().default(!0).describe("Whether to confirm or cancel the dialog after filling it. True to confirm, false to cancel.")}),R1=[{name:"trigger_action",description:"Triggers an action in the Blockbench editor.",annotations:{title:"Trigger Action",destructiveHint:!0,openWorldHint:!0},parameters:sD,status:k},{name:"risky_eval",description:"Evaluates the given expression and logs it to the console. Do not pass `console` commands as they will not work.",annotations:{title:"Eval",destructiveHint:!0,openWorldHint:!0},parameters:eD,status:d},{name:"emulate_clicks",description:"Emulates clicks on the given interface elements.",annotations:{title:"Emulate Clicks",destructiveHint:!0,openWorldHint:!0},parameters:WE,status:k},{name:"fill_dialog",description:"Fills the dialog with the given values.",annotations:{title:"Fill Dialog",destructiveHint:!0,openWorldHint:!0},parameters:YE,status:k}];function zF(){E(R1[0].name,{...R1[0],async execute({action:Q,confirmEvent:$,confirmDialog:W}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let Y={};if($)try{Y=JSON.parse($)}catch(H){throw Error(`Invalid JSON in confirmEvent: ${H instanceof Error?H.message:H}`)}if(!(Q in BarItems))throw Error(`Action "${Q}" not found.`);let X=BarItems[Q];if(X&&X instanceof Action){let{event:H,...G}=Y;X.trigger(new Event(H||"click",{...G}))}if(W)Dialog.open?.confirm();Undo.finishEdit("Agent triggered action");let J;try{J=await K8()}catch(H){J=`Action "${Q}" executed, but failed to capture app screenshot: ${H}`}return J}},R1[0].status),E(R1[1].name,{...R1[1],async execute({code}){try{Undo.initEdit({elements:[],outliner:!0,collections:[]});let result=await eval(code.trim());if(result!==void 0)return JSON.stringify(result);return"(Code executed successfully, but no result was returned.)"}catch(Q){return`Error executing code: ${Q}`}finally{Undo.finishEdit("Agent executed code")}}},R1[1].status),E(R1[2].name,{...R1[2],async execute({position:Q,drag:$}){let{x:W,y:Y,button:X}=Q,J=new MouseEvent("click",{clientX:W,clientY:Y,button:X==="left"?0:2});if(document.dispatchEvent(J),$){let{to:H,duration:G}=$,B=new MouseEvent("mousedown",{clientX:W,clientY:Y,button:X==="left"?0:2}),K=new MouseEvent("mouseup",{clientX:H.x,clientY:H.y,button:X==="left"?0:2});document.dispatchEvent(B),await new Promise((F)=>setTimeout(F,G)),document.dispatchEvent(K)}return await K8()}},R1[2].status),E(R1[3].name,{...R1[3],async execute({values:Q,confirm:$}){if(!Dialog.stack.length)throw Error("No dialogs found in the Blockbench editor.");if(!Dialog.open)Dialog.stack[Dialog.stack.length-1]?.focus();let W;try{W=JSON.parse(Q)}catch(J){throw Error(`Invalid JSON in values: ${J instanceof Error?J.message:J}`)}let Y=Object.keys(Dialog.open?.getFormResult()??{}),X=Object.entries(W).reduce((J,[H,G])=>{if(Y.includes(H))J[H]=G;return J},{});if(Dialog.open?.setFormValues(X,!0),$)Dialog.open?.confirm();else Dialog.open?.cancel();return JSON.stringify({result:`Current dialog stack is now ${Dialog.stack.length} deep.`,dialogs:Dialog.stack.map((J)=>({id:J.id,values:J.getFormResult()}))})}},R1[3].status)}var XE=L.object({mesh_id:H9,face_key:L.string().describe("Face key to set UV for."),uv_mapping:L.record(L.string(),gK).describe("UV coordinates for each vertex of the face.")}),JE=L.object({mesh_id:K1,mode:pK.default("project").describe("UV mapping mode: project from view, unwrap, cylinder, or sphere mapping."),faces:LX.describe("Specific face keys to UV map. If not provided, maps all selected faces.")}),HE=L.object({mesh_id:K1,angle:eK.default("90").describe("Rotation angle in degrees."),faces:LX.describe("Specific face keys to rotate UV for. If not provided, rotates all selected faces.")}),F6=[{name:"set_mesh_uv",description:"Sets UV coordinates for mesh faces or vertices.",annotations:{title:"Set Mesh UV",destructiveHint:!0},parameters:XE,status:k},{name:"auto_uv_mesh",description:"Automatically generates UV mapping for selected mesh faces.",annotations:{title:"Auto UV Mesh",destructiveHint:!0},parameters:JE,status:k},{name:"rotate_mesh_uv",description:"Rotates UV coordinates of selected mesh faces.",annotations:{title:"Rotate Mesh UV",destructiveHint:!0},parameters:HE,status:k}];function wF(){E(F6[0].name,{...F6[0],async execute({mesh_id:Q,face_key:$,uv_mapping:W}){let Y=B8(Q);Undo.initEdit({elements:[Y],uv_only:!0});let X=Y.faces[$];if(!X)throw Error(`Face with key "${$}" not found in mesh.`);return Object.entries(W).forEach(([J,H])=>{if(X.vertices.includes(J))X.uv[J]=H}),Y.preview_controller.updateUV(Y),UVEditor.loadData(),Undo.finishEdit("Set mesh UV"),`Set UV mapping for face "${$}" of mesh "${Y.name}"`}},F6[0].status),E(F6[1].name,{...F6[1],async execute({mesh_id:Q,mode:$,faces:W}){let Y=G6(Q);Undo.initEdit({elements:[Y],uv_only:!0});let X=W||UVEditor.getSelectedFaces(Y);if($==="project")BarItems.uv_project_from_view.click();else X.forEach((J)=>{let H=Y.faces[J];if(!H)return;if($==="unwrap")UVEditor.setAutoSize(null,!0,[J]);else if($==="cylinder")H.getSortedVertices().forEach((B,K)=>{let F=Y.vertices[B],A=(Math.atan2(F[0],F[2])+Math.PI)/(2*Math.PI)*Project.texture_width,V=(F[1]+8)/16*Project.texture_height;H.uv[B]=[A,V]});else if($==="sphere")H.getSortedVertices().forEach((B)=>{let K=Y.vertices[B],F=Math.sqrt(K[0]**2+K[1]**2+K[2]**2),q=Math.acos(K[1]/F),V=(Math.atan2(K[0],K[2])+Math.PI)/(2*Math.PI)*Project.texture_width,U=q/Math.PI*Project.texture_height;H.uv[B]=[V,U]})});return Y.preview_controller.updateUV(Y),UVEditor.loadData(),Undo.finishEdit("Auto UV mesh"),`Applied ${$} UV mapping to ${X.length} faces of mesh "${Y.name}"`}},F6[1].status),E(F6[2].name,{...F6[2],async execute({mesh_id:Q,angle:$,faces:W}){let Y=G6(Q);if(Undo.initEdit({elements:[Y],uv_only:!0}),W&&W.length>0){let H=Y.getSelectedFaces(!0);H.length=0,H.push(...W)}let X=parseInt($);UVEditor.rotate(X),Undo.finishEdit("Rotate mesh UV");let J=W??Y.getSelectedFaces();return`Rotated UV by ${$} degrees for ${J.length} faces of mesh "${Y.name}"`}},F6[2].status)}var GE=L.object({}),BE=L.array(f6).optional().default(f6.options).describe("Faces to set the material instance on. Defaults to all faces."),OF=L.array(f6).optional().describe("Specific faces to get/clear material instances for. If not provided, returns/clears all faces."),KE=L.object({cube_id:B6.describe("ID or name of the cube. If not provided, uses the first selected cube."),faces:OF}),FE=L.object({cube_id:B6.describe("ID or name of the cube. If not provided, applies to all selected cubes."),material_name:L.string().describe("The material instance name to assign. Use empty string to clear the material instance."),faces:BE}),LE=L.object({cube_id:sK,faces:L.array(f6).describe("Faces to set the material instance on."),material_name:L.string().describe("Material instance name to assign.")}),qE=L.object({assignments:L.array(LE).min(1).describe("Array of material instance assignments.")}),VE=L.object({cube_id:B6.describe("ID or name of the cube. If not provided, clears from all selected cubes."),faces:OF.describe("Specific faces to clear. If not provided, clears all faces."),all_cubes:L.boolean().optional().default(!1).describe("If true, clears material instances from all cubes in the project.")});function N4(Q){let $=A1(Q);if(!($ instanceof Cube))throw Error(`Element "${Q}" is not a cube. Material instances are only supported on cube faces.`);return $}var W1=[{name:"get_face_material_instances",description:"Gets the material instance names for cube faces. Material instances are used in Bedrock Block format to map faces to materials defined in the minecraft:material_instances component.",annotations:{title:"Get Face Material Instances",readOnlyHint:!0},parameters:KE,status:d},{name:"set_face_material_instance",description:"Sets the material instance name for one or more cube faces. Material instances are strings that map to materials defined in the minecraft:material_instances component for Bedrock Block format.",annotations:{title:"Set Face Material Instance",destructiveHint:!0},parameters:FE,status:k},{name:"list_material_instances",description:"Lists all unique material instance names used in the project. Returns the material instance names along with which cubes and faces use them.",annotations:{title:"List Material Instances",readOnlyHint:!0},parameters:GE,status:d},{name:"bulk_set_material_instances",description:"Sets material instance names on multiple cubes at once. Useful for assigning different material instances to different faces across the project.",annotations:{title:"Bulk Set Material Instances",destructiveHint:!0},parameters:qE,status:k},{name:"clear_material_instances",description:"Clears (removes) material instance names from cube faces. Useful for resetting material assignments.",annotations:{title:"Clear Material Instances",destructiveHint:!0},parameters:VE,status:k}];function NF(){E(W1[0].name,{...W1[0],async execute({cube_id:Q,faces:$}){let W=Q?N4(Q):Cube.selected.at(0);if(!W)throw Error("No cube found to get material instances from.");let Y=$||f6.options,X={};for(let J of Y){let H=W.faces[J];if(H)X[J]={material_name:H.material_name||"",texture:H.texture?H.getTexture()?.name||H.texture.toString():null}}return JSON.stringify({cube:{name:W.name,uuid:W.uuid},faces:X},null,2)}},W1[0].status),E(W1[1].name,{...W1[1],async execute({cube_id:Q,material_name:$,faces:W}){let Y;if(Q)Y=[N4(Q)];else{if(!Cube.selected.length)throw Error("No cube specified and no cubes selected. Provide a cube_id or select cubes.");Y=Cube.selected}Undo.initEdit({elements:Y,uv_only:!0});let X=0;for(let J of Y)for(let H of W){let G=J.faces[H];if(G)G.extend({material_name:$}),X++}return Undo.finishEdit("Set material instances"),Canvas.updateAll(),`Set material instance "${$}" on ${X} face(s) across ${Y.length} cube(s).`}},W1[1].status),E(W1[2].name,{...W1[2],async execute(){let Q={};for(let W of Cube.all)for(let Y of f6.options){let X=W.faces[Y];if(X&&X.material_name){if(!Q[X.material_name])Q[X.material_name]=[];Q[X.material_name].push({cube_name:W.name,cube_uuid:W.uuid,face:Y})}}let $=Object.entries(Q).map(([W,Y])=>({name:W,usage_count:Y.length,usages:Y}));return JSON.stringify({total_unique_instances:$.length,material_instances:$},null,2)}},W1[2].status),E(W1[3].name,{...W1[3],async execute({assignments:Q}){let $={},W=[];for(let X of Q)if(!$[X.cube_id]){let J=N4(X.cube_id);$[X.cube_id]=J,W.push(J)}Undo.initEdit({elements:W,uv_only:!0});let Y=0;for(let X of Q){let J=$[X.cube_id];for(let H of X.faces){let G=J.faces[H];if(G)G.extend({material_name:X.material_name}),Y++}}return Undo.finishEdit("Bulk set material instances"),Canvas.updateAll(),`Applied ${Q.length} material instance assignment(s) affecting ${Y} face(s) on ${W.length} cube(s).`}},W1[3].status),E(W1[4].name,{...W1[4],async execute({cube_id:Q,faces:$,all_cubes:W}){let Y;if(W)Y=Cube.all;else if(Q)Y=[N4(Q)];else{if(!Cube.selected.length)throw Error("No cube specified and no cubes selected. Provide a cube_id, select cubes, or set all_cubes=true.");Y=Cube.selected}if(Y.length===0)return"No cubes to process.";Undo.initEdit({elements:Y,uv_only:!0});let X=$||f6.options,J=0;for(let H of Y)for(let G of X){let B=H.faces[G];if(B&&B.material_name)B.extend({material_name:""}),J++}return Undo.finishEdit("Clear material instances"),Canvas.updateAll(),`Cleared material instances from ${J} face(s) across ${Y.length} cube(s).`}},W1[4].status)}function MF(Q){return Armature.all.find(($)=>$.uuid===Q||$.name===Q||$.uuid.startsWith(Q))}function IQ(Q){let $=MF(Q);if(!$)throw Error(`Armature not found: ${Q}`);return $}function jF(Q){return ArmatureBone.all.find(($)=>$.uuid===Q||$.name===Q||$.uuid.startsWith(Q))}function L6(Q){let $=jF(Q);if(!$)throw Error(`Armature bone not found: ${Q}`);return $}function M4(Q){return Mesh.all.find(($)=>$.uuid===Q||$.name===Q||$.uuid.startsWith(Q))}function j4(Q){return{uuid:Q.uuid,name:Q.name,type:Q.type,visibility:Q.visibility,locked:Q.locked,export:Q.export,isOpen:Q.isOpen,origin:Q.origin,childCount:Q.children.length,boneCount:Q.getAllBones().length}}function F9(Q){let $=Q.getArmature();return{uuid:Q.uuid,name:Q.name,type:Q.type,armature:$?{uuid:$.uuid,name:$.name}:null,origin:Q.origin,rotation:Q.rotation,length:Q.length,width:Q.width,connected:Q.connected,color:Q.color,visibility:Q.visibility,locked:Q.locked,export:Q.export,parentBone:Q.parent instanceof ArmatureBone?{uuid:Q.parent.uuid,name:Q.parent.name}:null,childCount:Q.children.length,vertexWeightCount:Object.keys(Q.vertex_weights).length}}var UE=L.object({}),AE=L.object({id:T0.describe("UUID or name of the armature."),include_bones:L.boolean().optional().default(!0).describe("Whether to include bone hierarchy in response.")}),zE=L.object({name:L.string().optional().default("armature").describe("Name for the new armature."),visibility:L.boolean().optional().default(!0),locked:L.boolean().optional().default(!1),add_initial_bone:L.boolean().optional().default(!0).describe("Whether to add an initial bone to the armature.")}),wE=L.object({id:T0.describe("UUID or name of the armature to remove.")}),OE=L.object({id:T0.describe("UUID or name of the armature."),name:L.string().optional().describe("New name for the armature."),visibility:L.boolean().optional(),locked:L.boolean().optional(),export:L.boolean().optional().describe("Whether to export this armature.")}),NE=L.object({armature_id:L.string().optional().describe("Filter bones by armature UUID or name. If not provided, lists all bones.")}),ME=L.object({id:T0.describe("UUID or name of the bone."),include_weights:L.boolean().optional().default(!1).describe("Whether to include all vertex weights in response.")}),jE=L.object({parent_id:T0.describe("UUID or name of parent armature or bone."),name:L.string().optional().default("bone").describe("Name for the new bone."),origin:n.optional().describe("Position of the bone. Defaults to [0, parent.length, 0] for child bones."),rotation:n.optional().default([0,0,0]),length:L.number().optional().default(8).describe("Length of the bone."),width:L.number().optional().default(2).describe("Width of the bone."),connected:L.boolean().optional().default(!0).describe("Whether bone is connected to parent."),color:L.number().int().min(0).max(7).optional().describe("Marker color index (0-7).")}),DE=L.object({id:T0.describe("UUID or name of the bone to remove."),remove_children:L.boolean().optional().default(!0).describe("Whether to also remove child bones.")}),EE=L.object({id:T0.describe("UUID or name of the bone."),name:L.string().optional(),origin:n.optional().describe("New position of the bone."),rotation:n.optional().describe("New rotation [x, y, z] in degrees."),length:L.number().optional(),width:L.number().optional(),connected:L.boolean().optional(),color:L.number().int().min(0).max(7).optional(),visibility:L.boolean().optional(),locked:L.boolean().optional()}),RE=L.object({ids:L.array(T0).describe("Array of bone UUIDs or names to update."),visibility:L.boolean().optional(),locked:L.boolean().optional(),color:L.number().int().min(0).max(7).optional()}),PE=L.object({ids:L.array(T0).optional().describe("Array of bone UUIDs or names to select."),armature_id:L.string().optional().describe("Select all bones in this armature."),include_descendants:L.boolean().optional().default(!1).describe("Include all descendant bones in selection."),clear_selection:L.boolean().optional().default(!0).describe("Clear existing selection before selecting.")}),IE=L.object({mesh_id:K1,bone_id:L.string().optional().describe("Filter weights by specific bone.")}),SE=L.object({bone_id:T0.describe("UUID or name of the bone."),mesh_id:K1,vertex_key:L.string().describe("Key of the vertex in the mesh."),weight:L.number().min(0).max(1).describe("Weight value (0-1). Set to 0 to remove weight.")}),ZE=L.object({bone_id:T0.describe("UUID or name of the bone."),mesh_id:K1,weights:L.record(L.string(),L.number().min(0).max(1)).describe("Map of vertex_key -> weight value.")}),CE=L.object({bone_id:T0.describe("UUID or name of the bone."),mesh_id:K1}),l=[{name:"list_armatures",description:"Lists all armatures in the current project with their basic info.",annotations:{title:"List Armatures",readOnlyHint:!0},parameters:UE,status:d},{name:"get_armature",description:"Gets detailed information about a specific armature including its bones.",annotations:{title:"Get Armature",readOnlyHint:!0},parameters:AE,status:d},{name:"add_armature",description:"Creates a new armature in the project. An armature is a skeletal rig used for mesh deformation.",annotations:{title:"Add Armature",destructiveHint:!0},parameters:zE,status:d},{name:"remove_armature",description:"Removes an armature and all its bones from the project.",annotations:{title:"Remove Armature",destructiveHint:!0},parameters:wE,status:k},{name:"update_armature",description:"Updates properties of an existing armature.",annotations:{title:"Update Armature",destructiveHint:!0},parameters:OE,status:d},{name:"list_armature_bones",description:"Lists all armature bones, optionally filtered by a specific armature.",annotations:{title:"List Armature Bones",readOnlyHint:!0},parameters:NE,status:d},{name:"get_armature_bone",description:"Gets detailed information about a specific armature bone.",annotations:{title:"Get Armature Bone",readOnlyHint:!0},parameters:ME,status:d},{name:"add_armature_bone",description:"Creates a new bone and adds it to an armature or parent bone.",annotations:{title:"Add Armature Bone",destructiveHint:!0},parameters:jE,status:d},{name:"remove_armature_bone",description:"Removes an armature bone from the project.",annotations:{title:"Remove Armature Bone",destructiveHint:!0},parameters:DE,status:k},{name:"update_armature_bone",description:"Updates properties of an existing armature bone.",annotations:{title:"Update Armature Bone",destructiveHint:!0},parameters:EE,status:d},{name:"update_armature_bones_batch",description:"Updates multiple armature bones at once with the same properties.",annotations:{title:"Update Armature Bones (Batch)",destructiveHint:!0},parameters:RE,status:k},{name:"select_armature_bones",description:"Selects armature bones by ID. Can select single bone, multiple bones, or bone hierarchy.",annotations:{title:"Select Armature Bones",destructiveHint:!1},parameters:PE,status:d},{name:"get_vertex_weights",description:"Gets vertex weights for a mesh from all bones affecting it.",annotations:{title:"Get Vertex Weights",readOnlyHint:!0},parameters:IE,status:d},{name:"set_vertex_weight",description:"Sets the weight of a specific vertex on a bone.",annotations:{title:"Set Vertex Weight",destructiveHint:!0},parameters:SE,status:d},{name:"set_vertex_weights_batch",description:"Sets multiple vertex weights at once on a bone.",annotations:{title:"Set Vertex Weights (Batch)",destructiveHint:!0},parameters:ZE,status:k},{name:"clear_vertex_weights",description:"Clears all vertex weights from a bone for a specific mesh.",annotations:{title:"Clear Vertex Weights",destructiveHint:!0},parameters:CE,status:k}];function DF(){E(l[0].name,{...l[0],async execute(){let Q=Armature.all.map(j4);return JSON.stringify({count:Q.length,armatures:Q},null,2)}},l[0].status),E(l[1].name,{...l[1],async execute({id:Q,include_bones:$}){let W=IQ(Q),Y=j4(W);if($){let X=W.getAllBones().map(F9);return JSON.stringify({...Y,bones:X},null,2)}return JSON.stringify(Y,null,2)}},l[1].status),E(l[2].name,{...l[2],async execute({name:Q,visibility:$,locked:W,add_initial_bone:Y}){if(!Format.armature_rig)throw Error("Current format does not support armatures. Switch to a format that supports armature rigs.");Undo.initEdit({outliner:!0,elements:[]});let X=new Armature({name:Q,visibility:$,locked:W});X.addTo(Outliner.root),X.isOpen=!0,X.createUniqueName(),X.init();let J=[X];if(Y){let H=new ArmatureBone({name:"bone"});H.addTo(X),H.init(),J.push(H)}return Undo.finishEdit("Agent added armature",{outliner:!0,elements:J}),Canvas.updateAll(),JSON.stringify({message:`Created armature "${X.name}"`,armature:j4(X)},null,2)}},l[2].status),E(l[3].name,{...l[3],async execute({id:Q}){let $=IQ(Q),W=$.name;return Undo.initEdit({outliner:!0,elements:[]}),$.remove(),Undo.finishEdit("Agent removed armature"),Canvas.updateAll(),`Removed armature "${W}"`}},l[3].status),E(l[4].name,{...l[4],async execute({id:Q,name:$,visibility:W,locked:Y,export:X}){let J=IQ(Q);if(Undo.initEdit({outliner:!0,elements:[J]}),$!==void 0)J.name=$;if(W!==void 0)J.visibility=W;if(Y!==void 0)J.locked=Y;if(X!==void 0)J.export=X;return J.updateElement(),Undo.finishEdit("Agent updated armature"),Canvas.updateAll(),JSON.stringify({message:`Updated armature "${J.name}"`,armature:j4(J)},null,2)}},l[4].status),E(l[5].name,{...l[5],async execute({armature_id:Q}){let $;if(Q)$=IQ(Q).getAllBones();else $=ArmatureBone.all;let W=$.map(F9);return JSON.stringify({count:W.length,bones:W},null,2)}},l[5].status),E(l[6].name,{...l[6],async execute({id:Q,include_weights:$}){let W=L6(Q),Y=F9(W);if($)return JSON.stringify({...Y,vertex_weights:W.vertex_weights},null,2);return JSON.stringify(Y,null,2)}},l[6].status),E(l[7].name,{...l[7],async execute({parent_id:Q,name:$,origin:W,rotation:Y,length:X,width:J,connected:H,color:G}){let B=MF(Q);if(!B)B=jF(Q);if(!B)throw Error(`Parent not found: ${Q}. Must be an armature or bone.`);let K=B instanceof ArmatureBone?[0,B.length??8,0]:[0,0,0];Undo.initEdit({outliner:!0,elements:[]});let F=new ArmatureBone({name:$,origin:W??K,rotation:Y,length:X,width:J,connected:H,color:G});if(F.addTo(B),F.isOpen=!0,Format.bone_rig)F.createUniqueName();return F.init(),Undo.finishEdit("Agent added armature bone",{outliner:!0,elements:[F]}),Canvas.updateAll(),JSON.stringify({message:`Created bone "${F.name}"`,bone:F9(F)},null,2)}},l[7].status),E(l[8].name,{...l[8],async execute({id:Q,remove_children:$}){let W=L6(Q),Y=W.name;if(Undo.initEdit({outliner:!0,elements:[]}),!$&&W.children.length>0){let X=W.parent;for(let J of[...W.children])J.addTo(X)}return W.remove(),Undo.finishEdit("Agent removed armature bone"),Canvas.updateAll(),`Removed bone "${Y}"`}},l[8].status),E(l[9].name,{...l[9],async execute({id:Q,name:$,origin:W,rotation:Y,length:X,width:J,connected:H,color:G,visibility:B,locked:K}){let F=L6(Q);if(Undo.initEdit({outliner:!0,elements:[F]}),$!==void 0)F.name=$;if(W!==void 0)F.origin.V3_set(W);if(Y!==void 0)F.rotation.V3_set(Y);if(X!==void 0)F.length=X;if(J!==void 0)F.width=J;if(H!==void 0)F.connected=H;if(G!==void 0)F.setColor(G);if(B!==void 0)F.visibility=B;if(K!==void 0)F.locked=K;return F.preview_controller.updateTransform(F),F.updateElement(),Undo.finishEdit("Agent updated armature bone"),Canvas.updateAll(),JSON.stringify({message:`Updated bone "${F.name}"`,bone:F9(F)},null,2)}},l[9].status),E(l[10].name,{...l[10],async execute({ids:Q,visibility:$,locked:W,color:Y}){let X=Q.map(L6);Undo.initEdit({outliner:!0,elements:X});for(let J of X){if($!==void 0)J.visibility=$;if(W!==void 0)J.locked=W;if(Y!==void 0)J.setColor(Y);J.updateElement()}return Undo.finishEdit("Agent updated armature bones (batch)"),Canvas.updateAll(),JSON.stringify({message:`Updated ${X.length} bones`,bones:X.map(F9)},null,2)}},l[10].status),E(l[11].name,{...l[11],async execute({ids:Q,armature_id:$,include_descendants:W,clear_selection:Y}){if(Y)unselectAllElements();let X=[];if($)X=IQ($).getAllBones();else if(Q&&Q.length>0)for(let J of Q){let H=L6(J);if(X.push(H),W)H.forEachChild((G)=>{if(G instanceof ArmatureBone)X.push(G)})}for(let J of X)J.select();return updateSelection(),JSON.stringify({message:`Selected ${X.length} bone(s)`,bones:X.map((J)=>({uuid:J.uuid,name:J.name}))},null,2)}},l[11].status),E(l[12].name,{...l[12],async execute({mesh_id:Q,bone_id:$}){let W;if(Q)W=M4(Q);else W=Mesh.selected[0];if(!W)throw Error("No mesh found. Provide mesh_id or select a mesh.");let Y=W.getArmature?.();if(!Y)throw Error(`Mesh "${W.name}" is not associated with an armature.`);let X=$?[L6($)]:Y.getAllBones(),J={};for(let H of X){let G={};for(let B in W.vertices){let K=H.getVertexWeight(W,B);if(K>0)G[B]=K}if(Object.keys(G).length>0)J[H.name]=G}return JSON.stringify({mesh:{uuid:W.uuid,name:W.name},armature:{uuid:Y.uuid,name:Y.name},weights:J},null,2)}},l[12].status),E(l[13].name,{...l[13],async execute({bone_id:Q,mesh_id:$,vertex_key:W,weight:Y}){let X=L6(Q),J;if($)J=M4($);else J=Mesh.selected[0];if(!J)throw Error("No mesh found. Provide mesh_id or select a mesh.");if(!(W in J.vertices))throw Error(`Vertex "${W}" not found in mesh "${J.name}".`);return Undo.initEdit({elements:[X]}),X.setVertexWeight(J,W,Y),Undo.finishEdit("Agent set vertex weight"),Canvas.updateView({elements:[J],element_aspects:{geometry:!0}}),JSON.stringify({message:`Set weight ${Y} for vertex "${W}" on bone "${X.name}"`,bone:{uuid:X.uuid,name:X.name},mesh:{uuid:J.uuid,name:J.name},vertex:W,weight:Y},null,2)}},l[13].status),E(l[14].name,{...l[14],async execute({bone_id:Q,mesh_id:$,weights:W}){let Y=L6(Q),X;if($)X=M4($);else X=Mesh.selected[0];if(!X)throw Error("No mesh found. Provide mesh_id or select a mesh.");Undo.initEdit({elements:[Y]});let J=0;for(let[H,G]of Object.entries(W))if(H in X.vertices)Y.setVertexWeight(X,H,G),J++;return Undo.finishEdit("Agent set vertex weights (batch)"),Canvas.updateView({elements:[X],element_aspects:{geometry:!0}}),JSON.stringify({message:`Set ${J} vertex weights on bone "${Y.name}"`,bone:{uuid:Y.uuid,name:Y.name},mesh:{uuid:X.uuid,name:X.name},weightsSet:J},null,2)}},l[14].status),E(l[15].name,{...l[15],async execute({bone_id:Q,mesh_id:$}){let W=L6(Q),Y;if($)Y=M4($);else Y=Mesh.selected[0];if(!Y)throw Error("No mesh found. Provide mesh_id or select a mesh.");Undo.initEdit({elements:[W]});let X=0,J=Y.uuid.substring(0,6)+":";for(let H in W.vertex_weights)if(H.startsWith(J))delete W.vertex_weights[H],X++;return Undo.finishEdit("Agent cleared vertex weights"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0}}),JSON.stringify({message:`Cleared ${X} vertex weights from bone "${W.name}" for mesh "${Y.name}"`,bone:{uuid:W.uuid,name:W.name},mesh:{uuid:Y.uuid,name:Y.name},weightsCleared:X},null,2)}},l[15].status)}function bE(Q){let $=[];if(!Q.buttons)return $;let W=Q.message.match(/cube\s+"([^"]+)"/i);if(W){let H=W[1],G=Cube.all.find((B)=>B.name===H);if(G)$.push({type:"cube",name:G.name,uuid:G.uuid})}let Y=Q.message.match(/texture\s+"([^"]+)"/i);if(Y){let H=Y[1],G=Texture.all.find((B)=>B.name===H||B.folder+"/"+B.name===H);if(G)$.push({type:"texture",name:G.name,uuid:G.uuid})}let X=Q.message.match(/in\s+"([^"]+)"/i);if(X){let H=X[1],G=Animation.all?.find((B)=>B.name===H);if(G)$.push({type:"animation",name:G.name,uuid:G.uuid})}let J=Q.message.match(/on\s+"([^"]+)"/i);if(J&&!X){let H=J[1],G=Group.all.find((B)=>B.name===H);if(G)$.push({type:"group",name:G.name,uuid:G.uuid})}return $}function L9(Q,$){let W=bE(Q);return{message:Q.message,severity:$?"error":"warning",hasActions:(Q.buttons?.length??0)>0,actionNames:Q.buttons?.map((Y)=>Y.name)??[],elementRefs:W}}function EF(Q){return{id:Q.id,type:Q.type??null,updateTriggers:Q.update_triggers,plugin:Q.plugin??null,currentErrors:Q.errors.length,currentWarnings:Q.warnings.length}}function RF(){Q1("validator-status",{uriTemplate:"validator://status",title:"Validator Status",description:"Returns the current validation status including error/warning counts and a summary of all problems.",async listCallback(){return{resources:[{uri:"validator://status",name:"Validation Status",description:Validator.errors.length+Validator.warnings.length===0?"No validation problems":`${Validator.errors.length} errors, ${Validator.warnings.length} warnings`,mimeType:"application/json"}]}},async readCallback(Q){let $=Validator.errors.map((Y)=>L9(Y,!0)),W=Validator.warnings.map((Y)=>L9(Y,!1));return{contents:[{uri:Q.href,text:JSON.stringify({summary:{totalProblems:$.length+W.length,errorCount:$.length,warningCount:W.length,checkCount:Validator.checks.length,triggers:Validator.triggers},errors:$,warnings:W},null,2),mimeType:"application/json"}]}}}),Q1("validator-checks",{uriTemplate:"validator://checks/{id}",title:"Validator Checks",description:"Returns information about registered validator checks. Use without an ID to list all checks, or provide a check ID to get details about a specific check.",async listCallback(){if(Validator.checks.length===0)return{resources:[]};return{resources:Validator.checks.map((Q)=>({uri:`validator://checks/${Q.id}`,name:Q.id,description:`Triggers: ${Q.update_triggers.join(", ")||"manual"}`,mimeType:"application/json"}))}},async readCallback(Q,{id:$}){if(!$)return{contents:[{uri:Q.href,text:JSON.stringify({checks:Validator.checks.map(EF),count:Validator.checks.length,allTriggers:Validator.triggers},null,2),mimeType:"application/json"}]};let W=Validator.checks.find((Y)=>Y.id===$);if(!W)throw Error(`Validator check with ID "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify({...EF(W),errors:W.errors.map((Y)=>L9(Y,!0)),warnings:W.warnings.map((Y)=>L9(Y,!1))},null,2),mimeType:"application/json"}]}}}),Q1("validator-warnings",{uriTemplate:"validator://warnings",title:"Validator Warnings",description:"Returns all current validation warnings with element references where available.",async listCallback(){return{resources:[{uri:"validator://warnings",name:"Validation Warnings",description:Validator.warnings.length===0?"No warnings":`${Validator.warnings.length} warning(s)`,mimeType:"application/json"}]}},async readCallback(Q){let $=Validator.warnings.map((X)=>L9(X,!1)),W={},Y=[];for(let X of $)if(X.elementRefs.length>0){let J=X.elementRefs[0].type??"unknown";if(!W[J])W[J]=[];W[J].push(X)}else Y.push(X);return{contents:[{uri:Q.href,text:JSON.stringify({count:$.length,warnings:$,byElementType:W,unlinkedWarnings:Y},null,2),mimeType:"application/json"}]}}}),Q1("validator-errors",{uriTemplate:"validator://errors",title:"Validator Errors",description:"Returns all current validation errors with element references where available.",async listCallback(){return{resources:[{uri:"validator://errors",name:"Validation Errors",description:Validator.errors.length===0?"No errors":`${Validator.errors.length} error(s)`,mimeType:"application/json"}]}},async readCallback(Q){let $=Validator.errors.map((X)=>L9(X,!0)),W={},Y=[];for(let X of $)if(X.elementRefs.length>0){let J=X.elementRefs[0].type??"unknown";if(!W[J])W[J]=[];W[J].push(X)}else Y.push(X);return{contents:[{uri:Q.href,text:JSON.stringify({count:$.length,errors:$,byElementType:W,unlinkedErrors:Y},null,2),mimeType:"application/json"}]}}})}var vE=["hytale_character","hytale_prop"],PF=["flat","standard","fullbright","reflective"],IF=["+X","-X","+Y","-Y","+Z","-Z"];function L8(){if(typeof Plugins>"u")return!1;return Plugins.installed?.some?.((Q)=>Q.id==="hytale_plugin"&&!Q.disabled)??!1}function S0(){if(typeof Format>"u"||!Format?.id)return!1;return vE.includes(Format.id)}function q9(){if(!S0())return null;if(Format.id==="hytale_character")return"character";if(Format.id==="hytale_prop")return"prop";return null}function V9(){let Q=q9();if(Q==="character")return 64;if(Q==="prop")return 32;return 16}function SQ(){if(!L8())return[];if(typeof Collection>"u")return[];return(Collection.all??[]).filter((Q)=>Q.export_codec==="blockymodel")}function ZQ(){if(typeof Group>"u")return[];return(Group.all??[]).filter((Q)=>Q.is_piece===!0)}function q8(Q){return Q.shading_mode??"standard"}function V8(Q){return Q.double_sided??!1}function CQ(){return 60}function kE(){return 255}function TE(){if(typeof Group>"u")return 0;if(typeof Cube>"u")return 0;let Q=0,$=Group.all??[],W=Cube.all??[];Q+=$.length;for(let Y of W){let X=Y.parent;if(X instanceof Group){if(X.children.filter((H)=>H instanceof Cube).length>1)Q+=1}else Q+=1}return Q}function bQ(){let Q=TE(),$=kE(),W=Q<=$;return{valid:W,count:Q,max:$,message:W?void 0:`Node count (${Q}) exceeds Hytale limit of ${$} nodes.`}}var _E=L.enum(PF),xE=L.enum(IF),yE=L.enum(["loop","hold","once"]),D4=L.object({}),gE=L.object({cube_id:B6,shading_mode:_E.optional().describe("Shading mode: flat (no lighting), standard (normal), fullbright (emissive), reflective"),double_sided:L.boolean().optional().describe("Whether to render both sides of faces")}),hE=L.object({cube_id:B6}),fE=L.object({name:L.string().describe("Name for the quad"),position:n.default([0,0,0]).describe("Position [x, y, z]"),normal:xE.default("+Y").describe("Normal direction: +X, -X, +Y, -Y, +Z, -Z"),size:WF.default([16,16]),group:B9.describe("Parent group/bone name"),double_sided:L.boolean().default(!0).describe("Whether to render both sides")}),uE=L.object({group_name:L.string().describe("Name of the group to mark as attachment piece"),is_piece:L.boolean().describe("Whether the group is an attachment piece")}),lE=L.object({bone_name:RQ,time:L.number().describe("Time in seconds for the keyframe"),visible:L.boolean().describe("Whether the bone is visible at this keyframe"),animation_id:G9}),mE=L.object({animation_id:G9,loop_mode:yE.describe("Loop mode: loop (continuous), hold (freeze on last frame), once (play once)")}),cE=L.object({cube_id:B6,stretch:$F}),pE=L.object({cube_id:B6}),$0=[{name:"hytale_get_format_info",description:"Returns information about the current Hytale format. Requires the Hytale plugin and a Hytale format project to be active.",annotations:{title:"Get Hytale Format Info",readOnlyHint:!0},parameters:D4,status:"experimental"},{name:"hytale_validate_model",description:"Validates the current Hytale model against Hytale engine constraints (node count, UV sizes, etc.).",annotations:{title:"Validate Hytale Model",readOnlyHint:!0},parameters:D4,status:"experimental"},{name:"hytale_set_cube_properties",description:"Sets Hytale-specific properties on a cube: shading_mode (flat, standard, fullbright, reflective) and double_sided.",annotations:{title:"Set Hytale Cube Properties",destructiveHint:!1},parameters:gE,status:"experimental"},{name:"hytale_get_cube_properties",description:"Gets Hytale-specific properties from a cube (shading_mode, double_sided).",annotations:{title:"Get Hytale Cube Properties",readOnlyHint:!0},parameters:hE,status:"experimental"},{name:"hytale_create_quad",description:"Creates a Hytale quad (2D plane) with a specified normal direction. Quads are single-face elements useful for flat surfaces.",annotations:{title:"Create Hytale Quad",destructiveHint:!1},parameters:fE,status:"experimental"},{name:"hytale_list_attachments",description:"Lists all attachment collections in the current Hytale project.",annotations:{title:"List Hytale Attachments",readOnlyHint:!0},parameters:D4,status:"experimental"},{name:"hytale_set_attachment_piece",description:"Marks or unmarks a group as an attachment piece. Attachment pieces attach to like-named bones in the main model.",annotations:{title:"Set Attachment Piece",destructiveHint:!1},parameters:uE,status:"experimental"},{name:"hytale_list_attachment_pieces",description:"Lists all groups marked as attachment pieces.",annotations:{title:"List Attachment Pieces",readOnlyHint:!0},parameters:D4,status:"experimental"},{name:"hytale_create_visibility_keyframe",description:"Creates a visibility keyframe for a bone. Hytale supports toggling node visibility at keyframes.",annotations:{title:"Create Visibility Keyframe",destructiveHint:!1},parameters:lE,status:"experimental"},{name:"hytale_set_animation_loop",description:'Sets the loop mode for a Hytale animation. Hytale supports "loop" (continuous) or "hold" (freeze on last frame).',annotations:{title:"Set Animation Loop Mode",destructiveHint:!1},parameters:mE,status:"experimental"},{name:"hytale_set_cube_stretch",description:"Sets the stretch values for a cube. Hytale uses stretch instead of float sizes for better UV handling.",annotations:{title:"Set Cube Stretch",destructiveHint:!1},parameters:cE,status:"experimental"},{name:"hytale_get_cube_stretch",description:"Gets the stretch values for a cube.",annotations:{title:"Get Cube Stretch",readOnlyHint:!0},parameters:pE,status:"experimental"}];function SF(){if(!L8()){console.log("[MCP] Hytale plugin not detected, skipping Hytale tools registration");return}console.log("[MCP] Hytale plugin detected, registering Hytale tools"),E($0[0].name,{...$0[0],async execute(){if(!S0())throw Error("Current project is not using a Hytale format. Create or open a Hytale character or prop project first.");let Q=q9(),$=V9(),W=bQ();return JSON.stringify({formatType:Q,blockSize:$,animationFPS:CQ(),nodeCount:W.count,maxNodes:W.max,nodeCountValid:W.valid,features:{boneRig:!0,animationFiles:!0,quaternionInterpolation:!0,uvRotation:!0,stretchCubes:!0,attachments:!0,quads:!0}})}},$0[0].status),E($0[1].name,{...$0[1],async execute(){if(!S0())throw Error("Current project is not using a Hytale format.");let Q=bQ(),$=[];if(!Q.valid)$.push(Q.message);let W=Project?.textures??[],Y=V9();for(let X of W)if(X.width!==Y||X.height<Y){if(X.height%Y!==0)$.push(`Texture "${X.name}" has invalid dimensions (${X.width}x${X.height}). Expected width ${Y} and height multiple of ${Y}.`)}return JSON.stringify({valid:$.length===0,nodeCount:Q.count,maxNodes:Q.max,issues:$,blockSize:Y,textureCount:W.length})}},$0[1].status),E($0[2].name,{...$0[2],async execute({cube_id:Q,shading_mode:$,double_sided:W}){if(!S0())throw Error("Current project is not using a Hytale format.");let Y;if(Q){let J=A1(Q);if(!(J instanceof Cube))throw Error(`Element "${Q}" is not a cube.`);Y=J}else{let J=Cube.selected[0];if(!J)throw Error("No cube selected and no cube_id provided.");Y=J}Undo.initEdit({elements:[Y]});let X=Y;if($!==void 0)X.shading_mode=$;if(W!==void 0)X.double_sided=W;return Undo.finishEdit("Set Hytale cube properties"),JSON.stringify({uuid:Y.uuid,name:Y.name,shading_mode:q8(Y),double_sided:V8(Y)})}},$0[2].status),E($0[3].name,{...$0[3],async execute({cube_id:Q}){if(!S0())throw Error("Current project is not using a Hytale format.");let $;if(Q){let W=A1(Q);if(!(W instanceof Cube))throw Error(`Element "${Q}" is not a cube.`);$=W}else{let W=Cube.selected[0];if(!W)throw Error("No cube selected and no cube_id provided.");$=W}return JSON.stringify({uuid:$.uuid,name:$.name,shading_mode:q8($),double_sided:V8($)})}},$0[3].status),E($0[4].name,{...$0[4],async execute({name:Q,position:$,normal:W,size:Y,group:X,double_sided:J}){if(!S0())throw Error("Current project is not using a Hytale format.");let H;if(X)H=n0(X);let[G,B]=Y,[K,F,q]=$,A,V;switch(W){case"+X":case"-X":A=[K,F,q],V=[K,F+B,q+G];break;case"+Y":case"-Y":A=[K,F,q],V=[K+G,F,q+B];break;case"+Z":case"-Z":A=[K,F,q],V=[K+G,F+B,q];break;default:A=[K,F,q],V=[K+G,F+B,q]}Undo.initEdit({outliner:!0,elements:[]});let U=new Cube({name:Q,from:A,to:V,autouv:1}).init(),z=U;if(z.double_sided=J,z.shading_mode="standard",H)U.addTo(H);return Undo.finishEdit("Create Hytale quad"),Canvas.updateAll(),JSON.stringify({uuid:U.uuid,name:U.name,normal:W,from:A,to:V,double_sided:J})}},$0[4].status),E($0[5].name,{...$0[5],async execute(){if(!S0())throw Error("Current project is not using a Hytale format.");let Q=SQ();return JSON.stringify({count:Q.length,attachments:Q.map(($)=>({uuid:$.uuid,name:$.name,texture:$.texture??null,elementCount:$.children?.length??0}))})}},$0[5].status),E($0[6].name,{...$0[6],async execute({group_name:Q,is_piece:$}){if(!S0())throw Error("Current project is not using a Hytale format.");let W=n0(Q);return Undo.initEdit({outliner:!0}),W.is_piece=$,Undo.finishEdit("Set attachment piece"),JSON.stringify({uuid:W.uuid,name:W.name,is_piece:$})}},$0[6].status),E($0[7].name,{...$0[7],async execute(){if(!S0())throw Error("Current project is not using a Hytale format.");let Q=ZQ();return JSON.stringify({count:Q.length,pieces:Q.map(($)=>({uuid:$.uuid,name:$.name,origin:$.origin}))})}},$0[7].status),E($0[8].name,{...$0[8],async execute({bone_name:Q,time:$,visible:W,animation_id:Y}){if(!S0())throw Error("Current project is not using a Hytale format.");let X;if(Y){if(X=Animation.all.find((G)=>G.uuid===Y||G.name===Y),!X)throw Error(`Animation "${Y}" not found.`)}else if(X=Animation.selected,!X)throw Error("No animation selected and no animation_id provided.");let J=X.getBoneAnimator(n0(Q));if(!J)throw Error(`Could not get animator for bone "${Q}".`);Undo.initEdit({animations:[X]});let H=J.addKeyframe({channel:"visibility",time:$,data_points:[{visible:W}]});if(Undo.finishEdit("Create visibility keyframe"),typeof updateKeyframeSelection==="function")updateKeyframeSelection();return JSON.stringify({success:!0,animation:X.name,bone:Q,time:$,visible:W,keyframe_uuid:H?.uuid})}},$0[8].status),E($0[9].name,{...$0[9],async execute({animation_id:Q,loop_mode:$}){if(!S0())throw Error("Current project is not using a Hytale format.");let W;if(Q){if(W=Animation.all.find((Y)=>Y.uuid===Q||Y.name===Q),!W)throw Error(`Animation "${Q}" not found.`)}else if(W=Animation.selected,!W)throw Error("No animation selected and no animation_id provided.");return Undo.initEdit({animations:[W]}),W.loop=$,Undo.finishEdit("Set animation loop mode"),JSON.stringify({animation:W.name,uuid:W.uuid,loop_mode:$})}},$0[9].status),E($0[10].name,{...$0[10],async execute({cube_id:Q,stretch:$}){if(!S0())throw Error("Current project is not using a Hytale format.");let W;if(Q){let Y=A1(Q);if(!(Y instanceof Cube))throw Error(`Element "${Q}" is not a cube.`);W=Y}else{let Y=Cube.selected[0];if(!Y)throw Error("No cube selected and no cube_id provided.");W=Y}return Undo.initEdit({elements:[W]}),W.stretch=[...$],Undo.finishEdit("Set cube stretch"),Canvas.updateAll(),JSON.stringify({uuid:W.uuid,name:W.name,stretch:$})}},$0[10].status),E($0[11].name,{...$0[11],async execute({cube_id:Q}){if(!S0())throw Error("Current project is not using a Hytale format.");let $;if(Q){let Y=A1(Q);if(!(Y instanceof Cube))throw Error(`Element "${Q}" is not a cube.`);$=Y}else{let Y=Cube.selected[0];if(!Y)throw Error("No cube selected and no cube_id provided.");$=Y}let W=$.stretch??[1,1,1];return JSON.stringify({uuid:$.uuid,name:$.name,stretch:W})}},$0[11].status),console.log("[MCP] Hytale tools registered successfully")}function ZF(){if(!L8()){console.log("[MCP] Hytale plugin not detected, skipping Hytale resources registration");return}console.log("[MCP] Hytale plugin detected, registering Hytale resources"),Q1("hytale-format",{uriTemplate:"hytale://format",title:"Hytale Format Information",description:"Returns comprehensive information about the current Hytale format, including format type, block size, node limits, and feature support.",async listCallback(){if(!S0())return{resources:[]};return{resources:[{uri:"hytale://format",name:`Hytale ${q9()} format`,description:`Block size: ${V9()}, FPS: ${CQ()}`,mimeType:"application/json"}]}},async readCallback(Q){if(!S0())return{contents:[{uri:Q.href,text:JSON.stringify({active:!1,message:"No Hytale format project is currently active."}),mimeType:"application/json"}]};let $=q9(),W=V9(),Y=bQ();return{contents:[{uri:Q.href,text:JSON.stringify({active:!0,formatType:$,formatId:$==="character"?"hytale_character":"hytale_prop",blockSize:W,animationFPS:CQ(),nodeCount:Y.count,maxNodes:Y.max,nodeCountValid:Y.valid,features:{boneRig:!0,animationFiles:!0,quaternionInterpolation:!0,uvRotation:!0,stretchCubes:!0,attachments:!0,quads:!0,shadingModes:["flat","standard","fullbright","reflective"],doubleSided:!0,visibilityKeyframes:!0}}),mimeType:"application/json"}]}}}),Q1("hytale-attachments",{uriTemplate:"hytale://attachments/{id}",title:"Hytale Attachments",description:"Returns information about attachment collections in the current Hytale project. Attachments are separate models that can be attached to bones.",async listCallback(){if(!S0())return{resources:[]};return{resources:SQ().map(($)=>({uri:`hytale://attachments/${$.uuid}`,name:$.name,description:`Attachment collection${$.texture?" with texture":""}`,mimeType:"application/json"}))}},async readCallback(Q,{id:$}){if(!S0())return{contents:[{uri:Q.href,text:JSON.stringify({error:"No Hytale format project is currently active."}),mimeType:"application/json"}]};let W=SQ();if($){let Y=W.find((X)=>X.uuid===$||X.name===$);if(!Y)throw Error(`Attachment "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify({uuid:Y.uuid,name:Y.name,texture:Y.texture??null,elementCount:Y.children?.length??0,exportCodec:Y.export_codec}),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({count:W.length,attachments:W.map((Y)=>({uuid:Y.uuid,name:Y.name,texture:Y.texture??null,elementCount:Y.children?.length??0}))}),mimeType:"application/json"}]}}}),Q1("hytale-pieces",{uriTemplate:"hytale://pieces/{id}",title:"Hytale Attachment Pieces",description:"Returns information about groups marked as attachment pieces. Attachment pieces connect to like-named bones in the main model.",async listCallback(){if(!S0())return{resources:[]};return{resources:ZQ().map(($)=>({uri:`hytale://pieces/${$.uuid}`,name:$.name,description:"Attachment piece bone",mimeType:"application/json"}))}},async readCallback(Q,{id:$}){if(!S0())return{contents:[{uri:Q.href,text:JSON.stringify({error:"No Hytale format project is currently active."}),mimeType:"application/json"}]};let W=ZQ();if($){let Y=W.find((X)=>X.uuid===$||X.name===$);if(!Y)throw Error(`Attachment piece "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify({uuid:Y.uuid,name:Y.name,origin:Y.origin,rotation:Y.rotation,is_piece:!0,childCount:Y.children?.length??0}),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({count:W.length,pieces:W.map((Y)=>({uuid:Y.uuid,name:Y.name,origin:Y.origin}))}),mimeType:"application/json"}]}}}),Q1("hytale-cubes",{uriTemplate:"hytale://cubes/{id}",title:"Hytale Cubes",description:"Returns information about cubes with Hytale-specific properties (shading_mode, double_sided, stretch).",async listCallback(){if(!S0())return{resources:[]};return{resources:(Cube.all??[]).map(($)=>({uri:`hytale://cubes/${$.uuid}`,name:$.name,description:`Shading: ${q8($)}, Double-sided: ${V8($)}`,mimeType:"application/json"}))}},async readCallback(Q,{id:$}){if(!S0())return{contents:[{uri:Q.href,text:JSON.stringify({error:"No Hytale format project is currently active."}),mimeType:"application/json"}]};let W=Cube.all??[];if($){let Y=W.find((J)=>J.uuid===$||J.name===$);if(!Y)throw Error(`Cube "${$}" not found.`);let X=Y;return{contents:[{uri:Q.href,text:JSON.stringify({uuid:Y.uuid,name:Y.name,from:Y.from,to:Y.to,origin:Y.origin,rotation:Y.rotation,stretch:Y.stretch??[1,1,1],shading_mode:q8(Y),double_sided:V8(Y),autouv:Y.autouv,visibility:Y.visibility}),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({count:W.length,cubes:W.map((Y)=>({uuid:Y.uuid,name:Y.name,shading_mode:q8(Y),double_sided:V8(Y),stretch:Y.stretch??[1,1,1]}))}),mimeType:"application/json"}]}}}),console.log("[MCP] Hytale resources registered successfully")}function CF(){if(!L8()){console.log("[MCP] Hytale plugin not detected, skipping Hytale prompts registration");return}console.log("[MCP] Hytale plugin detected, registering Hytale prompts"),h6("hytale_model_creation",{title:"Hytale Model Creation Guide",description:"Comprehensive guide for creating Hytale character and prop models. Covers format selection, node limits, shading modes, stretch, quads, and best practices.",argsSchema:L.object({format_type:L.enum(["character","prop","both"]).describe("Which format type to focus on").optional().default("both")}),async generate({format_type:Q}){let $=await`# Hytale Model Creation Guide

This guide covers creating 3D models for Hytale using Blockbench with the Hytale plugin.

## Format Selection

Hytale uses two model formats:

### Character Format (\`hytale_character\`)
- **Block Size**: 64 pixels
- **Use Case**: Humanoid/creature models with complex rigs
- **Features**: Full bone hierarchy, attachments, animations

### Prop Format (\`hytale_prop\`)
- **Block Size**: 32 pixels
- **Use Case**: Items, weapons, decorative objects
- **Features**: Simpler structure, optimized for props

## Key Concepts

### Node Limit
Hytale has a **maximum of 255 nodes** per model. Nodes include:
- Groups/bones
- Individual cubes (excluding the main shape cube of a group)

Use \`hytale_validate_model\` tool to check node count.

### Shading Modes
Cubes support four shading modes:
- \`standard\` - Normal lighting (default)
- \`flat\` - No lighting/shadows
- \`fullbright\` - Always fully lit (emissive effect)
- \`reflective\` - Reflective material

Set with \`hytale_set_cube_properties\` tool.

### Double-Sided Faces
Enable \`double_sided\` on cubes to render both front and back faces. Useful for:
- Thin planes/quads
- Cloth/fabric elements
- Transparency effects

### Stretch vs Size
Hytale prefers **stretch** over floating-point sizes:
- Stretch is a multiplier [x, y, z] applied to the base cube
- Better UV handling than fractional sizes
- Use \`hytale_set_cube_stretch\` / \`hytale_get_cube_stretch\` tools

### Quads
Hytale supports single-face quads (2D planes):
- Created with \`hytale_create_quad\` tool
- Specify normal direction: +X, -X, +Y, -Y, +Z, -Z
- Automatically double-sided by default

## Workflow

1. **Create Project**: Use \`create_project\` with format \`bedrock\` (Hytale uses similar format structure)
2. **Build Skeleton**: Create bone hierarchy using \`add_group\` with proper origins
3. **Add Geometry**: Use \`place_cube\` for cubes, \`hytale_create_quad\` for flat surfaces
4. **Set Properties**: Apply shading modes and double-sided as needed
5. **Validate**: Run \`hytale_validate_model\` before export

## Texture Guidelines

- Character textures: 64x64 or multiples for flipbooks
- Prop textures: 32x32 or multiples for flipbooks
- UV size must match texture resolution
- Use integer positions for pixel-perfect UVs

## Tips

- Keep node count under 255
- Use stretch for scaling instead of fractional sizes
- Group related cubes under bones for animation
- Mark attachment bones with \`is_piece: true\` using \`hytale_set_attachment_piece\`
`,W="";if(Q==="character")W=`
## Character-Specific Guidelines

You are creating a **Hytale Character** model (64px block size).

Key considerations:
- Complex bone hierarchies for humanoid/creature rigs
- Full animation support with all channels
- Attachment system for equipment
- Higher detail level (64px textures)

Typical bone structure:
\`\`\`
root
 body
    head
       [face details]
    arm_left
       hand_left
    arm_right
       hand_right
    leg_left
       foot_left
    leg_right
        foot_right
 [accessories]
\`\`\`
`;else if(Q==="prop")W=`
## Prop-Specific Guidelines

You are creating a **Hytale Prop** model (32px block size).

Key considerations:
- Simpler structure optimized for items/objects
- May have minimal or no animation
- Often single-bone or simple hierarchy
- Lower detail level (32px textures)

Common prop types:
- Weapons (sword, axe, bow)
- Tools (pickaxe, shovel)
- Items (food, potions, keys)
- Decorations (furniture, plants)
`;return{messages:[{role:"user",content:{type:"text",text:$+W}}]}}},"experimental"),h6("hytale_animation_workflow",{title:"Hytale Animation Workflow",description:"Guide for creating animations for Hytale models. Covers 60 FPS timing, quaternion rotations, visibility keyframes, loop modes, and common animation patterns.",argsSchema:L.object({animation_type:L.enum(["walk","idle","attack","general"]).describe("Type of animation to focus on").optional().default("general")}),async generate({animation_type:Q}){let $=await`# Hytale Animation Workflow

This guide covers creating animations for Hytale models using Blockbench with the Hytale plugin.

## Animation Basics

### Frame Rate
Hytale animations run at **60 FPS**. When setting keyframe times:
- 1 second = 60 frames
- 0.5 seconds = 30 frames
- Use decimal seconds in tools (e.g., 0.5, 1.0, 2.5)

### File Format
Animations are stored in \`.blockyanim\` files, separate from the model (\`.blockymodel\`).

## Animation Channels

Hytale supports these animation channels per bone:

### Position
- Channel: \`position\`
- Values: [x, y, z] offset from rest pose

### Rotation (Quaternion)
- Channel: \`rotation\`
- Hytale uses **quaternion interpolation** for smooth 3D rotations
- Avoids gimbal lock issues

### Scale (Stretch)
- Channel: \`scale\`
- Values: [x, y, z] scale factors
- Linked to cube stretch system

### Visibility (Hytale-specific)
- Channel: \`visibility\`
- Values: boolean (true/false)
- Toggle bone visibility at keyframes
- Use \`hytale_create_visibility_keyframe\` tool

## Interpolation Types

- \`linear\` - Constant rate between keyframes
- \`smooth\` - Catmull-Rom spline for natural easing (default for Hytale)

## Loop Modes

Set with \`hytale_set_animation_loop\`:

- \`loop\` - Continuous playback, restarts from beginning
- \`hold\` - Play once, freeze on last frame
- \`once\` - Play once, return to rest pose

## Workflow

### 1. Create Animation
\`\`\`
Use create_animation tool:
- name: "walk_cycle"
- animation_length: 1.0 (1 second)
- loop: true
\`\`\`

### 2. Add Keyframes
Use animation tools to add keyframes:
- \`manage_keyframes\` for position/rotation/scale
- \`hytale_create_visibility_keyframe\` for visibility toggles

### 3. Set Interpolation
Use \`animation_graph_editor\` to adjust curves:
- \`smooth\` for organic movements
- \`linear\` for mechanical movements
- \`stepped\` for snappy transitions

### 4. Multi-Bone Animation
Hytale supports **duplicate bone names**:
- Multiple bones with same name receive same animation
- Useful for symmetrical limbs (left_leg, left_leg)
- Animation is automatically copied

## Tips

### Visibility Animations
Use visibility keyframes for:
- Showing/hiding alternate body parts
- Weapon swapping effects
- Damage states

### Attachment Animations
Attachment pieces inherit parent bone animation:
- Mark bones as attachment pieces with \`is_piece: true\`
- Attachments connect to matching bone names

### Performance
- Keep keyframes sparse, interpolation fills gaps
- Use linear interpolation for simple movements
- Quaternion rotation prevents flip issues

## Common Patterns

### Walk Cycle (1 second loop)
1. Contact pose (0s): Extended legs
2. Passing pose (0.25s): Mid-stride
3. Contact pose (0.5s): Opposite leg forward
4. Passing pose (0.75s): Return to start

### Idle Animation (2-3 second loop)
- Subtle breathing (scale Y on chest)
- Slight head movement
- Small position shifts for life

### Attack Animation (0.5-1 second)
- Wind-up phase with anticipation
- Quick strike (linear interpolation)
- Recovery with easing
`,W="";if(Q==="walk")W=`
## Walk Cycle Focus

Creating a walk cycle animation:

1. **Timing** (1 second loop at 60 FPS)
   - Frame 0: Right foot forward (contact)
   - Frame 15: Right foot passing
   - Frame 30: Left foot forward (contact)
   - Frame 45: Left foot passing
   - Frame 60: Loop to frame 0

2. **Key Bones**
   - Legs: Primary motion drivers
   - Arms: Counter-swing to legs
   - Body: Slight up/down bob
   - Head: Subtle stabilization

3. **Interpolation**
   - Use \`smooth\` for organic feel
   - Slight ease-in/out on contacts
`;else if(Q==="idle")W=`
## Idle Animation Focus

Creating a breathing/idle animation:

1. **Timing** (2-3 second loop)
   - Slow, subtle movements
   - Natural breathing rhythm

2. **Key Elements**
   - Chest: Scale Y for breathing (1.0  1.02  1.0)
   - Head: Tiny rotation shifts
   - Arms: Minimal sway
   - Weight shifts: Subtle body position

3. **Tips**
   - Keep movements very small
   - Use smooth interpolation
   - Avoid mechanical repetition
`;else if(Q==="attack")W=`
## Attack Animation Focus

Creating a combat animation:

1. **Timing** (0.5-1 second)
   - Anticipation: 0.1-0.2s (wind-up)
   - Strike: 0.1s (fast action)
   - Recovery: 0.2-0.5s (return)

2. **Key Phases**
   - Wind-up: Draw weapon back
   - Strike: Quick forward motion
   - Impact: Slight pause/emphasis
   - Recovery: Return to ready pose

3. **Interpolation**
   - Anticipation: Smooth ease-in
   - Strike: Linear (fast)
   - Recovery: Smooth ease-out

4. **Tips**
   - Exaggerate wind-up for readability
   - Strike should be 2-3x faster than wind-up
   - Add slight overshoot on recovery
`;return{messages:[{role:"user",content:{type:"text",text:$+W}}]}}},"experimental"),h6("hytale_attachments",{title:"Hytale Attachments System",description:"Guide for creating and managing attachments in Hytale models. Covers attachment collections, piece bones, modular equipment, and best practices.",argsSchema:L.object({}),async generate(){return{messages:[{role:"user",content:{type:"text",text:await`# Hytale Attachments System

This guide covers the attachment system in Hytale models for creating modular equipment, accessories, and interchangeable parts.

## What Are Attachments?

Attachments are separate models that can be dynamically attached to bones in a base model. Common uses:
- Armor pieces
- Weapons and tools
- Accessories (hats, capes)
- Alternate body parts
- Equipment variations

## Key Concepts

### Attachment Collections
Attachments are organized as **Collections** in Blockbench:
- Each collection is a separate exportable unit
- Collections have their own textures
- Export codec: \`blockymodel\`

Use \`hytale_list_attachments\` to see all attachment collections.

### Attachment Pieces
Groups marked as **attachment pieces** define connection points:
- Set with \`hytale_set_attachment_piece\` tool
- Pieces attach to bones with matching names in the base model
- Origin point defines the attachment anchor

Use \`hytale_list_attachment_pieces\` to see marked pieces.

## Workflow

### Creating an Attachment

1. **Create Collection**
   - Use Blockbench's collection panel
   - Set export codec to \`blockymodel\`

2. **Build Geometry**
   - Add cubes/meshes to the collection
   - Structure under bones as needed

3. **Mark Piece Bones**
   \`\`\`
   hytale_set_attachment_piece:
   - group_name: "hand_right"
   - is_piece: true
   \`\`\`
   This bone will attach to \`hand_right\` in the base model.

4. **Assign Texture**
   - Each attachment can have its own texture
   - Texture is stored in collection metadata

### Attachment Naming Convention

For automatic attachment:
- Base model has bone: \`hand_right\`
- Attachment has piece bone: \`hand_right\`
- Attachment snaps to base bone at runtime

### Multiple Attachments

A single bone can have multiple possible attachments:
- Create separate collections for each variant
- All share the same piece bone name
- Game logic selects which to display

## Resources

### hytale://attachments
Lists all attachment collections with:
- UUID and name
- Associated texture
- Element count

### hytale://pieces
Lists all attachment piece bones with:
- UUID and name
- Origin position
- Rotation

## Tips

### Pivot Points
Set piece bone origins carefully:
- Origin = attachment point
- Rotation = attachment orientation
- Match base model's bone origin for perfect fit

### Animation Inheritance
Attached pieces inherit animation from base:
- No separate animation needed
- Follows parent bone transforms
- Visibility can be animated

### Texture Organization
Keep attachment textures separate:
- One texture per attachment collection
- Allows mixing and matching
- Efficient for palette swaps

### Performance
- Attachments are lightweight
- Only active attachment is rendered
- Use for equipment variations instead of model variants

## Common Patterns

### Armor System
\`\`\`
Base Model: character.blockymodel
 body
    [geometry]
 arm_left (can have attachments)
 arm_right (can have attachments)
 head (can have attachments)

Attachments:
 helmet.blockymodel
    head (is_piece: true)
 chestplate.blockymodel
    body (is_piece: true)
 gauntlet_left.blockymodel
     arm_left (is_piece: true)
\`\`\`

### Weapon Slots
\`\`\`
character.blockymodel
 hand_right

Weapon Attachments:
 sword.blockymodel  hand_right
 axe.blockymodel  hand_right
 pickaxe.blockymodel  hand_right
\`\`\`

### Accessory Layers
\`\`\`
Base: character.blockymodel
 head
 back

Accessories:
 hat.blockymodel  head
 glasses.blockymodel  head
 cape.blockymodel  back
\`\`\`
`}}]}}},"experimental"),console.log("[MCP] Hytale prompts registered successfully")}var dE=[BF,DF,GF,KF,FF,LF,NF,qF,VF,UF,AF,zF,wF,RF],iE=[SF,ZF,CF];for(let Q of dE)Q();for(let Q of iE)Q();Q1("projects",{uriTemplate:"projects://{id}",title:"Blockbench Projects",description:"Returns information about available projects in Blockbench. Use without an ID to list all projects, or provide a project UUID/name to get details about a specific project.",async listCallback(){let Q=ModelProject.all;if(!Q||Q.length===0)return{resources:[]};return{resources:Q.map(($)=>({uri:`projects://${$.uuid}`,name:$.name||$.uuid,description:`${$.format?.name??"Unknown format"} project${$.saved?"":" (unsaved)"}`,mimeType:"application/json"}))}},async readCallback(Q,{id:$}){let W=ModelProject.all;if(!W||W.length===0)return{contents:[{uri:Q.href,text:JSON.stringify({projects:[],count:0}),mimeType:"application/json"}]};let Y=(X)=>({uuid:X.uuid,name:X.name,selected:X.selected,saved:X.saved,format:X.format?.id??null,formatName:X.format?.name??null,boxUv:X.box_uv,textureWidth:X.texture_width,textureHeight:X.texture_height,savePath:X.save_path||null,exportPath:X.export_path||null,elementCount:X.elements?.length??0,groupCount:X.groups?.length??0,textureCount:X.textures?.length??0,animationCount:X.animations?.length??0,modelIdentifier:X.model_identifier||null,geometryName:X.geometry_name||null});if($){let X=W.find((J)=>J.uuid===$||J.name===$);if(!X)throw Error(`Project with ID "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify(Y(X)),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({projects:W.map(Y),count:W.length,activeProject:Project?Project.uuid:null}),mimeType:"application/json"}]}}});Q1("nodes",{uriTemplate:"nodes://{id}",title:"Blockbench Nodes",description:"Returns the current nodes in the Blockbench editor.",async listCallback(){if(!Project?.nodes_3d)return{resources:[]};return{resources:Object.values(Project.nodes_3d).map(($)=>({uri:`nodes://${$.uuid}`,name:$.name||$.uuid,description:"3D node in current project",mimeType:"application/json"}))}},async readCallback(Q,{id:$}){if(!Project?.nodes_3d)throw Error("No nodes found in the Blockbench editor.");let W=Project.nodes_3d[$]??Object.values(Project.nodes_3d).find((G)=>G.name===$||G.uuid===$);if(!W)throw Error(`Node with ID "${$}" not found.`);let{position:Y,rotation:X,scale:J,...H}=W;return{contents:[{uri:Q.href,text:JSON.stringify({...H,position:Y.toArray(),rotation:X.toArray(),scale:J.toArray()}),mimeType:"application/json"}]}}});Q1("textures",{uriTemplate:"textures://{id}",title:"Blockbench Textures",description:"Returns information about textures in the current Blockbench project. Use without an ID to list all textures, or provide a texture UUID/name to get details about a specific texture.",async listCallback(){let Q=Project?.textures??[];if(Q.length===0)return{resources:[]};return{resources:Q.map(($)=>({uri:`textures://${$.uuid}`,name:$.name||$.uuid,mimeType:"application/json",description:$.path?`Texture from ${$.path}`:"Embedded texture"}))}},async readCallback(Q,{id:$}){let W=Project?.textures??[];if(W.length===0)return{contents:[{uri:Q.href,text:JSON.stringify({textures:[],count:0}),mimeType:"application/json"}]};let Y=(X)=>({uuid:X.uuid,name:X.name,id:X.id,width:X.width,height:X.height,frameCount:X.frameCount,ratio:X.ratio,path:X.path||null,folder:X.folder||null,namespace:X.namespace||null,particle:X.particle??!1,render_mode:X.render_mode||"default",render_sides:X.render_sides||"auto",visible:X.visible??!0,saved:X.saved??!1,selected:X.selected??!1,source:X.source||null});if($){let X=W.find((J)=>J.uuid===$||J.name===$||J.id===$);if(!X)throw Error(`Texture with ID "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify(Y(X)),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({textures:W.map(Y),count:W.length}),mimeType:"application/json"}]}}});if(Plugins.installed.some((Q)=>Q.id==="reference_models"))Q1("reference_models",{uriTemplate:"reference_models://{id}",title:"Reference Models",description:"Returns information about reference models in the current Blockbench project. Requires the Reference Models plugin. Use without an ID to list all reference models, or provide a UUID/name to get details about a specific reference model.",async listCallback(){let $=(Outliner?.elements??[]).filter((W)=>W.type==="reference_model");if($.length===0)return{resources:[]};return{resources:$.map((W)=>({uri:`reference_models://${W.uuid}`,name:W.name||W.uuid,description:W.path?`Reference model from ${W.path}`:"Reference model",mimeType:"application/json"}))}},async readCallback(Q,{id:$}){let Y=(Outliner?.elements??[]).filter((H)=>H.type==="reference_model");if(Y.length===0)return{contents:[{uri:Q.href,text:JSON.stringify({referenceModels:[],count:0}),mimeType:"application/json"}]};let X=(H,G)=>{if(!H)return G;if(Array.isArray(H)&&H.length>=3)return[Number(H[0]),Number(H[1]),Number(H[2])];if(typeof H==="object"&&"x"in H&&"y"in H&&"z"in H){let B=H;return[Number(B.x),Number(B.y),Number(B.z)]}return G},J=(H)=>{let G=H;return{uuid:G.uuid,name:G.name,path:G.path||null,origin:X(G.origin,[0,0,0]),rotation:X(G.rotation,[0,0,0]),scale:X(G.scale,[1,1,1]),visibility:G.visibility??!0}};if($){let H=Y.find((G)=>G.uuid===$||G.name===$);if(!H)throw Error(`Reference model with ID "${$}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify(J(H)),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({referenceModels:Y.map(J),count:Y.length}),mimeType:"application/json"}]}}});h6("blockbench_native_apis",{description:"Essential information about Blockbench v5.0 native API security model and requireNativeModule() usage. Use this when working with Node.js modules, file system access, or native APIs in Blockbench plugins.",argsSchema:L.object({}),async generate(){return{messages:[{role:"user",content:{type:"text",text:await`# Blockbench v5.0 Native API Security Model

**CRITICAL: Read this carefully before using any Node.js APIs or native modules in Blockbench plugins.**

## Overview

Blockbench v5.0 introduces a new security model that significantly changes how plugins access native Node.js APIs. These changes give users more control and trust over plugin capabilities.

## Key Changes from Previous Versions

### 1. Global Module Variables Removed

- **OLD (pre-v5.0)**: All Node.js APIs were globally available (e.g., \`fs\`, \`os\`, \`child_process\`)
- **NEW (v5.0+)**: Most global variables have been removed
- **EXCEPTION**: \`PathModule\` is still globally available for Node's \`path\` module

### 2. Module Access via \`requireNativeModule()\`

Use the new \`requireNativeModule()\` function instead of \`require()\` for better TypeScript support:

\`\`\`javascript
// TypeScript-friendly with proper type support
const os = requireNativeModule('os');

// Add custom permission message
const child_process = requireNativeModule('child_process', {
    message: 'This permission is required to open ffmpeg and encode the video.'
});
\`\`\`

**IMPORTANT**: \`requireNativeModule()\` will:
- Open a user permission prompt for restricted modules
- Return the module **synchronously** if the user accepts
- Return \`undefined\` if the user denies
- Always check if the module is defined before use!

### 3. Module Categories

#### Safe Modules (No Permission Required)
These can be required without user confirmation:
- \`path\`
- \`crypto\`
- \`events\`
- \`zlib\`
- \`timers\`
- \`url\`
- \`string_decoder\`
- \`querystring\`

#### Restricted Modules (Require User Permission)
These prompt the user for permission:
- \`fs\` (File System - see scoped access below)
- \`child_process\`
- \`electron\`
- \`https\`
- \`net\`
- \`tls\`
- \`util\`
- \`os\`
- \`v8\`

### 4. Scoped File System Access

The \`fs\` module is now limited. For even more restrictive access, use **scoped file systems**:

\`\`\`javascript
// Request scoped fs access to specific directory
const scoped_fs = requireNativeModule('fs', {
    scope: 'C:/path/to/directory'
});

if (scoped_fs) {
    //  Will succeed - inside scope
    scoped_fs.writeFileSync('C:/path/to/directory/file.json', 'hello world');
    
    //  Will throw error - outside scope
    scoped_fs.writeFileSync('C:/foo/bar.json', 'hello world');
}
\`\`\`

**Benefits**:
- Gives users more control over file access
- Builds trust by limiting plugin scope
- Prevents accidental or malicious file system access

### 5. Limited File System Capabilities

Even with permission, the \`fs\` module has reduced capabilities:
-  Reading and writing files is allowed
-  Advanced operations like modifying file permissions are NOT available

### 6. SystemInfo Interface

For basic system information, use the new \`SystemInfo\` global instead of requiring \`os\` or \`process\`:

\`\`\`javascript
// Available properties:
SystemInfo.platform          // 'win32' | 'darwin' | 'linux'
SystemInfo.home_directory    // 'path/to/home'
SystemInfo.arch             // 'x64' | 'arm64'
SystemInfo.appdata_directory // 'C:\\\\Users\\\\Name\\\\AppData\\\\Roaming'
SystemInfo.os_version       // 'Windows 11 Home', etc.
\`\`\`

## Best Practices for Plugin Development

### 1. Request Permissions On-Demand

**DON'T** request modules during plugin load:
\`\`\`javascript
//  BAD - Bombards user with prompts on install
BBPlugin.register('my_plugin', {
    onload() {
        const fs = requireNativeModule('fs');
        const os = requireNativeModule('os');
        const child_process = requireNativeModule('child_process');
    }
});
\`\`\`

**DO** request when actually needed:
\`\`\`javascript
//  GOOD - User knows why permission is needed
BBPlugin.register('my_plugin', {
    onload() {
        // Setup without requiring modules
    }
});

function exportModel() {
    const fs = requireNativeModule('fs', {
        message: 'File system access needed to save your model.'
    });
    
    if (!fs) {
        Blockbench.showQuickMessage('Export cancelled - file system access denied', 2000);
        return;
    }
    
    // Proceed with export...
}
\`\`\`

### 2. Always Check for undefined

\`\`\`javascript
const os = requireNativeModule('os');

//  ALWAYS check before use
if (!os) {
    console.warn('OS module access denied');
    return;
}

// Now safe to use
const platform = os.platform();
\`\`\`

### 3. Use Scoped Access When Possible

If you only need access to specific directories, use scoped file systems:

\`\`\`javascript
// Instead of full fs access
const project_dir = 'C:/Users/Name/Projects/MyProject';
const scoped_fs = requireNativeModule('fs', {
    scope: project_dir,
    message: 'Access needed to read/write project files in ' + project_dir
});

if (scoped_fs) {
    // Limited to project_dir only - safer!
    scoped_fs.writeFileSync(PathModule.join(project_dir, 'output.json'), data);
}
\`\`\`

### 4. Provide Clear Permission Messages

\`\`\`javascript
const child_process = requireNativeModule('child_process', {
    message: 'This plugin needs to run FFmpeg to encode your animation as a video file.'
});
\`\`\`

### 5. Use SystemInfo for Basic Info

\`\`\`javascript
//  No permission needed
if (SystemInfo.platform === 'win32') {
    // Windows-specific code
}

//  Requires permission unnecessarily
const os = requireNativeModule('os');
if (os?.platform() === 'win32') {
    // Windows-specific code
}
\`\`\`

## Example: Safe Plugin Structure

\`\`\`javascript
BBPlugin.register('safe_exporter', {
    title: 'Safe Model Exporter',
    onload() {
        // Minimal setup - no permissions yet
        new Action('export_custom', {
            name: 'Export Custom Format',
            icon: 'save',
            click: () => this.exportModel()
        });
    },
    
    exportModel() {
        // Request permission only when needed
        const fs = requireNativeModule('fs', {
            message: 'Save your model to disk'
        });
        
        if (!fs) {
            Blockbench.showMessageBox({
                title: 'Permission Required',
                message: 'File system access is required to save the model.'
            });
            return;
        }
        
        // Proceed with export
        try {
            const data = this.generateModelData();
            fs.writeFileSync(this.getExportPath(), data);
            Blockbench.showQuickMessage('Export successful!', 2000);
        } catch (error) {
            console.error('Export failed:', error);
            Blockbench.showQuickMessage('Export failed', 2000);
        }
    }
});
\`\`\`

## Migration from Pre-v5.0 Plugins

| Old (Pre-v5.0) | New (v5.0+) |
|----------------|-------------|
| \`fs.readFileSync()\` | \`const fs = requireNativeModule('fs'); if (fs) fs.readFileSync()\` |
| \`os.platform()\` | \`SystemInfo.platform\` |
| \`process.cwd()\` | Use Blockbench APIs or SystemInfo |
| \`require('path')\` | \`PathModule\` (still global) |
| Module at load time | Module on-demand with permission check |

## Summary Checklist

When using native APIs in Blockbench v5.0 plugins:

- [ ] Use \`requireNativeModule()\` instead of \`require()\`
- [ ] Always check if module is defined before use
- [ ] Request permissions on-demand, not during plugin load
- [ ] Provide clear permission messages
- [ ] Use \`SystemInfo\` for basic system info instead of \`os\`
- [ ] Consider scoped file system access for better security
- [ ] Use \`PathModule\` for path operations (no permission needed)
- [ ] Test with user denying permissions to ensure graceful failures

---

**Remember**: These changes improve user trust and security. Embrace them to build better, safer plugins!
`}}]}}});h6("blockbench_code_eval_safety",{description:"Critical safety guide for agents using code evaluation/execution tools with Blockbench v5.0+. Contains breaking changes, quick reference, common mistakes, and safe code patterns for native module usage. MUST READ before generating or executing Blockbench plugin code.",argsSchema:L.object({}),async generate(){return{messages:[{role:"user",content:{type:"text",text:await`# Blockbench Code Evaluation Safety Guide

**FOR AGENTS USING CODE EVALUATION TOOLS (e.g., \`risky_eval\`, code execution, REPL tools)**

## Critical Security Changes in Blockbench v5.0+

###  BREAKING: Global Node.js APIs Removed

\`\`\`javascript
//  THESE NO LONGER WORK IN v5.0+
fs.readFileSync()         // undefined
os.platform()             // undefined  
child_process.spawn()     // undefined

//  USE THESE INSTEAD
const fs = requireNativeModule('fs');
SystemInfo.platform
PathModule.join()         // Still global
\`\`\`

## Quick Reference for Code Generation

### File System Operations
\`\`\`javascript
// Always wrap in permission check
const fs = requireNativeModule('fs', {
    message: 'Describe why you need file system access'
});

if (!fs) {
    // User denied - handle gracefully
    return { error: 'File system access denied' };
}

// Now safe to use
fs.writeFileSync(path, data);
\`\`\`

### System Information
\`\`\`javascript
// No permission needed - USE THIS
const platform = SystemInfo.platform;        // 'win32' | 'darwin' | 'linux'
const home = SystemInfo.home_directory;
const arch = SystemInfo.arch;                // 'x64' | 'arm64'
const appdata = SystemInfo.appdata_directory;
const version = SystemInfo.os_version;
\`\`\`

### Path Operations
\`\`\`javascript
// No permission needed - USE THIS
const joined = PathModule.join('path', 'to', 'file');
const dirname = PathModule.dirname(path);
const basename = PathModule.basename(path);
\`\`\`

### Child Process (Requires Permission)
\`\`\`javascript
const child_process = requireNativeModule('child_process', {
    message: 'Execute external commands (e.g., FFmpeg for video encoding)'
});

if (!child_process) {
    return { error: 'Process execution denied' };
}

child_process.spawn('command', ['args']);
\`\`\`

## Module Permission Matrix

| Module | Permission | Alternative |
|--------|-----------|-------------|
| \`path\` |  None | Use \`PathModule\` |
| \`crypto\` |  None | Direct require |
| \`fs\` |  User prompt | \`requireNativeModule('fs')\` |
| \`os\` |  User prompt | Use \`SystemInfo\` instead |
| \`child_process\` |  User prompt | \`requireNativeModule('child_process')\` |
| \`http/https\` |  User prompt | \`requireNativeModule('https')\` |

## Code Generation Template

When generating Blockbench plugin code, use this pattern:

\`\`\`javascript
//  SAFE PATTERN FOR v5.0+
function myFeature() {
    // 1. Check if we need native modules
    const needsFileSystem = true; // or false
    
    if (needsFileSystem) {
        // 2. Request permission with clear message
        const fs = requireNativeModule('fs', {
            message: 'Save configuration to disk'
        });
        
        // 3. Handle denial gracefully
        if (!fs) {
            Blockbench.showQuickMessage('Feature requires file system access', 2000);
            return false;
        }
        
        // 4. Use the module
        try {
            fs.writeFileSync(path, data);
            return true;
        } catch (error) {
            console.error('Failed:', error);
            return false;
        }
    }
    
    // 5. Use SystemInfo for basic system checks
    if (SystemInfo.platform === 'win32') {
        // Windows-specific code
    }
}
\`\`\`

## Common Mistakes to Avoid

###  Don't Do This
\`\`\`javascript
// Requesting at plugin load
BBPlugin.register('my_plugin', {
    onload() {
        const fs = requireNativeModule('fs');
        const os = requireNativeModule('os');
        const cp = requireNativeModule('child_process');
        // Bombards user with 3 permission prompts!
    }
});

// Using without checking
const fs = requireNativeModule('fs');
fs.readFileSync(path); // Crashes if user denied!

// Using old globals
if (process.platform === 'win32') { // undefined in v5.0!
\`\`\`

###  Do This
\`\`\`javascript
// Request on-demand
BBPlugin.register('my_plugin', {
    onload() {
        // Just setup, no permissions yet
        new Action('my_action', {
            click: () => this.doWork()
        });
    },
    
    doWork() {
        // Request only when needed
        const fs = requireNativeModule('fs', {
            message: 'Save your work'
        });
        
        if (!fs) {
            return; // Handle gracefully
        }
        
        // Use safely
        fs.writeFileSync(path, data);
    }
});

// Use SystemInfo instead of process/os
if (SystemInfo.platform === 'win32') {
    // Windows-specific
}
\`\`\`

## Scoped File System (Enhanced Security)

For directory-specific access:

\`\`\`javascript
const project_fs = requireNativeModule('fs', {
    scope: '/path/to/project',
    message: 'Access project files in /path/to/project'
});

if (project_fs) {
    //  Works - inside scope
    project_fs.writeFileSync('/path/to/project/file.json', data);
    
    //  Throws - outside scope  
    project_fs.writeFileSync('/etc/passwd', data);
}
\`\`\`

## Evaluation Safety Checklist

Before running ANY generated code in Blockbench v5.0+:

- [ ] Uses \`requireNativeModule()\` instead of \`require()\` for native modules
- [ ] Checks if module is defined before use (\`if (!module) return\`)
- [ ] Uses \`SystemInfo\` for platform/arch/home instead of \`os\`/\`process\`
- [ ] Uses \`PathModule\` for path operations
- [ ] Requests permissions on-demand, not at plugin load
- [ ] Includes clear permission messages
- [ ] Handles user denial gracefully
- [ ] Avoids direct use of \`fs\`, \`os\`, \`child_process\` globals

## Migration Quick-Fixes

| Old Code | New Code |
|----------|----------|
| \`fs.readFileSync()\` | \`const fs = requireNativeModule('fs'); if (fs) fs.readFileSync()\` |
| \`os.platform()\` | \`SystemInfo.platform\` |
| \`os.homedir()\` | \`SystemInfo.home_directory\` |
| \`process.platform\` | \`SystemInfo.platform\` |
| \`require('path')\` | \`PathModule\` |
| At plugin load | On-demand in action handlers |

---

**Remember**: Code that works in Blockbench 4.x WILL BREAK in 5.0+ if it uses native modules. Always use the new patterns above.
`}}]}}});h6("model_creation_strategy",{description:"A strategy for creating a new 3D model in Blockbench.",argsSchema:L.object({format:L.enum(["java_block","bedrock"]).optional(),approach:L.enum(["ui","programmatic","import"]).optional()}),async generate({format:Q,approach:$}){let W=[];if(Q==="java_block")W.push(await`Create a new block model for Minecraft: Java Edition.
- Rotations are limited to 22.5 degree steps and one axis per element
- The model is limited to a size of 3 by 3 by 3 blocks. Display settings can make item models larger though
`);if(Q==="bedrock")W.push(await`Create a new block model for Minecraft: Bedrock Edition.
- Size total size of a block is limited to 30 pixels in all dimensions. The limit can be off-centered in all directions by 7 pixels from the block center.
`);if($==="ui")W.push(await"### Prefer tools, actions, and UI interactivity to assemble models\nWhen creating Blockbench models, use the following MCP tools (if available). They are listed in order of preference.\n\n1. `list_outline` - Check to see what the current project structure is like. This returns the 3D model outline information for the current project.\n2. `create_project` - If no project is open, or if the prompt calls for a new project, create a new project in Blockbench prior to attempting to use other tools.\n3. `add_group` - Organize meshes into bones\n4. `place_cube` - Creates new cube meshes in the project, with optional texture assignment.\n5. `modify_cube` - Edits existing cubes in the current project.\n6. `remove_element` - Removes a mesh from the active project.\n7. `trigger_action` - Dispatches default event for the given Blockbench Action name. Some actions will require follow-up with `fill_dialog` \n8. `fill_dialog` - Attempts to populate and submit form values in the currently open or visible Dialog window\n9. `emulate_clicks` - Attempts to dispatch click events at the given position in the app window.");if($==="programmatic")W.push(await`### Lean on your programming expertise when creating Blockbench models

- Utilize the \`risky_eval\` MCP tool to call Blockbench, Node.js, Electron, and JavaScript functions and run scripts.
- The MCP server has access to all variables and functions in the global scope.
- Blockbench exposes much of its API functionality on the \`Blockbench\` global variable namespace.
- Functions and classes can be converted to strings and logged to the console to inspect their source to determine how to properly use them.
- The API reference on the [Blockbench Wiki](https://www.blockbench.net/wiki) is incomplete.
- Never use these tools or APIs to make system changes.`);if($==="import")W.push(await"# Generate valid .geo.json directly\n- Use tool `from_geo_json` to import .geo.json string(s) directly into Blockbench.");return{messages:[{role:"user",content:{type:"text",text:W.join(`
`)}}]}}});class bF{sessions=new Map;listeners=new Set;removalCallback=null;pingCallback=null;config={inactivityTimeoutMs:300000,pingIntervalMs:30000,maxFailedPings:3};configure(Q){this.config={...this.config,...Q},console.log(`[MCP] Session config updated: timeout=${this.config.inactivityTimeoutMs}ms, ping=${this.config.pingIntervalMs}ms`)}getConfig(){return{...this.config}}add(Q){if(this.sessions.has(Q)){this.updateActivity(Q);return}let $={id:Q,connectedAt:new Date,lastActivity:new Date,failedPings:0};this.resetTimeout($),this.startPingInterval($),this.sessions.set(Q,$),this.notifyListeners(),console.log(`[MCP] Session connected: ${Q.slice(0,8)}...`)}remove(Q){let $=this.sessions.get(Q);if(!$)return;if(this.clearSessionTimers($),this.sessions.delete(Q),this.notifyListeners(),console.log(`[MCP] Session disconnected: ${Q.slice(0,8)}...`),this.removalCallback)try{this.removalCallback(Q)}catch(W){console.error("[MCP] Session removal callback error:",W)}}updateActivity(Q){let $=this.sessions.get(Q);if($)$.lastActivity=new Date,$.failedPings=0,this.resetTimeout($)}recordPingSent(Q){let $=this.sessions.get(Q);if($)$.lastPingAt=new Date}recordPongReceived(Q){let $=this.sessions.get(Q);if($)$.lastPongAt=new Date,$.failedPings=0}recordPingFailed(Q){let $=this.sessions.get(Q);if(!$)return!1;if($.failedPings++,console.log(`[MCP] Ping failed for session ${Q.slice(0,8)}... (${$.failedPings}/${this.config.maxFailedPings})`),$.failedPings>=this.config.maxFailedPings)return console.log(`[MCP] Session ${Q.slice(0,8)}... terminated: max failed pings reached`),this.remove(Q),!0;return!1}updateClientInfo(Q,$,W){let Y=this.sessions.get(Q);if(Y){Y.clientName=$,Y.clientVersion=W,this.notifyListeners();let X=$||Q.slice(0,8)+"...";console.log(`[MCP] Session identified: ${X}${W?` v${W}`:""}`)}}clearSessionTimers(Q){if(Q.timeoutHandle)clearTimeout(Q.timeoutHandle),Q.timeoutHandle=void 0;if(Q.pingHandle)clearInterval(Q.pingHandle),Q.pingHandle=void 0}resetTimeout(Q){if(Q.timeoutHandle)clearTimeout(Q.timeoutHandle);Q.timeoutHandle=setTimeout(()=>{console.log(`[MCP] Session timed out: ${Q.id.slice(0,8)}...`),this.remove(Q.id)},this.config.inactivityTimeoutMs)}startPingInterval(Q){if(this.config.pingIntervalMs<=0)return;Q.pingHandle=setInterval(async()=>{if(!this.pingCallback)return;this.recordPingSent(Q.id);try{if(await this.pingCallback(Q.id))this.recordPongReceived(Q.id);else this.recordPingFailed(Q.id)}catch($){console.error(`[MCP] Ping error for session ${Q.id.slice(0,8)}...:`,$),this.recordPingFailed(Q.id)}},this.config.pingIntervalMs)}getAll(){return[...this.sessions.values()]}getCount(){return this.sessions.size}has(Q){return this.sessions.has(Q)}get(Q){return this.sessions.get(Q)}subscribe(Q){return this.listeners.add(Q),Q(this.getAll()),()=>this.listeners.delete(Q)}setRemovalCallback(Q){this.removalCallback=Q}setPingCallback(Q){this.pingCallback=Q}notifyListeners(){let Q=this.getAll();this.listeners.forEach(($)=>{try{$(Q)}catch(W){console.error("[MCP] Session listener error:",W)}})}clear(){for(let Q of this.sessions.values())this.clearSessionTimers(Q);this.sessions.clear(),this.listeners.clear(),this.pingCallback=null,this.removalCallback=null}}var o0=new bF;var vF="#mcp-status-bar{display:flex;align-items:center;gap:8px;padding:4px 12px;background-color:var(--color-dark);border-block-start:1px solid var(--color-border);font-size:0.85em;user-select:none}#mcp-status-bar .mcp-status-indicator{display:flex;align-items:center;gap:6px;cursor:pointer;padding:2px 8px;border-radius:4px;transition:background-color 0.2s}#mcp-status-bar .mcp-status-indicator:hover{background-color:var(--color-button)}#mcp-status-bar .mcp-status-dot{inline-size:8px;block-size:8px;border-radius:50%;background-color:var(--color-subtle_text);transition:background-color 0.3s}#mcp-status-bar .mcp-status-dot.connected{background-color:#4caf50;box-shadow:0 0 8px rgba(76,175,80,0.6);animation:pulse 2s ease-in-out infinite}#mcp-status-bar .mcp-status-dot.disconnected{background-color:#f44336}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}#mcp-status-bar .mcp-status-text{color:var(--color-text);font-weight:500}#mcp-status-bar .mcp-server-info{color:var(--color-subtle_text);font-size:0.9em;margin-inline-start:4px}";var U8,E4;function kF(Q){let $=Settings.get("mcp_port")||3000,W=Settings.get("mcp_endpoint")||"/bb-mcp";Blockbench.addCSS(vF),U8=document.createElement("div"),U8.id="mcp-status-bar";let Y=document.createElement("div");Y.className="mcp-status-indicator",Y.title=tl("mcp.tooltip.click_to_view_panel");let X=document.createElement("div");X.className="mcp-status-dot";let J=document.createElement("span");J.className="mcp-status-text",J.textContent=tl("mcp.status.server");let H=document.createElement("span");H.className="mcp-server-info",H.textContent=`(${$}${W})`,Y.appendChild(X),Y.appendChild(J),Y.appendChild(H),U8.appendChild(Y);let G=(K)=>{let F=K.length;if(F>0)X.classList.remove("disconnected"),X.classList.add("connected"),J.textContent=F===1?tl("mcp.status.server_one_client"):tl("mcp.status.server_clients",[F]);else X.classList.remove("connected"),X.classList.add("disconnected"),J.textContent=tl("mcp.status.server")};E4=o0.subscribe(G),Y.addEventListener("click",()=>{let K=Panels.mcp_panel;if(!K)return;if(K.folded){K.fold(!1);return}if(K.slot==="float")K.moveToFront()});let B=document.getElementById("status_bar");if(!B){console.warn("Could not find status_bar element");return}B.appendChild(U8)}function TF(){if(E4)E4(),E4=void 0;if(U8)U8.remove(),U8=void 0}function R4(Q){let $=Q._def,W=$.typeName,Y=!1,X=!1,J=$.description,H=void 0,G,B,K,F;if(W==="ZodOptional"||W==="ZodNullable"){Y=!0;let A=$.innerType;return{...R4(A),isOptional:!0}}if(W==="ZodDefault"){H=$.defaultValue?.();let A=$.innerType;return{...R4(A),defaultValue:H,isOptional:!0}}if(W==="ZodArray")X=!0,F=$.type;if(W==="ZodEnum")G=$.values;if(W==="ZodNumber")$.checks?.forEach((V)=>{if(V.kind==="min")B=V.value;if(V.kind==="max")K=V.value});let q="text";switch(W){case"ZodString":q="text";break;case"ZodNumber":q="number";break;case"ZodBoolean":q="checkbox";break;case"ZodEnum":q="select";break;case"ZodArray":q="textarea";break;case"ZodObject":q="textarea";break;case"ZodUnion":q="textarea";break;default:q="text"}return{type:q,isOptional:Y,isArray:X,description:J,defaultValue:H,enumValues:G,min:B,max:K,innerType:F}}function rE(Q){let $={};for(let[W,Y]of Object.entries(Q)){let X=R4(Y),J=Y._def,H={label:`${W}${X.isOptional?"":" *"}`,description:X.description||`Parameter: ${W}`,type:X.type};if(X.defaultValue!==void 0)if(X.type==="textarea")H.value=JSON.stringify(X.defaultValue,null,2);else H.value=X.defaultValue;if(X.description)H.placeholder=X.description;if(X.enumValues){H.options={};for(let G of X.enumValues)H.options[G]=G}if(X.min!==void 0)H.min=X.min;if(X.max!==void 0)H.max=X.max;if(X.type==="textarea"){if(H.height=100,X.isArray)H.placeholder=tl("mcp.dialog.json_array_placeholder"),H.value=H.value??"[]";else if(J.typeName==="ZodObject")H.placeholder=tl("mcp.dialog.json_object_placeholder"),H.value=H.value??"{}"}$[W]=H}return $}function _F(Q,$){let W={};for(let[Y,X]of Object.entries($)){let J=Q[Y],H=R4(X);if(H.isOptional&&(J===""||J===void 0||J===null))continue;if(H.type==="textarea"&&typeof J==="string")try{W[Y]=JSON.parse(J)}catch{W[Y]=J}else if(H.type==="number"&&typeof J==="string")W[Y]=parseFloat(J);else W[Y]=J}return W}var UX=null;function xF(Q,$,W){let Y=typeof $==="string"?$:JSON.stringify($,null,2);UX?.hide(),UX=new Dialog({id:"mcp_tool_result",title:tl("mcp.dialog.result_title",[Q]),width:600,lines:[`<pre style="
        background: var(--color-back);
        padding: 12px;
        border-radius: 4px;
        overflow: auto;
        max-height: 400px;
        white-space: pre-wrap;
        word-break: break-word;
        color: ${W?"var(--color-error)":"var(--color-text)"};
        font-family: var(--font-code);
        font-size: 12px;
      ">${oE(Y)}</pre>`],singleButton:!0,buttons:[tl("mcp.dialog.close")]}),UX.show()}function oE(Q){return Q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var AX=null;function yF(Q){let W=vK()[Q];if(!W){Blockbench.showQuickMessage(tl("mcp.dialog.tool_not_found",[Q]),2000);return}AX?.hide();let Y=rE(W.inputSchema),X=Object.keys(Y).length>0;AX=new Dialog({id:"mcp_tool_test",title:W.title||Q,width:500,form:X?Y:void 0,lines:X?void 0:[`<p style="color: var(--color-subtle_text); font-style: italic;">${tl("mcp.dialog.no_parameters")}</p>`],buttons:[tl("mcp.dialog.run_tool"),tl("mcp.dialog.copy_input"),tl("mcp.dialog.cancel")],confirmIndex:0,cancelIndex:2,onButton(J){if(J===1){let G=this.form?.result??{},B=X?_F(G,W.inputSchema):{},K=JSON.stringify({tool:Q,arguments:B},null,2);return navigator.clipboard.writeText(K).then(()=>{Blockbench.showQuickMessage(tl("mcp.dialog.input_copied"),1500)}).catch(()=>{Blockbench.showQuickMessage(tl("mcp.dialog.copy_failed"),1500)}),!1}},async onConfirm(J){let H=X?_F(J,W.inputSchema):{};Blockbench.showQuickMessage(tl("mcp.dialog.running_tool"),1000);try{let G=await W.execute(H),B;if(typeof G==="string")B=G;else if(G&&typeof G==="object"&&"content"in G)B=G.content.map((F)=>{if(F.type==="text")return F.text;if(F.type==="image")return`[Image: ${F.data?.slice(0,50)}...]`;return JSON.stringify(F)}).join(`
`);else B=G;xF(Q,B,!1)}catch(G){let B=G instanceof Error?G.message:String(G);xF(Q,`Error: ${B}`,!0)}}}),AX.show()}function OX(Q){let $=Q._def,W=$.typeName,Y=!1,X=$.description,J=void 0,H;if(W==="ZodOptional"||W==="ZodNullable"){Y=!0;let B=$.innerType;return{...OX(B),isOptional:!0}}if(W==="ZodDefault"){J=$.defaultValue?.();let B=$.innerType;return{...OX(B),defaultValue:J,isOptional:!0}}if(W==="ZodEnum")H=$.values;let G="text";switch(W){case"ZodString":G="text";break;case"ZodNumber":G="number";break;case"ZodBoolean":G="checkbox";break;case"ZodEnum":G="select";break;default:G="text"}return{type:G,isOptional:Y,description:X,defaultValue:J,enumValues:H}}function aE(Q){let $={};for(let[W,Y]of Object.entries(Q)){let X=OX(Y),J={label:`${W}${X.isOptional?"":" *"}`,description:X.description||`Argument: ${W}`,type:X.type};if(X.defaultValue!==void 0)J.value=X.defaultValue;if(X.description)J.placeholder=X.description;if(X.enumValues){J.options={"":"(none)"};for(let H of X.enumValues)J.options[H]=H}$[W]=J}return $}function hF(Q){return Q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var zX=null;function gF(Q,$,W=!1){zX?.hide(),zX=new Dialog({id:"mcp_prompt_content",title:tl("mcp.dialog.prompt_title",[Q]),width:700,lines:[`<pre style="
        background: var(--color-back);
        padding: 12px;
        border-radius: 4px;
        overflow: auto;
        max-height: 500px;
        white-space: pre-wrap;
        word-break: break-word;
        color: ${W?"var(--color-error)":"var(--color-text)"};
        font-family: var(--font-code);
        font-size: 12px;
        line-height: 1.5;
      ">${hF($)}</pre>`],buttons:[tl("mcp.dialog.copy"),tl("mcp.dialog.close")],onButton(Y){if(Y===0)return navigator.clipboard.writeText($).then(()=>{Blockbench.showQuickMessage(tl("mcp.dialog.prompt_copied"),1500)}).catch(()=>{Blockbench.showQuickMessage(tl("mcp.dialog.copy_failed"),1500)}),!1}}),zX.show()}var wX=null;function fF(Q){let W=xK()[Q];if(!W){Blockbench.showQuickMessage(tl("mcp.dialog.prompt_not_found",[Q]),2000);return}wX?.hide();let Y=W.argsSchema&&Object.keys(W.argsSchema).length>0,X=Y?aE(W.argsSchema):{};wX=new Dialog({id:"mcp_prompt_preview",title:W.title||Q,width:500,form:Y?X:void 0,lines:[`<p style="margin-bottom: 12px; color: var(--color-subtle_text);">${hF(W.description)}</p>`,...Y?[]:[`<p style="color: var(--color-subtle_text); font-style: italic;">${tl("mcp.dialog.no_arguments")}</p>`]],buttons:[tl("mcp.dialog.generate_prompt"),tl("mcp.dialog.cancel")],confirmIndex:0,cancelIndex:1,async onConfirm(J){let H={};for(let[G,B]of Object.entries(J))if(B!==""&&B!==void 0&&B!==null)H[G]=B;Blockbench.showQuickMessage(tl("mcp.dialog.generating_prompt"),1000);try{let B=(await W.generate(H)).messages.map((K)=>{let F=K.role==="user"?tl("mcp.dialog.role_user"):tl("mcp.dialog.role_assistant"),q=typeof K.content==="string"?K.content:K.content.text;return`[${F}]
${q}`}).join(`

---

`);gF(Q,B)}catch(G){let B=G instanceof Error?G.message:String(G);gF(Q,`Error: ${B}`,!0)}}}),wX.show()}var uF={"mcp.panel.sessions":"Sessions","mcp.panel.server":"Server","mcp.panel.tools":"Tools","mcp.panel.resources":"Resources","mcp.panel.prompts":"Prompts","mcp.sessions.no_clients":"No clients connected","mcp.server.name":"Server Name","mcp.server.version":"Server Version","mcp.server.connected_clients":"Connected Clients","mcp.filter.tools_placeholder":"Filter tools...","mcp.filter.resources_placeholder":"Filter resources...","mcp.filter.prompts_placeholder":"Filter prompts...","mcp.filter.show_experimental":"Show Experimental","mcp.tools.no_match":"No tools match your filter.","mcp.tools.none_available":"No tools available.","mcp.resources.no_match":"No resources match your filter.","mcp.resources.none_available":"No resources available.","mcp.prompts.no_match":"No prompts match your filter.","mcp.prompts.none_available":"No prompts available.","mcp.prompts.argument_count":"%0 argument","mcp.prompts.argument_count_plural":"%0 arguments","mcp.tooltip.click_to_test":"Click to test %0","mcp.tooltip.click_to_preview":"Click to preview %0","mcp.tooltip.click_to_view_panel":"Click to view MCP panel","mcp.status.experimental_tooltip":"This tool is experimental","mcp.status.server":"MCP Server","mcp.status.server_one_client":"MCP Server (1 client)","mcp.status.server_clients":"MCP Server (%0 clients)","mcp.settings.instructions_name":"MCP System Instructions","mcp.settings.instructions_desc":"Instructions for the MCP system.","mcp.settings.port_name":"MCP Server Port","mcp.settings.port_desc":"Port for the MCP server.","mcp.settings.endpoint_name":"MCP Server Endpoint","mcp.settings.endpoint_desc":"Endpoint for the MCP server.","mcp.dialog.result_title":"Result: %0","mcp.dialog.no_parameters":"This tool has no parameters.","mcp.dialog.run_tool":"Run Tool","mcp.dialog.copy_input":"Copy Input","mcp.dialog.cancel":"Cancel","mcp.dialog.close":"Close","mcp.dialog.json_array_placeholder":"Enter JSON array, e.g. [1, 2, 3]","mcp.dialog.json_object_placeholder":"Enter JSON object","mcp.dialog.input_copied":"Input copied to clipboard","mcp.dialog.copy_failed":"Failed to copy to clipboard","mcp.dialog.running_tool":"Running tool...","mcp.dialog.tool_not_found":'Tool "%0" not found',"mcp.dialog.prompt_title":"Prompt: %0","mcp.dialog.copy":"Copy","mcp.dialog.prompt_copied":"Prompt copied to clipboard","mcp.dialog.no_arguments":"This prompt has no arguments.","mcp.dialog.generate_prompt":"Generate Prompt","mcp.dialog.generating_prompt":"Generating prompt...","mcp.dialog.prompt_not_found":'Prompt "%0" not found',"mcp.dialog.role_user":"User","mcp.dialog.role_assistant":"Assistant"},tE={"mcp.panel.sessions":"Sitzungen","mcp.panel.server":"Server","mcp.panel.tools":"Werkzeuge","mcp.panel.resources":"Ressourcen","mcp.panel.prompts":"Prompts","mcp.sessions.no_clients":"Keine Clients verbunden","mcp.server.name":"Servername","mcp.server.version":"Serverversion","mcp.server.connected_clients":"Verbundene Clients","mcp.filter.tools_placeholder":"Werkzeuge filtern...","mcp.filter.resources_placeholder":"Ressourcen filtern...","mcp.filter.prompts_placeholder":"Prompts filtern...","mcp.filter.show_experimental":"Experimentelle anzeigen","mcp.tools.no_match":"Keine Werkzeuge entsprechen Ihrem Filter.","mcp.tools.none_available":"Keine Werkzeuge verfgbar.","mcp.resources.no_match":"Keine Ressourcen entsprechen Ihrem Filter.","mcp.resources.none_available":"Keine Ressourcen verfgbar.","mcp.prompts.no_match":"Keine Prompts entsprechen Ihrem Filter.","mcp.prompts.none_available":"Keine Prompts verfgbar.","mcp.prompts.argument_count":"%0 Argument","mcp.prompts.argument_count_plural":"%0 Argumente","mcp.tooltip.click_to_test":"Klicken zum Testen von %0","mcp.tooltip.click_to_preview":"Klicken zur Vorschau von %0","mcp.tooltip.click_to_view_panel":"Klicken zum Anzeigen des MCP-Panels","mcp.status.experimental_tooltip":"Dieses Werkzeug ist experimentell","mcp.status.server":"MCP Server","mcp.status.server_one_client":"MCP Server (1 Client)","mcp.status.server_clients":"MCP Server (%0 Clients)","mcp.settings.instructions_name":"MCP Systemanweisungen","mcp.settings.instructions_desc":"Anweisungen fr das MCP-System.","mcp.settings.port_name":"MCP Server Port","mcp.settings.port_desc":"Port fr den MCP-Server.","mcp.settings.endpoint_name":"MCP Server Endpunkt","mcp.settings.endpoint_desc":"Endpunkt fr den MCP-Server.","mcp.dialog.result_title":"Ergebnis: %0","mcp.dialog.no_parameters":"Dieses Werkzeug hat keine Parameter.","mcp.dialog.run_tool":"Werkzeug ausfhren","mcp.dialog.copy_input":"Eingabe kopieren","mcp.dialog.cancel":"Abbrechen","mcp.dialog.close":"Schlieen","mcp.dialog.json_array_placeholder":"JSON-Array eingeben, z.B. [1, 2, 3]","mcp.dialog.json_object_placeholder":"JSON-Objekt eingeben","mcp.dialog.input_copied":"Eingabe in Zwischenablage kopiert","mcp.dialog.copy_failed":"Kopieren in Zwischenablage fehlgeschlagen","mcp.dialog.running_tool":"Werkzeug wird ausgefhrt...","mcp.dialog.tool_not_found":'Werkzeug "%0" nicht gefunden',"mcp.dialog.prompt_title":"Prompt: %0","mcp.dialog.copy":"Kopieren","mcp.dialog.prompt_copied":"Prompt in Zwischenablage kopiert","mcp.dialog.no_arguments":"Dieser Prompt hat keine Argumente.","mcp.dialog.generate_prompt":"Prompt generieren","mcp.dialog.generating_prompt":"Prompt wird generiert...","mcp.dialog.prompt_not_found":'Prompt "%0" nicht gefunden',"mcp.dialog.role_user":"Benutzer","mcp.dialog.role_assistant":"Assistent"},sE={"mcp.panel.sessions":"","mcp.panel.server":"","mcp.panel.tools":"","mcp.panel.resources":"","mcp.panel.prompts":"","mcp.sessions.no_clients":"","mcp.server.name":"","mcp.server.version":"","mcp.server.connected_clients":"","mcp.filter.tools_placeholder":"...","mcp.filter.resources_placeholder":"...","mcp.filter.prompts_placeholder":"...","mcp.filter.show_experimental":"","mcp.tools.no_match":"","mcp.tools.none_available":"","mcp.resources.no_match":"","mcp.resources.none_available":"","mcp.prompts.no_match":"","mcp.prompts.none_available":"","mcp.prompts.argument_count":"%0 ","mcp.prompts.argument_count_plural":"%0 ","mcp.tooltip.click_to_test":" %0 ","mcp.tooltip.click_to_preview":" %0 ","mcp.tooltip.click_to_view_panel":"MCP","mcp.status.experimental_tooltip":"","mcp.status.server":"MCP","mcp.status.server_one_client":"MCP (1)","mcp.status.server_clients":"MCP (%0)","mcp.settings.instructions_name":"MCP","mcp.settings.instructions_desc":"MCP","mcp.settings.port_name":"MCP","mcp.settings.port_desc":"MCP","mcp.settings.endpoint_name":"MCP","mcp.settings.endpoint_desc":"MCP","mcp.dialog.result_title":": %0","mcp.dialog.no_parameters":"","mcp.dialog.run_tool":"","mcp.dialog.copy_input":"","mcp.dialog.cancel":"","mcp.dialog.close":"","mcp.dialog.json_array_placeholder":"JSON (: [1, 2, 3])","mcp.dialog.json_object_placeholder":"JSON","mcp.dialog.input_copied":"","mcp.dialog.copy_failed":"","mcp.dialog.running_tool":"...","mcp.dialog.tool_not_found":' "%0" ',"mcp.dialog.prompt_title":": %0","mcp.dialog.copy":"","mcp.dialog.prompt_copied":"","mcp.dialog.no_arguments":"","mcp.dialog.generate_prompt":"","mcp.dialog.generating_prompt":"...","mcp.dialog.prompt_not_found":' "%0" ',"mcp.dialog.role_user":"","mcp.dialog.role_assistant":""},eE={"mcp.panel.sessions":"","mcp.panel.server":"","mcp.panel.tools":"","mcp.panel.resources":"","mcp.panel.prompts":"","mcp.sessions.no_clients":"","mcp.server.name":"","mcp.server.version":"","mcp.server.connected_clients":"","mcp.filter.tools_placeholder":"...","mcp.filter.resources_placeholder":"...","mcp.filter.prompts_placeholder":"...","mcp.filter.show_experimental":"","mcp.tools.no_match":"","mcp.tools.none_available":"","mcp.resources.no_match":"","mcp.resources.none_available":"","mcp.prompts.no_match":"","mcp.prompts.none_available":"","mcp.prompts.argument_count":"%0 ","mcp.prompts.argument_count_plural":"%0 ","mcp.tooltip.click_to_test":" %0","mcp.tooltip.click_to_preview":" %0","mcp.tooltip.click_to_view_panel":"MCP","mcp.status.experimental_tooltip":"","mcp.status.server":"MCP","mcp.status.server_one_client":"MCP (1)","mcp.status.server_clients":"MCP (%0)","mcp.settings.instructions_name":"MCP","mcp.settings.instructions_desc":"MCP","mcp.settings.port_name":"MCP","mcp.settings.port_desc":"MCP","mcp.settings.endpoint_name":"MCP","mcp.settings.endpoint_desc":"MCP","mcp.dialog.result_title":": %0","mcp.dialog.no_parameters":"","mcp.dialog.run_tool":"","mcp.dialog.copy_input":"","mcp.dialog.cancel":"","mcp.dialog.close":"","mcp.dialog.json_array_placeholder":"JSON [1, 2, 3]","mcp.dialog.json_object_placeholder":"JSON","mcp.dialog.input_copied":"","mcp.dialog.copy_failed":"","mcp.dialog.running_tool":"...","mcp.dialog.tool_not_found":' "%0"',"mcp.dialog.prompt_title":": %0","mcp.dialog.copy":"","mcp.dialog.prompt_copied":"","mcp.dialog.no_arguments":"","mcp.dialog.generate_prompt":"","mcp.dialog.generating_prompt":"...","mcp.dialog.prompt_not_found":' "%0"',"mcp.dialog.role_user":"","mcp.dialog.role_assistant":""},QR={en:uF,de:tE,ja:sE,zh:eE};function lF(){Language.addTranslations("en",uF);for(let[Q,$]of Object.entries(QR))if(Q!=="en")Language.addTranslations(Q,$)}function mF(Q){if(Q===1)return tl("mcp.prompts.argument_count",[Q]);return tl("mcp.prompts.argument_count_plural",[Q])}var cF='.mcp-panel{display:grid;grid-template-rows:auto 1fr auto;max-block-size:66vh;overflow:auto;padding:10px;details{overflow:auto}summary{cursor:pointer}dl{display:grid;grid-template-columns:1fr 1fr;grid-auto-flow:row;margin:0;padding:0;dt{font-size:0.825em;font-weight:bold;grid-column:1;margin:0;padding:0}dd{grid-column:2;margin:0;padding:0}}.tool-toggle-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--color-border)}.tool-toggle-row:last-child{border-bottom:none}.tool-toggle-row.clickable{cursor:pointer;padding:8px;margin:0 -8px;border-radius:4px;transition:background-color 0.15s ease}.tool-toggle-row.clickable:hover{background-color:var(--color-button)}.tool-toggle-row.clickable:active{background-color:var(--color-accent)}.tool-toggle-row.clickable .tool-name::after{content:"chevron_right";font-family:"Material Icons";font-size:16px;margin-left:4px;opacity:0.5;vertical-align:middle}.tool-info{flex:1;min-width:0}.tool-name{font-weight:bold;font-size:0.9em;margin-bottom:2px}.tool-description{font-size:0.8em;color:var(--color-subtle_text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tool-description+.tool-description{margin-top:4px}.tool-toggle{margin-left:12px;flex-shrink:0;label{font-size:0.9em}}.tool-status.experimental{font-family:"Material Icons";font-size:14px;margin-left:6px;vertical-align:middle;line-height:1}.tool-status.experimental::before{content:"science"}.session-item{display:flex;align-items:center;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--color-border);font-size:0.85em}.session-item:last-child{border-bottom:none}.session-id{font-family:monospace;color:var(--color-text)}.session-time{color:var(--color-subtle_text);font-size:0.9em}.no-sessions{color:var(--color-subtle_text);font-style:italic;padding:8px 0}.no-results{color:var(--color-subtle_text);font-style:italic;padding:12px 0;text-align:center}.filter-bar{display:flex;flex-direction:row;align-items:center;gap:10px;padding:8px 0;margin-bottom:4px;border-bottom:1px solid var(--color-border)}.filter-input{flex:1;min-width:0;padding:6px 8px;border:1px solid var(--color-border);border-radius:4px;background:var(--color-back);color:var(--color-text);font-size:0.85em;box-sizing:border-box}.filter-input:focus{outline:none;border-color:var(--color-accent)}.filter-input::placeholder{color:var(--color-subtle_text)}.filter-switch{display:inline-flex;align-items:center;gap:6px;font-size:0.75em;color:var(--color-subtle_text);cursor:pointer;user-select:none;white-space:nowrap}.filter-switch input[type="checkbox"]{display:none}.switch-slider{position:relative;width:28px;height:16px;background:var(--color-button);border-radius:8px;transition:background-color 0.2s ease}.switch-slider::before{content:"";position:absolute;top:2px;left:2px;width:12px;height:12px;background:var(--color-text);border-radius:50%;transition:transform 0.2s ease}.filter-switch input:checked+.switch-slider{background:var(--color-accent)}.filter-switch input:checked+.switch-slider::before{transform:translateX(12px)}.switch-label{color:var(--color-subtle_text)}.filter-switch input:checked~.switch-label{color:var(--color-text)}}';var pF=`<div class="mcp-panel"><details name="mcp_panel" open><summary>{{tl('mcp.panel.sessions')}} ({{sessions.length}})</summary><div v-if="sessions.length > 0"><div v-for="session in sessions" :key="session.id" class="session-item" :title="session.id"><span class="session-id">{{formatSessionId(session)}}</span><span class="session-time">{{formatTime(session.connectedAt)}}</span></div></div><div v-else class="no-sessions"> {{tl('mcp.sessions.no_clients')}} </div></details><details name="mcp_panel"><summary>{{tl('mcp.panel.server')}}</summary><dl><dt>{{tl('mcp.server.name')}}</dt><dd>{{server.name}}</dd><dt>{{tl('mcp.server.version')}}</dt><dd><a href="https://github.com/jasonjgardner/blockbench-mcp-plugin/releases/" target="_blank" rel="noopener noreferrer">{{server.version}}</a></dd><dt>{{tl('mcp.server.connected_clients')}}</dt><dd>{{sessions.length}}</dd></dl></details><details name="mcp_panel" @toggle="onToolsToggle"><summary>{{tl('mcp.panel.tools')}} ({{filteredTools.length}}/{{tools.length}})</summary><div class="filter-bar"><input type="text" v-model="toolsFilter.search" :placeholder="tl('mcp.filter.tools_placeholder')" :aria-label="tl('mcp.filter.tools_placeholder')" class="filter-input" @input="toolsFilter.search=$event.target.value"><label class="filter-switch"><input type="checkbox" v-model="toolsFilter.showExperimental"><span class="switch-slider"></span><span class="switch-label">{{tl('mcp.filter.show_experimental')}}</span></label></div><div v-if="filteredTools.length > 0"><div v-for="tool in filteredTools" :key="tool.name" class="tool-toggle-row clickable" @click="openToolTest(tool.name)" :title="tl('mcp.tooltip.click_to_test', [getDisplayName(tool.name)])"><div class="tool-info"><div class="tool-name"> {{getDisplayName(tool.name)}} <span v-if="tool.status==='experimental'" class="tool-status experimental" :title="tl('mcp.status.experimental_tooltip')"></span></div><div class="tool-description" :title="tool.description">{{tool.description}}</div></div></div></div><div v-else-if="tools.length > 0" class="no-results"> {{tl('mcp.tools.no_match')}} </div><div v-else><p>{{tl('mcp.tools.none_available')}}</p></div></details><details name="mcp_panel" @toggle="onResourcesToggle"><summary>{{tl('mcp.panel.resources')}} ({{filteredResources.length}}/{{resources.length}})</summary><div class="filter-bar"><input type="text" v-model="resourcesFilter.search" :placeholder="tl('mcp.filter.resources_placeholder')" :aria-label="tl('mcp.filter.resources_placeholder')" class="filter-input" @input="resourcesFilter.search=$event.target.value"></div><div v-if="filteredResources.length > 0"><div v-for="resource in filteredResources" :key="resource.name" class="tool-toggle-row"><div class="tool-info"><div class="tool-name">{{getDisplayName(resource.name)}}</div><div class="tool-description" :title="resource.description">{{resource.description}}</div><div class="tool-description" style="font-style: italic; margin-top: 2px;" :title="resource.uriTemplate">{{resource.uriTemplate}}</div></div></div></div><div v-else-if="resources.length > 0" class="no-results"> {{tl('mcp.resources.no_match')}} </div><div v-else><p>{{tl('mcp.resources.none_available')}}</p></div></details><details name="mcp_panel" @toggle="onPromptsToggle"><summary>{{tl('mcp.panel.prompts')}} ({{filteredPrompts.length}}/{{prompts.length}})</summary><div class="filter-bar"><input type="text" v-model="promptsFilter.search" :placeholder="tl('mcp.filter.prompts_placeholder')" :aria-label="tl('mcp.filter.prompts_placeholder')" class="filter-input" @input="promptsFilter.search=$event.target.value"><label class="filter-switch"><input type="checkbox" v-model="promptsFilter.showExperimental"><span class="switch-slider"></span><span class="switch-label">{{tl('mcp.filter.show_experimental')}}</span></label></div><div v-if="filteredPrompts.length > 0"><div v-for="prompt in filteredPrompts" :key="prompt.name" class="tool-toggle-row clickable" @click="openPromptPreview(prompt.name)" :title="tl('mcp.tooltip.click_to_preview', [getDisplayName(prompt.name)])"><div class="tool-info"><div class="tool-name"> {{getDisplayName(prompt.name)}} <span v-if="prompt.status==='experimental'" class="tool-status experimental" :title="tl('mcp.status.experimental_tooltip')"></span></div><div class="tool-description" :title="prompt.description">{{prompt.description}}</div><div v-if="prompt.argumentCount > 0" class="tool-description" style="font-style: italic; margin-top: 2px;"> {{formatArgumentCount(prompt.argumentCount)}} </div></div></div></div><div v-else-if="prompts.length > 0" class="no-results"> {{tl('mcp.prompts.no_match')}} </div><div v-else><p>{{tl('mcp.prompts.none_available')}}</p></div></details></div>`;var NX,P4;function dF({server:Q,tools:$,resources:W,prompts:Y}){return Blockbench.addCSS(cF),kF(Q),NX=new Panel("mcp_panel",{id:"mcp_panel",icon:"robot",name:"MCP",default_side:"right",resizable:!0,component:{mounted(){let X=this;P4=o0.subscribe((J)=>{X.sessions=J.map((H)=>({id:H.id,connectedAt:H.connectedAt,lastActivity:H.lastActivity,clientName:H.clientName,clientVersion:H.clientVersion})),X.server.connected=J.length>0})},beforeDestroy(){if(P4)P4(),P4=void 0},data:()=>({sessions:[],server:{connected:!1,name:"Blockbench MCP",version:w8},tools:Object.values($).map((X)=>({name:X.name,description:X.description,enabled:X.enabled,status:X.status})),resources:Object.values(W).map((X)=>({name:X.name,description:X.description,uriTemplate:X.uriTemplate})),prompts:Object.values(Y).map((X)=>({name:X.name,description:X.description,enabled:X.enabled,status:X.status,argumentCount:Object.keys(X.arguments).length})),toolsFilter:{search:"",showExperimental:!0},resourcesFilter:{search:""},promptsFilter:{search:"",showExperimental:!0}}),computed:{filteredTools(){let{tools:X,toolsFilter:J}=this,H=J.search.toLowerCase();return X.filter((G)=>{if(G.status==="experimental"&&!J.showExperimental)return!1;if(H&&!G.name.toLowerCase().includes(H))return!1;return!0})},filteredResources(){let{resources:X,resourcesFilter:J}=this,H=J.search.toLowerCase();if(!H)return X;return X.filter((G)=>G.name.toLowerCase().includes(H))},filteredPrompts(){let{prompts:X,promptsFilter:J}=this,H=J.search.toLowerCase();return X.filter((G)=>{if(G.status==="experimental"&&!J.showExperimental)return!1;if(H&&!G.name.toLowerCase().includes(H))return!1;return!0})}},methods:{tl(X,J){return tl(X,J)},getDisplayName(X){return X.replace("blockbench_","")},formatSessionId(X){if(X.clientName)return X.clientVersion?`${X.clientName} v${X.clientVersion}`:X.clientName;return X.id.slice(0,8)+"..."},formatTime(X){return new Date(X).toLocaleTimeString()},openToolTest(X){yF(X)},openPromptPreview(X){fF(X)},formatArgumentCount:mF,onToolsToggle(X){if(!X.target.open)this.toolsFilter.search=""},onResourcesToggle(X){if(!X.target.open)this.resourcesFilter.search=""},onPromptsToggle(X){if(!X.target.open)this.promptsFilter.search=""}},name:"mcp_panel",template:pF},expand_button:!0}),NX}function iF(){TF(),NX?.delete()}var nF=[];function rF(){nF.push(new Setting("mcp_instructions",{name:tl("mcp.settings.instructions_name"),description:tl("mcp.settings.instructions_desc"),type:"text",value:"Generate simple, low-poly models for Minecraft inside Blockbench.",category:"general",icon:"psychology"}),new Setting("mcp_port",{name:tl("mcp.settings.port_name"),description:tl("mcp.settings.port_desc"),type:"number",value:3000,category:"general",icon:"numbers"}),new Setting("mcp_endpoint",{name:tl("mcp.settings.endpoint_name"),description:tl("mcp.settings.endpoint_desc"),type:"text",value:"/bb-mcp",category:"general",icon:"webhook"}))}function MX(){nF.forEach((Q)=>{Q.delete()})}class jX{constructor(Q={}){this._started=!1,this._streamMapping=new Map,this._requestToStreamMapping=new Map,this._requestResponseMap=new Map,this._initialized=!1,this._enableJsonResponse=!1,this._standaloneSseStreamId="_GET_stream",this.sessionIdGenerator=Q.sessionIdGenerator,this._enableJsonResponse=Q.enableJsonResponse??!1,this._eventStore=Q.eventStore,this._onsessioninitialized=Q.onsessioninitialized,this._onsessionclosed=Q.onsessionclosed,this._allowedHosts=Q.allowedHosts,this._allowedOrigins=Q.allowedOrigins,this._enableDnsRebindingProtection=Q.enableDnsRebindingProtection??!1,this._retryInterval=Q.retryInterval}async start(){if(this._started)throw Error("Transport already started");this._started=!0}createJsonErrorResponse(Q,$,W,Y){let X={code:$,message:W};if(Y?.data!==void 0)X.data=Y.data;return new Response(JSON.stringify({jsonrpc:"2.0",error:X,id:null}),{status:Q,headers:{"Content-Type":"application/json",...Y?.headers}})}validateRequestHeaders(Q){if(!this._enableDnsRebindingProtection)return;if(this._allowedHosts&&this._allowedHosts.length>0){let $=Q.headers.get("host");if(!$||!this._allowedHosts.includes($)){let W=`Invalid Host header: ${$}`;return this.onerror?.(Error(W)),this.createJsonErrorResponse(403,-32000,W)}}if(this._allowedOrigins&&this._allowedOrigins.length>0){let $=Q.headers.get("origin");if($&&!this._allowedOrigins.includes($)){let W=`Invalid Origin header: ${$}`;return this.onerror?.(Error(W)),this.createJsonErrorResponse(403,-32000,W)}}return}async handleRequest(Q,$){let W=this.validateRequestHeaders(Q);if(W)return W;switch(Q.method){case"POST":return this.handlePostRequest(Q,$);case"GET":return this.handleGetRequest(Q);case"DELETE":return this.handleDeleteRequest(Q);default:return this.handleUnsupportedRequest()}}async writePrimingEvent(Q,$,W,Y){if(!this._eventStore)return;if(Y<"2025-11-25")return;let X=await this._eventStore.storeEvent(W,{}),J=`id: ${X}
data: 

`;if(this._retryInterval!==void 0)J=`id: ${X}
retry: ${this._retryInterval}
data: 

`;Q.enqueue($.encode(J))}async handleGetRequest(Q){if(!Q.headers.get("accept")?.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32000,"Not Acceptable: Client must accept text/event-stream");let W=this.validateSession(Q);if(W)return W;let Y=this.validateProtocolVersion(Q);if(Y)return Y;if(this._eventStore){let B=Q.headers.get("last-event-id");if(B)return this.replayEvents(B)}if(this._streamMapping.get(this._standaloneSseStreamId)!==void 0)return this.createJsonErrorResponse(409,-32000,"Conflict: Only one SSE stream is allowed per session");let X=new TextEncoder,J,H=new ReadableStream({start:(B)=>{J=B},cancel:()=>{this._streamMapping.delete(this._standaloneSseStreamId)}}),G={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};if(this.sessionId!==void 0)G["mcp-session-id"]=this.sessionId;return this._streamMapping.set(this._standaloneSseStreamId,{controller:J,encoder:X,cleanup:()=>{this._streamMapping.delete(this._standaloneSseStreamId);try{J.close()}catch{}}}),new Response(H,{headers:G})}async replayEvents(Q){if(!this._eventStore)return this.createJsonErrorResponse(400,-32000,"Event store not configured");try{let $;if(this._eventStore.getStreamIdForEventId){if($=await this._eventStore.getStreamIdForEventId(Q),!$)return this.createJsonErrorResponse(400,-32000,"Invalid event ID format");if(this._streamMapping.get($)!==void 0)return this.createJsonErrorResponse(409,-32000,"Conflict: Stream already has an active connection")}let W={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};if(this.sessionId!==void 0)W["mcp-session-id"]=this.sessionId;let Y=new TextEncoder,X,J=new ReadableStream({start:(G)=>{X=G},cancel:()=>{}}),H=await this._eventStore.replayEventsAfter(Q,{send:async(G,B)=>{if(!this.writeSSEEvent(X,Y,B,G)){this.onerror?.(Error("Failed replay events"));try{X.close()}catch{}}}});return this._streamMapping.set(H,{controller:X,encoder:Y,cleanup:()=>{this._streamMapping.delete(H);try{X.close()}catch{}}}),new Response(J,{headers:W})}catch($){return this.onerror?.($),this.createJsonErrorResponse(500,-32000,"Error replaying events")}}writeSSEEvent(Q,$,W,Y){try{let X=`event: message
`;if(Y)X+=`id: ${Y}
`;return X+=`data: ${JSON.stringify(W)}

`,Q.enqueue($.encode(X)),!0}catch{return!1}}handleUnsupportedRequest(){return new Response(JSON.stringify({jsonrpc:"2.0",error:{code:-32000,message:"Method not allowed."},id:null}),{status:405,headers:{Allow:"GET, POST, DELETE","Content-Type":"application/json"}})}async handlePostRequest(Q,$){try{let W=Q.headers.get("accept");if(!W?.includes("application/json")||!W.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32000,"Not Acceptable: Client must accept both application/json and text/event-stream");let Y=Q.headers.get("content-type");if(!Y||!Y.includes("application/json"))return this.createJsonErrorResponse(415,-32000,"Unsupported Media Type: Content-Type must be application/json");let X={headers:Object.fromEntries(Q.headers.entries())},J;if($?.parsedBody!==void 0)J=$.parsedBody;else try{J=await Q.json()}catch{return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON")}let H;try{if(Array.isArray(J))H=J.map((w)=>iW.parse(w));else H=[iW.parse(J)]}catch{return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON-RPC message")}let G=H.some(nW);if(G){if(this._initialized&&this.sessionId!==void 0)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Server already initialized");if(H.length>1)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Only one initialization request is allowed");if(this.sessionId=this.sessionIdGenerator?.(),this._initialized=!0,this.sessionId&&this._onsessioninitialized)await Promise.resolve(this._onsessioninitialized(this.sessionId))}if(!G){let w=this.validateSession(Q);if(w)return w;let O=this.validateProtocolVersion(Q);if(O)return O}if(!H.some(P6)){for(let w of H)this.onmessage?.(w,{authInfo:$?.authInfo,requestInfo:X});return new Response(null,{status:202})}let K=crypto.randomUUID(),F=H.find((w)=>nW(w)),q=F?F.params.protocolVersion:Q.headers.get("mcp-protocol-version")??E3;if(this._enableJsonResponse)return new Promise((w)=>{this._streamMapping.set(K,{resolveJson:w,cleanup:()=>{this._streamMapping.delete(K)}});for(let O of H)if(P6(O))this._requestToStreamMapping.set(O.id,K);for(let O of H)this.onmessage?.(O,{authInfo:$?.authInfo,requestInfo:X})});let A=new TextEncoder,V,U=new ReadableStream({start:(w)=>{V=w},cancel:()=>{this._streamMapping.delete(K)}}),z={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};if(this.sessionId!==void 0)z["mcp-session-id"]=this.sessionId;for(let w of H)if(P6(w))this._streamMapping.set(K,{controller:V,encoder:A,cleanup:()=>{this._streamMapping.delete(K);try{V.close()}catch{}}}),this._requestToStreamMapping.set(w.id,K);await this.writePrimingEvent(V,A,K,q);for(let w of H){let O,D;if(P6(w)&&this._eventStore&&q>="2025-11-25")O=()=>{this.closeSSEStream(w.id)},D=()=>{this.closeStandaloneSSEStream()};this.onmessage?.(w,{authInfo:$?.authInfo,requestInfo:X,closeSSEStream:O,closeStandaloneSSEStream:D})}return new Response(U,{status:200,headers:z})}catch(W){return this.onerror?.(W),this.createJsonErrorResponse(400,-32700,"Parse error",{data:String(W)})}}async handleDeleteRequest(Q){let $=this.validateSession(Q);if($)return $;let W=this.validateProtocolVersion(Q);if(W)return W;return await Promise.resolve(this._onsessionclosed?.(this.sessionId)),await this.close(),new Response(null,{status:200})}validateSession(Q){if(this.sessionIdGenerator===void 0)return;if(!this._initialized)return this.createJsonErrorResponse(400,-32000,"Bad Request: Server not initialized");let $=Q.headers.get("mcp-session-id");if(!$)return this.createJsonErrorResponse(400,-32000,"Bad Request: Mcp-Session-Id header is required");if($!==this.sessionId)return this.createJsonErrorResponse(404,-32001,"Session not found");return}validateProtocolVersion(Q){let $=Q.headers.get("mcp-protocol-version");if($!==null&&!y9.includes($))return this.createJsonErrorResponse(400,-32000,`Bad Request: Unsupported protocol version: ${$} (supported versions: ${y9.join(", ")})`);return}async close(){this._streamMapping.forEach(({cleanup:Q})=>{Q()}),this._streamMapping.clear(),this._requestResponseMap.clear(),this.onclose?.()}closeSSEStream(Q){let $=this._requestToStreamMapping.get(Q);if(!$)return;let W=this._streamMapping.get($);if(W)W.cleanup()}closeStandaloneSSEStream(){let Q=this._streamMapping.get(this._standaloneSseStreamId);if(Q)Q.cleanup()}async send(Q,$){let W=$?.relatedRequestId;if($6(Q)||h8(Q))W=Q.id;if(W===void 0){if($6(Q)||h8(Q))throw Error("Cannot send a response on a standalone SSE stream unless resuming a previous client request");let J;if(this._eventStore)J=await this._eventStore.storeEvent(this._standaloneSseStreamId,Q);let H=this._streamMapping.get(this._standaloneSseStreamId);if(H===void 0)return;if(H.controller&&H.encoder)this.writeSSEEvent(H.controller,H.encoder,Q,J);return}let Y=this._requestToStreamMapping.get(W);if(!Y)throw Error(`No connection established for request ID: ${String(W)}`);let X=this._streamMapping.get(Y);if(!this._enableJsonResponse&&X?.controller&&X?.encoder){let J;if(this._eventStore)J=await this._eventStore.storeEvent(Y,Q);this.writeSSEEvent(X.controller,X.encoder,Q,J)}if($6(Q)||h8(Q)){this._requestResponseMap.set(W,Q);let J=Array.from(this._requestToStreamMapping.entries()).filter(([G,B])=>B===Y).map(([G])=>G);if(J.every((G)=>this._requestResponseMap.has(G))){if(!X)throw Error(`No connection established for request ID: ${String(W)}`);if(this._enableJsonResponse&&X.resolveJson){let G={"Content-Type":"application/json"};if(this.sessionId!==void 0)G["mcp-session-id"]=this.sessionId;let B=J.map((K)=>this._requestResponseMap.get(K));if(B.length===1)X.resolveJson(new Response(JSON.stringify(B[0]),{status:200,headers:G}));else X.resolveJson(new Response(JSON.stringify(B),{status:200,headers:G}))}else X.cleanup();for(let G of J)this._requestResponseMap.delete(G),this._requestToStreamMapping.delete(G)}}}}var oF={enabled:!0,initialDelay:30000};function aF(Q){return{200:"OK",201:"Created",204:"No Content",400:"Bad Request",404:"Not Found",405:"Method Not Allowed",409:"Conflict",500:"Internal Server Error"}[Q]||"Unknown"}function DX({createServer:Q},{port:$,endpoint:W,keepAlive:Y=oF,sessionConfig:X}){let J=new Map,H={...oF,...Y};if(X)o0.configure(X);o0.setPingCallback(async(B)=>{if(!J.get(B))return!1;return!0}),o0.setRemovalCallback(async(B)=>{let K=J.get(B);if(K){console.log(`[MCP] Closing transport for session: ${B.slice(0,8)}...`);try{await K.transport.close()}catch(F){console.error("[MCP] Error closing transport:",F)}finally{J.delete(B)}}});let G=Q((B)=>{let K=Buffer.alloc(0),F=!1;if(H.enabled)B.setKeepAlive(!0,H.initialDelay);B.on("data",(U)=>{if(F)return;K=Buffer.concat([K,U]),q().catch((z)=>{if(console.error("[MCP] Unhandled error in processHttpRequests:",z),!B.destroyed)try{V(B,500,{"content-type":"application/json"},JSON.stringify({error:"Internal server error"}),void 0)}catch(w){console.error("[MCP] Failed to send error response:",w),B.destroy()}})}),B.on("error",(U)=>{if(U.message!=="read ECONNRESET")console.error("[MCP] Socket error:",U.message);B.destroy()}),B.on("close",()=>{K=Buffer.alloc(0)});async function q(){while(!0){if(F||B.destroyed||!B.writable)return;let U=K.indexOf(`\r
\r
`);if(U===-1)return;let w=K.subarray(0,U).toString().split(`\r
`),[O,D]=w[0].split(" "),j={};for(let E0=1;E0<w.length;E0++){let F1=w[E0].indexOf(":");if(F1>0){let l1=w[E0].substring(0,F1).trim().toLowerCase(),A8=w[E0].substring(F1+1).trim();j[l1]=A8}}let S=U+4,C=parseInt(j["content-length"]||"0",10),K0=S+C;if(K.length<K0)return;let b0=K.subarray(S,K0).toString();K=K.subarray(K0);let f1=`http://localhost:${$}${D}`,q6=new Headers;for(let[E0,F1]of Object.entries(j))q6.set(E0,F1);let u1={method:O,headers:q6};if(O!=="GET"&&O!=="HEAD"&&b0)u1.body=b0;let U9=new Request(f1,u1),V6=D.split("?")[0];if(V6==="/health"||V6===W+"/health"){let E0={status:"ok",timestamp:new Date().toISOString(),sessions:{active:o0.getCount(),config:o0.getConfig()}};V(B,200,{"content-type":"application/json"},JSON.stringify(E0),j.connection);continue}if(V6==="/ready"||V6===W+"/ready"){V(B,200,{"content-type":"application/json"},JSON.stringify({ready:!0}),j.connection);continue}if(V6!==W&&!D.startsWith(W+"/")&&!D.startsWith(W+"?")){V(B,404,{"content-type":"text/plain"},"Not Found",j.connection);continue}try{let E0=j["mcp-session-id"],F1=E0?J.get(E0):null;if(E0&&!F1){console.log(`[MCP] Invalid session ID: ${E0.slice(0,8)}... (session expired or not found)`),V(B,409,{"content-type":"application/json"},JSON.stringify({jsonrpc:"2.0",error:{code:-32600,message:"Session expired or not found. Please reconnect."},id:null}),j.connection);continue}if(!F1){let P1=OQ();kK(P1),_K(P1),yK(P1);let z8=new jX({sessionIdGenerator:()=>crypto.randomUUID(),enableJsonResponse:!0,onsessioninitialized:(z1)=>{console.log(`[MCP] Session initialized: ${z1.slice(0,8)}...`),o0.add(z1);let A9=J.get("__pending__");if(A9){J.delete("__pending__"),J.set(z1,A9);let vQ=A9.server.server;vQ.oninitialized=()=>{let S4=vQ.getClientVersion();if(S4)o0.updateClientInfo(z1,S4.name,S4.version)}}},onsessionclosed:(z1)=>{console.log(`[MCP] Session closed: ${z1.slice(0,8)}...`),J.delete(z1),o0.remove(z1)}});if(await P1.connect(z8),F1={transport:z8,server:P1},!E0)J.set("__pending__",F1)}if(E0)o0.updateActivity(E0);let l1=await F1.transport.handleRequest(U9),A8={};l1.headers.forEach((P1,z8)=>{A8[z8]=P1});let RX=l1.headers.get("content-type")||"";if(!RX&&l1.status!==204)A8["content-type"]="application/json";if(RX.includes("text/event-stream"))if(A(B,l1.status,A8),l1.body){let P1=l1.body.getReader(),z8=new TextDecoder;try{while(!0){if(F||B.destroyed||!B.writable)break;let{done:z1,value:A9}=await P1.read();if(z1)break;let vQ=z8.decode(A9,{stream:!0});B.write(vQ)}}catch(z1){console.error("[MCP] SSE stream error:",z1)}finally{F=!0,B.end()}}else F=!0,B.end();else{let P1=await l1.text();V(B,l1.status,A8,P1,j.connection)}}catch(E0){console.error("[MCP] Request handler error:",E0),V(B,500,{"content-type":"application/json"},JSON.stringify({error:String(E0)}),j.connection)}}}function A(U,z,w){if(F||U.destroyed||!U.writable)return!1;let O=`HTTP/1.1 ${z} ${aF(z)}\r
`;delete w["content-length"],w["cache-control"]="no-cache",w.connection="keep-alive";for(let[D,j]of Object.entries(w))O+=`${D}: ${j}\r
`;return O+=`\r
`,U.write(O),!0}function V(U,z,w,O,D){if(F||U.destroyed||!U.writable)return!1;let j=`HTTP/1.1 ${z} ${aF(z)}\r
`,S=Buffer.byteLength(O);w["content-length"]=S.toString();let C=D?.toLowerCase()==="keep-alive";if(w.connection=C?"keep-alive":"close",!w.date)w.date=new Date().toUTCString();for(let[K0,b0]of Object.entries(w))j+=`${K0}: ${b0}\r
`;if(j+=`\r
`,j+=O,!C)F=!0,U.write(j,()=>{U.end()});else U.write(j);return!0}});return G.listen($,()=>{console.log(`[MCP] Server listening on http://localhost:${$}${W}`)}),G.on("error",(B)=>{console.error("[MCP] Server error:",B),Blockbench.showQuickMessage(`MCP Server error: ${B.message}`,3000)}),[G,J]}var I4=null,EX=null;BBPlugin.register("mcp",{version:w8,title:"MCP Server",author:"Jason J. Gardner",description:"Create an MCP server inside Blockbench.",tags:["MCP","AI"],icon:"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzMzLjg5IDM3Mi44NCI+PHBhdGggZD0iTTI1OS41NCw3NC4yNGM2MC43MS03LjQxLDk3LjU2LDYyLjA2LDU2LjQsMTA4LjlsLTEzNC40MywxMzMuODFjLTEuMDksMi4xMS0xLjY1LDQuODQtLjAyLDYuODVsMjkuMywyOS43YzQuNzgsMTIuNS02LjA1LDIzLjA5LTE4LjEzLDE3LjEzLTMuNzctMS44Ni0yNy4zNS0yNS41OS0zMC45Mi0zMC4wNC0xMC4zNS0xMi45My05LjYxLTI4LjA0LjE1LTQxLjAxbDEzNy40Ni0xMzYuOTljMjguNjMtMzguOTktMjIuMjktODUuMDgtNTguMzQtNTIuMzhsLTExMS45NywxMTIuMDNjLTEyLjMyLDguMDEtMjUuNzItNy44NC0xNy4wMy0xOS4wM2wxMTQuNDgtMTE0Ljc0YzI2LjkyLTM4LjYxLTIxLjA1LTgyLjcyLTU3LjYxLTUxLjg5TDIxLjkyLDE4NC4wN2MtMTQuNjMsMTAuMS0yOS40My04LjM0LTE2LjQtMjAuMzVMMTU3LjYzLDEyLjgyYzM0LjEzLTI1LjQ3LDg0LjYxLTkuNTQsOTguNjksMzAuMTQuNTUsMS41NSwzLjIzLDEwLjAzLDMuMjMsMTAuNzd2MjAuNVoiIHN0eWxlPSJmaWxsOiM3ODc4Nzg7IHN0cm9rZTojZmZmOyBzdHJva2UtbWl0ZXJsaW1pdDoxMDsiLz48cGF0aCBkPSJNMjAxLjk2LDc2LjY1Yy0zMC45NSwzMy42Ny02NS45OSw2My44Ny05Ny40Nyw5Ny4wMy03LjI4LDcuNjctMTQuOCwxNC44Ni0xNy40OCwyNS41Mi05Ljg0LDM5LjE3LDM3Ljc3LDY0LjY1LDY2LjA2LDM2LjA2bDEwOS4xLTEwOC45YzExLjg5LTUuNTMsMjQuMTcsNi40NCwxNy4yMiwxOC4yMmwtMTE3LjMzLDExNi42N2MtNjQuMTksNDMuNDMtMTM2LjctMzcuNDEtODQuNTctOTYuNTQsMzMuMjItMzcuNjgsNzQuOTgtNzEuNjUsMTA5LjEzLTEwOC44OSwxMS0xMC4wMSwyNi42NywxLjk2LDIwLjMsMTUuMzEtMS4xLDIuMzEtMy40MSwzLjgxLTQuOTgsNS41MloiIHN0eWxlPSJmaWxsOiM3ODc4Nzg7IHN0cm9rZTojZmZmOyBzdHJva2UtbWl0ZXJsaW1pdDoxMDsiLz48L3N2Zz4=",variant:"desktop",async onload(){let Q=requireNativeModule("net",{message:"Network access is required for the MCP server to accept connections.",detail:"The MCP plugin needs to create a local server that AI assistants can connect to.",optional:!1});if(!Q){console.error("[MCP] Failed to get net module - server will not start"),Blockbench.showQuickMessage("MCP Server requires network permission",3000);return}lF(),rF(),[I4,EX]=DX(Q,{port:Number(Settings.get("mcp_port")||3000),endpoint:String(Settings.get("mcp_endpoint")||"/bb-mcp")});let $=OQ();dF({server:$,tools:H8,resources:Y9,prompts:G8})},onunload(){if(I4)I4.close(),I4=null;let Q=Array.from(EX?.values()??[]);for(let $ of Q)$.transport.close();EX?.clear(),o0.clear(),iF(),MX()},oninstall(){Blockbench.showQuickMessage("Installed MCP Server plugin",2000)},onuninstall(){Blockbench.showQuickMessage("Uninstalled MCP Server plugin",2000),MX()}});
