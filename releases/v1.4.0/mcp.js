let process = requireNativeModule('process');
var JK=Object.create;var{getPrototypeOf:XK,defineProperty:CQ,getOwnPropertyNames:HK}=Object;var GK=Object.prototype.hasOwnProperty;var j7=(Q,W,$)=>{$=Q!=null?JK(XK(Q)):{};let Y=W||!Q||!Q.__esModule?CQ($,"default",{value:Q,enumerable:!0}):$;for(let J of HK(Q))if(!GK.call(Y,J))CQ(Y,J,{get:()=>Q[J],enumerable:!0});return Y};var Z=(Q,W)=>()=>(W||Q((W={exports:{}}).exports,W),W.exports);var ZQ=(Q,W)=>{for(var $ in W)CQ(Q,$,{get:W[$],enumerable:!0,configurable:!0,set:(Y)=>W[$]=()=>Y})};var G9=Z((Q0)=>{Object.defineProperty(Q0,"__esModule",{value:!0});Q0.regexpCode=Q0.getEsmExportName=Q0.getProperty=Q0.safeStringify=Q0.stringify=Q0.strConcat=Q0.addCodeArg=Q0.str=Q0._=Q0.nil=Q0._Code=Q0.Name=Q0.IDENTIFIER=Q0._CodeOrName=void 0;class y8{}Q0._CodeOrName=y8;Q0.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class V4 extends y8{constructor(Q){super();if(!Q0.IDENTIFIER.test(Q))throw Error("CodeGen: name must be a valid identifier");this.str=Q}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}Q0.Name=V4;class D1 extends y8{constructor(Q){super();this._items=typeof Q==="string"?[Q]:Q}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let Q=this._items[0];return Q===""||Q==='""'}get str(){var Q;return(Q=this._str)!==null&&Q!==void 0?Q:this._str=this._items.reduce((W,$)=>`${W}${$}`,"")}get names(){var Q;return(Q=this._names)!==null&&Q!==void 0?Q:this._names=this._items.reduce((W,$)=>{if($ instanceof V4)W[$.str]=(W[$.str]||0)+1;return W},{})}}Q0._Code=D1;Q0.nil=new D1("");function D3(Q,...W){let $=[Q[0]],Y=0;while(Y<W.length)DY($,W[Y]),$.push(Q[++Y]);return new D1($)}Q0._=D3;var AY=new D1("+");function O3(Q,...W){let $=[H9(Q[0])],Y=0;while(Y<W.length)$.push(AY),DY($,W[Y]),$.push(AY,H9(Q[++Y]));return GU($),new D1($)}Q0.str=O3;function DY(Q,W){if(W instanceof D1)Q.push(...W._items);else if(W instanceof V4)Q.push(W);else Q.push(FU(W))}Q0.addCodeArg=DY;function GU(Q){let W=1;while(W<Q.length-1){if(Q[W]===AY){let $=BU(Q[W-1],Q[W+1]);if($!==void 0){Q.splice(W-1,3,$);continue}Q[W++]="+"}W++}}function BU(Q,W){if(W==='""')return Q;if(Q==='""')return W;if(typeof Q=="string"){if(W instanceof V4||Q[Q.length-1]!=='"')return;if(typeof W!="string")return`${Q.slice(0,-1)}${W}"`;if(W[0]==='"')return Q.slice(0,-1)+W.slice(1);return}if(typeof W=="string"&&W[0]==='"'&&!(Q instanceof V4))return`"${Q}${W.slice(1)}`;return}function KU(Q,W){return W.emptyStr()?Q:Q.emptyStr()?W:O3`${Q}${W}`}Q0.strConcat=KU;function FU(Q){return typeof Q=="number"||typeof Q=="boolean"||Q===null?Q:H9(Array.isArray(Q)?Q.join(","):Q)}function VU(Q){return new D1(H9(Q))}Q0.stringify=VU;function H9(Q){return JSON.stringify(Q).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Q0.safeStringify=H9;function LU(Q){return typeof Q=="string"&&Q0.IDENTIFIER.test(Q)?new D1(`.${Q}`):D3`[${Q}]`}Q0.getProperty=LU;function qU(Q){if(typeof Q=="string"&&Q0.IDENTIFIER.test(Q))return new D1(`${Q}`);throw Error(`CodeGen: invalid export name: ${Q}, use explicit $id name mapping`)}Q0.getEsmExportName=qU;function UU(Q){return new D1(Q.toString())}Q0.regexpCode=UU});var NY=Z((n0)=>{Object.defineProperty(n0,"__esModule",{value:!0});n0.ValueScope=n0.ValueScopeName=n0.Scope=n0.varKinds=n0.UsedValueState=void 0;var i0=G9();class w3 extends Error{constructor(Q){super(`CodeGen: "code" for ${Q} not defined`);this.value=Q.value}}var g8;(function(Q){Q[Q.Started=0]="Started",Q[Q.Completed=1]="Completed"})(g8||(n0.UsedValueState=g8={}));n0.varKinds={const:new i0.Name("const"),let:new i0.Name("let"),var:new i0.Name("var")};class OY{constructor({prefixes:Q,parent:W}={}){this._names={},this._prefixes=Q,this._parent=W}toName(Q){return Q instanceof i0.Name?Q:this.name(Q)}name(Q){return new i0.Name(this._newName(Q))}_newName(Q){let W=this._names[Q]||this._nameGroup(Q);return`${Q}${W.index++}`}_nameGroup(Q){var W,$;if((($=(W=this._parent)===null||W===void 0?void 0:W._prefixes)===null||$===void 0?void 0:$.has(Q))||this._prefixes&&!this._prefixes.has(Q))throw Error(`CodeGen: prefix "${Q}" is not allowed in this scope`);return this._names[Q]={prefix:Q,index:0}}}n0.Scope=OY;class wY extends i0.Name{constructor(Q,W){super(W);this.prefix=Q}setValue(Q,{property:W,itemIndex:$}){this.value=Q,this.scopePath=i0._`.${new i0.Name(W)}[${$}]`}}n0.ValueScopeName=wY;var AU=i0._`\n`;class N3 extends OY{constructor(Q){super(Q);this._values={},this._scope=Q.scope,this.opts={...Q,_n:Q.lines?AU:i0.nil}}get(){return this._scope}name(Q){return new wY(Q,this._newName(Q))}value(Q,W){var $;if(W.ref===void 0)throw Error("CodeGen: ref must be passed in value");let Y=this.toName(Q),{prefix:J}=Y,X=($=W.key)!==null&&$!==void 0?$:W.ref,H=this._values[J];if(H){let K=H.get(X);if(K)return K}else H=this._values[J]=new Map;H.set(X,Y);let G=this._scope[J]||(this._scope[J]=[]),B=G.length;return G[B]=W.ref,Y.setValue(W,{property:J,itemIndex:B}),Y}getValue(Q,W){let $=this._values[Q];if(!$)return;return $.get(W)}scopeRefs(Q,W=this._values){return this._reduceValues(W,($)=>{if($.scopePath===void 0)throw Error(`CodeGen: name "${$}" has no value`);return i0._`${Q}${$.scopePath}`})}scopeCode(Q=this._values,W,$){return this._reduceValues(Q,(Y)=>{if(Y.value===void 0)throw Error(`CodeGen: name "${Y}" has no value`);return Y.value.code},W,$)}_reduceValues(Q,W,$={},Y){let J=i0.nil;for(let X in Q){let H=Q[X];if(!H)continue;let G=$[X]=$[X]||new Map;H.forEach((B)=>{if(G.has(B))return;G.set(B,g8.Started);let K=W(B);if(K){let V=this.opts.es5?n0.varKinds.var:n0.varKinds.const;J=i0._`${J}${V} ${B} = ${K};${this.opts._n}`}else if(K=Y===null||Y===void 0?void 0:Y(B))J=i0._`${J}${K}${this.opts._n}`;else throw new w3(B);G.set(B,g8.Completed)})}return J}}n0.ValueScope=N3});var p=Z((i)=>{Object.defineProperty(i,"__esModule",{value:!0});i.or=i.and=i.not=i.CodeGen=i.operators=i.varKinds=i.ValueScopeName=i.ValueScope=i.Scope=i.Name=i.regexpCode=i.stringify=i.getProperty=i.nil=i.strConcat=i.str=i._=void 0;var s=G9(),O1=NY(),J6=G9();Object.defineProperty(i,"_",{enumerable:!0,get:function(){return J6._}});Object.defineProperty(i,"str",{enumerable:!0,get:function(){return J6.str}});Object.defineProperty(i,"strConcat",{enumerable:!0,get:function(){return J6.strConcat}});Object.defineProperty(i,"nil",{enumerable:!0,get:function(){return J6.nil}});Object.defineProperty(i,"getProperty",{enumerable:!0,get:function(){return J6.getProperty}});Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return J6.stringify}});Object.defineProperty(i,"regexpCode",{enumerable:!0,get:function(){return J6.regexpCode}});Object.defineProperty(i,"Name",{enumerable:!0,get:function(){return J6.Name}});var c8=NY();Object.defineProperty(i,"Scope",{enumerable:!0,get:function(){return c8.Scope}});Object.defineProperty(i,"ValueScope",{enumerable:!0,get:function(){return c8.ValueScope}});Object.defineProperty(i,"ValueScopeName",{enumerable:!0,get:function(){return c8.ValueScopeName}});Object.defineProperty(i,"varKinds",{enumerable:!0,get:function(){return c8.varKinds}});i.operators={GT:new s._Code(">"),GTE:new s._Code(">="),LT:new s._Code("<"),LTE:new s._Code("<="),EQ:new s._Code("==="),NEQ:new s._Code("!=="),NOT:new s._Code("!"),OR:new s._Code("||"),AND:new s._Code("&&"),ADD:new s._Code("+")};class X6{optimizeNodes(){return this}optimizeNames(Q,W){return this}}class M3 extends X6{constructor(Q,W,$){super();this.varKind=Q,this.name=W,this.rhs=$}render({es5:Q,_n:W}){let $=Q?O1.varKinds.var:this.varKind,Y=this.rhs===void 0?"":` = ${this.rhs}`;return`${$} ${this.name}${Y};`+W}optimizeNames(Q,W){if(!Q[this.name.str])return;if(this.rhs)this.rhs=q4(this.rhs,Q,W);return this}get names(){return this.rhs instanceof s._CodeOrName?this.rhs.names:{}}}class zY extends X6{constructor(Q,W,$){super();this.lhs=Q,this.rhs=W,this.sideEffects=$}render({_n:Q}){return`${this.lhs} = ${this.rhs};`+Q}optimizeNames(Q,W){if(this.lhs instanceof s.Name&&!Q[this.lhs.str]&&!this.sideEffects)return;return this.rhs=q4(this.rhs,Q,W),this}get names(){let Q=this.lhs instanceof s.Name?{}:{...this.lhs.names};return m8(Q,this.rhs)}}class j3 extends zY{constructor(Q,W,$,Y){super(Q,$,Y);this.op=W}render({_n:Q}){return`${this.lhs} ${this.op}= ${this.rhs};`+Q}}class z3 extends X6{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`${this.label}:`+Q}}class E3 extends X6{constructor(Q){super();this.label=Q,this.names={}}render({_n:Q}){return`break${this.label?` ${this.label}`:""};`+Q}}class P3 extends X6{constructor(Q){super();this.error=Q}render({_n:Q}){return`throw ${this.error};`+Q}get names(){return this.error.names}}class R3 extends X6{constructor(Q){super();this.code=Q}render({_n:Q}){return`${this.code};`+Q}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Q,W){return this.code=q4(this.code,Q,W),this}get names(){return this.code instanceof s._CodeOrName?this.code.names:{}}}class p8 extends X6{constructor(Q=[]){super();this.nodes=Q}render(Q){return this.nodes.reduce((W,$)=>W+$.render(Q),"")}optimizeNodes(){let{nodes:Q}=this,W=Q.length;while(W--){let $=Q[W].optimizeNodes();if(Array.isArray($))Q.splice(W,1,...$);else if($)Q[W]=$;else Q.splice(W,1)}return Q.length>0?this:void 0}optimizeNames(Q,W){let{nodes:$}=this,Y=$.length;while(Y--){let J=$[Y];if(J.optimizeNames(Q,W))continue;DU(Q,J.names),$.splice(Y,1)}return $.length>0?this:void 0}get names(){return this.nodes.reduce((Q,W)=>S6(Q,W.names),{})}}class H6 extends p8{render(Q){return"{"+Q._n+super.render(Q)+"}"+Q._n}}class b3 extends p8{}class B9 extends H6{}B9.kind="else";class h1 extends H6{constructor(Q,W){super(W);this.condition=Q}render(Q){let W=`if(${this.condition})`+super.render(Q);if(this.else)W+="else "+this.else.render(Q);return W}optimizeNodes(){super.optimizeNodes();let Q=this.condition;if(Q===!0)return this.nodes;let W=this.else;if(W){let $=W.optimizeNodes();W=this.else=Array.isArray($)?new B9($):$}if(W){if(Q===!1)return W instanceof h1?W:W.nodes;if(this.nodes.length)return this;return new h1(v3(Q),W instanceof h1?[W]:W.nodes)}if(Q===!1||!this.nodes.length)return;return this}optimizeNames(Q,W){var $;if(this.else=($=this.else)===null||$===void 0?void 0:$.optimizeNames(Q,W),!(super.optimizeNames(Q,W)||this.else))return;return this.condition=q4(this.condition,Q,W),this}get names(){let Q=super.names;if(m8(Q,this.condition),this.else)S6(Q,this.else.names);return Q}}h1.kind="if";class L4 extends H6{}L4.kind="for";class S3 extends L4{constructor(Q){super();this.iteration=Q}render(Q){return`for(${this.iteration})`+super.render(Q)}optimizeNames(Q,W){if(!super.optimizeNames(Q,W))return;return this.iteration=q4(this.iteration,Q,W),this}get names(){return S6(super.names,this.iteration.names)}}class I3 extends L4{constructor(Q,W,$,Y){super();this.varKind=Q,this.name=W,this.from=$,this.to=Y}render(Q){let W=Q.es5?O1.varKinds.var:this.varKind,{name:$,from:Y,to:J}=this;return`for(${W} ${$}=${Y}; ${$}<${J}; ${$}++)`+super.render(Q)}get names(){let Q=m8(super.names,this.from);return m8(Q,this.to)}}class MY extends L4{constructor(Q,W,$,Y){super();this.loop=Q,this.varKind=W,this.name=$,this.iterable=Y}render(Q){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Q)}optimizeNames(Q,W){if(!super.optimizeNames(Q,W))return;return this.iterable=q4(this.iterable,Q,W),this}get names(){return S6(super.names,this.iterable.names)}}class h8 extends H6{constructor(Q,W,$){super();this.name=Q,this.args=W,this.async=$}render(Q){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Q)}}h8.kind="func";class f8 extends p8{render(Q){return"return "+super.render(Q)}}f8.kind="return";class C3 extends H6{render(Q){let W="try"+super.render(Q);if(this.catch)W+=this.catch.render(Q);if(this.finally)W+=this.finally.render(Q);return W}optimizeNodes(){var Q,W;return super.optimizeNodes(),(Q=this.catch)===null||Q===void 0||Q.optimizeNodes(),(W=this.finally)===null||W===void 0||W.optimizeNodes(),this}optimizeNames(Q,W){var $,Y;return super.optimizeNames(Q,W),($=this.catch)===null||$===void 0||$.optimizeNames(Q,W),(Y=this.finally)===null||Y===void 0||Y.optimizeNames(Q,W),this}get names(){let Q=super.names;if(this.catch)S6(Q,this.catch.names);if(this.finally)S6(Q,this.finally.names);return Q}}class u8 extends H6{constructor(Q){super();this.error=Q}render(Q){return`catch(${this.error})`+super.render(Q)}}u8.kind="catch";class l8 extends H6{render(Q){return"finally"+super.render(Q)}}l8.kind="finally";class Z3{constructor(Q,W={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...W,_n:W.lines?`
`:""},this._extScope=Q,this._scope=new O1.Scope({parent:Q}),this._nodes=[new b3]}toString(){return this._root.render(this.opts)}name(Q){return this._scope.name(Q)}scopeName(Q){return this._extScope.name(Q)}scopeValue(Q,W){let $=this._extScope.value(Q,W);return(this._values[$.prefix]||(this._values[$.prefix]=new Set)).add($),$}getScopeValue(Q,W){return this._extScope.getValue(Q,W)}scopeRefs(Q){return this._extScope.scopeRefs(Q,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Q,W,$,Y){let J=this._scope.toName(W);if($!==void 0&&Y)this._constants[J.str]=$;return this._leafNode(new M3(Q,J,$)),J}const(Q,W,$){return this._def(O1.varKinds.const,Q,W,$)}let(Q,W,$){return this._def(O1.varKinds.let,Q,W,$)}var(Q,W,$){return this._def(O1.varKinds.var,Q,W,$)}assign(Q,W,$){return this._leafNode(new zY(Q,W,$))}add(Q,W){return this._leafNode(new j3(Q,i.operators.ADD,W))}code(Q){if(typeof Q=="function")Q();else if(Q!==s.nil)this._leafNode(new R3(Q));return this}object(...Q){let W=["{"];for(let[$,Y]of Q){if(W.length>1)W.push(",");if(W.push($),$!==Y||this.opts.es5)W.push(":"),(0,s.addCodeArg)(W,Y)}return W.push("}"),new s._Code(W)}if(Q,W,$){if(this._blockNode(new h1(Q)),W&&$)this.code(W).else().code($).endIf();else if(W)this.code(W).endIf();else if($)throw Error('CodeGen: "else" body without "then" body');return this}elseIf(Q){return this._elseNode(new h1(Q))}else(){return this._elseNode(new B9)}endIf(){return this._endBlockNode(h1,B9)}_for(Q,W){if(this._blockNode(Q),W)this.code(W).endFor();return this}for(Q,W){return this._for(new S3(Q),W)}forRange(Q,W,$,Y,J=this.opts.es5?O1.varKinds.var:O1.varKinds.let){let X=this._scope.toName(Q);return this._for(new I3(J,X,W,$),()=>Y(X))}forOf(Q,W,$,Y=O1.varKinds.const){let J=this._scope.toName(Q);if(this.opts.es5){let X=W instanceof s.Name?W:this.var("_arr",W);return this.forRange("_i",0,s._`${X}.length`,(H)=>{this.var(J,s._`${X}[${H}]`),$(J)})}return this._for(new MY("of",Y,J,W),()=>$(J))}forIn(Q,W,$,Y=this.opts.es5?O1.varKinds.var:O1.varKinds.const){if(this.opts.ownProperties)return this.forOf(Q,s._`Object.keys(${W})`,$);let J=this._scope.toName(Q);return this._for(new MY("in",Y,J,W),()=>$(J))}endFor(){return this._endBlockNode(L4)}label(Q){return this._leafNode(new z3(Q))}break(Q){return this._leafNode(new E3(Q))}return(Q){let W=new f8;if(this._blockNode(W),this.code(Q),W.nodes.length!==1)throw Error('CodeGen: "return" should have one node');return this._endBlockNode(f8)}try(Q,W,$){if(!W&&!$)throw Error('CodeGen: "try" without "catch" and "finally"');let Y=new C3;if(this._blockNode(Y),this.code(Q),W){let J=this.name("e");this._currNode=Y.catch=new u8(J),W(J)}if($)this._currNode=Y.finally=new l8,this.code($);return this._endBlockNode(u8,l8)}throw(Q){return this._leafNode(new P3(Q))}block(Q,W){if(this._blockStarts.push(this._nodes.length),Q)this.code(Q).endBlock(W);return this}endBlock(Q){let W=this._blockStarts.pop();if(W===void 0)throw Error("CodeGen: not in self-balancing block");let $=this._nodes.length-W;if($<0||Q!==void 0&&$!==Q)throw Error(`CodeGen: wrong number of nodes: ${$} vs ${Q} expected`);return this._nodes.length=W,this}func(Q,W=s.nil,$,Y){if(this._blockNode(new h8(Q,W,$)),Y)this.code(Y).endFunc();return this}endFunc(){return this._endBlockNode(h8)}optimize(Q=1){while(Q-- >0)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Q){return this._currNode.nodes.push(Q),this}_blockNode(Q){this._currNode.nodes.push(Q),this._nodes.push(Q)}_endBlockNode(Q,W){let $=this._currNode;if($ instanceof Q||W&&$ instanceof W)return this._nodes.pop(),this;throw Error(`CodeGen: not in block "${W?`${Q.kind}/${W.kind}`:Q.kind}"`)}_elseNode(Q){let W=this._currNode;if(!(W instanceof h1))throw Error('CodeGen: "else" without "if"');return this._currNode=W.else=Q,this}get _root(){return this._nodes[0]}get _currNode(){let Q=this._nodes;return Q[Q.length-1]}set _currNode(Q){let W=this._nodes;W[W.length-1]=Q}}i.CodeGen=Z3;function S6(Q,W){for(let $ in W)Q[$]=(Q[$]||0)+(W[$]||0);return Q}function m8(Q,W){return W instanceof s._CodeOrName?S6(Q,W.names):Q}function q4(Q,W,$){if(Q instanceof s.Name)return Y(Q);if(!J(Q))return Q;return new s._Code(Q._items.reduce((X,H)=>{if(H instanceof s.Name)H=Y(H);if(H instanceof s._Code)X.push(...H._items);else X.push(H);return X},[]));function Y(X){let H=$[X.str];if(H===void 0||W[X.str]!==1)return X;return delete W[X.str],H}function J(X){return X instanceof s._Code&&X._items.some((H)=>H instanceof s.Name&&W[H.str]===1&&$[H.str]!==void 0)}}function DU(Q,W){for(let $ in W)Q[$]=(Q[$]||0)-(W[$]||0)}function v3(Q){return typeof Q=="boolean"||typeof Q=="number"||Q===null?!Q:s._`!${jY(Q)}`}i.not=v3;var OU=T3(i.operators.AND);function wU(...Q){return Q.reduce(OU)}i.and=wU;var NU=T3(i.operators.OR);function MU(...Q){return Q.reduce(NU)}i.or=MU;function T3(Q){return(W,$)=>W===s.nil?$:$===s.nil?W:s._`${jY(W)} ${Q} ${jY($)}`}function jY(Q){return Q instanceof s.Name?Q:s._`(${Q})`}});var W0=Z((n)=>{Object.defineProperty(n,"__esModule",{value:!0});n.checkStrictMode=n.getErrorPath=n.Type=n.useFunc=n.setEvaluated=n.evaluatedPropsToName=n.mergeEvaluated=n.eachItem=n.unescapeJsonPointer=n.escapeJsonPointer=n.escapeFragment=n.unescapeFragment=n.schemaRefOrVal=n.schemaHasRulesButRef=n.schemaHasRules=n.checkUnknownRules=n.alwaysValidSchema=n.toHash=void 0;var X0=p(),jU=G9();function zU(Q){let W={};for(let $ of Q)W[$]=!0;return W}n.toHash=zU;function EU(Q,W){if(typeof W=="boolean")return W;if(Object.keys(W).length===0)return!0;return x3(Q,W),!y3(W,Q.self.RULES.all)}n.alwaysValidSchema=EU;function x3(Q,W=Q.schema){let{opts:$,self:Y}=Q;if(!$.strictSchema)return;if(typeof W==="boolean")return;let J=Y.RULES.keywords;for(let X in W)if(!J[X])f3(Q,`unknown keyword: "${X}"`)}n.checkUnknownRules=x3;function y3(Q,W){if(typeof Q=="boolean")return!Q;for(let $ in Q)if(W[$])return!0;return!1}n.schemaHasRules=y3;function PU(Q,W){if(typeof Q=="boolean")return!Q;for(let $ in Q)if($!=="$ref"&&W.all[$])return!0;return!1}n.schemaHasRulesButRef=PU;function RU({topSchemaRef:Q,schemaPath:W},$,Y,J){if(!J){if(typeof $=="number"||typeof $=="boolean")return $;if(typeof $=="string")return X0._`${$}`}return X0._`${Q}${W}${(0,X0.getProperty)(Y)}`}n.schemaRefOrVal=RU;function bU(Q){return g3(decodeURIComponent(Q))}n.unescapeFragment=bU;function SU(Q){return encodeURIComponent(PY(Q))}n.escapeFragment=SU;function PY(Q){if(typeof Q=="number")return`${Q}`;return Q.replace(/~/g,"~0").replace(/\//g,"~1")}n.escapeJsonPointer=PY;function g3(Q){return Q.replace(/~1/g,"/").replace(/~0/g,"~")}n.unescapeJsonPointer=g3;function IU(Q,W){if(Array.isArray(Q))for(let $ of Q)W($);else W(Q)}n.eachItem=IU;function k3({mergeNames:Q,mergeToName:W,mergeValues:$,resultToName:Y}){return(J,X,H,G)=>{let B=H===void 0?X:H instanceof X0.Name?(X instanceof X0.Name?Q(J,X,H):W(J,X,H),H):X instanceof X0.Name?(W(J,H,X),X):$(X,H);return G===X0.Name&&!(B instanceof X0.Name)?Y(J,B):B}}n.mergeEvaluated={props:k3({mergeNames:(Q,W,$)=>Q.if(X0._`${$} !== true && ${W} !== undefined`,()=>{Q.if(X0._`${W} === true`,()=>Q.assign($,!0),()=>Q.assign($,X0._`${$} || {}`).code(X0._`Object.assign(${$}, ${W})`))}),mergeToName:(Q,W,$)=>Q.if(X0._`${$} !== true`,()=>{if(W===!0)Q.assign($,!0);else Q.assign($,X0._`${$} || {}`),RY(Q,$,W)}),mergeValues:(Q,W)=>Q===!0?!0:{...Q,...W},resultToName:h3}),items:k3({mergeNames:(Q,W,$)=>Q.if(X0._`${$} !== true && ${W} !== undefined`,()=>Q.assign($,X0._`${W} === true ? true : ${$} > ${W} ? ${$} : ${W}`)),mergeToName:(Q,W,$)=>Q.if(X0._`${$} !== true`,()=>Q.assign($,W===!0?!0:X0._`${$} > ${W} ? ${$} : ${W}`)),mergeValues:(Q,W)=>Q===!0?!0:Math.max(Q,W),resultToName:(Q,W)=>Q.var("items",W)})};function h3(Q,W){if(W===!0)return Q.var("props",!0);let $=Q.var("props",X0._`{}`);if(W!==void 0)RY(Q,$,W);return $}n.evaluatedPropsToName=h3;function RY(Q,W,$){Object.keys($).forEach((Y)=>Q.assign(X0._`${W}${(0,X0.getProperty)(Y)}`,!0))}n.setEvaluated=RY;var _3={};function CU(Q,W){return Q.scopeValue("func",{ref:W,code:_3[W.code]||(_3[W.code]=new jU._Code(W.code))})}n.useFunc=CU;var EY;(function(Q){Q[Q.Num=0]="Num",Q[Q.Str=1]="Str"})(EY||(n.Type=EY={}));function ZU(Q,W,$){if(Q instanceof X0.Name){let Y=W===EY.Num;return $?Y?X0._`"[" + ${Q} + "]"`:X0._`"['" + ${Q} + "']"`:Y?X0._`"/" + ${Q}`:X0._`"/" + ${Q}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return $?(0,X0.getProperty)(Q).toString():"/"+PY(Q)}n.getErrorPath=ZU;function f3(Q,W,$=Q.opts.strictSchema){if(!$)return;if(W=`strict mode: ${W}`,$===!0)throw Error(W);Q.self.logger.warn(W)}n.checkStrictMode=f3});var f1=Z((bY)=>{Object.defineProperty(bY,"__esModule",{value:!0});var x0=p(),vU={data:new x0.Name("data"),valCxt:new x0.Name("valCxt"),instancePath:new x0.Name("instancePath"),parentData:new x0.Name("parentData"),parentDataProperty:new x0.Name("parentDataProperty"),rootData:new x0.Name("rootData"),dynamicAnchors:new x0.Name("dynamicAnchors"),vErrors:new x0.Name("vErrors"),errors:new x0.Name("errors"),this:new x0.Name("this"),self:new x0.Name("self"),scope:new x0.Name("scope"),json:new x0.Name("json"),jsonPos:new x0.Name("jsonPos"),jsonLen:new x0.Name("jsonLen"),jsonPart:new x0.Name("jsonPart")};bY.default=vU});var K9=Z((y0)=>{Object.defineProperty(y0,"__esModule",{value:!0});y0.extendErrors=y0.resetErrorsCount=y0.reportExtraError=y0.reportError=y0.keyword$DataError=y0.keywordError=void 0;var e=p(),d8=W0(),m0=f1();y0.keywordError={message:({keyword:Q})=>e.str`must pass "${Q}" keyword validation`};y0.keyword$DataError={message:({keyword:Q,schemaType:W})=>W?e.str`"${Q}" keyword must be ${W} ($data)`:e.str`"${Q}" keyword is invalid ($data)`};function TU(Q,W=y0.keywordError,$,Y){let{it:J}=Q,{gen:X,compositeRule:H,allErrors:G}=J,B=m3(Q,W,$);if(Y!==null&&Y!==void 0?Y:H||G)u3(X,B);else l3(J,e._`[${B}]`)}y0.reportError=TU;function kU(Q,W=y0.keywordError,$){let{it:Y}=Q,{gen:J,compositeRule:X,allErrors:H}=Y,G=m3(Q,W,$);if(u3(J,G),!(X||H))l3(Y,m0.default.vErrors)}y0.reportExtraError=kU;function _U(Q,W){Q.assign(m0.default.errors,W),Q.if(e._`${m0.default.vErrors} !== null`,()=>Q.if(W,()=>Q.assign(e._`${m0.default.vErrors}.length`,W),()=>Q.assign(m0.default.vErrors,null)))}y0.resetErrorsCount=_U;function xU({gen:Q,keyword:W,schemaValue:$,data:Y,errsCount:J,it:X}){if(J===void 0)throw Error("ajv implementation error");let H=Q.name("err");Q.forRange("i",J,m0.default.errors,(G)=>{if(Q.const(H,e._`${m0.default.vErrors}[${G}]`),Q.if(e._`${H}.instancePath === undefined`,()=>Q.assign(e._`${H}.instancePath`,(0,e.strConcat)(m0.default.instancePath,X.errorPath))),Q.assign(e._`${H}.schemaPath`,e.str`${X.errSchemaPath}/${W}`),X.opts.verbose)Q.assign(e._`${H}.schema`,$),Q.assign(e._`${H}.data`,Y)})}y0.extendErrors=xU;function u3(Q,W){let $=Q.const("err",W);Q.if(e._`${m0.default.vErrors} === null`,()=>Q.assign(m0.default.vErrors,e._`[${$}]`),e._`${m0.default.vErrors}.push(${$})`),Q.code(e._`${m0.default.errors}++`)}function l3(Q,W){let{gen:$,validateName:Y,schemaEnv:J}=Q;if(J.$async)$.throw(e._`new ${Q.ValidationError}(${W})`);else $.assign(e._`${Y}.errors`,W),$.return(!1)}var I6={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function m3(Q,W,$){let{createErrors:Y}=Q.it;if(Y===!1)return e._`{}`;return yU(Q,W,$)}function yU(Q,W,$={}){let{gen:Y,it:J}=Q,X=[gU(J,$),hU(Q,$)];return fU(Q,W,X),Y.object(...X)}function gU({errorPath:Q},{instancePath:W}){let $=W?e.str`${Q}${(0,d8.getErrorPath)(W,d8.Type.Str)}`:Q;return[m0.default.instancePath,(0,e.strConcat)(m0.default.instancePath,$)]}function hU({keyword:Q,it:{errSchemaPath:W}},{schemaPath:$,parentSchema:Y}){let J=Y?W:e.str`${W}/${Q}`;if($)J=e.str`${J}${(0,d8.getErrorPath)($,d8.Type.Str)}`;return[I6.schemaPath,J]}function fU(Q,{params:W,message:$},Y){let{keyword:J,data:X,schemaValue:H,it:G}=Q,{opts:B,propertyName:K,topSchemaRef:V,schemaPath:L}=G;if(Y.push([I6.keyword,J],[I6.params,typeof W=="function"?W(Q):W||e._`{}`]),B.messages)Y.push([I6.message,typeof $=="function"?$(Q):$]);if(B.verbose)Y.push([I6.schema,H],[I6.parentSchema,e._`${V}${L}`],[m0.default.data,X]);if(K)Y.push([I6.propertyName,K])}});var p3=Z((U4)=>{Object.defineProperty(U4,"__esModule",{value:!0});U4.boolOrEmptySchema=U4.topBoolOrEmptySchema=void 0;var uU=K9(),lU=p(),mU=f1(),cU={message:"boolean schema is false"};function pU(Q){let{gen:W,schema:$,validateName:Y}=Q;if($===!1)c3(Q,!1);else if(typeof $=="object"&&$.$async===!0)W.return(mU.default.data);else W.assign(lU._`${Y}.errors`,null),W.return(!0)}U4.topBoolOrEmptySchema=pU;function dU(Q,W){let{gen:$,schema:Y}=Q;if(Y===!1)$.var(W,!1),c3(Q);else $.var(W,!0)}U4.boolOrEmptySchema=dU;function c3(Q,W){let{gen:$,data:Y}=Q,J={gen:$,keyword:"false schema",data:Y,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:Q};(0,uU.reportError)(J,cU,void 0,W)}});var SY=Z((A4)=>{Object.defineProperty(A4,"__esModule",{value:!0});A4.getRules=A4.isJSONType=void 0;var iU=["string","number","integer","boolean","null","object","array"],nU=new Set(iU);function oU(Q){return typeof Q=="string"&&nU.has(Q)}A4.isJSONType=oU;function rU(){let Q={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...Q,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},Q.number,Q.string,Q.array,Q.object],post:{rules:[]},all:{},keywords:{}}}A4.getRules=rU});var IY=Z((G6)=>{Object.defineProperty(G6,"__esModule",{value:!0});G6.shouldUseRule=G6.shouldUseGroup=G6.schemaHasRulesForType=void 0;function aU({schema:Q,self:W},$){let Y=W.RULES.types[$];return Y&&Y!==!0&&d3(Q,Y)}G6.schemaHasRulesForType=aU;function d3(Q,W){return W.rules.some(($)=>i3(Q,$))}G6.shouldUseGroup=d3;function i3(Q,W){var $;return Q[W.keyword]!==void 0||(($=W.definition.implements)===null||$===void 0?void 0:$.some((Y)=>Q[Y]!==void 0))}G6.shouldUseRule=i3});var F9=Z((g0)=>{Object.defineProperty(g0,"__esModule",{value:!0});g0.reportTypeError=g0.checkDataTypes=g0.checkDataType=g0.coerceAndCheckDataType=g0.getJSONTypes=g0.getSchemaTypes=g0.DataType=void 0;var tU=SY(),sU=IY(),eU=K9(),c=p(),n3=W0(),D4;(function(Q){Q[Q.Correct=0]="Correct",Q[Q.Wrong=1]="Wrong"})(D4||(g0.DataType=D4={}));function QA(Q){let W=o3(Q.type);if(W.includes("null")){if(Q.nullable===!1)throw Error("type: null contradicts nullable: false")}else{if(!W.length&&Q.nullable!==void 0)throw Error('"nullable" cannot be used without "type"');if(Q.nullable===!0)W.push("null")}return W}g0.getSchemaTypes=QA;function o3(Q){let W=Array.isArray(Q)?Q:Q?[Q]:[];if(W.every(tU.isJSONType))return W;throw Error("type must be JSONType or JSONType[]: "+W.join(","))}g0.getJSONTypes=o3;function WA(Q,W){let{gen:$,data:Y,opts:J}=Q,X=$A(W,J.coerceTypes),H=W.length>0&&!(X.length===0&&W.length===1&&(0,sU.schemaHasRulesForType)(Q,W[0]));if(H){let G=ZY(W,Y,J.strictNumbers,D4.Wrong);$.if(G,()=>{if(X.length)YA(Q,W,X);else vY(Q)})}return H}g0.coerceAndCheckDataType=WA;var r3=new Set(["string","number","integer","boolean","null"]);function $A(Q,W){return W?Q.filter(($)=>r3.has($)||W==="array"&&$==="array"):[]}function YA(Q,W,$){let{gen:Y,data:J,opts:X}=Q,H=Y.let("dataType",c._`typeof ${J}`),G=Y.let("coerced",c._`undefined`);if(X.coerceTypes==="array")Y.if(c._`${H} == 'object' && Array.isArray(${J}) && ${J}.length == 1`,()=>Y.assign(J,c._`${J}[0]`).assign(H,c._`typeof ${J}`).if(ZY(W,J,X.strictNumbers),()=>Y.assign(G,J)));Y.if(c._`${G} !== undefined`);for(let K of $)if(r3.has(K)||K==="array"&&X.coerceTypes==="array")B(K);Y.else(),vY(Q),Y.endIf(),Y.if(c._`${G} !== undefined`,()=>{Y.assign(J,G),JA(Q,G)});function B(K){switch(K){case"string":Y.elseIf(c._`${H} == "number" || ${H} == "boolean"`).assign(G,c._`"" + ${J}`).elseIf(c._`${J} === null`).assign(G,c._`""`);return;case"number":Y.elseIf(c._`${H} == "boolean" || ${J} === null
              || (${H} == "string" && ${J} && ${J} == +${J})`).assign(G,c._`+${J}`);return;case"integer":Y.elseIf(c._`${H} === "boolean" || ${J} === null
              || (${H} === "string" && ${J} && ${J} == +${J} && !(${J} % 1))`).assign(G,c._`+${J}`);return;case"boolean":Y.elseIf(c._`${J} === "false" || ${J} === 0 || ${J} === null`).assign(G,!1).elseIf(c._`${J} === "true" || ${J} === 1`).assign(G,!0);return;case"null":Y.elseIf(c._`${J} === "" || ${J} === 0 || ${J} === false`),Y.assign(G,null);return;case"array":Y.elseIf(c._`${H} === "string" || ${H} === "number"
              || ${H} === "boolean" || ${J} === null`).assign(G,c._`[${J}]`)}}}function JA({gen:Q,parentData:W,parentDataProperty:$},Y){Q.if(c._`${W} !== undefined`,()=>Q.assign(c._`${W}[${$}]`,Y))}function CY(Q,W,$,Y=D4.Correct){let J=Y===D4.Correct?c.operators.EQ:c.operators.NEQ,X;switch(Q){case"null":return c._`${W} ${J} null`;case"array":X=c._`Array.isArray(${W})`;break;case"object":X=c._`${W} && typeof ${W} == "object" && !Array.isArray(${W})`;break;case"integer":X=H(c._`!(${W} % 1) && !isNaN(${W})`);break;case"number":X=H();break;default:return c._`typeof ${W} ${J} ${Q}`}return Y===D4.Correct?X:(0,c.not)(X);function H(G=c.nil){return(0,c.and)(c._`typeof ${W} == "number"`,G,$?c._`isFinite(${W})`:c.nil)}}g0.checkDataType=CY;function ZY(Q,W,$,Y){if(Q.length===1)return CY(Q[0],W,$,Y);let J,X=(0,n3.toHash)(Q);if(X.array&&X.object){let H=c._`typeof ${W} != "object"`;J=X.null?H:c._`!${W} || ${H}`,delete X.null,delete X.array,delete X.object}else J=c.nil;if(X.number)delete X.integer;for(let H in X)J=(0,c.and)(J,CY(H,W,$,Y));return J}g0.checkDataTypes=ZY;var XA={message:({schema:Q})=>`must be ${Q}`,params:({schema:Q,schemaValue:W})=>typeof Q=="string"?c._`{type: ${Q}}`:c._`{type: ${W}}`};function vY(Q){let W=HA(Q);(0,eU.reportError)(W,XA)}g0.reportTypeError=vY;function HA(Q){let{gen:W,data:$,schema:Y}=Q,J=(0,n3.schemaRefOrVal)(Q,Y,"type");return{gen:W,keyword:"type",data:$,schema:Y.type,schemaCode:J,schemaValue:J,parentSchema:Y,params:{},it:Q}}});var t3=Z((i8)=>{Object.defineProperty(i8,"__esModule",{value:!0});i8.assignDefaults=void 0;var O4=p(),GA=W0();function BA(Q,W){let{properties:$,items:Y}=Q.schema;if(W==="object"&&$)for(let J in $)a3(Q,J,$[J].default);else if(W==="array"&&Array.isArray(Y))Y.forEach((J,X)=>a3(Q,X,J.default))}i8.assignDefaults=BA;function a3(Q,W,$){let{gen:Y,compositeRule:J,data:X,opts:H}=Q;if($===void 0)return;let G=O4._`${X}${(0,O4.getProperty)(W)}`;if(J){(0,GA.checkStrictMode)(Q,`default is ignored for: ${G}`);return}let B=O4._`${G} === undefined`;if(H.useDefaults==="empty")B=O4._`${B} || ${G} === null || ${G} === ""`;Y.if(B,O4._`${G} = ${(0,O4.stringify)($)}`)}});var X1=Z((J0)=>{Object.defineProperty(J0,"__esModule",{value:!0});J0.validateUnion=J0.validateArray=J0.usePattern=J0.callValidateCode=J0.schemaProperties=J0.allSchemaProperties=J0.noPropertyInData=J0.propertyInData=J0.isOwnProperty=J0.hasPropFunc=J0.reportMissingProp=J0.checkMissingProp=J0.checkReportMissingProp=void 0;var F0=p(),TY=W0(),B6=f1(),KA=W0();function FA(Q,W){let{gen:$,data:Y,it:J}=Q;$.if(_Y($,Y,W,J.opts.ownProperties),()=>{Q.setParams({missingProperty:F0._`${W}`},!0),Q.error()})}J0.checkReportMissingProp=FA;function VA({gen:Q,data:W,it:{opts:$}},Y,J){return(0,F0.or)(...Y.map((X)=>(0,F0.and)(_Y(Q,W,X,$.ownProperties),F0._`${J} = ${X}`)))}J0.checkMissingProp=VA;function LA(Q,W){Q.setParams({missingProperty:W},!0),Q.error()}J0.reportMissingProp=LA;function s3(Q){return Q.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:F0._`Object.prototype.hasOwnProperty`})}J0.hasPropFunc=s3;function kY(Q,W,$){return F0._`${s3(Q)}.call(${W}, ${$})`}J0.isOwnProperty=kY;function qA(Q,W,$,Y){let J=F0._`${W}${(0,F0.getProperty)($)} !== undefined`;return Y?F0._`${J} && ${kY(Q,W,$)}`:J}J0.propertyInData=qA;function _Y(Q,W,$,Y){let J=F0._`${W}${(0,F0.getProperty)($)} === undefined`;return Y?(0,F0.or)(J,(0,F0.not)(kY(Q,W,$))):J}J0.noPropertyInData=_Y;function e3(Q){return Q?Object.keys(Q).filter((W)=>W!=="__proto__"):[]}J0.allSchemaProperties=e3;function UA(Q,W){return e3(W).filter(($)=>!(0,TY.alwaysValidSchema)(Q,W[$]))}J0.schemaProperties=UA;function AA({schemaCode:Q,data:W,it:{gen:$,topSchemaRef:Y,schemaPath:J,errorPath:X},it:H},G,B,K){let V=K?F0._`${Q}, ${W}, ${Y}${J}`:W,L=[[B6.default.instancePath,(0,F0.strConcat)(B6.default.instancePath,X)],[B6.default.parentData,H.parentData],[B6.default.parentDataProperty,H.parentDataProperty],[B6.default.rootData,B6.default.rootData]];if(H.opts.dynamicRef)L.push([B6.default.dynamicAnchors,B6.default.dynamicAnchors]);let U=F0._`${V}, ${$.object(...L)}`;return B!==F0.nil?F0._`${G}.call(${B}, ${U})`:F0._`${G}(${U})`}J0.callValidateCode=AA;var DA=F0._`new RegExp`;function OA({gen:Q,it:{opts:W}},$){let Y=W.unicodeRegExp?"u":"",{regExp:J}=W.code,X=J($,Y);return Q.scopeValue("pattern",{key:X.toString(),ref:X,code:F0._`${J.code==="new RegExp"?DA:(0,KA.useFunc)(Q,J)}(${$}, ${Y})`})}J0.usePattern=OA;function wA(Q){let{gen:W,data:$,keyword:Y,it:J}=Q,X=W.name("valid");if(J.allErrors){let G=W.let("valid",!0);return H(()=>W.assign(G,!1)),G}return W.var(X,!0),H(()=>W.break()),X;function H(G){let B=W.const("len",F0._`${$}.length`);W.forRange("i",0,B,(K)=>{Q.subschema({keyword:Y,dataProp:K,dataPropType:TY.Type.Num},X),W.if((0,F0.not)(X),G)})}}J0.validateArray=wA;function NA(Q){let{gen:W,schema:$,keyword:Y,it:J}=Q;if(!Array.isArray($))throw Error("ajv implementation error");if($.some((B)=>(0,TY.alwaysValidSchema)(J,B))&&!J.opts.unevaluated)return;let H=W.let("valid",!1),G=W.name("_valid");W.block(()=>$.forEach((B,K)=>{let V=Q.subschema({keyword:Y,schemaProp:K,compositeRule:!0},G);if(W.assign(H,F0._`${H} || ${G}`),!Q.mergeValidEvaluated(V,G))W.if((0,F0.not)(H))})),Q.result(H,()=>Q.reset(),()=>Q.error(!0))}J0.validateUnion=NA});var $H=Z((S1)=>{Object.defineProperty(S1,"__esModule",{value:!0});S1.validateKeywordUsage=S1.validSchemaType=S1.funcKeywordCode=S1.macroKeywordCode=void 0;var c0=p(),C6=f1(),MA=X1(),jA=K9();function zA(Q,W){let{gen:$,keyword:Y,schema:J,parentSchema:X,it:H}=Q,G=W.macro.call(H.self,J,X,H),B=WH($,Y,G);if(H.opts.validateSchema!==!1)H.self.validateSchema(G,!0);let K=$.name("valid");Q.subschema({schema:G,schemaPath:c0.nil,errSchemaPath:`${H.errSchemaPath}/${Y}`,topSchemaRef:B,compositeRule:!0},K),Q.pass(K,()=>Q.error(!0))}S1.macroKeywordCode=zA;function EA(Q,W){var $;let{gen:Y,keyword:J,schema:X,parentSchema:H,$data:G,it:B}=Q;RA(B,W);let K=!G&&W.compile?W.compile.call(B.self,X,H,B):W.validate,V=WH(Y,J,K),L=Y.let("valid");Q.block$data(L,U),Q.ok(($=W.valid)!==null&&$!==void 0?$:L);function U(){if(W.errors===!1){if(D(),W.modifying)QH(Q);O(()=>Q.error())}else{let w=W.async?q():A();if(W.modifying)QH(Q);O(()=>PA(Q,w))}}function q(){let w=Y.let("ruleErrs",null);return Y.try(()=>D(c0._`await `),(j)=>Y.assign(L,!1).if(c0._`${j} instanceof ${B.ValidationError}`,()=>Y.assign(w,c0._`${j}.errors`),()=>Y.throw(j))),w}function A(){let w=c0._`${V}.errors`;return Y.assign(w,null),D(c0.nil),w}function D(w=W.async?c0._`await `:c0.nil){let j=B.opts.passContext?C6.default.this:C6.default.self,z=!(("compile"in W)&&!G||W.schema===!1);Y.assign(L,c0._`${w}${(0,MA.callValidateCode)(Q,V,j,z)}`,W.modifying)}function O(w){var j;Y.if((0,c0.not)((j=W.valid)!==null&&j!==void 0?j:L),w)}}S1.funcKeywordCode=EA;function QH(Q){let{gen:W,data:$,it:Y}=Q;W.if(Y.parentData,()=>W.assign($,c0._`${Y.parentData}[${Y.parentDataProperty}]`))}function PA(Q,W){let{gen:$}=Q;$.if(c0._`Array.isArray(${W})`,()=>{$.assign(C6.default.vErrors,c0._`${C6.default.vErrors} === null ? ${W} : ${C6.default.vErrors}.concat(${W})`).assign(C6.default.errors,c0._`${C6.default.vErrors}.length`),(0,jA.extendErrors)(Q)},()=>Q.error())}function RA({schemaEnv:Q},W){if(W.async&&!Q.$async)throw Error("async keyword in sync schema")}function WH(Q,W,$){if($===void 0)throw Error(`keyword "${W}" failed to compile`);return Q.scopeValue("keyword",typeof $=="function"?{ref:$}:{ref:$,code:(0,c0.stringify)($)})}function bA(Q,W,$=!1){return!W.length||W.some((Y)=>Y==="array"?Array.isArray(Q):Y==="object"?Q&&typeof Q=="object"&&!Array.isArray(Q):typeof Q==Y||$&&typeof Q>"u")}S1.validSchemaType=bA;function SA({schema:Q,opts:W,self:$,errSchemaPath:Y},J,X){if(Array.isArray(J.keyword)?!J.keyword.includes(X):J.keyword!==X)throw Error("ajv implementation error");let H=J.dependencies;if(H===null||H===void 0?void 0:H.some((G)=>!Object.prototype.hasOwnProperty.call(Q,G)))throw Error(`parent schema must have dependencies of ${X}: ${H.join(",")}`);if(J.validateSchema){if(!J.validateSchema(Q[X])){let B=`keyword "${X}" value is invalid at path "${Y}": `+$.errorsText(J.validateSchema.errors);if(W.validateSchema==="log")$.logger.error(B);else throw Error(B)}}}S1.validateKeywordUsage=SA});var JH=Z((K6)=>{Object.defineProperty(K6,"__esModule",{value:!0});K6.extendSubschemaMode=K6.extendSubschemaData=K6.getSubschema=void 0;var I1=p(),YH=W0();function IA(Q,{keyword:W,schemaProp:$,schema:Y,schemaPath:J,errSchemaPath:X,topSchemaRef:H}){if(W!==void 0&&Y!==void 0)throw Error('both "keyword" and "schema" passed, only one allowed');if(W!==void 0){let G=Q.schema[W];return $===void 0?{schema:G,schemaPath:I1._`${Q.schemaPath}${(0,I1.getProperty)(W)}`,errSchemaPath:`${Q.errSchemaPath}/${W}`}:{schema:G[$],schemaPath:I1._`${Q.schemaPath}${(0,I1.getProperty)(W)}${(0,I1.getProperty)($)}`,errSchemaPath:`${Q.errSchemaPath}/${W}/${(0,YH.escapeFragment)($)}`}}if(Y!==void 0){if(J===void 0||X===void 0||H===void 0)throw Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:Y,schemaPath:J,topSchemaRef:H,errSchemaPath:X}}throw Error('either "keyword" or "schema" must be passed')}K6.getSubschema=IA;function CA(Q,W,{dataProp:$,dataPropType:Y,data:J,dataTypes:X,propertyName:H}){if(J!==void 0&&$!==void 0)throw Error('both "data" and "dataProp" passed, only one allowed');let{gen:G}=W;if($!==void 0){let{errorPath:K,dataPathArr:V,opts:L}=W,U=G.let("data",I1._`${W.data}${(0,I1.getProperty)($)}`,!0);B(U),Q.errorPath=I1.str`${K}${(0,YH.getErrorPath)($,Y,L.jsPropertySyntax)}`,Q.parentDataProperty=I1._`${$}`,Q.dataPathArr=[...V,Q.parentDataProperty]}if(J!==void 0){let K=J instanceof I1.Name?J:G.let("data",J,!0);if(B(K),H!==void 0)Q.propertyName=H}if(X)Q.dataTypes=X;function B(K){Q.data=K,Q.dataLevel=W.dataLevel+1,Q.dataTypes=[],W.definedProperties=new Set,Q.parentData=W.data,Q.dataNames=[...W.dataNames,K]}}K6.extendSubschemaData=CA;function ZA(Q,{jtdDiscriminator:W,jtdMetadata:$,compositeRule:Y,createErrors:J,allErrors:X}){if(Y!==void 0)Q.compositeRule=Y;if(J!==void 0)Q.createErrors=J;if(X!==void 0)Q.allErrors=X;Q.jtdDiscriminator=W,Q.jtdMetadata=$}K6.extendSubschemaMode=ZA});var xY=Z((SR,XH)=>{XH.exports=function Q(W,$){if(W===$)return!0;if(W&&$&&typeof W=="object"&&typeof $=="object"){if(W.constructor!==$.constructor)return!1;var Y,J,X;if(Array.isArray(W)){if(Y=W.length,Y!=$.length)return!1;for(J=Y;J--!==0;)if(!Q(W[J],$[J]))return!1;return!0}if(W.constructor===RegExp)return W.source===$.source&&W.flags===$.flags;if(W.valueOf!==Object.prototype.valueOf)return W.valueOf()===$.valueOf();if(W.toString!==Object.prototype.toString)return W.toString()===$.toString();if(X=Object.keys(W),Y=X.length,Y!==Object.keys($).length)return!1;for(J=Y;J--!==0;)if(!Object.prototype.hasOwnProperty.call($,X[J]))return!1;for(J=Y;J--!==0;){var H=X[J];if(!Q(W[H],$[H]))return!1}return!0}return W!==W&&$!==$}});var GH=Z((IR,HH)=>{var F6=HH.exports=function(Q,W,$){if(typeof W=="function")$=W,W={};$=W.cb||$;var Y=typeof $=="function"?$:$.pre||function(){},J=$.post||function(){};n8(W,Y,J,Q,"",Q)};F6.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};F6.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};F6.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};F6.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function n8(Q,W,$,Y,J,X,H,G,B,K){if(Y&&typeof Y=="object"&&!Array.isArray(Y)){W(Y,J,X,H,G,B,K);for(var V in Y){var L=Y[V];if(Array.isArray(L)){if(V in F6.arrayKeywords)for(var U=0;U<L.length;U++)n8(Q,W,$,L[U],J+"/"+V+"/"+U,X,J,V,Y,U)}else if(V in F6.propsKeywords){if(L&&typeof L=="object")for(var q in L)n8(Q,W,$,L[q],J+"/"+V+"/"+vA(q),X,J,V,Y,q)}else if(V in F6.keywords||Q.allKeys&&!(V in F6.skipKeywords))n8(Q,W,$,L,J+"/"+V,X,J,V,Y)}$(Y,J,X,H,G,B,K)}}function vA(Q){return Q.replace(/~/g,"~0").replace(/\//g,"~1")}});var V9=Z((o0)=>{Object.defineProperty(o0,"__esModule",{value:!0});o0.getSchemaRefs=o0.resolveUrl=o0.normalizeId=o0._getFullPath=o0.getFullPath=o0.inlineRef=void 0;var TA=W0(),kA=xY(),_A=GH(),xA=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function yA(Q,W=!0){if(typeof Q=="boolean")return!0;if(W===!0)return!yY(Q);if(!W)return!1;return BH(Q)<=W}o0.inlineRef=yA;var gA=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function yY(Q){for(let W in Q){if(gA.has(W))return!0;let $=Q[W];if(Array.isArray($)&&$.some(yY))return!0;if(typeof $=="object"&&yY($))return!0}return!1}function BH(Q){let W=0;for(let $ in Q){if($==="$ref")return 1/0;if(W++,xA.has($))continue;if(typeof Q[$]=="object")(0,TA.eachItem)(Q[$],(Y)=>W+=BH(Y));if(W===1/0)return 1/0}return W}function KH(Q,W="",$){if($!==!1)W=w4(W);let Y=Q.parse(W);return FH(Q,Y)}o0.getFullPath=KH;function FH(Q,W){return Q.serialize(W).split("#")[0]+"#"}o0._getFullPath=FH;var hA=/#\/?$/;function w4(Q){return Q?Q.replace(hA,""):""}o0.normalizeId=w4;function fA(Q,W,$){return $=w4($),Q.resolve(W,$)}o0.resolveUrl=fA;var uA=/^[a-z_][-a-z0-9._]*$/i;function lA(Q,W){if(typeof Q=="boolean")return{};let{schemaId:$,uriResolver:Y}=this.opts,J=w4(Q[$]||W),X={"":J},H=KH(Y,J,!1),G={},B=new Set;return _A(Q,{allKeys:!0},(L,U,q,A)=>{if(A===void 0)return;let D=H+U,O=X[A];if(typeof L[$]=="string")O=w.call(this,L[$]);j.call(this,L.$anchor),j.call(this,L.$dynamicAnchor),X[U]=O;function w(z){let C=this.opts.uriResolver.resolve;if(z=w4(O?C(O,z):z),B.has(z))throw V(z);B.add(z);let S=this.refs[z];if(typeof S=="string")S=this.refs[S];if(typeof S=="object")K(L,S.schema,z);else if(z!==w4(D))if(z[0]==="#")K(L,G[z],z),G[z]=L;else this.refs[z]=D;return z}function j(z){if(typeof z=="string"){if(!uA.test(z))throw Error(`invalid anchor "${z}"`);w.call(this,`#${z}`)}}}),G;function K(L,U,q){if(U!==void 0&&!kA(L,U))throw V(q)}function V(L){return Error(`reference "${L}" resolves to more than one schema`)}}o0.getSchemaRefs=lA});var U9=Z((V6)=>{Object.defineProperty(V6,"__esModule",{value:!0});V6.getData=V6.KeywordCxt=V6.validateFunctionCode=void 0;var AH=p3(),VH=F9(),hY=IY(),o8=F9(),mA=t3(),q9=$H(),gY=JH(),x=p(),l=f1(),cA=V9(),u1=W0(),L9=K9();function pA(Q){if(wH(Q)){if(NH(Q),OH(Q)){nA(Q);return}}DH(Q,()=>(0,AH.topBoolOrEmptySchema)(Q))}V6.validateFunctionCode=pA;function DH({gen:Q,validateName:W,schema:$,schemaEnv:Y,opts:J},X){if(J.code.es5)Q.func(W,x._`${l.default.data}, ${l.default.valCxt}`,Y.$async,()=>{Q.code(x._`"use strict"; ${LH($,J)}`),iA(Q,J),Q.code(X)});else Q.func(W,x._`${l.default.data}, ${dA(J)}`,Y.$async,()=>Q.code(LH($,J)).code(X))}function dA(Q){return x._`{${l.default.instancePath}="", ${l.default.parentData}, ${l.default.parentDataProperty}, ${l.default.rootData}=${l.default.data}${Q.dynamicRef?x._`, ${l.default.dynamicAnchors}={}`:x.nil}}={}`}function iA(Q,W){Q.if(l.default.valCxt,()=>{if(Q.var(l.default.instancePath,x._`${l.default.valCxt}.${l.default.instancePath}`),Q.var(l.default.parentData,x._`${l.default.valCxt}.${l.default.parentData}`),Q.var(l.default.parentDataProperty,x._`${l.default.valCxt}.${l.default.parentDataProperty}`),Q.var(l.default.rootData,x._`${l.default.valCxt}.${l.default.rootData}`),W.dynamicRef)Q.var(l.default.dynamicAnchors,x._`${l.default.valCxt}.${l.default.dynamicAnchors}`)},()=>{if(Q.var(l.default.instancePath,x._`""`),Q.var(l.default.parentData,x._`undefined`),Q.var(l.default.parentDataProperty,x._`undefined`),Q.var(l.default.rootData,l.default.data),W.dynamicRef)Q.var(l.default.dynamicAnchors,x._`{}`)})}function nA(Q){let{schema:W,opts:$,gen:Y}=Q;DH(Q,()=>{if($.$comment&&W.$comment)jH(Q);if(sA(Q),Y.let(l.default.vErrors,null),Y.let(l.default.errors,0),$.unevaluated)oA(Q);MH(Q),WD(Q)});return}function oA(Q){let{gen:W,validateName:$}=Q;Q.evaluated=W.const("evaluated",x._`${$}.evaluated`),W.if(x._`${Q.evaluated}.dynamicProps`,()=>W.assign(x._`${Q.evaluated}.props`,x._`undefined`)),W.if(x._`${Q.evaluated}.dynamicItems`,()=>W.assign(x._`${Q.evaluated}.items`,x._`undefined`))}function LH(Q,W){let $=typeof Q=="object"&&Q[W.schemaId];return $&&(W.code.source||W.code.process)?x._`/*# sourceURL=${$} */`:x.nil}function rA(Q,W){if(wH(Q)){if(NH(Q),OH(Q)){aA(Q,W);return}}(0,AH.boolOrEmptySchema)(Q,W)}function OH({schema:Q,self:W}){if(typeof Q=="boolean")return!Q;for(let $ in Q)if(W.RULES.all[$])return!0;return!1}function wH(Q){return typeof Q.schema!="boolean"}function aA(Q,W){let{schema:$,gen:Y,opts:J}=Q;if(J.$comment&&$.$comment)jH(Q);eA(Q),QD(Q);let X=Y.const("_errs",l.default.errors);MH(Q,X),Y.var(W,x._`${X} === ${l.default.errors}`)}function NH(Q){(0,u1.checkUnknownRules)(Q),tA(Q)}function MH(Q,W){if(Q.opts.jtd)return qH(Q,[],!1,W);let $=(0,VH.getSchemaTypes)(Q.schema),Y=(0,VH.coerceAndCheckDataType)(Q,$);qH(Q,$,!Y,W)}function tA(Q){let{schema:W,errSchemaPath:$,opts:Y,self:J}=Q;if(W.$ref&&Y.ignoreKeywordsWithRef&&(0,u1.schemaHasRulesButRef)(W,J.RULES))J.logger.warn(`$ref: keywords ignored in schema at path "${$}"`)}function sA(Q){let{schema:W,opts:$}=Q;if(W.default!==void 0&&$.useDefaults&&$.strictSchema)(0,u1.checkStrictMode)(Q,"default is ignored in the schema root")}function eA(Q){let W=Q.schema[Q.opts.schemaId];if(W)Q.baseId=(0,cA.resolveUrl)(Q.opts.uriResolver,Q.baseId,W)}function QD(Q){if(Q.schema.$async&&!Q.schemaEnv.$async)throw Error("async schema in sync schema")}function jH({gen:Q,schemaEnv:W,schema:$,errSchemaPath:Y,opts:J}){let X=$.$comment;if(J.$comment===!0)Q.code(x._`${l.default.self}.logger.log(${X})`);else if(typeof J.$comment=="function"){let H=x.str`${Y}/$comment`,G=Q.scopeValue("root",{ref:W.root});Q.code(x._`${l.default.self}.opts.$comment(${X}, ${H}, ${G}.schema)`)}}function WD(Q){let{gen:W,schemaEnv:$,validateName:Y,ValidationError:J,opts:X}=Q;if($.$async)W.if(x._`${l.default.errors} === 0`,()=>W.return(l.default.data),()=>W.throw(x._`new ${J}(${l.default.vErrors})`));else{if(W.assign(x._`${Y}.errors`,l.default.vErrors),X.unevaluated)$D(Q);W.return(x._`${l.default.errors} === 0`)}}function $D({gen:Q,evaluated:W,props:$,items:Y}){if($ instanceof x.Name)Q.assign(x._`${W}.props`,$);if(Y instanceof x.Name)Q.assign(x._`${W}.items`,Y)}function qH(Q,W,$,Y){let{gen:J,schema:X,data:H,allErrors:G,opts:B,self:K}=Q,{RULES:V}=K;if(X.$ref&&(B.ignoreKeywordsWithRef||!(0,u1.schemaHasRulesButRef)(X,V))){J.block(()=>EH(Q,"$ref",V.all.$ref.definition));return}if(!B.jtd)YD(Q,W);J.block(()=>{for(let U of V.rules)L(U);L(V.post)});function L(U){if(!(0,hY.shouldUseGroup)(X,U))return;if(U.type){if(J.if((0,o8.checkDataType)(U.type,H,B.strictNumbers)),UH(Q,U),W.length===1&&W[0]===U.type&&$)J.else(),(0,o8.reportTypeError)(Q);J.endIf()}else UH(Q,U);if(!G)J.if(x._`${l.default.errors} === ${Y||0}`)}}function UH(Q,W){let{gen:$,schema:Y,opts:{useDefaults:J}}=Q;if(J)(0,mA.assignDefaults)(Q,W.type);$.block(()=>{for(let X of W.rules)if((0,hY.shouldUseRule)(Y,X))EH(Q,X.keyword,X.definition,W.type)})}function YD(Q,W){if(Q.schemaEnv.meta||!Q.opts.strictTypes)return;if(JD(Q,W),!Q.opts.allowUnionTypes)XD(Q,W);HD(Q,Q.dataTypes)}function JD(Q,W){if(!W.length)return;if(!Q.dataTypes.length){Q.dataTypes=W;return}W.forEach(($)=>{if(!zH(Q.dataTypes,$))fY(Q,`type "${$}" not allowed by context "${Q.dataTypes.join(",")}"`)}),BD(Q,W)}function XD(Q,W){if(W.length>1&&!(W.length===2&&W.includes("null")))fY(Q,"use allowUnionTypes to allow union type keyword")}function HD(Q,W){let $=Q.self.RULES.all;for(let Y in $){let J=$[Y];if(typeof J=="object"&&(0,hY.shouldUseRule)(Q.schema,J)){let{type:X}=J.definition;if(X.length&&!X.some((H)=>GD(W,H)))fY(Q,`missing type "${X.join(",")}" for keyword "${Y}"`)}}}function GD(Q,W){return Q.includes(W)||W==="number"&&Q.includes("integer")}function zH(Q,W){return Q.includes(W)||W==="integer"&&Q.includes("number")}function BD(Q,W){let $=[];for(let Y of Q.dataTypes)if(zH(W,Y))$.push(Y);else if(W.includes("integer")&&Y==="number")$.push("integer");Q.dataTypes=$}function fY(Q,W){let $=Q.schemaEnv.baseId+Q.errSchemaPath;W+=` at "${$}" (strictTypes)`,(0,u1.checkStrictMode)(Q,W,Q.opts.strictTypes)}class uY{constructor(Q,W,$){if((0,q9.validateKeywordUsage)(Q,W,$),this.gen=Q.gen,this.allErrors=Q.allErrors,this.keyword=$,this.data=Q.data,this.schema=Q.schema[$],this.$data=W.$data&&Q.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,u1.schemaRefOrVal)(Q,this.schema,$,this.$data),this.schemaType=W.schemaType,this.parentSchema=Q.schema,this.params={},this.it=Q,this.def=W,this.$data)this.schemaCode=Q.gen.const("vSchema",PH(this.$data,Q));else if(this.schemaCode=this.schemaValue,!(0,q9.validSchemaType)(this.schema,W.schemaType,W.allowUndefined))throw Error(`${$} value must be ${JSON.stringify(W.schemaType)}`);if("code"in W?W.trackErrors:W.errors!==!1)this.errsCount=Q.gen.const("_errs",l.default.errors)}result(Q,W,$){this.failResult((0,x.not)(Q),W,$)}failResult(Q,W,$){if(this.gen.if(Q),$)$();else this.error();if(W){if(this.gen.else(),W(),this.allErrors)this.gen.endIf()}else if(this.allErrors)this.gen.endIf();else this.gen.else()}pass(Q,W){this.failResult((0,x.not)(Q),void 0,W)}fail(Q){if(Q===void 0){if(this.error(),!this.allErrors)this.gen.if(!1);return}if(this.gen.if(Q),this.error(),this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(Q){if(!this.$data)return this.fail(Q);let{schemaCode:W}=this;this.fail(x._`${W} !== undefined && (${(0,x.or)(this.invalid$data(),Q)})`)}error(Q,W,$){if(W){this.setParams(W),this._error(Q,$),this.setParams({});return}this._error(Q,$)}_error(Q,W){(Q?L9.reportExtraError:L9.reportError)(this,this.def.error,W)}$dataError(){(0,L9.reportError)(this,this.def.$dataError||L9.keyword$DataError)}reset(){if(this.errsCount===void 0)throw Error('add "trackErrors" to keyword definition');(0,L9.resetErrorsCount)(this.gen,this.errsCount)}ok(Q){if(!this.allErrors)this.gen.if(Q)}setParams(Q,W){if(W)Object.assign(this.params,Q);else this.params=Q}block$data(Q,W,$=x.nil){this.gen.block(()=>{this.check$data(Q,$),W()})}check$data(Q=x.nil,W=x.nil){if(!this.$data)return;let{gen:$,schemaCode:Y,schemaType:J,def:X}=this;if($.if((0,x.or)(x._`${Y} === undefined`,W)),Q!==x.nil)$.assign(Q,!0);if(J.length||X.validateSchema){if($.elseIf(this.invalid$data()),this.$dataError(),Q!==x.nil)$.assign(Q,!1)}$.else()}invalid$data(){let{gen:Q,schemaCode:W,schemaType:$,def:Y,it:J}=this;return(0,x.or)(X(),H());function X(){if($.length){if(!(W instanceof x.Name))throw Error("ajv implementation error");let G=Array.isArray($)?$:[$];return x._`${(0,o8.checkDataTypes)(G,W,J.opts.strictNumbers,o8.DataType.Wrong)}`}return x.nil}function H(){if(Y.validateSchema){let G=Q.scopeValue("validate$data",{ref:Y.validateSchema});return x._`!${G}(${W})`}return x.nil}}subschema(Q,W){let $=(0,gY.getSubschema)(this.it,Q);(0,gY.extendSubschemaData)($,this.it,Q),(0,gY.extendSubschemaMode)($,Q);let Y={...this.it,...$,items:void 0,props:void 0};return rA(Y,W),Y}mergeEvaluated(Q,W){let{it:$,gen:Y}=this;if(!$.opts.unevaluated)return;if($.props!==!0&&Q.props!==void 0)$.props=u1.mergeEvaluated.props(Y,Q.props,$.props,W);if($.items!==!0&&Q.items!==void 0)$.items=u1.mergeEvaluated.items(Y,Q.items,$.items,W)}mergeValidEvaluated(Q,W){let{it:$,gen:Y}=this;if($.opts.unevaluated&&($.props!==!0||$.items!==!0))return Y.if(W,()=>this.mergeEvaluated(Q,x.Name)),!0}}V6.KeywordCxt=uY;function EH(Q,W,$,Y){let J=new uY(Q,$,W);if("code"in $)$.code(J,Y);else if(J.$data&&$.validate)(0,q9.funcKeywordCode)(J,$);else if("macro"in $)(0,q9.macroKeywordCode)(J,$);else if($.compile||$.validate)(0,q9.funcKeywordCode)(J,$)}var KD=/^\/(?:[^~]|~0|~1)*$/,FD=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function PH(Q,{dataLevel:W,dataNames:$,dataPathArr:Y}){let J,X;if(Q==="")return l.default.rootData;if(Q[0]==="/"){if(!KD.test(Q))throw Error(`Invalid JSON-pointer: ${Q}`);J=Q,X=l.default.rootData}else{let K=FD.exec(Q);if(!K)throw Error(`Invalid JSON-pointer: ${Q}`);let V=+K[1];if(J=K[2],J==="#"){if(V>=W)throw Error(B("property/index",V));return Y[W-V]}if(V>W)throw Error(B("data",V));if(X=$[W-V],!J)return X}let H=X,G=J.split("/");for(let K of G)if(K)X=x._`${X}${(0,x.getProperty)((0,u1.unescapeJsonPointer)(K))}`,H=x._`${H} && ${X}`;return H;function B(K,V){return`Cannot access ${K} ${V} levels up, current level is ${W}`}}V6.getData=PH});var r8=Z((lY)=>{Object.defineProperty(lY,"__esModule",{value:!0});class RH extends Error{constructor(Q){super("validation failed");this.errors=Q,this.ajv=this.validation=!0}}lY.default=RH});var A9=Z((cY)=>{Object.defineProperty(cY,"__esModule",{value:!0});var mY=V9();class bH extends Error{constructor(Q,W,$,Y){super(Y||`can't resolve reference ${$} from id ${W}`);this.missingRef=(0,mY.resolveUrl)(Q,W,$),this.missingSchema=(0,mY.normalizeId)((0,mY.getFullPath)(Q,this.missingRef))}}cY.default=bH});var t8=Z((H1)=>{Object.defineProperty(H1,"__esModule",{value:!0});H1.resolveSchema=H1.getCompilingSchema=H1.resolveRef=H1.compileSchema=H1.SchemaEnv=void 0;var w1=p(),VD=r8(),Z6=f1(),N1=V9(),SH=W0(),LD=U9();class D9{constructor(Q){var W;this.refs={},this.dynamicAnchors={};let $;if(typeof Q.schema=="object")$=Q.schema;this.schema=Q.schema,this.schemaId=Q.schemaId,this.root=Q.root||this,this.baseId=(W=Q.baseId)!==null&&W!==void 0?W:(0,N1.normalizeId)($===null||$===void 0?void 0:$[Q.schemaId||"$id"]),this.schemaPath=Q.schemaPath,this.localRefs=Q.localRefs,this.meta=Q.meta,this.$async=$===null||$===void 0?void 0:$.$async,this.refs={}}}H1.SchemaEnv=D9;function dY(Q){let W=IH.call(this,Q);if(W)return W;let $=(0,N1.getFullPath)(this.opts.uriResolver,Q.root.baseId),{es5:Y,lines:J}=this.opts.code,{ownProperties:X}=this.opts,H=new w1.CodeGen(this.scope,{es5:Y,lines:J,ownProperties:X}),G;if(Q.$async)G=H.scopeValue("Error",{ref:VD.default,code:w1._`require("ajv/dist/runtime/validation_error").default`});let B=H.scopeName("validate");Q.validateName=B;let K={gen:H,allErrors:this.opts.allErrors,data:Z6.default.data,parentData:Z6.default.parentData,parentDataProperty:Z6.default.parentDataProperty,dataNames:[Z6.default.data],dataPathArr:[w1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:H.scopeValue("schema",this.opts.code.source===!0?{ref:Q.schema,code:(0,w1.stringify)(Q.schema)}:{ref:Q.schema}),validateName:B,ValidationError:G,schema:Q.schema,schemaEnv:Q,rootId:$,baseId:Q.baseId||$,schemaPath:w1.nil,errSchemaPath:Q.schemaPath||(this.opts.jtd?"":"#"),errorPath:w1._`""`,opts:this.opts,self:this},V;try{this._compilations.add(Q),(0,LD.validateFunctionCode)(K),H.optimize(this.opts.code.optimize);let L=H.toString();if(V=`${H.scopeRefs(Z6.default.scope)}return ${L}`,this.opts.code.process)V=this.opts.code.process(V,Q);let q=Function(`${Z6.default.self}`,`${Z6.default.scope}`,V)(this,this.scope.get());if(this.scope.value(B,{ref:q}),q.errors=null,q.schema=Q.schema,q.schemaEnv=Q,Q.$async)q.$async=!0;if(this.opts.code.source===!0)q.source={validateName:B,validateCode:L,scopeValues:H._values};if(this.opts.unevaluated){let{props:A,items:D}=K;if(q.evaluated={props:A instanceof w1.Name?void 0:A,items:D instanceof w1.Name?void 0:D,dynamicProps:A instanceof w1.Name,dynamicItems:D instanceof w1.Name},q.source)q.source.evaluated=(0,w1.stringify)(q.evaluated)}return Q.validate=q,Q}catch(L){if(delete Q.validate,delete Q.validateName,V)this.logger.error("Error compiling schema, function code:",V);throw L}finally{this._compilations.delete(Q)}}H1.compileSchema=dY;function qD(Q,W,$){var Y;$=(0,N1.resolveUrl)(this.opts.uriResolver,W,$);let J=Q.refs[$];if(J)return J;let X=DD.call(this,Q,$);if(X===void 0){let H=(Y=Q.localRefs)===null||Y===void 0?void 0:Y[$],{schemaId:G}=this.opts;if(H)X=new D9({schema:H,schemaId:G,root:Q,baseId:W})}if(X===void 0)return;return Q.refs[$]=UD.call(this,X)}H1.resolveRef=qD;function UD(Q){if((0,N1.inlineRef)(Q.schema,this.opts.inlineRefs))return Q.schema;return Q.validate?Q:dY.call(this,Q)}function IH(Q){for(let W of this._compilations)if(AD(W,Q))return W}H1.getCompilingSchema=IH;function AD(Q,W){return Q.schema===W.schema&&Q.root===W.root&&Q.baseId===W.baseId}function DD(Q,W){let $;while(typeof($=this.refs[W])=="string")W=$;return $||this.schemas[W]||a8.call(this,Q,W)}function a8(Q,W){let $=this.opts.uriResolver.parse(W),Y=(0,N1._getFullPath)(this.opts.uriResolver,$),J=(0,N1.getFullPath)(this.opts.uriResolver,Q.baseId,void 0);if(Object.keys(Q.schema).length>0&&Y===J)return pY.call(this,$,Q);let X=(0,N1.normalizeId)(Y),H=this.refs[X]||this.schemas[X];if(typeof H=="string"){let G=a8.call(this,Q,H);if(typeof(G===null||G===void 0?void 0:G.schema)!=="object")return;return pY.call(this,$,G)}if(typeof(H===null||H===void 0?void 0:H.schema)!=="object")return;if(!H.validate)dY.call(this,H);if(X===(0,N1.normalizeId)(W)){let{schema:G}=H,{schemaId:B}=this.opts,K=G[B];if(K)J=(0,N1.resolveUrl)(this.opts.uriResolver,J,K);return new D9({schema:G,schemaId:B,root:Q,baseId:J})}return pY.call(this,$,H)}H1.resolveSchema=a8;var OD=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function pY(Q,{baseId:W,schema:$,root:Y}){var J;if(((J=Q.fragment)===null||J===void 0?void 0:J[0])!=="/")return;for(let G of Q.fragment.slice(1).split("/")){if(typeof $==="boolean")return;let B=$[(0,SH.unescapeFragment)(G)];if(B===void 0)return;$=B;let K=typeof $==="object"&&$[this.opts.schemaId];if(!OD.has(G)&&K)W=(0,N1.resolveUrl)(this.opts.uriResolver,W,K)}let X;if(typeof $!="boolean"&&$.$ref&&!(0,SH.schemaHasRulesButRef)($,this.RULES)){let G=(0,N1.resolveUrl)(this.opts.uriResolver,W,$.$ref);X=a8.call(this,Y,G)}let{schemaId:H}=this.opts;if(X=X||new D9({schema:$,schemaId:H,root:Y,baseId:W}),X.schema!==X.root.schema)return X;return}});var CH=Z((_R,wD)=>{wD.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var nY=Z((xR,kH)=>{var ND=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),vH=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function iY(Q){let W="",$=0,Y=0;for(Y=0;Y<Q.length;Y++){if($=Q[Y].charCodeAt(0),$===48)continue;if(!($>=48&&$<=57||$>=65&&$<=70||$>=97&&$<=102))return"";W+=Q[Y];break}for(Y+=1;Y<Q.length;Y++){if($=Q[Y].charCodeAt(0),!($>=48&&$<=57||$>=65&&$<=70||$>=97&&$<=102))return"";W+=Q[Y]}return W}var MD=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function ZH(Q){return Q.length=0,!0}function jD(Q,W,$){if(Q.length){let Y=iY(Q);if(Y!=="")W.push(Y);else return $.error=!0,!1;Q.length=0}return!0}function zD(Q){let W=0,$={error:!1,address:"",zone:""},Y=[],J=[],X=!1,H=!1,G=jD;for(let B=0;B<Q.length;B++){let K=Q[B];if(K==="["||K==="]")continue;if(K===":"){if(X===!0)H=!0;if(!G(J,Y,$))break;if(++W>7){$.error=!0;break}if(B>0&&Q[B-1]===":")X=!0;Y.push(":");continue}else if(K==="%"){if(!G(J,Y,$))break;G=ZH}else{J.push(K);continue}}if(J.length)if(G===ZH)$.zone=J.join("");else if(H)Y.push(J.join(""));else Y.push(iY(J));return $.address=Y.join(""),$}function TH(Q){if(ED(Q,":")<2)return{host:Q,isIPV6:!1};let W=zD(Q);if(!W.error){let{address:$,address:Y}=W;if(W.zone)$+="%"+W.zone,Y+="%25"+W.zone;return{host:$,isIPV6:!0,escapedHost:Y}}else return{host:Q,isIPV6:!1}}function ED(Q,W){let $=0;for(let Y=0;Y<Q.length;Y++)if(Q[Y]===W)$++;return $}function PD(Q){let W=Q,$=[],Y=-1,J=0;while(J=W.length){if(J===1)if(W===".")break;else if(W==="/"){$.push("/");break}else{$.push(W);break}else if(J===2){if(W[0]==="."){if(W[1]===".")break;else if(W[1]==="/"){W=W.slice(2);continue}}else if(W[0]==="/"){if(W[1]==="."||W[1]==="/"){$.push("/");break}}}else if(J===3){if(W==="/.."){if($.length!==0)$.pop();$.push("/");break}}if(W[0]==="."){if(W[1]==="."){if(W[2]==="/"){W=W.slice(3);continue}}else if(W[1]==="/"){W=W.slice(2);continue}}else if(W[0]==="/"){if(W[1]==="."){if(W[2]==="/"){W=W.slice(2);continue}else if(W[2]==="."){if(W[3]==="/"){if(W=W.slice(3),$.length!==0)$.pop();continue}}}}if((Y=W.indexOf("/",1))===-1){$.push(W);break}else $.push(W.slice(0,Y)),W=W.slice(Y)}return $.join("")}function RD(Q,W){let $=W!==!0?escape:unescape;if(Q.scheme!==void 0)Q.scheme=$(Q.scheme);if(Q.userinfo!==void 0)Q.userinfo=$(Q.userinfo);if(Q.host!==void 0)Q.host=$(Q.host);if(Q.path!==void 0)Q.path=$(Q.path);if(Q.query!==void 0)Q.query=$(Q.query);if(Q.fragment!==void 0)Q.fragment=$(Q.fragment);return Q}function bD(Q){let W=[];if(Q.userinfo!==void 0)W.push(Q.userinfo),W.push("@");if(Q.host!==void 0){let $=unescape(Q.host);if(!vH($)){let Y=TH($);if(Y.isIPV6===!0)$=`[${Y.escapedHost}]`;else $=Q.host}W.push($)}if(typeof Q.port==="number"||typeof Q.port==="string")W.push(":"),W.push(String(Q.port));return W.length?W.join(""):void 0}kH.exports={nonSimpleDomain:MD,recomposeAuthority:bD,normalizeComponentEncoding:RD,removeDotSegments:PD,isIPv4:vH,isUUID:ND,normalizeIPv6:TH,stringArrayToHexStripped:iY}});var hH=Z((yR,gH)=>{var{isUUID:SD}=nY(),ID=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,CD=["http","https","ws","wss","urn","urn:uuid"];function ZD(Q){return CD.indexOf(Q)!==-1}function oY(Q){if(Q.secure===!0)return!0;else if(Q.secure===!1)return!1;else if(Q.scheme)return Q.scheme.length===3&&(Q.scheme[0]==="w"||Q.scheme[0]==="W")&&(Q.scheme[1]==="s"||Q.scheme[1]==="S")&&(Q.scheme[2]==="s"||Q.scheme[2]==="S");else return!1}function _H(Q){if(!Q.host)Q.error=Q.error||"HTTP URIs must have a host.";return Q}function xH(Q){let W=String(Q.scheme).toLowerCase()==="https";if(Q.port===(W?443:80)||Q.port==="")Q.port=void 0;if(!Q.path)Q.path="/";return Q}function vD(Q){return Q.secure=oY(Q),Q.resourceName=(Q.path||"/")+(Q.query?"?"+Q.query:""),Q.path=void 0,Q.query=void 0,Q}function TD(Q){if(Q.port===(oY(Q)?443:80)||Q.port==="")Q.port=void 0;if(typeof Q.secure==="boolean")Q.scheme=Q.secure?"wss":"ws",Q.secure=void 0;if(Q.resourceName){let[W,$]=Q.resourceName.split("?");Q.path=W&&W!=="/"?W:void 0,Q.query=$,Q.resourceName=void 0}return Q.fragment=void 0,Q}function kD(Q,W){if(!Q.path)return Q.error="URN can not be parsed",Q;let $=Q.path.match(ID);if($){let Y=W.scheme||Q.scheme||"urn";Q.nid=$[1].toLowerCase(),Q.nss=$[2];let J=`${Y}:${W.nid||Q.nid}`,X=rY(J);if(Q.path=void 0,X)Q=X.parse(Q,W)}else Q.error=Q.error||"URN can not be parsed.";return Q}function _D(Q,W){if(Q.nid===void 0)throw Error("URN without nid cannot be serialized");let $=W.scheme||Q.scheme||"urn",Y=Q.nid.toLowerCase(),J=`${$}:${W.nid||Y}`,X=rY(J);if(X)Q=X.serialize(Q,W);let H=Q,G=Q.nss;return H.path=`${Y||W.nid}:${G}`,W.skipEscape=!0,H}function xD(Q,W){let $=Q;if($.uuid=$.nss,$.nss=void 0,!W.tolerant&&(!$.uuid||!SD($.uuid)))$.error=$.error||"UUID is not valid.";return $}function yD(Q){let W=Q;return W.nss=(Q.uuid||"").toLowerCase(),W}var yH={scheme:"http",domainHost:!0,parse:_H,serialize:xH},gD={scheme:"https",domainHost:yH.domainHost,parse:_H,serialize:xH},s8={scheme:"ws",domainHost:!0,parse:vD,serialize:TD},hD={scheme:"wss",domainHost:s8.domainHost,parse:s8.parse,serialize:s8.serialize},fD={scheme:"urn",parse:kD,serialize:_D,skipNormalize:!0},uD={scheme:"urn:uuid",parse:xD,serialize:yD,skipNormalize:!0},e8={http:yH,https:gD,ws:s8,wss:hD,urn:fD,"urn:uuid":uD};Object.setPrototypeOf(e8,null);function rY(Q){return Q&&(e8[Q]||e8[Q.toLowerCase()])||void 0}gH.exports={wsIsSecure:oY,SCHEMES:e8,isValidSchemeName:ZD,getSchemeHandler:rY}});var lH=Z((gR,WQ)=>{var{normalizeIPv6:lD,removeDotSegments:O9,recomposeAuthority:mD,normalizeComponentEncoding:QQ,isIPv4:cD,nonSimpleDomain:pD}=nY(),{SCHEMES:dD,getSchemeHandler:fH}=hH();function iD(Q,W){if(typeof Q==="string")Q=C1(l1(Q,W),W);else if(typeof Q==="object")Q=l1(C1(Q,W),W);return Q}function nD(Q,W,$){let Y=$?Object.assign({scheme:"null"},$):{scheme:"null"},J=uH(l1(Q,Y),l1(W,Y),Y,!0);return Y.skipEscape=!0,C1(J,Y)}function uH(Q,W,$,Y){let J={};if(!Y)Q=l1(C1(Q,$),$),W=l1(C1(W,$),$);if($=$||{},!$.tolerant&&W.scheme)J.scheme=W.scheme,J.userinfo=W.userinfo,J.host=W.host,J.port=W.port,J.path=O9(W.path||""),J.query=W.query;else{if(W.userinfo!==void 0||W.host!==void 0||W.port!==void 0)J.userinfo=W.userinfo,J.host=W.host,J.port=W.port,J.path=O9(W.path||""),J.query=W.query;else{if(!W.path)if(J.path=Q.path,W.query!==void 0)J.query=W.query;else J.query=Q.query;else{if(W.path[0]==="/")J.path=O9(W.path);else{if((Q.userinfo!==void 0||Q.host!==void 0||Q.port!==void 0)&&!Q.path)J.path="/"+W.path;else if(!Q.path)J.path=W.path;else J.path=Q.path.slice(0,Q.path.lastIndexOf("/")+1)+W.path;J.path=O9(J.path)}J.query=W.query}J.userinfo=Q.userinfo,J.host=Q.host,J.port=Q.port}J.scheme=Q.scheme}return J.fragment=W.fragment,J}function oD(Q,W,$){if(typeof Q==="string")Q=unescape(Q),Q=C1(QQ(l1(Q,$),!0),{...$,skipEscape:!0});else if(typeof Q==="object")Q=C1(QQ(Q,!0),{...$,skipEscape:!0});if(typeof W==="string")W=unescape(W),W=C1(QQ(l1(W,$),!0),{...$,skipEscape:!0});else if(typeof W==="object")W=C1(QQ(W,!0),{...$,skipEscape:!0});return Q.toLowerCase()===W.toLowerCase()}function C1(Q,W){let $={host:Q.host,scheme:Q.scheme,userinfo:Q.userinfo,port:Q.port,path:Q.path,query:Q.query,nid:Q.nid,nss:Q.nss,uuid:Q.uuid,fragment:Q.fragment,reference:Q.reference,resourceName:Q.resourceName,secure:Q.secure,error:""},Y=Object.assign({},W),J=[],X=fH(Y.scheme||$.scheme);if(X&&X.serialize)X.serialize($,Y);if($.path!==void 0)if(!Y.skipEscape){if($.path=escape($.path),$.scheme!==void 0)$.path=$.path.split("%3A").join(":")}else $.path=unescape($.path);if(Y.reference!=="suffix"&&$.scheme)J.push($.scheme,":");let H=mD($);if(H!==void 0){if(Y.reference!=="suffix")J.push("//");if(J.push(H),$.path&&$.path[0]!=="/")J.push("/")}if($.path!==void 0){let G=$.path;if(!Y.absolutePath&&(!X||!X.absolutePath))G=O9(G);if(H===void 0&&G[0]==="/"&&G[1]==="/")G="/%2F"+G.slice(2);J.push(G)}if($.query!==void 0)J.push("?",$.query);if($.fragment!==void 0)J.push("#",$.fragment);return J.join("")}var rD=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function l1(Q,W){let $=Object.assign({},W),Y={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},J=!1;if($.reference==="suffix")if($.scheme)Q=$.scheme+":"+Q;else Q="//"+Q;let X=Q.match(rD);if(X){if(Y.scheme=X[1],Y.userinfo=X[3],Y.host=X[4],Y.port=parseInt(X[5],10),Y.path=X[6]||"",Y.query=X[7],Y.fragment=X[8],isNaN(Y.port))Y.port=X[5];if(Y.host)if(cD(Y.host)===!1){let B=lD(Y.host);Y.host=B.host.toLowerCase(),J=B.isIPV6}else J=!0;if(Y.scheme===void 0&&Y.userinfo===void 0&&Y.host===void 0&&Y.port===void 0&&Y.query===void 0&&!Y.path)Y.reference="same-document";else if(Y.scheme===void 0)Y.reference="relative";else if(Y.fragment===void 0)Y.reference="absolute";else Y.reference="uri";if($.reference&&$.reference!=="suffix"&&$.reference!==Y.reference)Y.error=Y.error||"URI is not a "+$.reference+" reference.";let H=fH($.scheme||Y.scheme);if(!$.unicodeSupport&&(!H||!H.unicodeSupport)){if(Y.host&&($.domainHost||H&&H.domainHost)&&J===!1&&pD(Y.host))try{Y.host=URL.domainToASCII(Y.host.toLowerCase())}catch(G){Y.error=Y.error||"Host's domain name can not be converted to ASCII: "+G}}if(!H||H&&!H.skipNormalize){if(Q.indexOf("%")!==-1){if(Y.scheme!==void 0)Y.scheme=unescape(Y.scheme);if(Y.host!==void 0)Y.host=unescape(Y.host)}if(Y.path)Y.path=escape(unescape(Y.path));if(Y.fragment)Y.fragment=encodeURI(decodeURIComponent(Y.fragment))}if(H&&H.parse)H.parse(Y,$)}else Y.error=Y.error||"URI can not be parsed.";return Y}var aY={SCHEMES:dD,normalize:iD,resolve:nD,resolveComponent:uH,equal:oD,serialize:C1,parse:l1};WQ.exports=aY;WQ.exports.default=aY;WQ.exports.fastUri=aY});var cH=Z((tY)=>{Object.defineProperty(tY,"__esModule",{value:!0});var mH=lH();mH.code='require("ajv/dist/runtime/uri").default';tY.default=mH});var tH=Z((T0)=>{Object.defineProperty(T0,"__esModule",{value:!0});T0.CodeGen=T0.Name=T0.nil=T0.stringify=T0.str=T0._=T0.KeywordCxt=void 0;var aD=U9();Object.defineProperty(T0,"KeywordCxt",{enumerable:!0,get:function(){return aD.KeywordCxt}});var N4=p();Object.defineProperty(T0,"_",{enumerable:!0,get:function(){return N4._}});Object.defineProperty(T0,"str",{enumerable:!0,get:function(){return N4.str}});Object.defineProperty(T0,"stringify",{enumerable:!0,get:function(){return N4.stringify}});Object.defineProperty(T0,"nil",{enumerable:!0,get:function(){return N4.nil}});Object.defineProperty(T0,"Name",{enumerable:!0,get:function(){return N4.Name}});Object.defineProperty(T0,"CodeGen",{enumerable:!0,get:function(){return N4.CodeGen}});var tD=r8(),oH=A9(),sD=SY(),w9=t8(),eD=p(),N9=V9(),$Q=F9(),eY=W0(),pH=CH(),QO=cH(),rH=(Q,W)=>new RegExp(Q,W);rH.code="new RegExp";var WO=["removeAdditional","useDefaults","coerceTypes"],$O=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),YO={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},JO={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},dH=200;function XO(Q){var W,$,Y,J,X,H,G,B,K,V,L,U,q,A,D,O,w,j,z,C,S,D0,b0,k1,M0;let P0=Q.strict,f0=(W=Q.code)===null||W===void 0?void 0:W.optimize,p1=f0===!0||f0===void 0?1:f0||0,SQ=(Y=($=Q.code)===null||$===void 0?void 0:$.regExp)!==null&&Y!==void 0?Y:rH,a0=(J=Q.uriResolver)!==null&&J!==void 0?J:QO.default;return{strictSchema:(H=(X=Q.strictSchema)!==null&&X!==void 0?X:P0)!==null&&H!==void 0?H:!0,strictNumbers:(B=(G=Q.strictNumbers)!==null&&G!==void 0?G:P0)!==null&&B!==void 0?B:!0,strictTypes:(V=(K=Q.strictTypes)!==null&&K!==void 0?K:P0)!==null&&V!==void 0?V:"log",strictTuples:(U=(L=Q.strictTuples)!==null&&L!==void 0?L:P0)!==null&&U!==void 0?U:"log",strictRequired:(A=(q=Q.strictRequired)!==null&&q!==void 0?q:P0)!==null&&A!==void 0?A:!1,code:Q.code?{...Q.code,optimize:p1,regExp:SQ}:{optimize:p1,regExp:SQ},loopRequired:(D=Q.loopRequired)!==null&&D!==void 0?D:dH,loopEnum:(O=Q.loopEnum)!==null&&O!==void 0?O:dH,meta:(w=Q.meta)!==null&&w!==void 0?w:!0,messages:(j=Q.messages)!==null&&j!==void 0?j:!0,inlineRefs:(z=Q.inlineRefs)!==null&&z!==void 0?z:!0,schemaId:(C=Q.schemaId)!==null&&C!==void 0?C:"$id",addUsedSchema:(S=Q.addUsedSchema)!==null&&S!==void 0?S:!0,validateSchema:(D0=Q.validateSchema)!==null&&D0!==void 0?D0:!0,validateFormats:(b0=Q.validateFormats)!==null&&b0!==void 0?b0:!0,unicodeRegExp:(k1=Q.unicodeRegExp)!==null&&k1!==void 0?k1:!0,int32range:(M0=Q.int32range)!==null&&M0!==void 0?M0:!0,uriResolver:a0}}class YQ{constructor(Q={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Q=this.opts={...Q,...XO(Q)};let{es5:W,lines:$}=this.opts.code;this.scope=new eD.ValueScope({scope:{},prefixes:$O,es5:W,lines:$}),this.logger=VO(Q.logger);let Y=Q.validateFormats;if(Q.validateFormats=!1,this.RULES=(0,sD.getRules)(),iH.call(this,YO,Q,"NOT SUPPORTED"),iH.call(this,JO,Q,"DEPRECATED","warn"),this._metaOpts=KO.call(this),Q.formats)GO.call(this);if(this._addVocabularies(),this._addDefaultMetaSchema(),Q.keywords)BO.call(this,Q.keywords);if(typeof Q.meta=="object")this.addMetaSchema(Q.meta);HO.call(this),Q.validateFormats=Y}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:Q,meta:W,schemaId:$}=this.opts,Y=pH;if($==="id")Y={...pH},Y.id=Y.$id,delete Y.$id;if(W&&Q)this.addMetaSchema(Y,Y[$],!1)}defaultMeta(){let{meta:Q,schemaId:W}=this.opts;return this.opts.defaultMeta=typeof Q=="object"?Q[W]||Q:void 0}validate(Q,W){let $;if(typeof Q=="string"){if($=this.getSchema(Q),!$)throw Error(`no schema with key or ref "${Q}"`)}else $=this.compile(Q);let Y=$(W);if(!("$async"in $))this.errors=$.errors;return Y}compile(Q,W){let $=this._addSchema(Q,W);return $.validate||this._compileSchemaEnv($)}compileAsync(Q,W){if(typeof this.opts.loadSchema!="function")throw Error("options.loadSchema should be a function");let{loadSchema:$}=this.opts;return Y.call(this,Q,W);async function Y(K,V){await J.call(this,K.$schema);let L=this._addSchema(K,V);return L.validate||X.call(this,L)}async function J(K){if(K&&!this.getSchema(K))await Y.call(this,{$ref:K},!0)}async function X(K){try{return this._compileSchemaEnv(K)}catch(V){if(!(V instanceof oH.default))throw V;return H.call(this,V),await G.call(this,V.missingSchema),X.call(this,K)}}function H({missingSchema:K,missingRef:V}){if(this.refs[K])throw Error(`AnySchema ${K} is loaded but ${V} cannot be resolved`)}async function G(K){let V=await B.call(this,K);if(!this.refs[K])await J.call(this,V.$schema);if(!this.refs[K])this.addSchema(V,K,W)}async function B(K){let V=this._loading[K];if(V)return V;try{return await(this._loading[K]=$(K))}finally{delete this._loading[K]}}}addSchema(Q,W,$,Y=this.opts.validateSchema){if(Array.isArray(Q)){for(let X of Q)this.addSchema(X,void 0,$,Y);return this}let J;if(typeof Q==="object"){let{schemaId:X}=this.opts;if(J=Q[X],J!==void 0&&typeof J!="string")throw Error(`schema ${X} must be string`)}return W=(0,N9.normalizeId)(W||J),this._checkUnique(W),this.schemas[W]=this._addSchema(Q,$,W,Y,!0),this}addMetaSchema(Q,W,$=this.opts.validateSchema){return this.addSchema(Q,W,!0,$),this}validateSchema(Q,W){if(typeof Q=="boolean")return!0;let $;if($=Q.$schema,$!==void 0&&typeof $!="string")throw Error("$schema must be a string");if($=$||this.opts.defaultMeta||this.defaultMeta(),!$)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let Y=this.validate($,Q);if(!Y&&W){let J="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(J);else throw Error(J)}return Y}getSchema(Q){let W;while(typeof(W=nH.call(this,Q))=="string")Q=W;if(W===void 0){let{schemaId:$}=this.opts,Y=new w9.SchemaEnv({schema:{},schemaId:$});if(W=w9.resolveSchema.call(this,Y,Q),!W)return;this.refs[Q]=W}return W.validate||this._compileSchemaEnv(W)}removeSchema(Q){if(Q instanceof RegExp)return this._removeAllSchemas(this.schemas,Q),this._removeAllSchemas(this.refs,Q),this;switch(typeof Q){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let W=nH.call(this,Q);if(typeof W=="object")this._cache.delete(W.schema);return delete this.schemas[Q],delete this.refs[Q],this}case"object":{let W=Q;this._cache.delete(W);let $=Q[this.opts.schemaId];if($)$=(0,N9.normalizeId)($),delete this.schemas[$],delete this.refs[$];return this}default:throw Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Q){for(let W of Q)this.addKeyword(W);return this}addKeyword(Q,W){let $;if(typeof Q=="string"){if($=Q,typeof W=="object")this.logger.warn("these parameters are deprecated, see docs for addKeyword"),W.keyword=$}else if(typeof Q=="object"&&W===void 0){if(W=Q,$=W.keyword,Array.isArray($)&&!$.length)throw Error("addKeywords: keyword must be string or non-empty array")}else throw Error("invalid addKeywords parameters");if(qO.call(this,$,W),!W)return(0,eY.eachItem)($,(J)=>sY.call(this,J)),this;AO.call(this,W);let Y={...W,type:(0,$Q.getJSONTypes)(W.type),schemaType:(0,$Q.getJSONTypes)(W.schemaType)};return(0,eY.eachItem)($,Y.type.length===0?(J)=>sY.call(this,J,Y):(J)=>Y.type.forEach((X)=>sY.call(this,J,Y,X))),this}getKeyword(Q){let W=this.RULES.all[Q];return typeof W=="object"?W.definition:!!W}removeKeyword(Q){let{RULES:W}=this;delete W.keywords[Q],delete W.all[Q];for(let $ of W.rules){let Y=$.rules.findIndex((J)=>J.keyword===Q);if(Y>=0)$.rules.splice(Y,1)}return this}addFormat(Q,W){if(typeof W=="string")W=new RegExp(W);return this.formats[Q]=W,this}errorsText(Q=this.errors,{separator:W=", ",dataVar:$="data"}={}){if(!Q||Q.length===0)return"No errors";return Q.map((Y)=>`${$}${Y.instancePath} ${Y.message}`).reduce((Y,J)=>Y+W+J)}$dataMetaSchema(Q,W){let $=this.RULES.all;Q=JSON.parse(JSON.stringify(Q));for(let Y of W){let J=Y.split("/").slice(1),X=Q;for(let H of J)X=X[H];for(let H in $){let G=$[H];if(typeof G!="object")continue;let{$data:B}=G.definition,K=X[H];if(B&&K)X[H]=aH(K)}}return Q}_removeAllSchemas(Q,W){for(let $ in Q){let Y=Q[$];if(!W||W.test($)){if(typeof Y=="string")delete Q[$];else if(Y&&!Y.meta)this._cache.delete(Y.schema),delete Q[$]}}}_addSchema(Q,W,$,Y=this.opts.validateSchema,J=this.opts.addUsedSchema){let X,{schemaId:H}=this.opts;if(typeof Q=="object")X=Q[H];else if(this.opts.jtd)throw Error("schema must be object");else if(typeof Q!="boolean")throw Error("schema must be object or boolean");let G=this._cache.get(Q);if(G!==void 0)return G;$=(0,N9.normalizeId)(X||$);let B=N9.getSchemaRefs.call(this,Q,$);if(G=new w9.SchemaEnv({schema:Q,schemaId:H,meta:W,baseId:$,localRefs:B}),this._cache.set(G.schema,G),J&&!$.startsWith("#")){if($)this._checkUnique($);this.refs[$]=G}if(Y)this.validateSchema(Q,!0);return G}_checkUnique(Q){if(this.schemas[Q]||this.refs[Q])throw Error(`schema with key or id "${Q}" already exists`)}_compileSchemaEnv(Q){if(Q.meta)this._compileMetaSchema(Q);else w9.compileSchema.call(this,Q);if(!Q.validate)throw Error("ajv implementation error");return Q.validate}_compileMetaSchema(Q){let W=this.opts;this.opts=this._metaOpts;try{w9.compileSchema.call(this,Q)}finally{this.opts=W}}}YQ.ValidationError=tD.default;YQ.MissingRefError=oH.default;T0.default=YQ;function iH(Q,W,$,Y="error"){for(let J in Q){let X=J;if(X in W)this.logger[Y](`${$}: option ${J}. ${Q[X]}`)}}function nH(Q){return Q=(0,N9.normalizeId)(Q),this.schemas[Q]||this.refs[Q]}function HO(){let Q=this.opts.schemas;if(!Q)return;if(Array.isArray(Q))this.addSchema(Q);else for(let W in Q)this.addSchema(Q[W],W)}function GO(){for(let Q in this.opts.formats){let W=this.opts.formats[Q];if(W)this.addFormat(Q,W)}}function BO(Q){if(Array.isArray(Q)){this.addVocabulary(Q);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let W in Q){let $=Q[W];if(!$.keyword)$.keyword=W;this.addKeyword($)}}function KO(){let Q={...this.opts};for(let W of WO)delete Q[W];return Q}var FO={log(){},warn(){},error(){}};function VO(Q){if(Q===!1)return FO;if(Q===void 0)return console;if(Q.log&&Q.warn&&Q.error)return Q;throw Error("logger must implement log, warn and error methods")}var LO=/^[a-z_$][a-z0-9_$:-]*$/i;function qO(Q,W){let{RULES:$}=this;if((0,eY.eachItem)(Q,(Y)=>{if($.keywords[Y])throw Error(`Keyword ${Y} is already defined`);if(!LO.test(Y))throw Error(`Keyword ${Y} has invalid name`)}),!W)return;if(W.$data&&!(("code"in W)||("validate"in W)))throw Error('$data keyword must have "code" or "validate" function')}function sY(Q,W,$){var Y;let J=W===null||W===void 0?void 0:W.post;if($&&J)throw Error('keyword with "post" flag cannot have "type"');let{RULES:X}=this,H=J?X.post:X.rules.find(({type:B})=>B===$);if(!H)H={type:$,rules:[]},X.rules.push(H);if(X.keywords[Q]=!0,!W)return;let G={keyword:Q,definition:{...W,type:(0,$Q.getJSONTypes)(W.type),schemaType:(0,$Q.getJSONTypes)(W.schemaType)}};if(W.before)UO.call(this,H,G,W.before);else H.rules.push(G);X.all[Q]=G,(Y=W.implements)===null||Y===void 0||Y.forEach((B)=>this.addKeyword(B))}function UO(Q,W,$){let Y=Q.rules.findIndex((J)=>J.keyword===$);if(Y>=0)Q.rules.splice(Y,0,W);else Q.rules.push(W),this.logger.warn(`rule ${$} is not defined`)}function AO(Q){let{metaSchema:W}=Q;if(W===void 0)return;if(Q.$data&&this.opts.$data)W=aH(W);Q.validateSchema=this.compile(W,!0)}var DO={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function aH(Q){return{anyOf:[Q,DO]}}});var sH=Z((Q5)=>{Object.defineProperty(Q5,"__esModule",{value:!0});var OO={keyword:"id",code(){throw Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Q5.default=OO});var $G=Z((v6)=>{Object.defineProperty(v6,"__esModule",{value:!0});v6.callRef=v6.getValidate=void 0;var wO=A9(),eH=X1(),r0=p(),M4=f1(),QG=t8(),JQ=W0(),NO={keyword:"$ref",schemaType:"string",code(Q){let{gen:W,schema:$,it:Y}=Q,{baseId:J,schemaEnv:X,validateName:H,opts:G,self:B}=Y,{root:K}=X;if(($==="#"||$==="#/")&&J===K.baseId)return L();let V=QG.resolveRef.call(B,K,J,$);if(V===void 0)throw new wO.default(Y.opts.uriResolver,J,$);if(V instanceof QG.SchemaEnv)return U(V);return q(V);function L(){if(X===K)return XQ(Q,H,X,X.$async);let A=W.scopeValue("root",{ref:K});return XQ(Q,r0._`${A}.validate`,K,K.$async)}function U(A){let D=WG(Q,A);XQ(Q,D,A,A.$async)}function q(A){let D=W.scopeValue("schema",G.code.source===!0?{ref:A,code:(0,r0.stringify)(A)}:{ref:A}),O=W.name("valid"),w=Q.subschema({schema:A,dataTypes:[],schemaPath:r0.nil,topSchemaRef:D,errSchemaPath:$},O);Q.mergeEvaluated(w),Q.ok(O)}}};function WG(Q,W){let{gen:$}=Q;return W.validate?$.scopeValue("validate",{ref:W.validate}):r0._`${$.scopeValue("wrapper",{ref:W})}.validate`}v6.getValidate=WG;function XQ(Q,W,$,Y){let{gen:J,it:X}=Q,{allErrors:H,schemaEnv:G,opts:B}=X,K=B.passContext?M4.default.this:r0.nil;if(Y)V();else L();function V(){if(!G.$async)throw Error("async schema referenced by sync schema");let A=J.let("valid");J.try(()=>{if(J.code(r0._`await ${(0,eH.callValidateCode)(Q,W,K)}`),q(W),!H)J.assign(A,!0)},(D)=>{if(J.if(r0._`!(${D} instanceof ${X.ValidationError})`,()=>J.throw(D)),U(D),!H)J.assign(A,!1)}),Q.ok(A)}function L(){Q.result((0,eH.callValidateCode)(Q,W,K),()=>q(W),()=>U(W))}function U(A){let D=r0._`${A}.errors`;J.assign(M4.default.vErrors,r0._`${M4.default.vErrors} === null ? ${D} : ${M4.default.vErrors}.concat(${D})`),J.assign(M4.default.errors,r0._`${M4.default.vErrors}.length`)}function q(A){var D;if(!X.opts.unevaluated)return;let O=(D=$===null||$===void 0?void 0:$.validate)===null||D===void 0?void 0:D.evaluated;if(X.props!==!0)if(O&&!O.dynamicProps){if(O.props!==void 0)X.props=JQ.mergeEvaluated.props(J,O.props,X.props)}else{let w=J.var("props",r0._`${A}.evaluated.props`);X.props=JQ.mergeEvaluated.props(J,w,X.props,r0.Name)}if(X.items!==!0)if(O&&!O.dynamicItems){if(O.items!==void 0)X.items=JQ.mergeEvaluated.items(J,O.items,X.items)}else{let w=J.var("items",r0._`${A}.evaluated.items`);X.items=JQ.mergeEvaluated.items(J,w,X.items,r0.Name)}}}v6.callRef=XQ;v6.default=NO});var YG=Z((W5)=>{Object.defineProperty(W5,"__esModule",{value:!0});var MO=sH(),jO=$G(),zO=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",MO.default,jO.default];W5.default=zO});var JG=Z(($5)=>{Object.defineProperty($5,"__esModule",{value:!0});var HQ=p(),L6=HQ.operators,GQ={maximum:{okStr:"<=",ok:L6.LTE,fail:L6.GT},minimum:{okStr:">=",ok:L6.GTE,fail:L6.LT},exclusiveMaximum:{okStr:"<",ok:L6.LT,fail:L6.GTE},exclusiveMinimum:{okStr:">",ok:L6.GT,fail:L6.LTE}},EO={message:({keyword:Q,schemaCode:W})=>HQ.str`must be ${GQ[Q].okStr} ${W}`,params:({keyword:Q,schemaCode:W})=>HQ._`{comparison: ${GQ[Q].okStr}, limit: ${W}}`},PO={keyword:Object.keys(GQ),type:"number",schemaType:"number",$data:!0,error:EO,code(Q){let{keyword:W,data:$,schemaCode:Y}=Q;Q.fail$data(HQ._`${$} ${GQ[W].fail} ${Y} || isNaN(${$})`)}};$5.default=PO});var XG=Z((Y5)=>{Object.defineProperty(Y5,"__esModule",{value:!0});var M9=p(),RO={message:({schemaCode:Q})=>M9.str`must be multiple of ${Q}`,params:({schemaCode:Q})=>M9._`{multipleOf: ${Q}}`},bO={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:RO,code(Q){let{gen:W,data:$,schemaCode:Y,it:J}=Q,X=J.opts.multipleOfPrecision,H=W.let("res"),G=X?M9._`Math.abs(Math.round(${H}) - ${H}) > 1e-${X}`:M9._`${H} !== parseInt(${H})`;Q.fail$data(M9._`(${Y} === 0 || (${H} = ${$}/${Y}, ${G}))`)}};Y5.default=bO});var GG=Z((J5)=>{Object.defineProperty(J5,"__esModule",{value:!0});function HG(Q){let W=Q.length,$=0,Y=0,J;while(Y<W)if($++,J=Q.charCodeAt(Y++),J>=55296&&J<=56319&&Y<W){if(J=Q.charCodeAt(Y),(J&64512)===56320)Y++}return $}J5.default=HG;HG.code='require("ajv/dist/runtime/ucs2length").default'});var BG=Z((X5)=>{Object.defineProperty(X5,"__esModule",{value:!0});var T6=p(),SO=W0(),IO=GG(),CO={message({keyword:Q,schemaCode:W}){let $=Q==="maxLength"?"more":"fewer";return T6.str`must NOT have ${$} than ${W} characters`},params:({schemaCode:Q})=>T6._`{limit: ${Q}}`},ZO={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:CO,code(Q){let{keyword:W,data:$,schemaCode:Y,it:J}=Q,X=W==="maxLength"?T6.operators.GT:T6.operators.LT,H=J.opts.unicode===!1?T6._`${$}.length`:T6._`${(0,SO.useFunc)(Q.gen,IO.default)}(${$})`;Q.fail$data(T6._`${H} ${X} ${Y}`)}};X5.default=ZO});var KG=Z((H5)=>{Object.defineProperty(H5,"__esModule",{value:!0});var vO=X1(),BQ=p(),TO={message:({schemaCode:Q})=>BQ.str`must match pattern "${Q}"`,params:({schemaCode:Q})=>BQ._`{pattern: ${Q}}`},kO={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:TO,code(Q){let{data:W,$data:$,schema:Y,schemaCode:J,it:X}=Q,H=X.opts.unicodeRegExp?"u":"",G=$?BQ._`(new RegExp(${J}, ${H}))`:(0,vO.usePattern)(Q,Y);Q.fail$data(BQ._`!${G}.test(${W})`)}};H5.default=kO});var FG=Z((G5)=>{Object.defineProperty(G5,"__esModule",{value:!0});var j9=p(),_O={message({keyword:Q,schemaCode:W}){let $=Q==="maxProperties"?"more":"fewer";return j9.str`must NOT have ${$} than ${W} properties`},params:({schemaCode:Q})=>j9._`{limit: ${Q}}`},xO={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:_O,code(Q){let{keyword:W,data:$,schemaCode:Y}=Q,J=W==="maxProperties"?j9.operators.GT:j9.operators.LT;Q.fail$data(j9._`Object.keys(${$}).length ${J} ${Y}`)}};G5.default=xO});var VG=Z((B5)=>{Object.defineProperty(B5,"__esModule",{value:!0});var z9=X1(),E9=p(),yO=W0(),gO={message:({params:{missingProperty:Q}})=>E9.str`must have required property '${Q}'`,params:({params:{missingProperty:Q}})=>E9._`{missingProperty: ${Q}}`},hO={keyword:"required",type:"object",schemaType:"array",$data:!0,error:gO,code(Q){let{gen:W,schema:$,schemaCode:Y,data:J,$data:X,it:H}=Q,{opts:G}=H;if(!X&&$.length===0)return;let B=$.length>=G.loopRequired;if(H.allErrors)K();else V();if(G.strictRequired){let q=Q.parentSchema.properties,{definedProperties:A}=Q.it;for(let D of $)if((q===null||q===void 0?void 0:q[D])===void 0&&!A.has(D)){let O=H.schemaEnv.baseId+H.errSchemaPath,w=`required property "${D}" is not defined at "${O}" (strictRequired)`;(0,yO.checkStrictMode)(H,w,H.opts.strictRequired)}}function K(){if(B||X)Q.block$data(E9.nil,L);else for(let q of $)(0,z9.checkReportMissingProp)(Q,q)}function V(){let q=W.let("missing");if(B||X){let A=W.let("valid",!0);Q.block$data(A,()=>U(q,A)),Q.ok(A)}else W.if((0,z9.checkMissingProp)(Q,$,q)),(0,z9.reportMissingProp)(Q,q),W.else()}function L(){W.forOf("prop",Y,(q)=>{Q.setParams({missingProperty:q}),W.if((0,z9.noPropertyInData)(W,J,q,G.ownProperties),()=>Q.error())})}function U(q,A){Q.setParams({missingProperty:q}),W.forOf(q,Y,()=>{W.assign(A,(0,z9.propertyInData)(W,J,q,G.ownProperties)),W.if((0,E9.not)(A),()=>{Q.error(),W.break()})},E9.nil)}}};B5.default=hO});var LG=Z((K5)=>{Object.defineProperty(K5,"__esModule",{value:!0});var P9=p(),fO={message({keyword:Q,schemaCode:W}){let $=Q==="maxItems"?"more":"fewer";return P9.str`must NOT have ${$} than ${W} items`},params:({schemaCode:Q})=>P9._`{limit: ${Q}}`},uO={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:fO,code(Q){let{keyword:W,data:$,schemaCode:Y}=Q,J=W==="maxItems"?P9.operators.GT:P9.operators.LT;Q.fail$data(P9._`${$}.length ${J} ${Y}`)}};K5.default=uO});var KQ=Z((F5)=>{Object.defineProperty(F5,"__esModule",{value:!0});var qG=xY();qG.code='require("ajv/dist/runtime/equal").default';F5.default=qG});var UG=Z((L5)=>{Object.defineProperty(L5,"__esModule",{value:!0});var V5=F9(),k0=p(),lO=W0(),mO=KQ(),cO={message:({params:{i:Q,j:W}})=>k0.str`must NOT have duplicate items (items ## ${W} and ${Q} are identical)`,params:({params:{i:Q,j:W}})=>k0._`{i: ${Q}, j: ${W}}`},pO={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:cO,code(Q){let{gen:W,data:$,$data:Y,schema:J,parentSchema:X,schemaCode:H,it:G}=Q;if(!Y&&!J)return;let B=W.let("valid"),K=X.items?(0,V5.getSchemaTypes)(X.items):[];Q.block$data(B,V,k0._`${H} === false`),Q.ok(B);function V(){let A=W.let("i",k0._`${$}.length`),D=W.let("j");Q.setParams({i:A,j:D}),W.assign(B,!0),W.if(k0._`${A} > 1`,()=>(L()?U:q)(A,D))}function L(){return K.length>0&&!K.some((A)=>A==="object"||A==="array")}function U(A,D){let O=W.name("item"),w=(0,V5.checkDataTypes)(K,O,G.opts.strictNumbers,V5.DataType.Wrong),j=W.const("indices",k0._`{}`);W.for(k0._`;${A}--;`,()=>{if(W.let(O,k0._`${$}[${A}]`),W.if(w,k0._`continue`),K.length>1)W.if(k0._`typeof ${O} == "string"`,k0._`${O} += "_"`);W.if(k0._`typeof ${j}[${O}] == "number"`,()=>{W.assign(D,k0._`${j}[${O}]`),Q.error(),W.assign(B,!1).break()}).code(k0._`${j}[${O}] = ${A}`)})}function q(A,D){let O=(0,lO.useFunc)(W,mO.default),w=W.name("outer");W.label(w).for(k0._`;${A}--;`,()=>W.for(k0._`${D} = ${A}; ${D}--;`,()=>W.if(k0._`${O}(${$}[${A}], ${$}[${D}])`,()=>{Q.error(),W.assign(B,!1).break(w)})))}}};L5.default=pO});var AG=Z((U5)=>{Object.defineProperty(U5,"__esModule",{value:!0});var q5=p(),dO=W0(),iO=KQ(),nO={message:"must be equal to constant",params:({schemaCode:Q})=>q5._`{allowedValue: ${Q}}`},oO={keyword:"const",$data:!0,error:nO,code(Q){let{gen:W,data:$,$data:Y,schemaCode:J,schema:X}=Q;if(Y||X&&typeof X=="object")Q.fail$data(q5._`!${(0,dO.useFunc)(W,iO.default)}(${$}, ${J})`);else Q.fail(q5._`${X} !== ${$}`)}};U5.default=oO});var DG=Z((A5)=>{Object.defineProperty(A5,"__esModule",{value:!0});var R9=p(),rO=W0(),aO=KQ(),tO={message:"must be equal to one of the allowed values",params:({schemaCode:Q})=>R9._`{allowedValues: ${Q}}`},sO={keyword:"enum",schemaType:"array",$data:!0,error:tO,code(Q){let{gen:W,data:$,$data:Y,schema:J,schemaCode:X,it:H}=Q;if(!Y&&J.length===0)throw Error("enum must have non-empty array");let G=J.length>=H.opts.loopEnum,B,K=()=>B!==null&&B!==void 0?B:B=(0,rO.useFunc)(W,aO.default),V;if(G||Y)V=W.let("valid"),Q.block$data(V,L);else{if(!Array.isArray(J))throw Error("ajv implementation error");let q=W.const("vSchema",X);V=(0,R9.or)(...J.map((A,D)=>U(q,D)))}Q.pass(V);function L(){W.assign(V,!1),W.forOf("v",X,(q)=>W.if(R9._`${K()}(${$}, ${q})`,()=>W.assign(V,!0).break()))}function U(q,A){let D=J[A];return typeof D==="object"&&D!==null?R9._`${K()}(${$}, ${q}[${A}])`:R9._`${$} === ${D}`}}};A5.default=sO});var OG=Z((D5)=>{Object.defineProperty(D5,"__esModule",{value:!0});var eO=JG(),Qw=XG(),Ww=BG(),$w=KG(),Yw=FG(),Jw=VG(),Xw=LG(),Hw=UG(),Gw=AG(),Bw=DG(),Kw=[eO.default,Qw.default,Ww.default,$w.default,Yw.default,Jw.default,Xw.default,Hw.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Gw.default,Bw.default];D5.default=Kw});var w5=Z((b9)=>{Object.defineProperty(b9,"__esModule",{value:!0});b9.validateAdditionalItems=void 0;var k6=p(),O5=W0(),Fw={message:({params:{len:Q}})=>k6.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>k6._`{limit: ${Q}}`},Vw={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Fw,code(Q){let{parentSchema:W,it:$}=Q,{items:Y}=W;if(!Array.isArray(Y)){(0,O5.checkStrictMode)($,'"additionalItems" is ignored when "items" is not an array of schemas');return}wG(Q,Y)}};function wG(Q,W){let{gen:$,schema:Y,data:J,keyword:X,it:H}=Q;H.items=!0;let G=$.const("len",k6._`${J}.length`);if(Y===!1)Q.setParams({len:W.length}),Q.pass(k6._`${G} <= ${W.length}`);else if(typeof Y=="object"&&!(0,O5.alwaysValidSchema)(H,Y)){let K=$.var("valid",k6._`${G} <= ${W.length}`);$.if((0,k6.not)(K),()=>B(K)),Q.ok(K)}function B(K){$.forRange("i",W.length,G,(V)=>{if(Q.subschema({keyword:X,dataProp:V,dataPropType:O5.Type.Num},K),!H.allErrors)$.if((0,k6.not)(K),()=>$.break())})}}b9.validateAdditionalItems=wG;b9.default=Vw});var N5=Z((S9)=>{Object.defineProperty(S9,"__esModule",{value:!0});S9.validateTuple=void 0;var NG=p(),FQ=W0(),Lw=X1(),qw={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(Q){let{schema:W,it:$}=Q;if(Array.isArray(W))return MG(Q,"additionalItems",W);if($.items=!0,(0,FQ.alwaysValidSchema)($,W))return;Q.ok((0,Lw.validateArray)(Q))}};function MG(Q,W,$=Q.schema){let{gen:Y,parentSchema:J,data:X,keyword:H,it:G}=Q;if(V(J),G.opts.unevaluated&&$.length&&G.items!==!0)G.items=FQ.mergeEvaluated.items(Y,$.length,G.items);let B=Y.name("valid"),K=Y.const("len",NG._`${X}.length`);$.forEach((L,U)=>{if((0,FQ.alwaysValidSchema)(G,L))return;Y.if(NG._`${K} > ${U}`,()=>Q.subschema({keyword:H,schemaProp:U,dataProp:U},B)),Q.ok(B)});function V(L){let{opts:U,errSchemaPath:q}=G,A=$.length,D=A===L.minItems&&(A===L.maxItems||L[W]===!1);if(U.strictTuples&&!D){let O=`"${H}" is ${A}-tuple, but minItems or maxItems/${W} are not specified or different at path "${q}"`;(0,FQ.checkStrictMode)(G,O,U.strictTuples)}}}S9.validateTuple=MG;S9.default=qw});var jG=Z((M5)=>{Object.defineProperty(M5,"__esModule",{value:!0});var Uw=N5(),Aw={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:(Q)=>(0,Uw.validateTuple)(Q,"items")};M5.default=Aw});var EG=Z((j5)=>{Object.defineProperty(j5,"__esModule",{value:!0});var zG=p(),Dw=W0(),Ow=X1(),ww=w5(),Nw={message:({params:{len:Q}})=>zG.str`must NOT have more than ${Q} items`,params:({params:{len:Q}})=>zG._`{limit: ${Q}}`},Mw={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Nw,code(Q){let{schema:W,parentSchema:$,it:Y}=Q,{prefixItems:J}=$;if(Y.items=!0,(0,Dw.alwaysValidSchema)(Y,W))return;if(J)(0,ww.validateAdditionalItems)(Q,J);else Q.ok((0,Ow.validateArray)(Q))}};j5.default=Mw});var PG=Z((z5)=>{Object.defineProperty(z5,"__esModule",{value:!0});var G1=p(),VQ=W0(),jw={message:({params:{min:Q,max:W}})=>W===void 0?G1.str`must contain at least ${Q} valid item(s)`:G1.str`must contain at least ${Q} and no more than ${W} valid item(s)`,params:({params:{min:Q,max:W}})=>W===void 0?G1._`{minContains: ${Q}}`:G1._`{minContains: ${Q}, maxContains: ${W}}`},zw={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:jw,code(Q){let{gen:W,schema:$,parentSchema:Y,data:J,it:X}=Q,H,G,{minContains:B,maxContains:K}=Y;if(X.opts.next)H=B===void 0?1:B,G=K;else H=1;let V=W.const("len",G1._`${J}.length`);if(Q.setParams({min:H,max:G}),G===void 0&&H===0){(0,VQ.checkStrictMode)(X,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(G!==void 0&&H>G){(0,VQ.checkStrictMode)(X,'"minContains" > "maxContains" is always invalid'),Q.fail();return}if((0,VQ.alwaysValidSchema)(X,$)){let D=G1._`${V} >= ${H}`;if(G!==void 0)D=G1._`${D} && ${V} <= ${G}`;Q.pass(D);return}X.items=!0;let L=W.name("valid");if(G===void 0&&H===1)q(L,()=>W.if(L,()=>W.break()));else if(H===0){if(W.let(L,!0),G!==void 0)W.if(G1._`${J}.length > 0`,U)}else W.let(L,!1),U();Q.result(L,()=>Q.reset());function U(){let D=W.name("_valid"),O=W.let("count",0);q(D,()=>W.if(D,()=>A(O)))}function q(D,O){W.forRange("i",0,V,(w)=>{Q.subschema({keyword:"contains",dataProp:w,dataPropType:VQ.Type.Num,compositeRule:!0},D),O()})}function A(D){if(W.code(G1._`${D}++`),G===void 0)W.if(G1._`${D} >= ${H}`,()=>W.assign(L,!0).break());else if(W.if(G1._`${D} > ${G}`,()=>W.assign(L,!1).break()),H===1)W.assign(L,!0);else W.if(G1._`${D} >= ${H}`,()=>W.assign(L,!0))}}};z5.default=zw});var SG=Z((Z1)=>{Object.defineProperty(Z1,"__esModule",{value:!0});Z1.validateSchemaDeps=Z1.validatePropertyDeps=Z1.error=void 0;var E5=p(),Ew=W0(),I9=X1();Z1.error={message:({params:{property:Q,depsCount:W,deps:$}})=>{let Y=W===1?"property":"properties";return E5.str`must have ${Y} ${$} when property ${Q} is present`},params:({params:{property:Q,depsCount:W,deps:$,missingProperty:Y}})=>E5._`{property: ${Q},
    missingProperty: ${Y},
    depsCount: ${W},
    deps: ${$}}`};var Pw={keyword:"dependencies",type:"object",schemaType:"object",error:Z1.error,code(Q){let[W,$]=Rw(Q);RG(Q,W),bG(Q,$)}};function Rw({schema:Q}){let W={},$={};for(let Y in Q){if(Y==="__proto__")continue;let J=Array.isArray(Q[Y])?W:$;J[Y]=Q[Y]}return[W,$]}function RG(Q,W=Q.schema){let{gen:$,data:Y,it:J}=Q;if(Object.keys(W).length===0)return;let X=$.let("missing");for(let H in W){let G=W[H];if(G.length===0)continue;let B=(0,I9.propertyInData)($,Y,H,J.opts.ownProperties);if(Q.setParams({property:H,depsCount:G.length,deps:G.join(", ")}),J.allErrors)$.if(B,()=>{for(let K of G)(0,I9.checkReportMissingProp)(Q,K)});else $.if(E5._`${B} && (${(0,I9.checkMissingProp)(Q,G,X)})`),(0,I9.reportMissingProp)(Q,X),$.else()}}Z1.validatePropertyDeps=RG;function bG(Q,W=Q.schema){let{gen:$,data:Y,keyword:J,it:X}=Q,H=$.name("valid");for(let G in W){if((0,Ew.alwaysValidSchema)(X,W[G]))continue;$.if((0,I9.propertyInData)($,Y,G,X.opts.ownProperties),()=>{let B=Q.subschema({keyword:J,schemaProp:G},H);Q.mergeValidEvaluated(B,H)},()=>$.var(H,!0)),Q.ok(H)}}Z1.validateSchemaDeps=bG;Z1.default=Pw});var CG=Z((P5)=>{Object.defineProperty(P5,"__esModule",{value:!0});var IG=p(),bw=W0(),Sw={message:"property name must be valid",params:({params:Q})=>IG._`{propertyName: ${Q.propertyName}}`},Iw={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Sw,code(Q){let{gen:W,schema:$,data:Y,it:J}=Q;if((0,bw.alwaysValidSchema)(J,$))return;let X=W.name("valid");W.forIn("key",Y,(H)=>{Q.setParams({propertyName:H}),Q.subschema({keyword:"propertyNames",data:H,dataTypes:["string"],propertyName:H,compositeRule:!0},X),W.if((0,IG.not)(X),()=>{if(Q.error(!0),!J.allErrors)W.break()})}),Q.ok(X)}};P5.default=Iw});var b5=Z((R5)=>{Object.defineProperty(R5,"__esModule",{value:!0});var LQ=X1(),M1=p(),Cw=f1(),qQ=W0(),Zw={message:"must NOT have additional properties",params:({params:Q})=>M1._`{additionalProperty: ${Q.additionalProperty}}`},vw={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Zw,code(Q){let{gen:W,schema:$,parentSchema:Y,data:J,errsCount:X,it:H}=Q;if(!X)throw Error("ajv implementation error");let{allErrors:G,opts:B}=H;if(H.props=!0,B.removeAdditional!=="all"&&(0,qQ.alwaysValidSchema)(H,$))return;let K=(0,LQ.allSchemaProperties)(Y.properties),V=(0,LQ.allSchemaProperties)(Y.patternProperties);L(),Q.ok(M1._`${X} === ${Cw.default.errors}`);function L(){W.forIn("key",J,(O)=>{if(!K.length&&!V.length)A(O);else W.if(U(O),()=>A(O))})}function U(O){let w;if(K.length>8){let j=(0,qQ.schemaRefOrVal)(H,Y.properties,"properties");w=(0,LQ.isOwnProperty)(W,j,O)}else if(K.length)w=(0,M1.or)(...K.map((j)=>M1._`${O} === ${j}`));else w=M1.nil;if(V.length)w=(0,M1.or)(w,...V.map((j)=>M1._`${(0,LQ.usePattern)(Q,j)}.test(${O})`));return(0,M1.not)(w)}function q(O){W.code(M1._`delete ${J}[${O}]`)}function A(O){if(B.removeAdditional==="all"||B.removeAdditional&&$===!1){q(O);return}if($===!1){if(Q.setParams({additionalProperty:O}),Q.error(),!G)W.break();return}if(typeof $=="object"&&!(0,qQ.alwaysValidSchema)(H,$)){let w=W.name("valid");if(B.removeAdditional==="failing")D(O,w,!1),W.if((0,M1.not)(w),()=>{Q.reset(),q(O)});else if(D(O,w),!G)W.if((0,M1.not)(w),()=>W.break())}}function D(O,w,j){let z={keyword:"additionalProperties",dataProp:O,dataPropType:qQ.Type.Str};if(j===!1)Object.assign(z,{compositeRule:!0,createErrors:!1,allErrors:!1});Q.subschema(z,w)}}};R5.default=vw});var TG=Z((I5)=>{Object.defineProperty(I5,"__esModule",{value:!0});var Tw=U9(),ZG=X1(),S5=W0(),vG=b5(),kw={keyword:"properties",type:"object",schemaType:"object",code(Q){let{gen:W,schema:$,parentSchema:Y,data:J,it:X}=Q;if(X.opts.removeAdditional==="all"&&Y.additionalProperties===void 0)vG.default.code(new Tw.KeywordCxt(X,vG.default,"additionalProperties"));let H=(0,ZG.allSchemaProperties)($);for(let L of H)X.definedProperties.add(L);if(X.opts.unevaluated&&H.length&&X.props!==!0)X.props=S5.mergeEvaluated.props(W,(0,S5.toHash)(H),X.props);let G=H.filter((L)=>!(0,S5.alwaysValidSchema)(X,$[L]));if(G.length===0)return;let B=W.name("valid");for(let L of G){if(K(L))V(L);else{if(W.if((0,ZG.propertyInData)(W,J,L,X.opts.ownProperties)),V(L),!X.allErrors)W.else().var(B,!0);W.endIf()}Q.it.definedProperties.add(L),Q.ok(B)}function K(L){return X.opts.useDefaults&&!X.compositeRule&&$[L].default!==void 0}function V(L){Q.subschema({keyword:"properties",schemaProp:L,dataProp:L},B)}}};I5.default=kw});var yG=Z((C5)=>{Object.defineProperty(C5,"__esModule",{value:!0});var kG=X1(),UQ=p(),_G=W0(),xG=W0(),_w={keyword:"patternProperties",type:"object",schemaType:"object",code(Q){let{gen:W,schema:$,data:Y,parentSchema:J,it:X}=Q,{opts:H}=X,G=(0,kG.allSchemaProperties)($),B=G.filter((D)=>(0,_G.alwaysValidSchema)(X,$[D]));if(G.length===0||B.length===G.length&&(!X.opts.unevaluated||X.props===!0))return;let K=H.strictSchema&&!H.allowMatchingProperties&&J.properties,V=W.name("valid");if(X.props!==!0&&!(X.props instanceof UQ.Name))X.props=(0,xG.evaluatedPropsToName)(W,X.props);let{props:L}=X;U();function U(){for(let D of G){if(K)q(D);if(X.allErrors)A(D);else W.var(V,!0),A(D),W.if(V)}}function q(D){for(let O in K)if(new RegExp(D).test(O))(0,_G.checkStrictMode)(X,`property ${O} matches pattern ${D} (use allowMatchingProperties)`)}function A(D){W.forIn("key",Y,(O)=>{W.if(UQ._`${(0,kG.usePattern)(Q,D)}.test(${O})`,()=>{let w=B.includes(D);if(!w)Q.subschema({keyword:"patternProperties",schemaProp:D,dataProp:O,dataPropType:xG.Type.Str},V);if(X.opts.unevaluated&&L!==!0)W.assign(UQ._`${L}[${O}]`,!0);else if(!w&&!X.allErrors)W.if((0,UQ.not)(V),()=>W.break())})})}}};C5.default=_w});var gG=Z((Z5)=>{Object.defineProperty(Z5,"__esModule",{value:!0});var xw=W0(),yw={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(Q){let{gen:W,schema:$,it:Y}=Q;if((0,xw.alwaysValidSchema)(Y,$)){Q.fail();return}let J=W.name("valid");Q.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},J),Q.failResult(J,()=>Q.reset(),()=>Q.error())},error:{message:"must NOT be valid"}};Z5.default=yw});var hG=Z((v5)=>{Object.defineProperty(v5,"__esModule",{value:!0});var gw=X1(),hw={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:gw.validateUnion,error:{message:"must match a schema in anyOf"}};v5.default=hw});var fG=Z((T5)=>{Object.defineProperty(T5,"__esModule",{value:!0});var AQ=p(),fw=W0(),uw={message:"must match exactly one schema in oneOf",params:({params:Q})=>AQ._`{passingSchemas: ${Q.passing}}`},lw={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:uw,code(Q){let{gen:W,schema:$,parentSchema:Y,it:J}=Q;if(!Array.isArray($))throw Error("ajv implementation error");if(J.opts.discriminator&&Y.discriminator)return;let X=$,H=W.let("valid",!1),G=W.let("passing",null),B=W.name("_valid");Q.setParams({passing:G}),W.block(K),Q.result(H,()=>Q.reset(),()=>Q.error(!0));function K(){X.forEach((V,L)=>{let U;if((0,fw.alwaysValidSchema)(J,V))W.var(B,!0);else U=Q.subschema({keyword:"oneOf",schemaProp:L,compositeRule:!0},B);if(L>0)W.if(AQ._`${B} && ${H}`).assign(H,!1).assign(G,AQ._`[${G}, ${L}]`).else();W.if(B,()=>{if(W.assign(H,!0),W.assign(G,L),U)Q.mergeEvaluated(U,AQ.Name)})})}}};T5.default=lw});var uG=Z((k5)=>{Object.defineProperty(k5,"__esModule",{value:!0});var mw=W0(),cw={keyword:"allOf",schemaType:"array",code(Q){let{gen:W,schema:$,it:Y}=Q;if(!Array.isArray($))throw Error("ajv implementation error");let J=W.name("valid");$.forEach((X,H)=>{if((0,mw.alwaysValidSchema)(Y,X))return;let G=Q.subschema({keyword:"allOf",schemaProp:H},J);Q.ok(J),Q.mergeEvaluated(G)})}};k5.default=cw});var cG=Z((_5)=>{Object.defineProperty(_5,"__esModule",{value:!0});var DQ=p(),mG=W0(),pw={message:({params:Q})=>DQ.str`must match "${Q.ifClause}" schema`,params:({params:Q})=>DQ._`{failingKeyword: ${Q.ifClause}}`},dw={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:pw,code(Q){let{gen:W,parentSchema:$,it:Y}=Q;if($.then===void 0&&$.else===void 0)(0,mG.checkStrictMode)(Y,'"if" without "then" and "else" is ignored');let J=lG(Y,"then"),X=lG(Y,"else");if(!J&&!X)return;let H=W.let("valid",!0),G=W.name("_valid");if(B(),Q.reset(),J&&X){let V=W.let("ifClause");Q.setParams({ifClause:V}),W.if(G,K("then",V),K("else",V))}else if(J)W.if(G,K("then"));else W.if((0,DQ.not)(G),K("else"));Q.pass(H,()=>Q.error(!0));function B(){let V=Q.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},G);Q.mergeEvaluated(V)}function K(V,L){return()=>{let U=Q.subschema({keyword:V},G);if(W.assign(H,G),Q.mergeValidEvaluated(U,H),L)W.assign(L,DQ._`${V}`);else Q.setParams({ifClause:V})}}}};function lG(Q,W){let $=Q.schema[W];return $!==void 0&&!(0,mG.alwaysValidSchema)(Q,$)}_5.default=dw});var pG=Z((x5)=>{Object.defineProperty(x5,"__esModule",{value:!0});var iw=W0(),nw={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:Q,parentSchema:W,it:$}){if(W.if===void 0)(0,iw.checkStrictMode)($,`"${Q}" without "if" is ignored`)}};x5.default=nw});var dG=Z((y5)=>{Object.defineProperty(y5,"__esModule",{value:!0});var ow=w5(),rw=jG(),aw=N5(),tw=EG(),sw=PG(),ew=SG(),QN=CG(),WN=b5(),$N=TG(),YN=yG(),JN=gG(),XN=hG(),HN=fG(),GN=uG(),BN=cG(),KN=pG();function FN(Q=!1){let W=[JN.default,XN.default,HN.default,GN.default,BN.default,KN.default,QN.default,WN.default,ew.default,$N.default,YN.default];if(Q)W.push(rw.default,tw.default);else W.push(ow.default,aw.default);return W.push(sw.default),W}y5.default=FN});var iG=Z((g5)=>{Object.defineProperty(g5,"__esModule",{value:!0});var j0=p(),VN={message:({schemaCode:Q})=>j0.str`must match format "${Q}"`,params:({schemaCode:Q})=>j0._`{format: ${Q}}`},LN={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:VN,code(Q,W){let{gen:$,data:Y,$data:J,schema:X,schemaCode:H,it:G}=Q,{opts:B,errSchemaPath:K,schemaEnv:V,self:L}=G;if(!B.validateFormats)return;if(J)U();else q();function U(){let A=$.scopeValue("formats",{ref:L.formats,code:B.code.formats}),D=$.const("fDef",j0._`${A}[${H}]`),O=$.let("fType"),w=$.let("format");$.if(j0._`typeof ${D} == "object" && !(${D} instanceof RegExp)`,()=>$.assign(O,j0._`${D}.type || "string"`).assign(w,j0._`${D}.validate`),()=>$.assign(O,j0._`"string"`).assign(w,D)),Q.fail$data((0,j0.or)(j(),z()));function j(){if(B.strictSchema===!1)return j0.nil;return j0._`${H} && !${w}`}function z(){let C=V.$async?j0._`(${D}.async ? await ${w}(${Y}) : ${w}(${Y}))`:j0._`${w}(${Y})`,S=j0._`(typeof ${w} == "function" ? ${C} : ${w}.test(${Y}))`;return j0._`${w} && ${w} !== true && ${O} === ${W} && !${S}`}}function q(){let A=L.formats[X];if(!A){j();return}if(A===!0)return;let[D,O,w]=z(A);if(D===W)Q.pass(C());function j(){if(B.strictSchema===!1){L.logger.warn(S());return}throw Error(S());function S(){return`unknown format "${X}" ignored in schema at path "${K}"`}}function z(S){let D0=S instanceof RegExp?(0,j0.regexpCode)(S):B.code.formats?j0._`${B.code.formats}${(0,j0.getProperty)(X)}`:void 0,b0=$.scopeValue("formats",{key:X,ref:S,code:D0});if(typeof S=="object"&&!(S instanceof RegExp))return[S.type||"string",S.validate,j0._`${b0}.validate`];return["string",S,b0]}function C(){if(typeof A=="object"&&!(A instanceof RegExp)&&A.async){if(!V.$async)throw Error("async format in sync schema");return j0._`await ${w}(${Y})`}return typeof O=="function"?j0._`${w}(${Y})`:j0._`${w}.test(${Y})`}}}};g5.default=LN});var nG=Z((h5)=>{Object.defineProperty(h5,"__esModule",{value:!0});var qN=iG(),UN=[qN.default];h5.default=UN});var oG=Z((j4)=>{Object.defineProperty(j4,"__esModule",{value:!0});j4.contentVocabulary=j4.metadataVocabulary=void 0;j4.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];j4.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var aG=Z((f5)=>{Object.defineProperty(f5,"__esModule",{value:!0});var AN=YG(),DN=OG(),ON=dG(),wN=nG(),rG=oG(),NN=[AN.default,DN.default,(0,ON.default)(),wN.default,rG.metadataVocabulary,rG.contentVocabulary];f5.default=NN});var sG=Z((OQ)=>{Object.defineProperty(OQ,"__esModule",{value:!0});OQ.DiscrError=void 0;var tG;(function(Q){Q.Tag="tag",Q.Mapping="mapping"})(tG||(OQ.DiscrError=tG={}))});var QB=Z((l5)=>{Object.defineProperty(l5,"__esModule",{value:!0});var z4=p(),u5=sG(),eG=t8(),MN=A9(),jN=W0(),zN={message:({params:{discrError:Q,tagName:W}})=>Q===u5.DiscrError.Tag?`tag "${W}" must be string`:`value of tag "${W}" must be in oneOf`,params:({params:{discrError:Q,tag:W,tagName:$}})=>z4._`{error: ${Q}, tag: ${$}, tagValue: ${W}}`},EN={keyword:"discriminator",type:"object",schemaType:"object",error:zN,code(Q){let{gen:W,data:$,schema:Y,parentSchema:J,it:X}=Q,{oneOf:H}=J;if(!X.opts.discriminator)throw Error("discriminator: requires discriminator option");let G=Y.propertyName;if(typeof G!="string")throw Error("discriminator: requires propertyName");if(Y.mapping)throw Error("discriminator: mapping is not supported");if(!H)throw Error("discriminator: requires oneOf keyword");let B=W.let("valid",!1),K=W.const("tag",z4._`${$}${(0,z4.getProperty)(G)}`);W.if(z4._`typeof ${K} == "string"`,()=>V(),()=>Q.error(!1,{discrError:u5.DiscrError.Tag,tag:K,tagName:G})),Q.ok(B);function V(){let q=U();W.if(!1);for(let A in q)W.elseIf(z4._`${K} === ${A}`),W.assign(B,L(q[A]));W.else(),Q.error(!1,{discrError:u5.DiscrError.Mapping,tag:K,tagName:G}),W.endIf()}function L(q){let A=W.name("valid"),D=Q.subschema({keyword:"oneOf",schemaProp:q},A);return Q.mergeEvaluated(D,z4.Name),A}function U(){var q;let A={},D=w(J),O=!0;for(let C=0;C<H.length;C++){let S=H[C];if((S===null||S===void 0?void 0:S.$ref)&&!(0,jN.schemaHasRulesButRef)(S,X.self.RULES)){let b0=S.$ref;if(S=eG.resolveRef.call(X.self,X.schemaEnv.root,X.baseId,b0),S instanceof eG.SchemaEnv)S=S.schema;if(S===void 0)throw new MN.default(X.opts.uriResolver,X.baseId,b0)}let D0=(q=S===null||S===void 0?void 0:S.properties)===null||q===void 0?void 0:q[G];if(typeof D0!="object")throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${G}"`);O=O&&(D||w(S)),j(D0,C)}if(!O)throw Error(`discriminator: "${G}" must be required`);return A;function w({required:C}){return Array.isArray(C)&&C.includes(G)}function j(C,S){if(C.const)z(C.const,S);else if(C.enum)for(let D0 of C.enum)z(D0,S);else throw Error(`discriminator: "properties/${G}" must have "const" or "enum"`)}function z(C,S){if(typeof C!="string"||C in A)throw Error(`discriminator: "${G}" values must be unique strings`);A[C]=S}}}};l5.default=EN});var WB=Z((Rb,PN)=>{PN.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var c5=Z((V0,m5)=>{Object.defineProperty(V0,"__esModule",{value:!0});V0.MissingRefError=V0.ValidationError=V0.CodeGen=V0.Name=V0.nil=V0.stringify=V0.str=V0._=V0.KeywordCxt=V0.Ajv=void 0;var RN=tH(),bN=aG(),SN=QB(),$B=WB(),IN=["/properties"],wQ="http://json-schema.org/draft-07/schema";class C9 extends RN.default{_addVocabularies(){if(super._addVocabularies(),bN.default.forEach((Q)=>this.addVocabulary(Q)),this.opts.discriminator)this.addKeyword(SN.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let Q=this.opts.$data?this.$dataMetaSchema($B,IN):$B;this.addMetaSchema(Q,wQ,!1),this.refs["http://json-schema.org/schema"]=wQ}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(wQ)?wQ:void 0)}}V0.Ajv=C9;m5.exports=V0=C9;m5.exports.Ajv=C9;Object.defineProperty(V0,"__esModule",{value:!0});V0.default=C9;var CN=U9();Object.defineProperty(V0,"KeywordCxt",{enumerable:!0,get:function(){return CN.KeywordCxt}});var E4=p();Object.defineProperty(V0,"_",{enumerable:!0,get:function(){return E4._}});Object.defineProperty(V0,"str",{enumerable:!0,get:function(){return E4.str}});Object.defineProperty(V0,"stringify",{enumerable:!0,get:function(){return E4.stringify}});Object.defineProperty(V0,"nil",{enumerable:!0,get:function(){return E4.nil}});Object.defineProperty(V0,"Name",{enumerable:!0,get:function(){return E4.Name}});Object.defineProperty(V0,"CodeGen",{enumerable:!0,get:function(){return E4.CodeGen}});var ZN=r8();Object.defineProperty(V0,"ValidationError",{enumerable:!0,get:function(){return ZN.default}});var vN=A9();Object.defineProperty(V0,"MissingRefError",{enumerable:!0,get:function(){return vN.default}})});var FB=Z((T1)=>{Object.defineProperty(T1,"__esModule",{value:!0});T1.formatNames=T1.fastFormats=T1.fullFormats=void 0;function v1(Q,W){return{validate:Q,compare:W}}T1.fullFormats={date:v1(HB,n5),time:v1(d5(!0),o5),"date-time":v1(YB(!0),BB),"iso-time":v1(d5(),GB),"iso-date-time":v1(YB(),KB),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:gN,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:pN,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:hN,int32:{type:"number",validate:lN},int64:{type:"number",validate:mN},float:{type:"number",validate:XB},double:{type:"number",validate:XB},password:!0,binary:!0};T1.fastFormats={...T1.fullFormats,date:v1(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,n5),time:v1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,o5),"date-time":v1(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,BB),"iso-time":v1(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,GB),"iso-date-time":v1(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,KB),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};T1.formatNames=Object.keys(T1.fullFormats);function TN(Q){return Q%4===0&&(Q%100!==0||Q%400===0)}var kN=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,_N=[0,31,28,31,30,31,30,31,31,30,31,30,31];function HB(Q){let W=kN.exec(Q);if(!W)return!1;let $=+W[1],Y=+W[2],J=+W[3];return Y>=1&&Y<=12&&J>=1&&J<=(Y===2&&TN($)?29:_N[Y])}function n5(Q,W){if(!(Q&&W))return;if(Q>W)return 1;if(Q<W)return-1;return 0}var p5=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function d5(Q){return function($){let Y=p5.exec($);if(!Y)return!1;let J=+Y[1],X=+Y[2],H=+Y[3],G=Y[4],B=Y[5]==="-"?-1:1,K=+(Y[6]||0),V=+(Y[7]||0);if(K>23||V>59||Q&&!G)return!1;if(J<=23&&X<=59&&H<60)return!0;let L=X-V*B,U=J-K*B-(L<0?1:0);return(U===23||U===-1)&&(L===59||L===-1)&&H<61}}function o5(Q,W){if(!(Q&&W))return;let $=new Date("2020-01-01T"+Q).valueOf(),Y=new Date("2020-01-01T"+W).valueOf();if(!($&&Y))return;return $-Y}function GB(Q,W){if(!(Q&&W))return;let $=p5.exec(Q),Y=p5.exec(W);if(!($&&Y))return;if(Q=$[1]+$[2]+$[3],W=Y[1]+Y[2]+Y[3],Q>W)return 1;if(Q<W)return-1;return 0}var i5=/t|\s/i;function YB(Q){let W=d5(Q);return function(Y){let J=Y.split(i5);return J.length===2&&HB(J[0])&&W(J[1])}}function BB(Q,W){if(!(Q&&W))return;let $=new Date(Q).valueOf(),Y=new Date(W).valueOf();if(!($&&Y))return;return $-Y}function KB(Q,W){if(!(Q&&W))return;let[$,Y]=Q.split(i5),[J,X]=W.split(i5),H=n5($,J);if(H===void 0)return;return H||o5(Y,X)}var xN=/\/|:/,yN=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function gN(Q){return xN.test(Q)&&yN.test(Q)}var JB=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function hN(Q){return JB.lastIndex=0,JB.test(Q)}var fN=-2147483648,uN=2147483647;function lN(Q){return Number.isInteger(Q)&&Q<=uN&&Q>=fN}function mN(Q){return Number.isInteger(Q)}function XB(){return!0}var cN=/[^\\]\\Z/;function pN(Q){if(cN.test(Q))return!1;try{return new RegExp(Q),!0}catch(W){return!1}}});var VB=Z((P4)=>{Object.defineProperty(P4,"__esModule",{value:!0});P4.formatLimitDefinition=void 0;var dN=c5(),j1=p(),q6=j1.operators,NQ={formatMaximum:{okStr:"<=",ok:q6.LTE,fail:q6.GT},formatMinimum:{okStr:">=",ok:q6.GTE,fail:q6.LT},formatExclusiveMaximum:{okStr:"<",ok:q6.LT,fail:q6.GTE},formatExclusiveMinimum:{okStr:">",ok:q6.GT,fail:q6.LTE}},iN={message:({keyword:Q,schemaCode:W})=>j1.str`should be ${NQ[Q].okStr} ${W}`,params:({keyword:Q,schemaCode:W})=>j1._`{comparison: ${NQ[Q].okStr}, limit: ${W}}`};P4.formatLimitDefinition={keyword:Object.keys(NQ),type:"string",schemaType:"string",$data:!0,error:iN,code(Q){let{gen:W,data:$,schemaCode:Y,keyword:J,it:X}=Q,{opts:H,self:G}=X;if(!H.validateFormats)return;let B=new dN.KeywordCxt(X,G.RULES.all.format.definition,"format");if(B.$data)K();else V();function K(){let U=W.scopeValue("formats",{ref:G.formats,code:H.code.formats}),q=W.const("fmt",j1._`${U}[${B.schemaCode}]`);Q.fail$data((0,j1.or)(j1._`typeof ${q} != "object"`,j1._`${q} instanceof RegExp`,j1._`typeof ${q}.compare != "function"`,L(q)))}function V(){let U=B.schema,q=G.formats[U];if(!q||q===!0)return;if(typeof q!="object"||q instanceof RegExp||typeof q.compare!="function")throw Error(`"${J}": format "${U}" does not define "compare" function`);let A=W.scopeValue("formats",{key:U,ref:q,code:H.code.formats?j1._`${H.code.formats}${(0,j1.getProperty)(U)}`:void 0});Q.fail$data(L(A))}function L(U){return j1._`${U}.compare(${$}, ${Y}) ${NQ[J].fail} 0`}},dependencies:["format"]};var nN=(Q)=>{return Q.addKeyword(P4.formatLimitDefinition),Q};P4.default=nN});var AB=Z((Z9,UB)=>{Object.defineProperty(Z9,"__esModule",{value:!0});var R4=FB(),oN=VB(),r5=p(),LB=new r5.Name("fullFormats"),rN=new r5.Name("fastFormats"),a5=(Q,W={keywords:!0})=>{if(Array.isArray(W))return qB(Q,W,R4.fullFormats,LB),Q;let[$,Y]=W.mode==="fast"?[R4.fastFormats,rN]:[R4.fullFormats,LB],J=W.formats||R4.formatNames;if(qB(Q,J,$,Y),W.keywords)(0,oN.default)(Q);return Q};a5.get=(Q,W="full")=>{let Y=(W==="fast"?R4.fastFormats:R4.fullFormats)[Q];if(!Y)throw Error(`Unknown format "${Q}"`);return Y};function qB(Q,W,$,Y){var J,X;(J=(X=Q.opts.code).formats)!==null&&J!==void 0||(X.formats=r5._`require("ajv-formats/dist/formats").${Y}`);for(let H of W)Q.addFormat(H,$[H])}UB.exports=Z9=a5;Object.defineProperty(Z9,"__esModule",{value:!0});Z9.default=a5});var z7={name:"blockbench-mcp",version:"1.4.0",description:"Blockbench MCP server plugin",keywords:["Blockbench","MCP"],license:"GPL-3.0-only",author:"Jason J. Gardner",type:"module",main:"dist/mcp.js",scripts:{test:'echo "Error: no test specified" && exit 1',dev:"bun run ./build.ts --sourcemap","dev:watch":"bun run dev --watch",build:"bun run ./build.ts --minify",inspect:"bunx @modelcontextprotocol/inspector"},dependencies:{zod:"^3.25.76"},devDependencies:{"@types/express":"^5.0.6","blockbench-types":"^5.0.6",typescript:"^5.9.3","@modelcontextprotocol/sdk":"^1.25.1","@types/bun":"^1.3.5",tinycolor2:"^1.6.0"}};var u6=z7.version,K0="stable",g="experimental";var F={};ZQ(F,{void:()=>iK,util:()=>o,unknown:()=>pK,union:()=>rK,undefined:()=>lK,tuple:()=>sK,transformer:()=>BF,symbol:()=>uK,string:()=>v7,strictObject:()=>oK,setErrorMap:()=>VK,set:()=>WF,record:()=>eK,quotelessJson:()=>KK,promise:()=>GF,preprocess:()=>VF,pipeline:()=>LF,ostring:()=>qF,optional:()=>KF,onumber:()=>UF,oboolean:()=>AF,objectUtil:()=>vQ,object:()=>_Q,number:()=>T7,nullable:()=>FF,null:()=>mK,never:()=>dK,nativeEnum:()=>HF,nan:()=>gK,map:()=>QF,makeIssue:()=>Z4,literal:()=>JF,lazy:()=>YF,late:()=>xK,isValid:()=>d1,isDirty:()=>h9,isAsync:()=>m6,isAborted:()=>g9,intersection:()=>tK,instanceof:()=>yK,getParsedType:()=>E1,getErrorMap:()=>l6,function:()=>$F,enum:()=>XF,effect:()=>BF,discriminatedUnion:()=>aK,defaultErrorMap:()=>_1,datetimeRegex:()=>I7,date:()=>fK,custom:()=>Z7,coerce:()=>DF,boolean:()=>k7,bigint:()=>hK,array:()=>nK,any:()=>cK,addIssueToContext:()=>b,ZodVoid:()=>T4,ZodUnknown:()=>i1,ZodUnion:()=>o6,ZodUndefined:()=>i6,ZodType:()=>d,ZodTuple:()=>R1,ZodTransformer:()=>L1,ZodSymbol:()=>v4,ZodString:()=>K1,ZodSet:()=>w6,ZodSchema:()=>d,ZodRecord:()=>k4,ZodReadonly:()=>W4,ZodPromise:()=>N6,ZodPipeline:()=>y4,ZodParsedType:()=>R,ZodOptional:()=>t0,ZodObject:()=>O0,ZodNumber:()=>n1,ZodNullable:()=>y1,ZodNull:()=>n6,ZodNever:()=>P1,ZodNativeEnum:()=>s6,ZodNaN:()=>x4,ZodMap:()=>_4,ZodLiteral:()=>t6,ZodLazy:()=>a6,ZodIssueCode:()=>E,ZodIntersection:()=>r6,ZodFunction:()=>p6,ZodFirstPartyTypeKind:()=>P,ZodError:()=>p0,ZodEnum:()=>r1,ZodEffects:()=>L1,ZodDiscriminatedUnion:()=>f9,ZodDefault:()=>e6,ZodDate:()=>D6,ZodCatch:()=>Q4,ZodBranded:()=>u9,ZodBoolean:()=>d6,ZodBigInt:()=>o1,ZodArray:()=>F1,ZodAny:()=>O6,Schema:()=>d,ParseStatus:()=>S0,OK:()=>_0,NEVER:()=>OF,INVALID:()=>h,EMPTY_PATH:()=>LK,DIRTY:()=>A6,BRAND:()=>_K});var o;(function(Q){Q.assertEqual=(J)=>{};function W(J){}Q.assertIs=W;function $(J){throw Error()}Q.assertNever=$,Q.arrayToEnum=(J)=>{let X={};for(let H of J)X[H]=H;return X},Q.getValidEnumValues=(J)=>{let X=Q.objectKeys(J).filter((G)=>typeof J[J[G]]!=="number"),H={};for(let G of X)H[G]=J[G];return Q.objectValues(H)},Q.objectValues=(J)=>{return Q.objectKeys(J).map(function(X){return J[X]})},Q.objectKeys=typeof Object.keys==="function"?(J)=>Object.keys(J):(J)=>{let X=[];for(let H in J)if(Object.prototype.hasOwnProperty.call(J,H))X.push(H);return X},Q.find=(J,X)=>{for(let H of J)if(X(H))return H;return},Q.isInteger=typeof Number.isInteger==="function"?(J)=>Number.isInteger(J):(J)=>typeof J==="number"&&Number.isFinite(J)&&Math.floor(J)===J;function Y(J,X=" | "){return J.map((H)=>typeof H==="string"?`'${H}'`:H).join(X)}Q.joinValues=Y,Q.jsonStringifyReplacer=(J,X)=>{if(typeof X==="bigint")return X.toString();return X}})(o||(o={}));var vQ;(function(Q){Q.mergeShapes=(W,$)=>{return{...W,...$}}})(vQ||(vQ={}));var R=o.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),E1=(Q)=>{switch(typeof Q){case"undefined":return R.undefined;case"string":return R.string;case"number":return Number.isNaN(Q)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":if(Array.isArray(Q))return R.array;if(Q===null)return R.null;if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return R.promise;if(typeof Map<"u"&&Q instanceof Map)return R.map;if(typeof Set<"u"&&Q instanceof Set)return R.set;if(typeof Date<"u"&&Q instanceof Date)return R.date;return R.object;default:return R.unknown}};var E=o.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),KK=(Q)=>{return JSON.stringify(Q,null,2).replace(/"([^"]+)":/g,"$1:")};class p0 extends Error{get errors(){return this.issues}constructor(Q){super();this.issues=[],this.addIssue=($)=>{this.issues=[...this.issues,$]},this.addIssues=($=[])=>{this.issues=[...this.issues,...$]};let W=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,W);else this.__proto__=W;this.name="ZodError",this.issues=Q}format(Q){let W=Q||function(J){return J.message},$={_errors:[]},Y=(J)=>{for(let X of J.issues)if(X.code==="invalid_union")X.unionErrors.map(Y);else if(X.code==="invalid_return_type")Y(X.returnTypeError);else if(X.code==="invalid_arguments")Y(X.argumentsError);else if(X.path.length===0)$._errors.push(W(X));else{let H=$,G=0;while(G<X.path.length){let B=X.path[G];if(G!==X.path.length-1)H[B]=H[B]||{_errors:[]};else H[B]=H[B]||{_errors:[]},H[B]._errors.push(W(X));H=H[B],G++}}};return Y(this),$}static assert(Q){if(!(Q instanceof p0))throw Error(`Not a ZodError: ${Q}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,o.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(Q=(W)=>W.message){let W={},$=[];for(let Y of this.issues)if(Y.path.length>0){let J=Y.path[0];W[J]=W[J]||[],W[J].push(Q(Y))}else $.push(Q(Y));return{formErrors:$,fieldErrors:W}}get formErrors(){return this.flatten()}}p0.create=(Q)=>{return new p0(Q)};var FK=(Q,W)=>{let $;switch(Q.code){case E.invalid_type:if(Q.received===R.undefined)$="Required";else $=`Expected ${Q.expected}, received ${Q.received}`;break;case E.invalid_literal:$=`Invalid literal value, expected ${JSON.stringify(Q.expected,o.jsonStringifyReplacer)}`;break;case E.unrecognized_keys:$=`Unrecognized key(s) in object: ${o.joinValues(Q.keys,", ")}`;break;case E.invalid_union:$="Invalid input";break;case E.invalid_union_discriminator:$=`Invalid discriminator value. Expected ${o.joinValues(Q.options)}`;break;case E.invalid_enum_value:$=`Invalid enum value. Expected ${o.joinValues(Q.options)}, received '${Q.received}'`;break;case E.invalid_arguments:$="Invalid function arguments";break;case E.invalid_return_type:$="Invalid function return type";break;case E.invalid_date:$="Invalid date";break;case E.invalid_string:if(typeof Q.validation==="object")if("includes"in Q.validation){if($=`Invalid input: must include "${Q.validation.includes}"`,typeof Q.validation.position==="number")$=`${$} at one or more positions greater than or equal to ${Q.validation.position}`}else if("startsWith"in Q.validation)$=`Invalid input: must start with "${Q.validation.startsWith}"`;else if("endsWith"in Q.validation)$=`Invalid input: must end with "${Q.validation.endsWith}"`;else o.assertNever(Q.validation);else if(Q.validation!=="regex")$=`Invalid ${Q.validation}`;else $="Invalid";break;case E.too_small:if(Q.type==="array")$=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at least":"more than"} ${Q.minimum} element(s)`;else if(Q.type==="string")$=`String must contain ${Q.exact?"exactly":Q.inclusive?"at least":"over"} ${Q.minimum} character(s)`;else if(Q.type==="number")$=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="bigint")$=`Number must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${Q.minimum}`;else if(Q.type==="date")$=`Date must be ${Q.exact?"exactly equal to ":Q.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(Q.minimum))}`;else $="Invalid input";break;case E.too_big:if(Q.type==="array")$=`Array must contain ${Q.exact?"exactly":Q.inclusive?"at most":"less than"} ${Q.maximum} element(s)`;else if(Q.type==="string")$=`String must contain ${Q.exact?"exactly":Q.inclusive?"at most":"under"} ${Q.maximum} character(s)`;else if(Q.type==="number")$=`Number must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="bigint")$=`BigInt must be ${Q.exact?"exactly":Q.inclusive?"less than or equal to":"less than"} ${Q.maximum}`;else if(Q.type==="date")$=`Date must be ${Q.exact?"exactly":Q.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(Q.maximum))}`;else $="Invalid input";break;case E.custom:$="Invalid input";break;case E.invalid_intersection_types:$="Intersection results could not be merged";break;case E.not_multiple_of:$=`Number must be a multiple of ${Q.multipleOf}`;break;case E.not_finite:$="Number must be finite";break;default:$=W.defaultError,o.assertNever(Q)}return{message:$}},_1=FK;var E7=_1;function VK(Q){E7=Q}function l6(){return E7}var Z4=(Q)=>{let{data:W,path:$,errorMaps:Y,issueData:J}=Q,X=[...$,...J.path||[]],H={...J,path:X};if(J.message!==void 0)return{...J,path:X,message:J.message};let G="",B=Y.filter((K)=>!!K).slice().reverse();for(let K of B)G=K(H,{data:W,defaultError:G}).message;return{...J,path:X,message:G}},LK=[];function b(Q,W){let $=l6(),Y=Z4({issueData:W,data:Q.data,path:Q.path,errorMaps:[Q.common.contextualErrorMap,Q.schemaErrorMap,$,$===_1?void 0:_1].filter((J)=>!!J)});Q.common.issues.push(Y)}class S0{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray(Q,W){let $=[];for(let Y of W){if(Y.status==="aborted")return h;if(Y.status==="dirty")Q.dirty();$.push(Y.value)}return{status:Q.value,value:$}}static async mergeObjectAsync(Q,W){let $=[];for(let Y of W){let J=await Y.key,X=await Y.value;$.push({key:J,value:X})}return S0.mergeObjectSync(Q,$)}static mergeObjectSync(Q,W){let $={};for(let Y of W){let{key:J,value:X}=Y;if(J.status==="aborted")return h;if(X.status==="aborted")return h;if(J.status==="dirty")Q.dirty();if(X.status==="dirty")Q.dirty();if(J.value!=="__proto__"&&(typeof X.value<"u"||Y.alwaysSet))$[J.value]=X.value}return{status:Q.value,value:$}}}var h=Object.freeze({status:"aborted"}),A6=(Q)=>({status:"dirty",value:Q}),_0=(Q)=>({status:"valid",value:Q}),g9=(Q)=>Q.status==="aborted",h9=(Q)=>Q.status==="dirty",d1=(Q)=>Q.status==="valid",m6=(Q)=>typeof Promise<"u"&&Q instanceof Promise;var T;(function(Q){Q.errToObj=(W)=>typeof W==="string"?{message:W}:W||{},Q.toString=(W)=>typeof W==="string"?W:W?.message})(T||(T={}));class V1{constructor(Q,W,$,Y){this._cachedPath=[],this.parent=Q,this.data=W,this._path=$,this._key=Y}get path(){if(!this._cachedPath.length)if(Array.isArray(this._key))this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var P7=(Q,W)=>{if(d1(W))return{success:!0,data:W.value};else{if(!Q.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let $=new p0(Q.common.issues);return this._error=$,this._error}}}};function m(Q){if(!Q)return{};let{errorMap:W,invalid_type_error:$,required_error:Y,description:J}=Q;if(W&&($||Y))throw Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(W)return{errorMap:W,description:J};return{errorMap:(H,G)=>{let{message:B}=Q;if(H.code==="invalid_enum_value")return{message:B??G.defaultError};if(typeof G.data>"u")return{message:B??Y??G.defaultError};if(H.code!=="invalid_type")return{message:G.defaultError};return{message:B??$??G.defaultError}},description:J}}class d{get description(){return this._def.description}_getType(Q){return E1(Q.data)}_getOrReturnCtx(Q,W){return W||{common:Q.parent.common,data:Q.data,parsedType:E1(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}_processInputParams(Q){return{status:new S0,ctx:{common:Q.parent.common,data:Q.data,parsedType:E1(Q.data),schemaErrorMap:this._def.errorMap,path:Q.path,parent:Q.parent}}}_parseSync(Q){let W=this._parse(Q);if(m6(W))throw Error("Synchronous parse encountered promise.");return W}_parseAsync(Q){let W=this._parse(Q);return Promise.resolve(W)}parse(Q,W){let $=this.safeParse(Q,W);if($.success)return $.data;throw $.error}safeParse(Q,W){let $={common:{issues:[],async:W?.async??!1,contextualErrorMap:W?.errorMap},path:W?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:E1(Q)},Y=this._parseSync({data:Q,path:$.path,parent:$});return P7($,Y)}"~validate"(Q){let W={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:E1(Q)};if(!this["~standard"].async)try{let $=this._parseSync({data:Q,path:[],parent:W});return d1($)?{value:$.value}:{issues:W.common.issues}}catch($){if($?.message?.toLowerCase()?.includes("encountered"))this["~standard"].async=!0;W.common={issues:[],async:!0}}return this._parseAsync({data:Q,path:[],parent:W}).then(($)=>d1($)?{value:$.value}:{issues:W.common.issues})}async parseAsync(Q,W){let $=await this.safeParseAsync(Q,W);if($.success)return $.data;throw $.error}async safeParseAsync(Q,W){let $={common:{issues:[],contextualErrorMap:W?.errorMap,async:!0},path:W?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:Q,parsedType:E1(Q)},Y=this._parse({data:Q,path:$.path,parent:$}),J=await(m6(Y)?Y:Promise.resolve(Y));return P7($,J)}refine(Q,W){let $=(Y)=>{if(typeof W==="string"||typeof W>"u")return{message:W};else if(typeof W==="function")return W(Y);else return W};return this._refinement((Y,J)=>{let X=Q(Y),H=()=>J.addIssue({code:E.custom,...$(Y)});if(typeof Promise<"u"&&X instanceof Promise)return X.then((G)=>{if(!G)return H(),!1;else return!0});if(!X)return H(),!1;else return!0})}refinement(Q,W){return this._refinement(($,Y)=>{if(!Q($))return Y.addIssue(typeof W==="function"?W($,Y):W),!1;else return!0})}_refinement(Q){return new L1({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:Q}})}superRefine(Q){return this._refinement(Q)}constructor(Q){this.spa=this.safeParseAsync,this._def=Q,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:(W)=>this["~validate"](W)}}optional(){return t0.create(this,this._def)}nullable(){return y1.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return F1.create(this)}promise(){return N6.create(this,this._def)}or(Q){return o6.create([this,Q],this._def)}and(Q){return r6.create(this,Q,this._def)}transform(Q){return new L1({...m(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:Q}})}default(Q){let W=typeof Q==="function"?Q:()=>Q;return new e6({...m(this._def),innerType:this,defaultValue:W,typeName:P.ZodDefault})}brand(){return new u9({typeName:P.ZodBranded,type:this,...m(this._def)})}catch(Q){let W=typeof Q==="function"?Q:()=>Q;return new Q4({...m(this._def),innerType:this,catchValue:W,typeName:P.ZodCatch})}describe(Q){return new this.constructor({...this._def,description:Q})}pipe(Q){return y4.create(this,Q)}readonly(){return W4.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var qK=/^c[^\s-]{8,}$/i,UK=/^[0-9a-z]+$/,AK=/^[0-9A-HJKMNP-TV-Z]{26}$/i,DK=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,OK=/^[a-z0-9_-]{21}$/i,wK=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,NK=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,MK=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,jK="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",TQ,zK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,EK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,PK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,RK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bK=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,SK=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,b7="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",IK=new RegExp(`^${b7}$`);function S7(Q){let W="[0-5]\\d";if(Q.precision)W=`${W}\\.\\d{${Q.precision}}`;else if(Q.precision==null)W=`${W}(\\.\\d+)?`;let $=Q.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${W})${$}`}function CK(Q){return new RegExp(`^${S7(Q)}$`)}function I7(Q){let W=`${b7}T${S7(Q)}`,$=[];if($.push(Q.local?"Z?":"Z"),Q.offset)$.push("([+-]\\d{2}:?\\d{2})");return W=`${W}(${$.join("|")})`,new RegExp(`^${W}$`)}function ZK(Q,W){if((W==="v4"||!W)&&zK.test(Q))return!0;if((W==="v6"||!W)&&PK.test(Q))return!0;return!1}function vK(Q,W){if(!wK.test(Q))return!1;try{let[$]=Q.split(".");if(!$)return!1;let Y=$.replace(/-/g,"+").replace(/_/g,"/").padEnd($.length+(4-$.length%4)%4,"="),J=JSON.parse(atob(Y));if(typeof J!=="object"||J===null)return!1;if("typ"in J&&J?.typ!=="JWT")return!1;if(!J.alg)return!1;if(W&&J.alg!==W)return!1;return!0}catch{return!1}}function TK(Q,W){if((W==="v4"||!W)&&EK.test(Q))return!0;if((W==="v6"||!W)&&RK.test(Q))return!0;return!1}class K1 extends d{_parse(Q){if(this._def.coerce)Q.data=String(Q.data);if(this._getType(Q)!==R.string){let J=this._getOrReturnCtx(Q);return b(J,{code:E.invalid_type,expected:R.string,received:J.parsedType}),h}let $=new S0,Y=void 0;for(let J of this._def.checks)if(J.kind==="min"){if(Q.data.length<J.value)Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.too_small,minimum:J.value,type:"string",inclusive:!0,exact:!1,message:J.message}),$.dirty()}else if(J.kind==="max"){if(Q.data.length>J.value)Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.too_big,maximum:J.value,type:"string",inclusive:!0,exact:!1,message:J.message}),$.dirty()}else if(J.kind==="length"){let X=Q.data.length>J.value,H=Q.data.length<J.value;if(X||H){if(Y=this._getOrReturnCtx(Q,Y),X)b(Y,{code:E.too_big,maximum:J.value,type:"string",inclusive:!0,exact:!0,message:J.message});else if(H)b(Y,{code:E.too_small,minimum:J.value,type:"string",inclusive:!0,exact:!0,message:J.message});$.dirty()}}else if(J.kind==="email"){if(!MK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"email",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="emoji"){if(!TQ)TQ=new RegExp(jK,"u");if(!TQ.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"emoji",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="uuid"){if(!DK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"uuid",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="nanoid"){if(!OK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"nanoid",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="cuid"){if(!qK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"cuid",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="cuid2"){if(!UK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"cuid2",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="ulid"){if(!AK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"ulid",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="url")try{new URL(Q.data)}catch{Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"url",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="regex"){if(J.regex.lastIndex=0,!J.regex.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"regex",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="trim")Q.data=Q.data.trim();else if(J.kind==="includes"){if(!Q.data.includes(J.value,J.position))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:{includes:J.value,position:J.position},message:J.message}),$.dirty()}else if(J.kind==="toLowerCase")Q.data=Q.data.toLowerCase();else if(J.kind==="toUpperCase")Q.data=Q.data.toUpperCase();else if(J.kind==="startsWith"){if(!Q.data.startsWith(J.value))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:{startsWith:J.value},message:J.message}),$.dirty()}else if(J.kind==="endsWith"){if(!Q.data.endsWith(J.value))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:{endsWith:J.value},message:J.message}),$.dirty()}else if(J.kind==="datetime"){if(!I7(J).test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:"datetime",message:J.message}),$.dirty()}else if(J.kind==="date"){if(!IK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:"date",message:J.message}),$.dirty()}else if(J.kind==="time"){if(!CK(J).test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.invalid_string,validation:"time",message:J.message}),$.dirty()}else if(J.kind==="duration"){if(!NK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"duration",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="ip"){if(!ZK(Q.data,J.version))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"ip",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="jwt"){if(!vK(Q.data,J.alg))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"jwt",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="cidr"){if(!TK(Q.data,J.version))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"cidr",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="base64"){if(!bK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"base64",code:E.invalid_string,message:J.message}),$.dirty()}else if(J.kind==="base64url"){if(!SK.test(Q.data))Y=this._getOrReturnCtx(Q,Y),b(Y,{validation:"base64url",code:E.invalid_string,message:J.message}),$.dirty()}else o.assertNever(J);return{status:$.value,value:Q.data}}_regex(Q,W,$){return this.refinement((Y)=>Q.test(Y),{validation:W,code:E.invalid_string,...T.errToObj($)})}_addCheck(Q){return new K1({...this._def,checks:[...this._def.checks,Q]})}email(Q){return this._addCheck({kind:"email",...T.errToObj(Q)})}url(Q){return this._addCheck({kind:"url",...T.errToObj(Q)})}emoji(Q){return this._addCheck({kind:"emoji",...T.errToObj(Q)})}uuid(Q){return this._addCheck({kind:"uuid",...T.errToObj(Q)})}nanoid(Q){return this._addCheck({kind:"nanoid",...T.errToObj(Q)})}cuid(Q){return this._addCheck({kind:"cuid",...T.errToObj(Q)})}cuid2(Q){return this._addCheck({kind:"cuid2",...T.errToObj(Q)})}ulid(Q){return this._addCheck({kind:"ulid",...T.errToObj(Q)})}base64(Q){return this._addCheck({kind:"base64",...T.errToObj(Q)})}base64url(Q){return this._addCheck({kind:"base64url",...T.errToObj(Q)})}jwt(Q){return this._addCheck({kind:"jwt",...T.errToObj(Q)})}ip(Q){return this._addCheck({kind:"ip",...T.errToObj(Q)})}cidr(Q){return this._addCheck({kind:"cidr",...T.errToObj(Q)})}datetime(Q){if(typeof Q==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:Q});return this._addCheck({kind:"datetime",precision:typeof Q?.precision>"u"?null:Q?.precision,offset:Q?.offset??!1,local:Q?.local??!1,...T.errToObj(Q?.message)})}date(Q){return this._addCheck({kind:"date",message:Q})}time(Q){if(typeof Q==="string")return this._addCheck({kind:"time",precision:null,message:Q});return this._addCheck({kind:"time",precision:typeof Q?.precision>"u"?null:Q?.precision,...T.errToObj(Q?.message)})}duration(Q){return this._addCheck({kind:"duration",...T.errToObj(Q)})}regex(Q,W){return this._addCheck({kind:"regex",regex:Q,...T.errToObj(W)})}includes(Q,W){return this._addCheck({kind:"includes",value:Q,position:W?.position,...T.errToObj(W?.message)})}startsWith(Q,W){return this._addCheck({kind:"startsWith",value:Q,...T.errToObj(W)})}endsWith(Q,W){return this._addCheck({kind:"endsWith",value:Q,...T.errToObj(W)})}min(Q,W){return this._addCheck({kind:"min",value:Q,...T.errToObj(W)})}max(Q,W){return this._addCheck({kind:"max",value:Q,...T.errToObj(W)})}length(Q,W){return this._addCheck({kind:"length",value:Q,...T.errToObj(W)})}nonempty(Q){return this.min(1,T.errToObj(Q))}trim(){return new K1({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new K1({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new K1({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((Q)=>Q.kind==="datetime")}get isDate(){return!!this._def.checks.find((Q)=>Q.kind==="date")}get isTime(){return!!this._def.checks.find((Q)=>Q.kind==="time")}get isDuration(){return!!this._def.checks.find((Q)=>Q.kind==="duration")}get isEmail(){return!!this._def.checks.find((Q)=>Q.kind==="email")}get isURL(){return!!this._def.checks.find((Q)=>Q.kind==="url")}get isEmoji(){return!!this._def.checks.find((Q)=>Q.kind==="emoji")}get isUUID(){return!!this._def.checks.find((Q)=>Q.kind==="uuid")}get isNANOID(){return!!this._def.checks.find((Q)=>Q.kind==="nanoid")}get isCUID(){return!!this._def.checks.find((Q)=>Q.kind==="cuid")}get isCUID2(){return!!this._def.checks.find((Q)=>Q.kind==="cuid2")}get isULID(){return!!this._def.checks.find((Q)=>Q.kind==="ulid")}get isIP(){return!!this._def.checks.find((Q)=>Q.kind==="ip")}get isCIDR(){return!!this._def.checks.find((Q)=>Q.kind==="cidr")}get isBase64(){return!!this._def.checks.find((Q)=>Q.kind==="base64")}get isBase64url(){return!!this._def.checks.find((Q)=>Q.kind==="base64url")}get minLength(){let Q=null;for(let W of this._def.checks)if(W.kind==="min"){if(Q===null||W.value>Q)Q=W.value}return Q}get maxLength(){let Q=null;for(let W of this._def.checks)if(W.kind==="max"){if(Q===null||W.value<Q)Q=W.value}return Q}}K1.create=(Q)=>{return new K1({checks:[],typeName:P.ZodString,coerce:Q?.coerce??!1,...m(Q)})};function kK(Q,W){let $=(Q.toString().split(".")[1]||"").length,Y=(W.toString().split(".")[1]||"").length,J=$>Y?$:Y,X=Number.parseInt(Q.toFixed(J).replace(".","")),H=Number.parseInt(W.toFixed(J).replace(".",""));return X%H/10**J}class n1 extends d{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(Q){if(this._def.coerce)Q.data=Number(Q.data);if(this._getType(Q)!==R.number){let J=this._getOrReturnCtx(Q);return b(J,{code:E.invalid_type,expected:R.number,received:J.parsedType}),h}let $=void 0,Y=new S0;for(let J of this._def.checks)if(J.kind==="int"){if(!o.isInteger(Q.data))$=this._getOrReturnCtx(Q,$),b($,{code:E.invalid_type,expected:"integer",received:"float",message:J.message}),Y.dirty()}else if(J.kind==="min"){if(J.inclusive?Q.data<J.value:Q.data<=J.value)$=this._getOrReturnCtx(Q,$),b($,{code:E.too_small,minimum:J.value,type:"number",inclusive:J.inclusive,exact:!1,message:J.message}),Y.dirty()}else if(J.kind==="max"){if(J.inclusive?Q.data>J.value:Q.data>=J.value)$=this._getOrReturnCtx(Q,$),b($,{code:E.too_big,maximum:J.value,type:"number",inclusive:J.inclusive,exact:!1,message:J.message}),Y.dirty()}else if(J.kind==="multipleOf"){if(kK(Q.data,J.value)!==0)$=this._getOrReturnCtx(Q,$),b($,{code:E.not_multiple_of,multipleOf:J.value,message:J.message}),Y.dirty()}else if(J.kind==="finite"){if(!Number.isFinite(Q.data))$=this._getOrReturnCtx(Q,$),b($,{code:E.not_finite,message:J.message}),Y.dirty()}else o.assertNever(J);return{status:Y.value,value:Q.data}}gte(Q,W){return this.setLimit("min",Q,!0,T.toString(W))}gt(Q,W){return this.setLimit("min",Q,!1,T.toString(W))}lte(Q,W){return this.setLimit("max",Q,!0,T.toString(W))}lt(Q,W){return this.setLimit("max",Q,!1,T.toString(W))}setLimit(Q,W,$,Y){return new n1({...this._def,checks:[...this._def.checks,{kind:Q,value:W,inclusive:$,message:T.toString(Y)}]})}_addCheck(Q){return new n1({...this._def,checks:[...this._def.checks,Q]})}int(Q){return this._addCheck({kind:"int",message:T.toString(Q)})}positive(Q){return this._addCheck({kind:"min",value:0,inclusive:!1,message:T.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:0,inclusive:!1,message:T.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:0,inclusive:!0,message:T.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:0,inclusive:!0,message:T.toString(Q)})}multipleOf(Q,W){return this._addCheck({kind:"multipleOf",value:Q,message:T.toString(W)})}finite(Q){return this._addCheck({kind:"finite",message:T.toString(Q)})}safe(Q){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:T.toString(Q)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:T.toString(Q)})}get minValue(){let Q=null;for(let W of this._def.checks)if(W.kind==="min"){if(Q===null||W.value>Q)Q=W.value}return Q}get maxValue(){let Q=null;for(let W of this._def.checks)if(W.kind==="max"){if(Q===null||W.value<Q)Q=W.value}return Q}get isInt(){return!!this._def.checks.find((Q)=>Q.kind==="int"||Q.kind==="multipleOf"&&o.isInteger(Q.value))}get isFinite(){let Q=null,W=null;for(let $ of this._def.checks)if($.kind==="finite"||$.kind==="int"||$.kind==="multipleOf")return!0;else if($.kind==="min"){if(W===null||$.value>W)W=$.value}else if($.kind==="max"){if(Q===null||$.value<Q)Q=$.value}return Number.isFinite(W)&&Number.isFinite(Q)}}n1.create=(Q)=>{return new n1({checks:[],typeName:P.ZodNumber,coerce:Q?.coerce||!1,...m(Q)})};class o1 extends d{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse(Q){if(this._def.coerce)try{Q.data=BigInt(Q.data)}catch{return this._getInvalidInput(Q)}if(this._getType(Q)!==R.bigint)return this._getInvalidInput(Q);let $=void 0,Y=new S0;for(let J of this._def.checks)if(J.kind==="min"){if(J.inclusive?Q.data<J.value:Q.data<=J.value)$=this._getOrReturnCtx(Q,$),b($,{code:E.too_small,type:"bigint",minimum:J.value,inclusive:J.inclusive,message:J.message}),Y.dirty()}else if(J.kind==="max"){if(J.inclusive?Q.data>J.value:Q.data>=J.value)$=this._getOrReturnCtx(Q,$),b($,{code:E.too_big,type:"bigint",maximum:J.value,inclusive:J.inclusive,message:J.message}),Y.dirty()}else if(J.kind==="multipleOf"){if(Q.data%J.value!==BigInt(0))$=this._getOrReturnCtx(Q,$),b($,{code:E.not_multiple_of,multipleOf:J.value,message:J.message}),Y.dirty()}else o.assertNever(J);return{status:Y.value,value:Q.data}}_getInvalidInput(Q){let W=this._getOrReturnCtx(Q);return b(W,{code:E.invalid_type,expected:R.bigint,received:W.parsedType}),h}gte(Q,W){return this.setLimit("min",Q,!0,T.toString(W))}gt(Q,W){return this.setLimit("min",Q,!1,T.toString(W))}lte(Q,W){return this.setLimit("max",Q,!0,T.toString(W))}lt(Q,W){return this.setLimit("max",Q,!1,T.toString(W))}setLimit(Q,W,$,Y){return new o1({...this._def,checks:[...this._def.checks,{kind:Q,value:W,inclusive:$,message:T.toString(Y)}]})}_addCheck(Q){return new o1({...this._def,checks:[...this._def.checks,Q]})}positive(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:T.toString(Q)})}negative(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:T.toString(Q)})}nonpositive(Q){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:T.toString(Q)})}nonnegative(Q){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:T.toString(Q)})}multipleOf(Q,W){return this._addCheck({kind:"multipleOf",value:Q,message:T.toString(W)})}get minValue(){let Q=null;for(let W of this._def.checks)if(W.kind==="min"){if(Q===null||W.value>Q)Q=W.value}return Q}get maxValue(){let Q=null;for(let W of this._def.checks)if(W.kind==="max"){if(Q===null||W.value<Q)Q=W.value}return Q}}o1.create=(Q)=>{return new o1({checks:[],typeName:P.ZodBigInt,coerce:Q?.coerce??!1,...m(Q)})};class d6 extends d{_parse(Q){if(this._def.coerce)Q.data=Boolean(Q.data);if(this._getType(Q)!==R.boolean){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.boolean,received:$.parsedType}),h}return _0(Q.data)}}d6.create=(Q)=>{return new d6({typeName:P.ZodBoolean,coerce:Q?.coerce||!1,...m(Q)})};class D6 extends d{_parse(Q){if(this._def.coerce)Q.data=new Date(Q.data);if(this._getType(Q)!==R.date){let J=this._getOrReturnCtx(Q);return b(J,{code:E.invalid_type,expected:R.date,received:J.parsedType}),h}if(Number.isNaN(Q.data.getTime())){let J=this._getOrReturnCtx(Q);return b(J,{code:E.invalid_date}),h}let $=new S0,Y=void 0;for(let J of this._def.checks)if(J.kind==="min"){if(Q.data.getTime()<J.value)Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.too_small,message:J.message,inclusive:!0,exact:!1,minimum:J.value,type:"date"}),$.dirty()}else if(J.kind==="max"){if(Q.data.getTime()>J.value)Y=this._getOrReturnCtx(Q,Y),b(Y,{code:E.too_big,message:J.message,inclusive:!0,exact:!1,maximum:J.value,type:"date"}),$.dirty()}else o.assertNever(J);return{status:$.value,value:new Date(Q.data.getTime())}}_addCheck(Q){return new D6({...this._def,checks:[...this._def.checks,Q]})}min(Q,W){return this._addCheck({kind:"min",value:Q.getTime(),message:T.toString(W)})}max(Q,W){return this._addCheck({kind:"max",value:Q.getTime(),message:T.toString(W)})}get minDate(){let Q=null;for(let W of this._def.checks)if(W.kind==="min"){if(Q===null||W.value>Q)Q=W.value}return Q!=null?new Date(Q):null}get maxDate(){let Q=null;for(let W of this._def.checks)if(W.kind==="max"){if(Q===null||W.value<Q)Q=W.value}return Q!=null?new Date(Q):null}}D6.create=(Q)=>{return new D6({checks:[],coerce:Q?.coerce||!1,typeName:P.ZodDate,...m(Q)})};class v4 extends d{_parse(Q){if(this._getType(Q)!==R.symbol){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.symbol,received:$.parsedType}),h}return _0(Q.data)}}v4.create=(Q)=>{return new v4({typeName:P.ZodSymbol,...m(Q)})};class i6 extends d{_parse(Q){if(this._getType(Q)!==R.undefined){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.undefined,received:$.parsedType}),h}return _0(Q.data)}}i6.create=(Q)=>{return new i6({typeName:P.ZodUndefined,...m(Q)})};class n6 extends d{_parse(Q){if(this._getType(Q)!==R.null){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.null,received:$.parsedType}),h}return _0(Q.data)}}n6.create=(Q)=>{return new n6({typeName:P.ZodNull,...m(Q)})};class O6 extends d{constructor(){super(...arguments);this._any=!0}_parse(Q){return _0(Q.data)}}O6.create=(Q)=>{return new O6({typeName:P.ZodAny,...m(Q)})};class i1 extends d{constructor(){super(...arguments);this._unknown=!0}_parse(Q){return _0(Q.data)}}i1.create=(Q)=>{return new i1({typeName:P.ZodUnknown,...m(Q)})};class P1 extends d{_parse(Q){let W=this._getOrReturnCtx(Q);return b(W,{code:E.invalid_type,expected:R.never,received:W.parsedType}),h}}P1.create=(Q)=>{return new P1({typeName:P.ZodNever,...m(Q)})};class T4 extends d{_parse(Q){if(this._getType(Q)!==R.undefined){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.void,received:$.parsedType}),h}return _0(Q.data)}}T4.create=(Q)=>{return new T4({typeName:P.ZodVoid,...m(Q)})};class F1 extends d{_parse(Q){let{ctx:W,status:$}=this._processInputParams(Q),Y=this._def;if(W.parsedType!==R.array)return b(W,{code:E.invalid_type,expected:R.array,received:W.parsedType}),h;if(Y.exactLength!==null){let X=W.data.length>Y.exactLength.value,H=W.data.length<Y.exactLength.value;if(X||H)b(W,{code:X?E.too_big:E.too_small,minimum:H?Y.exactLength.value:void 0,maximum:X?Y.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:Y.exactLength.message}),$.dirty()}if(Y.minLength!==null){if(W.data.length<Y.minLength.value)b(W,{code:E.too_small,minimum:Y.minLength.value,type:"array",inclusive:!0,exact:!1,message:Y.minLength.message}),$.dirty()}if(Y.maxLength!==null){if(W.data.length>Y.maxLength.value)b(W,{code:E.too_big,maximum:Y.maxLength.value,type:"array",inclusive:!0,exact:!1,message:Y.maxLength.message}),$.dirty()}if(W.common.async)return Promise.all([...W.data].map((X,H)=>{return Y.type._parseAsync(new V1(W,X,W.path,H))})).then((X)=>{return S0.mergeArray($,X)});let J=[...W.data].map((X,H)=>{return Y.type._parseSync(new V1(W,X,W.path,H))});return S0.mergeArray($,J)}get element(){return this._def.type}min(Q,W){return new F1({...this._def,minLength:{value:Q,message:T.toString(W)}})}max(Q,W){return new F1({...this._def,maxLength:{value:Q,message:T.toString(W)}})}length(Q,W){return new F1({...this._def,exactLength:{value:Q,message:T.toString(W)}})}nonempty(Q){return this.min(1,Q)}}F1.create=(Q,W)=>{return new F1({type:Q,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...m(W)})};function c6(Q){if(Q instanceof O0){let W={};for(let $ in Q.shape){let Y=Q.shape[$];W[$]=t0.create(c6(Y))}return new O0({...Q._def,shape:()=>W})}else if(Q instanceof F1)return new F1({...Q._def,type:c6(Q.element)});else if(Q instanceof t0)return t0.create(c6(Q.unwrap()));else if(Q instanceof y1)return y1.create(c6(Q.unwrap()));else if(Q instanceof R1)return R1.create(Q.items.map((W)=>c6(W)));else return Q}class O0 extends d{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let Q=this._def.shape(),W=o.objectKeys(Q);return this._cached={shape:Q,keys:W},this._cached}_parse(Q){if(this._getType(Q)!==R.object){let B=this._getOrReturnCtx(Q);return b(B,{code:E.invalid_type,expected:R.object,received:B.parsedType}),h}let{status:$,ctx:Y}=this._processInputParams(Q),{shape:J,keys:X}=this._getCached(),H=[];if(!(this._def.catchall instanceof P1&&this._def.unknownKeys==="strip")){for(let B in Y.data)if(!X.includes(B))H.push(B)}let G=[];for(let B of X){let K=J[B],V=Y.data[B];G.push({key:{status:"valid",value:B},value:K._parse(new V1(Y,V,Y.path,B)),alwaysSet:B in Y.data})}if(this._def.catchall instanceof P1){let B=this._def.unknownKeys;if(B==="passthrough")for(let K of H)G.push({key:{status:"valid",value:K},value:{status:"valid",value:Y.data[K]}});else if(B==="strict"){if(H.length>0)b(Y,{code:E.unrecognized_keys,keys:H}),$.dirty()}else if(B==="strip");else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let B=this._def.catchall;for(let K of H){let V=Y.data[K];G.push({key:{status:"valid",value:K},value:B._parse(new V1(Y,V,Y.path,K)),alwaysSet:K in Y.data})}}if(Y.common.async)return Promise.resolve().then(async()=>{let B=[];for(let K of G){let V=await K.key,L=await K.value;B.push({key:V,value:L,alwaysSet:K.alwaysSet})}return B}).then((B)=>{return S0.mergeObjectSync($,B)});else return S0.mergeObjectSync($,G)}get shape(){return this._def.shape()}strict(Q){return T.errToObj,new O0({...this._def,unknownKeys:"strict",...Q!==void 0?{errorMap:(W,$)=>{let Y=this._def.errorMap?.(W,$).message??$.defaultError;if(W.code==="unrecognized_keys")return{message:T.errToObj(Q).message??Y};return{message:Y}}}:{}})}strip(){return new O0({...this._def,unknownKeys:"strip"})}passthrough(){return new O0({...this._def,unknownKeys:"passthrough"})}extend(Q){return new O0({...this._def,shape:()=>({...this._def.shape(),...Q})})}merge(Q){return new O0({unknownKeys:Q._def.unknownKeys,catchall:Q._def.catchall,shape:()=>({...this._def.shape(),...Q._def.shape()}),typeName:P.ZodObject})}setKey(Q,W){return this.augment({[Q]:W})}catchall(Q){return new O0({...this._def,catchall:Q})}pick(Q){let W={};for(let $ of o.objectKeys(Q))if(Q[$]&&this.shape[$])W[$]=this.shape[$];return new O0({...this._def,shape:()=>W})}omit(Q){let W={};for(let $ of o.objectKeys(this.shape))if(!Q[$])W[$]=this.shape[$];return new O0({...this._def,shape:()=>W})}deepPartial(){return c6(this)}partial(Q){let W={};for(let $ of o.objectKeys(this.shape)){let Y=this.shape[$];if(Q&&!Q[$])W[$]=Y;else W[$]=Y.optional()}return new O0({...this._def,shape:()=>W})}required(Q){let W={};for(let $ of o.objectKeys(this.shape))if(Q&&!Q[$])W[$]=this.shape[$];else{let J=this.shape[$];while(J instanceof t0)J=J._def.innerType;W[$]=J}return new O0({...this._def,shape:()=>W})}keyof(){return C7(o.objectKeys(this.shape))}}O0.create=(Q,W)=>{return new O0({shape:()=>Q,unknownKeys:"strip",catchall:P1.create(),typeName:P.ZodObject,...m(W)})};O0.strictCreate=(Q,W)=>{return new O0({shape:()=>Q,unknownKeys:"strict",catchall:P1.create(),typeName:P.ZodObject,...m(W)})};O0.lazycreate=(Q,W)=>{return new O0({shape:Q,unknownKeys:"strip",catchall:P1.create(),typeName:P.ZodObject,...m(W)})};class o6 extends d{_parse(Q){let{ctx:W}=this._processInputParams(Q),$=this._def.options;function Y(J){for(let H of J)if(H.result.status==="valid")return H.result;for(let H of J)if(H.result.status==="dirty")return W.common.issues.push(...H.ctx.common.issues),H.result;let X=J.map((H)=>new p0(H.ctx.common.issues));return b(W,{code:E.invalid_union,unionErrors:X}),h}if(W.common.async)return Promise.all($.map(async(J)=>{let X={...W,common:{...W.common,issues:[]},parent:null};return{result:await J._parseAsync({data:W.data,path:W.path,parent:X}),ctx:X}})).then(Y);else{let J=void 0,X=[];for(let G of $){let B={...W,common:{...W.common,issues:[]},parent:null},K=G._parseSync({data:W.data,path:W.path,parent:B});if(K.status==="valid")return K;else if(K.status==="dirty"&&!J)J={result:K,ctx:B};if(B.common.issues.length)X.push(B.common.issues)}if(J)return W.common.issues.push(...J.ctx.common.issues),J.result;let H=X.map((G)=>new p0(G));return b(W,{code:E.invalid_union,unionErrors:H}),h}}get options(){return this._def.options}}o6.create=(Q,W)=>{return new o6({options:Q,typeName:P.ZodUnion,...m(W)})};var x1=(Q)=>{if(Q instanceof a6)return x1(Q.schema);else if(Q instanceof L1)return x1(Q.innerType());else if(Q instanceof t6)return[Q.value];else if(Q instanceof r1)return Q.options;else if(Q instanceof s6)return o.objectValues(Q.enum);else if(Q instanceof e6)return x1(Q._def.innerType);else if(Q instanceof i6)return[void 0];else if(Q instanceof n6)return[null];else if(Q instanceof t0)return[void 0,...x1(Q.unwrap())];else if(Q instanceof y1)return[null,...x1(Q.unwrap())];else if(Q instanceof u9)return x1(Q.unwrap());else if(Q instanceof W4)return x1(Q.unwrap());else if(Q instanceof Q4)return x1(Q._def.innerType);else return[]};class f9 extends d{_parse(Q){let{ctx:W}=this._processInputParams(Q);if(W.parsedType!==R.object)return b(W,{code:E.invalid_type,expected:R.object,received:W.parsedType}),h;let $=this.discriminator,Y=W.data[$],J=this.optionsMap.get(Y);if(!J)return b(W,{code:E.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[$]}),h;if(W.common.async)return J._parseAsync({data:W.data,path:W.path,parent:W});else return J._parseSync({data:W.data,path:W.path,parent:W})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(Q,W,$){let Y=new Map;for(let J of W){let X=x1(J.shape[Q]);if(!X.length)throw Error(`A discriminator value for key \`${Q}\` could not be extracted from all schema options`);for(let H of X){if(Y.has(H))throw Error(`Discriminator property ${String(Q)} has duplicate value ${String(H)}`);Y.set(H,J)}}return new f9({typeName:P.ZodDiscriminatedUnion,discriminator:Q,options:W,optionsMap:Y,...m($)})}}function kQ(Q,W){let $=E1(Q),Y=E1(W);if(Q===W)return{valid:!0,data:Q};else if($===R.object&&Y===R.object){let J=o.objectKeys(W),X=o.objectKeys(Q).filter((G)=>J.indexOf(G)!==-1),H={...Q,...W};for(let G of X){let B=kQ(Q[G],W[G]);if(!B.valid)return{valid:!1};H[G]=B.data}return{valid:!0,data:H}}else if($===R.array&&Y===R.array){if(Q.length!==W.length)return{valid:!1};let J=[];for(let X=0;X<Q.length;X++){let H=Q[X],G=W[X],B=kQ(H,G);if(!B.valid)return{valid:!1};J.push(B.data)}return{valid:!0,data:J}}else if($===R.date&&Y===R.date&&+Q===+W)return{valid:!0,data:Q};else return{valid:!1}}class r6 extends d{_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q),Y=(J,X)=>{if(g9(J)||g9(X))return h;let H=kQ(J.value,X.value);if(!H.valid)return b($,{code:E.invalid_intersection_types}),h;if(h9(J)||h9(X))W.dirty();return{status:W.value,value:H.data}};if($.common.async)return Promise.all([this._def.left._parseAsync({data:$.data,path:$.path,parent:$}),this._def.right._parseAsync({data:$.data,path:$.path,parent:$})]).then(([J,X])=>Y(J,X));else return Y(this._def.left._parseSync({data:$.data,path:$.path,parent:$}),this._def.right._parseSync({data:$.data,path:$.path,parent:$}))}}r6.create=(Q,W,$)=>{return new r6({left:Q,right:W,typeName:P.ZodIntersection,...m($)})};class R1 extends d{_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.array)return b($,{code:E.invalid_type,expected:R.array,received:$.parsedType}),h;if($.data.length<this._def.items.length)return b($,{code:E.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),h;if(!this._def.rest&&$.data.length>this._def.items.length)b($,{code:E.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),W.dirty();let J=[...$.data].map((X,H)=>{let G=this._def.items[H]||this._def.rest;if(!G)return null;return G._parse(new V1($,X,$.path,H))}).filter((X)=>!!X);if($.common.async)return Promise.all(J).then((X)=>{return S0.mergeArray(W,X)});else return S0.mergeArray(W,J)}get items(){return this._def.items}rest(Q){return new R1({...this._def,rest:Q})}}R1.create=(Q,W)=>{if(!Array.isArray(Q))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new R1({items:Q,typeName:P.ZodTuple,rest:null,...m(W)})};class k4 extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.object)return b($,{code:E.invalid_type,expected:R.object,received:$.parsedType}),h;let Y=[],J=this._def.keyType,X=this._def.valueType;for(let H in $.data)Y.push({key:J._parse(new V1($,H,$.path,H)),value:X._parse(new V1($,$.data[H],$.path,H)),alwaysSet:H in $.data});if($.common.async)return S0.mergeObjectAsync(W,Y);else return S0.mergeObjectSync(W,Y)}get element(){return this._def.valueType}static create(Q,W,$){if(W instanceof d)return new k4({keyType:Q,valueType:W,typeName:P.ZodRecord,...m($)});return new k4({keyType:K1.create(),valueType:Q,typeName:P.ZodRecord,...m(W)})}}class _4 extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.map)return b($,{code:E.invalid_type,expected:R.map,received:$.parsedType}),h;let Y=this._def.keyType,J=this._def.valueType,X=[...$.data.entries()].map(([H,G],B)=>{return{key:Y._parse(new V1($,H,$.path,[B,"key"])),value:J._parse(new V1($,G,$.path,[B,"value"]))}});if($.common.async){let H=new Map;return Promise.resolve().then(async()=>{for(let G of X){let B=await G.key,K=await G.value;if(B.status==="aborted"||K.status==="aborted")return h;if(B.status==="dirty"||K.status==="dirty")W.dirty();H.set(B.value,K.value)}return{status:W.value,value:H}})}else{let H=new Map;for(let G of X){let{key:B,value:K}=G;if(B.status==="aborted"||K.status==="aborted")return h;if(B.status==="dirty"||K.status==="dirty")W.dirty();H.set(B.value,K.value)}return{status:W.value,value:H}}}}_4.create=(Q,W,$)=>{return new _4({valueType:W,keyType:Q,typeName:P.ZodMap,...m($)})};class w6 extends d{_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q);if($.parsedType!==R.set)return b($,{code:E.invalid_type,expected:R.set,received:$.parsedType}),h;let Y=this._def;if(Y.minSize!==null){if($.data.size<Y.minSize.value)b($,{code:E.too_small,minimum:Y.minSize.value,type:"set",inclusive:!0,exact:!1,message:Y.minSize.message}),W.dirty()}if(Y.maxSize!==null){if($.data.size>Y.maxSize.value)b($,{code:E.too_big,maximum:Y.maxSize.value,type:"set",inclusive:!0,exact:!1,message:Y.maxSize.message}),W.dirty()}let J=this._def.valueType;function X(G){let B=new Set;for(let K of G){if(K.status==="aborted")return h;if(K.status==="dirty")W.dirty();B.add(K.value)}return{status:W.value,value:B}}let H=[...$.data.values()].map((G,B)=>J._parse(new V1($,G,$.path,B)));if($.common.async)return Promise.all(H).then((G)=>X(G));else return X(H)}min(Q,W){return new w6({...this._def,minSize:{value:Q,message:T.toString(W)}})}max(Q,W){return new w6({...this._def,maxSize:{value:Q,message:T.toString(W)}})}size(Q,W){return this.min(Q,W).max(Q,W)}nonempty(Q){return this.min(1,Q)}}w6.create=(Q,W)=>{return new w6({valueType:Q,minSize:null,maxSize:null,typeName:P.ZodSet,...m(W)})};class p6 extends d{constructor(){super(...arguments);this.validate=this.implement}_parse(Q){let{ctx:W}=this._processInputParams(Q);if(W.parsedType!==R.function)return b(W,{code:E.invalid_type,expected:R.function,received:W.parsedType}),h;function $(H,G){return Z4({data:H,path:W.path,errorMaps:[W.common.contextualErrorMap,W.schemaErrorMap,l6(),_1].filter((B)=>!!B),issueData:{code:E.invalid_arguments,argumentsError:G}})}function Y(H,G){return Z4({data:H,path:W.path,errorMaps:[W.common.contextualErrorMap,W.schemaErrorMap,l6(),_1].filter((B)=>!!B),issueData:{code:E.invalid_return_type,returnTypeError:G}})}let J={errorMap:W.common.contextualErrorMap},X=W.data;if(this._def.returns instanceof N6){let H=this;return _0(async function(...G){let B=new p0([]),K=await H._def.args.parseAsync(G,J).catch((U)=>{throw B.addIssue($(G,U)),B}),V=await Reflect.apply(X,this,K);return await H._def.returns._def.type.parseAsync(V,J).catch((U)=>{throw B.addIssue(Y(V,U)),B})})}else{let H=this;return _0(function(...G){let B=H._def.args.safeParse(G,J);if(!B.success)throw new p0([$(G,B.error)]);let K=Reflect.apply(X,this,B.data),V=H._def.returns.safeParse(K,J);if(!V.success)throw new p0([Y(K,V.error)]);return V.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...Q){return new p6({...this._def,args:R1.create(Q).rest(i1.create())})}returns(Q){return new p6({...this._def,returns:Q})}implement(Q){return this.parse(Q)}strictImplement(Q){return this.parse(Q)}static create(Q,W,$){return new p6({args:Q?Q:R1.create([]).rest(i1.create()),returns:W||i1.create(),typeName:P.ZodFunction,...m($)})}}class a6 extends d{get schema(){return this._def.getter()}_parse(Q){let{ctx:W}=this._processInputParams(Q);return this._def.getter()._parse({data:W.data,path:W.path,parent:W})}}a6.create=(Q,W)=>{return new a6({getter:Q,typeName:P.ZodLazy,...m(W)})};class t6 extends d{_parse(Q){if(Q.data!==this._def.value){let W=this._getOrReturnCtx(Q);return b(W,{received:W.data,code:E.invalid_literal,expected:this._def.value}),h}return{status:"valid",value:Q.data}}get value(){return this._def.value}}t6.create=(Q,W)=>{return new t6({value:Q,typeName:P.ZodLiteral,...m(W)})};function C7(Q,W){return new r1({values:Q,typeName:P.ZodEnum,...m(W)})}class r1 extends d{_parse(Q){if(typeof Q.data!=="string"){let W=this._getOrReturnCtx(Q),$=this._def.values;return b(W,{expected:o.joinValues($),received:W.parsedType,code:E.invalid_type}),h}if(!this._cache)this._cache=new Set(this._def.values);if(!this._cache.has(Q.data)){let W=this._getOrReturnCtx(Q),$=this._def.values;return b(W,{received:W.data,code:E.invalid_enum_value,options:$}),h}return _0(Q.data)}get options(){return this._def.values}get enum(){let Q={};for(let W of this._def.values)Q[W]=W;return Q}get Values(){let Q={};for(let W of this._def.values)Q[W]=W;return Q}get Enum(){let Q={};for(let W of this._def.values)Q[W]=W;return Q}extract(Q,W=this._def){return r1.create(Q,{...this._def,...W})}exclude(Q,W=this._def){return r1.create(this.options.filter(($)=>!Q.includes($)),{...this._def,...W})}}r1.create=C7;class s6 extends d{_parse(Q){let W=o.getValidEnumValues(this._def.values),$=this._getOrReturnCtx(Q);if($.parsedType!==R.string&&$.parsedType!==R.number){let Y=o.objectValues(W);return b($,{expected:o.joinValues(Y),received:$.parsedType,code:E.invalid_type}),h}if(!this._cache)this._cache=new Set(o.getValidEnumValues(this._def.values));if(!this._cache.has(Q.data)){let Y=o.objectValues(W);return b($,{received:$.data,code:E.invalid_enum_value,options:Y}),h}return _0(Q.data)}get enum(){return this._def.values}}s6.create=(Q,W)=>{return new s6({values:Q,typeName:P.ZodNativeEnum,...m(W)})};class N6 extends d{unwrap(){return this._def.type}_parse(Q){let{ctx:W}=this._processInputParams(Q);if(W.parsedType!==R.promise&&W.common.async===!1)return b(W,{code:E.invalid_type,expected:R.promise,received:W.parsedType}),h;let $=W.parsedType===R.promise?W.data:Promise.resolve(W.data);return _0($.then((Y)=>{return this._def.type.parseAsync(Y,{path:W.path,errorMap:W.common.contextualErrorMap})}))}}N6.create=(Q,W)=>{return new N6({type:Q,typeName:P.ZodPromise,...m(W)})};class L1 extends d{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q),Y=this._def.effect||null,J={addIssue:(X)=>{if(b($,X),X.fatal)W.abort();else W.dirty()},get path(){return $.path}};if(J.addIssue=J.addIssue.bind(J),Y.type==="preprocess"){let X=Y.transform($.data,J);if($.common.async)return Promise.resolve(X).then(async(H)=>{if(W.value==="aborted")return h;let G=await this._def.schema._parseAsync({data:H,path:$.path,parent:$});if(G.status==="aborted")return h;if(G.status==="dirty")return A6(G.value);if(W.value==="dirty")return A6(G.value);return G});else{if(W.value==="aborted")return h;let H=this._def.schema._parseSync({data:X,path:$.path,parent:$});if(H.status==="aborted")return h;if(H.status==="dirty")return A6(H.value);if(W.value==="dirty")return A6(H.value);return H}}if(Y.type==="refinement"){let X=(H)=>{let G=Y.refinement(H,J);if($.common.async)return Promise.resolve(G);if(G instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return H};if($.common.async===!1){let H=this._def.schema._parseSync({data:$.data,path:$.path,parent:$});if(H.status==="aborted")return h;if(H.status==="dirty")W.dirty();return X(H.value),{status:W.value,value:H.value}}else return this._def.schema._parseAsync({data:$.data,path:$.path,parent:$}).then((H)=>{if(H.status==="aborted")return h;if(H.status==="dirty")W.dirty();return X(H.value).then(()=>{return{status:W.value,value:H.value}})})}if(Y.type==="transform")if($.common.async===!1){let X=this._def.schema._parseSync({data:$.data,path:$.path,parent:$});if(!d1(X))return h;let H=Y.transform(X.value,J);if(H instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:W.value,value:H}}else return this._def.schema._parseAsync({data:$.data,path:$.path,parent:$}).then((X)=>{if(!d1(X))return h;return Promise.resolve(Y.transform(X.value,J)).then((H)=>({status:W.value,value:H}))});o.assertNever(Y)}}L1.create=(Q,W,$)=>{return new L1({schema:Q,typeName:P.ZodEffects,effect:W,...m($)})};L1.createWithPreprocess=(Q,W,$)=>{return new L1({schema:W,effect:{type:"preprocess",transform:Q},typeName:P.ZodEffects,...m($)})};class t0 extends d{_parse(Q){if(this._getType(Q)===R.undefined)return _0(void 0);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}t0.create=(Q,W)=>{return new t0({innerType:Q,typeName:P.ZodOptional,...m(W)})};class y1 extends d{_parse(Q){if(this._getType(Q)===R.null)return _0(null);return this._def.innerType._parse(Q)}unwrap(){return this._def.innerType}}y1.create=(Q,W)=>{return new y1({innerType:Q,typeName:P.ZodNullable,...m(W)})};class e6 extends d{_parse(Q){let{ctx:W}=this._processInputParams(Q),$=W.data;if(W.parsedType===R.undefined)$=this._def.defaultValue();return this._def.innerType._parse({data:$,path:W.path,parent:W})}removeDefault(){return this._def.innerType}}e6.create=(Q,W)=>{return new e6({innerType:Q,typeName:P.ZodDefault,defaultValue:typeof W.default==="function"?W.default:()=>W.default,...m(W)})};class Q4 extends d{_parse(Q){let{ctx:W}=this._processInputParams(Q),$={...W,common:{...W.common,issues:[]}},Y=this._def.innerType._parse({data:$.data,path:$.path,parent:{...$}});if(m6(Y))return Y.then((J)=>{return{status:"valid",value:J.status==="valid"?J.value:this._def.catchValue({get error(){return new p0($.common.issues)},input:$.data})}});else return{status:"valid",value:Y.status==="valid"?Y.value:this._def.catchValue({get error(){return new p0($.common.issues)},input:$.data})}}removeCatch(){return this._def.innerType}}Q4.create=(Q,W)=>{return new Q4({innerType:Q,typeName:P.ZodCatch,catchValue:typeof W.catch==="function"?W.catch:()=>W.catch,...m(W)})};class x4 extends d{_parse(Q){if(this._getType(Q)!==R.nan){let $=this._getOrReturnCtx(Q);return b($,{code:E.invalid_type,expected:R.nan,received:$.parsedType}),h}return{status:"valid",value:Q.data}}}x4.create=(Q)=>{return new x4({typeName:P.ZodNaN,...m(Q)})};var _K=Symbol("zod_brand");class u9 extends d{_parse(Q){let{ctx:W}=this._processInputParams(Q),$=W.data;return this._def.type._parse({data:$,path:W.path,parent:W})}unwrap(){return this._def.type}}class y4 extends d{_parse(Q){let{status:W,ctx:$}=this._processInputParams(Q);if($.common.async)return(async()=>{let J=await this._def.in._parseAsync({data:$.data,path:$.path,parent:$});if(J.status==="aborted")return h;if(J.status==="dirty")return W.dirty(),A6(J.value);else return this._def.out._parseAsync({data:J.value,path:$.path,parent:$})})();else{let Y=this._def.in._parseSync({data:$.data,path:$.path,parent:$});if(Y.status==="aborted")return h;if(Y.status==="dirty")return W.dirty(),{status:"dirty",value:Y.value};else return this._def.out._parseSync({data:Y.value,path:$.path,parent:$})}}static create(Q,W){return new y4({in:Q,out:W,typeName:P.ZodPipeline})}}class W4 extends d{_parse(Q){let W=this._def.innerType._parse(Q),$=(Y)=>{if(d1(Y))Y.value=Object.freeze(Y.value);return Y};return m6(W)?W.then((Y)=>$(Y)):$(W)}unwrap(){return this._def.innerType}}W4.create=(Q,W)=>{return new W4({innerType:Q,typeName:P.ZodReadonly,...m(W)})};function R7(Q,W){let $=typeof Q==="function"?Q(W):typeof Q==="string"?{message:Q}:Q;return typeof $==="string"?{message:$}:$}function Z7(Q,W={},$){if(Q)return O6.create().superRefine((Y,J)=>{let X=Q(Y);if(X instanceof Promise)return X.then((H)=>{if(!H){let G=R7(W,Y),B=G.fatal??$??!0;J.addIssue({code:"custom",...G,fatal:B})}});if(!X){let H=R7(W,Y),G=H.fatal??$??!0;J.addIssue({code:"custom",...H,fatal:G})}return});return O6.create()}var xK={object:O0.lazycreate},P;(function(Q){Q.ZodString="ZodString",Q.ZodNumber="ZodNumber",Q.ZodNaN="ZodNaN",Q.ZodBigInt="ZodBigInt",Q.ZodBoolean="ZodBoolean",Q.ZodDate="ZodDate",Q.ZodSymbol="ZodSymbol",Q.ZodUndefined="ZodUndefined",Q.ZodNull="ZodNull",Q.ZodAny="ZodAny",Q.ZodUnknown="ZodUnknown",Q.ZodNever="ZodNever",Q.ZodVoid="ZodVoid",Q.ZodArray="ZodArray",Q.ZodObject="ZodObject",Q.ZodUnion="ZodUnion",Q.ZodDiscriminatedUnion="ZodDiscriminatedUnion",Q.ZodIntersection="ZodIntersection",Q.ZodTuple="ZodTuple",Q.ZodRecord="ZodRecord",Q.ZodMap="ZodMap",Q.ZodSet="ZodSet",Q.ZodFunction="ZodFunction",Q.ZodLazy="ZodLazy",Q.ZodLiteral="ZodLiteral",Q.ZodEnum="ZodEnum",Q.ZodEffects="ZodEffects",Q.ZodNativeEnum="ZodNativeEnum",Q.ZodOptional="ZodOptional",Q.ZodNullable="ZodNullable",Q.ZodDefault="ZodDefault",Q.ZodCatch="ZodCatch",Q.ZodPromise="ZodPromise",Q.ZodBranded="ZodBranded",Q.ZodPipeline="ZodPipeline",Q.ZodReadonly="ZodReadonly"})(P||(P={}));var yK=(Q,W={message:`Input not instance of ${Q.name}`})=>Z7(($)=>$ instanceof Q,W),v7=K1.create,T7=n1.create,gK=x4.create,hK=o1.create,k7=d6.create,fK=D6.create,uK=v4.create,lK=i6.create,mK=n6.create,cK=O6.create,pK=i1.create,dK=P1.create,iK=T4.create,nK=F1.create,_Q=O0.create,oK=O0.strictCreate,rK=o6.create,aK=f9.create,tK=r6.create,sK=R1.create,eK=k4.create,QF=_4.create,WF=w6.create,$F=p6.create,YF=a6.create,JF=t6.create,XF=r1.create,HF=s6.create,GF=N6.create,BF=L1.create,KF=t0.create,FF=y1.create,VF=L1.createWithPreprocess,LF=y4.create,qF=()=>v7().optional(),UF=()=>T7().optional(),AF=()=>k7().optional(),DF={string:(Q)=>K1.create({...Q,coerce:!0}),number:(Q)=>n1.create({...Q,coerce:!0}),boolean:(Q)=>d6.create({...Q,coerce:!0}),bigint:(Q)=>o1.create({...Q,coerce:!0}),date:(Q)=>D6.create({...Q,coerce:!0})};var OF=h;var wF=Object.freeze({status:"aborted"});function M(Q,W,$){function Y(G,B){var K;Object.defineProperty(G,"_zod",{value:G._zod??{},enumerable:!1}),(K=G._zod).traits??(K.traits=new Set),G._zod.traits.add(Q),W(G,B);for(let V in H.prototype)if(!(V in G))Object.defineProperty(G,V,{value:H.prototype[V].bind(G)});G._zod.constr=H,G._zod.def=B}let J=$?.Parent??Object;class X extends J{}Object.defineProperty(X,"name",{value:Q});function H(G){var B;let K=$?.Parent?new X:this;Y(K,G),(B=K._zod).deferred??(B.deferred=[]);for(let V of K._zod.deferred)V();return K}return Object.defineProperty(H,"init",{value:Y}),Object.defineProperty(H,Symbol.hasInstance,{value:(G)=>{if($?.Parent&&G instanceof $.Parent)return!0;return G?._zod?.traits?.has(Q)}}),Object.defineProperty(H,"name",{value:Q}),H}var NF=Symbol("zod_brand");class a1 extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}var l9={};function s0(Q){if(Q)Object.assign(l9,Q);return l9}var r={};ZQ(r,{unwrapMessage:()=>g4,stringifyPrimitive:()=>p9,required:()=>yF,randomString:()=>SF,propertyKeyTypes:()=>uQ,promiseAllObject:()=>bF,primitiveTypes:()=>_7,prefixIssues:()=>b1,pick:()=>vF,partial:()=>xF,optionalKeys:()=>lQ,omit:()=>TF,numKeys:()=>IF,nullish:()=>u4,normalizeParams:()=>f,merge:()=>_F,jsonStringifyReplacer:()=>yQ,joinValues:()=>m9,issue:()=>cQ,isPlainObject:()=>Y4,isObject:()=>$4,getSizableOrigin:()=>y7,getParsedType:()=>CF,getLengthableOrigin:()=>m4,getEnumValues:()=>h4,getElementAtPath:()=>RF,floatSafeRemainder:()=>gQ,finalizeIssue:()=>q1,extend:()=>kF,escapeRegex:()=>t1,esc:()=>M6,defineLazy:()=>H0,createTransparentProxy:()=>ZF,clone:()=>e0,cleanRegex:()=>l4,cleanEnum:()=>gF,captureStackTrace:()=>c9,cached:()=>f4,assignProp:()=>hQ,assertNotEqual:()=>jF,assertNever:()=>EF,assertIs:()=>zF,assertEqual:()=>MF,assert:()=>PF,allowsEval:()=>fQ,aborted:()=>j6,NUMBER_FORMAT_RANGES:()=>mQ,Class:()=>g7,BIGINT_FORMAT_RANGES:()=>x7});function MF(Q){return Q}function jF(Q){return Q}function zF(Q){}function EF(Q){throw Error()}function PF(Q){}function h4(Q){let W=Object.values(Q).filter((Y)=>typeof Y==="number");return Object.entries(Q).filter(([Y,J])=>W.indexOf(+Y)===-1).map(([Y,J])=>J)}function m9(Q,W="|"){return Q.map(($)=>p9($)).join(W)}function yQ(Q,W){if(typeof W==="bigint")return W.toString();return W}function f4(Q){return{get value(){{let $=Q();return Object.defineProperty(this,"value",{value:$}),$}throw Error("cached value already set")}}}function u4(Q){return Q===null||Q===void 0}function l4(Q){let W=Q.startsWith("^")?1:0,$=Q.endsWith("$")?Q.length-1:Q.length;return Q.slice(W,$)}function gQ(Q,W){let $=(Q.toString().split(".")[1]||"").length,Y=(W.toString().split(".")[1]||"").length,J=$>Y?$:Y,X=Number.parseInt(Q.toFixed(J).replace(".","")),H=Number.parseInt(W.toFixed(J).replace(".",""));return X%H/10**J}function H0(Q,W,$){Object.defineProperty(Q,W,{get(){{let J=$();return Q[W]=J,J}throw Error("cached value already set")},set(J){Object.defineProperty(Q,W,{value:J})},configurable:!0})}function hQ(Q,W,$){Object.defineProperty(Q,W,{value:$,writable:!0,enumerable:!0,configurable:!0})}function RF(Q,W){if(!W)return Q;return W.reduce(($,Y)=>$?.[Y],Q)}function bF(Q){let W=Object.keys(Q),$=W.map((Y)=>Q[Y]);return Promise.all($).then((Y)=>{let J={};for(let X=0;X<W.length;X++)J[W[X]]=Y[X];return J})}function SF(Q=10){let $="";for(let Y=0;Y<Q;Y++)$+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)];return $}function M6(Q){return JSON.stringify(Q)}var c9=Error.captureStackTrace?Error.captureStackTrace:(...Q)=>{};function $4(Q){return typeof Q==="object"&&Q!==null&&!Array.isArray(Q)}var fQ=f4(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(Q){return!1}});function Y4(Q){if($4(Q)===!1)return!1;let W=Q.constructor;if(W===void 0)return!0;let $=W.prototype;if($4($)===!1)return!1;if(Object.prototype.hasOwnProperty.call($,"isPrototypeOf")===!1)return!1;return!0}function IF(Q){let W=0;for(let $ in Q)if(Object.prototype.hasOwnProperty.call(Q,$))W++;return W}var CF=(Q)=>{let W=typeof Q;switch(W){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(Q)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Q.then&&typeof Q.then==="function"&&Q.catch&&typeof Q.catch==="function")return"promise";if(typeof Map<"u"&&Q instanceof Map)return"map";if(typeof Set<"u"&&Q instanceof Set)return"set";if(typeof Date<"u"&&Q instanceof Date)return"date";if(typeof File<"u"&&Q instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${W}`)}},uQ=new Set(["string","number","symbol"]),_7=new Set(["string","number","bigint","boolean","symbol","undefined"]);function t1(Q){return Q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function e0(Q,W,$){let Y=new Q._zod.constr(W??Q._zod.def);if(!W||$?.parent)Y._zod.parent=Q;return Y}function f(Q){let W=Q;if(!W)return{};if(typeof W==="string")return{error:()=>W};if(W?.message!==void 0){if(W?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");W.error=W.message}if(delete W.message,typeof W.error==="string")return{...W,error:()=>W.error};return W}function ZF(Q){let W;return new Proxy({},{get($,Y,J){return W??(W=Q()),Reflect.get(W,Y,J)},set($,Y,J,X){return W??(W=Q()),Reflect.set(W,Y,J,X)},has($,Y){return W??(W=Q()),Reflect.has(W,Y)},deleteProperty($,Y){return W??(W=Q()),Reflect.deleteProperty(W,Y)},ownKeys($){return W??(W=Q()),Reflect.ownKeys(W)},getOwnPropertyDescriptor($,Y){return W??(W=Q()),Reflect.getOwnPropertyDescriptor(W,Y)},defineProperty($,Y,J){return W??(W=Q()),Reflect.defineProperty(W,Y,J)}})}function p9(Q){if(typeof Q==="bigint")return Q.toString()+"n";if(typeof Q==="string")return`"${Q}"`;return`${Q}`}function lQ(Q){return Object.keys(Q).filter((W)=>{return Q[W]._zod.optin==="optional"&&Q[W]._zod.optout==="optional"})}var mQ={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-340282346638528860000000000000000000000,340282346638528860000000000000000000000],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},x7={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function vF(Q,W){let $={},Y=Q._zod.def;for(let J in W){if(!(J in Y.shape))throw Error(`Unrecognized key: "${J}"`);if(!W[J])continue;$[J]=Y.shape[J]}return e0(Q,{...Q._zod.def,shape:$,checks:[]})}function TF(Q,W){let $={...Q._zod.def.shape},Y=Q._zod.def;for(let J in W){if(!(J in Y.shape))throw Error(`Unrecognized key: "${J}"`);if(!W[J])continue;delete $[J]}return e0(Q,{...Q._zod.def,shape:$,checks:[]})}function kF(Q,W){if(!Y4(W))throw Error("Invalid input to extend: expected a plain object");let $={...Q._zod.def,get shape(){let Y={...Q._zod.def.shape,...W};return hQ(this,"shape",Y),Y},checks:[]};return e0(Q,$)}function _F(Q,W){return e0(Q,{...Q._zod.def,get shape(){let $={...Q._zod.def.shape,...W._zod.def.shape};return hQ(this,"shape",$),$},catchall:W._zod.def.catchall,checks:[]})}function xF(Q,W,$){let Y=W._zod.def.shape,J={...Y};if($)for(let X in $){if(!(X in Y))throw Error(`Unrecognized key: "${X}"`);if(!$[X])continue;J[X]=Q?new Q({type:"optional",innerType:Y[X]}):Y[X]}else for(let X in Y)J[X]=Q?new Q({type:"optional",innerType:Y[X]}):Y[X];return e0(W,{...W._zod.def,shape:J,checks:[]})}function yF(Q,W,$){let Y=W._zod.def.shape,J={...Y};if($)for(let X in $){if(!(X in J))throw Error(`Unrecognized key: "${X}"`);if(!$[X])continue;J[X]=new Q({type:"nonoptional",innerType:Y[X]})}else for(let X in Y)J[X]=new Q({type:"nonoptional",innerType:Y[X]});return e0(W,{...W._zod.def,shape:J,checks:[]})}function j6(Q,W=0){for(let $=W;$<Q.issues.length;$++)if(Q.issues[$]?.continue!==!0)return!0;return!1}function b1(Q,W){return W.map(($)=>{var Y;return(Y=$).path??(Y.path=[]),$.path.unshift(Q),$})}function g4(Q){return typeof Q==="string"?Q:Q?.message}function q1(Q,W,$){let Y={...Q,path:Q.path??[]};if(!Q.message){let J=g4(Q.inst?._zod.def?.error?.(Q))??g4(W?.error?.(Q))??g4($.customError?.(Q))??g4($.localeError?.(Q))??"Invalid input";Y.message=J}if(delete Y.inst,delete Y.continue,!W?.reportInput)delete Y.input;return Y}function y7(Q){if(Q instanceof Set)return"set";if(Q instanceof Map)return"map";if(Q instanceof File)return"file";return"unknown"}function m4(Q){if(Array.isArray(Q))return"array";if(typeof Q==="string")return"string";return"unknown"}function cQ(...Q){let[W,$,Y]=Q;if(typeof W==="string")return{message:W,code:"custom",input:$,inst:Y};return{...W}}function gF(Q){return Object.entries(Q).filter(([W,$])=>{return Number.isNaN(Number.parseInt(W,10))}).map((W)=>W[1])}class g7{constructor(...Q){}}var h7=(Q,W)=>{Q.name="$ZodError",Object.defineProperty(Q,"_zod",{value:Q._zod,enumerable:!1}),Object.defineProperty(Q,"issues",{value:W,enumerable:!1}),Object.defineProperty(Q,"message",{get(){return JSON.stringify(W,yQ,2)},enumerable:!0}),Object.defineProperty(Q,"toString",{value:()=>Q.message,enumerable:!1})},d9=M("$ZodError",h7),c4=M("$ZodError",h7,{Parent:Error});function pQ(Q,W=($)=>$.message){let $={},Y=[];for(let J of Q.issues)if(J.path.length>0)$[J.path[0]]=$[J.path[0]]||[],$[J.path[0]].push(W(J));else Y.push(W(J));return{formErrors:Y,fieldErrors:$}}function dQ(Q,W){let $=W||function(X){return X.message},Y={_errors:[]},J=(X)=>{for(let H of X.issues)if(H.code==="invalid_union"&&H.errors.length)H.errors.map((G)=>J({issues:G}));else if(H.code==="invalid_key")J({issues:H.issues});else if(H.code==="invalid_element")J({issues:H.issues});else if(H.path.length===0)Y._errors.push($(H));else{let G=Y,B=0;while(B<H.path.length){let K=H.path[B];if(B!==H.path.length-1)G[K]=G[K]||{_errors:[]};else G[K]=G[K]||{_errors:[]},G[K]._errors.push($(H));G=G[K],B++}}};return J(Q),Y}var iQ=(Q)=>(W,$,Y,J)=>{let X=Y?Object.assign(Y,{async:!1}):{async:!1},H=W._zod.run({value:$,issues:[]},X);if(H instanceof Promise)throw new a1;if(H.issues.length){let G=new(J?.Err??Q)(H.issues.map((B)=>q1(B,X,s0())));throw c9(G,J?.callee),G}return H.value},nQ=iQ(c4),oQ=(Q)=>async(W,$,Y,J)=>{let X=Y?Object.assign(Y,{async:!0}):{async:!0},H=W._zod.run({value:$,issues:[]},X);if(H instanceof Promise)H=await H;if(H.issues.length){let G=new(J?.Err??Q)(H.issues.map((B)=>q1(B,X,s0())));throw c9(G,J?.callee),G}return H.value},rQ=oQ(c4),aQ=(Q)=>(W,$,Y)=>{let J=Y?{...Y,async:!1}:{async:!1},X=W._zod.run({value:$,issues:[]},J);if(X instanceof Promise)throw new a1;return X.issues.length?{success:!1,error:new(Q??d9)(X.issues.map((H)=>q1(H,J,s0())))}:{success:!0,data:X.value}},z6=aQ(c4),tQ=(Q)=>async(W,$,Y)=>{let J=Y?Object.assign(Y,{async:!0}):{async:!0},X=W._zod.run({value:$,issues:[]},J);if(X instanceof Promise)X=await X;return X.issues.length?{success:!1,error:new Q(X.issues.map((H)=>q1(H,J,s0())))}:{success:!0,data:X.value}},E6=tQ(c4);var f7=/^[cC][^\s-]{8,}$/,u7=/^[0-9a-z]+$/,l7=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,m7=/^[0-9a-vA-V]{20}$/,c7=/^[A-Za-z0-9]{27}$/,p7=/^[a-zA-Z0-9_-]{21}$/,d7=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var i7=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,sQ=(Q)=>{if(!Q)return/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;return new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${Q}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`)};var n7=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;function o7(){return new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}var r7=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a7=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,t7=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,s7=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,e7=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,eQ=/^[A-Za-z0-9_-]*$/,QJ=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var WJ=/^\+(?:[0-9]){6,14}[0-9]$/,$J="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",YJ=new RegExp(`^${$J}$`);function JJ(Q){return typeof Q.precision==="number"?Q.precision===-1?"(?:[01]\\d|2[0-3]):[0-5]\\d":Q.precision===0?"(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d":`(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d\\.\\d{${Q.precision}}`:"(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?"}function XJ(Q){return new RegExp(`^${JJ(Q)}$`)}function HJ(Q){let W=JJ({precision:Q.precision}),$=["Z"];if(Q.local)$.push("");if(Q.offset)$.push("([+-]\\d{2}:\\d{2})");let Y=`${W}(?:${$.join("|")})`;return new RegExp(`^${$J}T(?:${Y})$`)}var GJ=(Q)=>{let W=Q?`[\\s\\S]{${Q?.minimum??0},${Q?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${W}$`)};var BJ=/^\d+$/,KJ=/^-?\d+(?:\.\d+)?/i,FJ=/true|false/i,VJ=/null/i;var LJ=/^[^A-Z]*$/,qJ=/^[^a-z]*$/;var I0=M("$ZodCheck",(Q,W)=>{var $;Q._zod??(Q._zod={}),Q._zod.def=W,($=Q._zod).onattach??($.onattach=[])}),UJ={number:"number",bigint:"bigint",object:"date"},QW=M("$ZodCheckLessThan",(Q,W)=>{I0.init(Q,W);let $=UJ[typeof W.value];Q._zod.onattach.push((Y)=>{let J=Y._zod.bag,X=(W.inclusive?J.maximum:J.exclusiveMaximum)??Number.POSITIVE_INFINITY;if(W.value<X)if(W.inclusive)J.maximum=W.value;else J.exclusiveMaximum=W.value}),Q._zod.check=(Y)=>{if(W.inclusive?Y.value<=W.value:Y.value<W.value)return;Y.issues.push({origin:$,code:"too_big",maximum:W.value,input:Y.value,inclusive:W.inclusive,inst:Q,continue:!W.abort})}}),WW=M("$ZodCheckGreaterThan",(Q,W)=>{I0.init(Q,W);let $=UJ[typeof W.value];Q._zod.onattach.push((Y)=>{let J=Y._zod.bag,X=(W.inclusive?J.minimum:J.exclusiveMinimum)??Number.NEGATIVE_INFINITY;if(W.value>X)if(W.inclusive)J.minimum=W.value;else J.exclusiveMinimum=W.value}),Q._zod.check=(Y)=>{if(W.inclusive?Y.value>=W.value:Y.value>W.value)return;Y.issues.push({origin:$,code:"too_small",minimum:W.value,input:Y.value,inclusive:W.inclusive,inst:Q,continue:!W.abort})}}),AJ=M("$ZodCheckMultipleOf",(Q,W)=>{I0.init(Q,W),Q._zod.onattach.push(($)=>{var Y;(Y=$._zod.bag).multipleOf??(Y.multipleOf=W.value)}),Q._zod.check=($)=>{if(typeof $.value!==typeof W.value)throw Error("Cannot mix number and bigint in multiple_of check.");if(typeof $.value==="bigint"?$.value%W.value===BigInt(0):gQ($.value,W.value)===0)return;$.issues.push({origin:typeof $.value,code:"not_multiple_of",divisor:W.value,input:$.value,inst:Q,continue:!W.abort})}}),DJ=M("$ZodCheckNumberFormat",(Q,W)=>{I0.init(Q,W),W.format=W.format||"float64";let $=W.format?.includes("int"),Y=$?"int":"number",[J,X]=mQ[W.format];Q._zod.onattach.push((H)=>{let G=H._zod.bag;if(G.format=W.format,G.minimum=J,G.maximum=X,$)G.pattern=BJ}),Q._zod.check=(H)=>{let G=H.value;if($){if(!Number.isInteger(G)){H.issues.push({expected:Y,format:W.format,code:"invalid_type",input:G,inst:Q});return}if(!Number.isSafeInteger(G)){if(G>0)H.issues.push({input:G,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!W.abort});else H.issues.push({input:G,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:Q,origin:Y,continue:!W.abort});return}}if(G<J)H.issues.push({origin:"number",input:G,code:"too_small",minimum:J,inclusive:!0,inst:Q,continue:!W.abort});if(G>X)H.issues.push({origin:"number",input:G,code:"too_big",maximum:X,inst:Q})}});var OJ=M("$ZodCheckMaxLength",(Q,W)=>{var $;I0.init(Q,W),($=Q._zod.def).when??($.when=(Y)=>{let J=Y.value;return!u4(J)&&J.length!==void 0}),Q._zod.onattach.push((Y)=>{let J=Y._zod.bag.maximum??Number.POSITIVE_INFINITY;if(W.maximum<J)Y._zod.bag.maximum=W.maximum}),Q._zod.check=(Y)=>{let J=Y.value;if(J.length<=W.maximum)return;let H=m4(J);Y.issues.push({origin:H,code:"too_big",maximum:W.maximum,inclusive:!0,input:J,inst:Q,continue:!W.abort})}}),wJ=M("$ZodCheckMinLength",(Q,W)=>{var $;I0.init(Q,W),($=Q._zod.def).when??($.when=(Y)=>{let J=Y.value;return!u4(J)&&J.length!==void 0}),Q._zod.onattach.push((Y)=>{let J=Y._zod.bag.minimum??Number.NEGATIVE_INFINITY;if(W.minimum>J)Y._zod.bag.minimum=W.minimum}),Q._zod.check=(Y)=>{let J=Y.value;if(J.length>=W.minimum)return;let H=m4(J);Y.issues.push({origin:H,code:"too_small",minimum:W.minimum,inclusive:!0,input:J,inst:Q,continue:!W.abort})}}),NJ=M("$ZodCheckLengthEquals",(Q,W)=>{var $;I0.init(Q,W),($=Q._zod.def).when??($.when=(Y)=>{let J=Y.value;return!u4(J)&&J.length!==void 0}),Q._zod.onattach.push((Y)=>{let J=Y._zod.bag;J.minimum=W.length,J.maximum=W.length,J.length=W.length}),Q._zod.check=(Y)=>{let J=Y.value,X=J.length;if(X===W.length)return;let H=m4(J),G=X>W.length;Y.issues.push({origin:H,...G?{code:"too_big",maximum:W.length}:{code:"too_small",minimum:W.length},inclusive:!0,exact:!0,input:Y.value,inst:Q,continue:!W.abort})}}),p4=M("$ZodCheckStringFormat",(Q,W)=>{var $,Y;if(I0.init(Q,W),Q._zod.onattach.push((J)=>{let X=J._zod.bag;if(X.format=W.format,W.pattern)X.patterns??(X.patterns=new Set),X.patterns.add(W.pattern)}),W.pattern)($=Q._zod).check??($.check=(J)=>{if(W.pattern.lastIndex=0,W.pattern.test(J.value))return;J.issues.push({origin:"string",code:"invalid_format",format:W.format,input:J.value,...W.pattern?{pattern:W.pattern.toString()}:{},inst:Q,continue:!W.abort})});else(Y=Q._zod).check??(Y.check=()=>{})}),MJ=M("$ZodCheckRegex",(Q,W)=>{p4.init(Q,W),Q._zod.check=($)=>{if(W.pattern.lastIndex=0,W.pattern.test($.value))return;$.issues.push({origin:"string",code:"invalid_format",format:"regex",input:$.value,pattern:W.pattern.toString(),inst:Q,continue:!W.abort})}}),jJ=M("$ZodCheckLowerCase",(Q,W)=>{W.pattern??(W.pattern=LJ),p4.init(Q,W)}),zJ=M("$ZodCheckUpperCase",(Q,W)=>{W.pattern??(W.pattern=qJ),p4.init(Q,W)}),EJ=M("$ZodCheckIncludes",(Q,W)=>{I0.init(Q,W);let $=t1(W.includes),Y=new RegExp(typeof W.position==="number"?`^.{${W.position}}${$}`:$);W.pattern=Y,Q._zod.onattach.push((J)=>{let X=J._zod.bag;X.patterns??(X.patterns=new Set),X.patterns.add(Y)}),Q._zod.check=(J)=>{if(J.value.includes(W.includes,W.position))return;J.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:W.includes,input:J.value,inst:Q,continue:!W.abort})}}),PJ=M("$ZodCheckStartsWith",(Q,W)=>{I0.init(Q,W);let $=new RegExp(`^${t1(W.prefix)}.*`);W.pattern??(W.pattern=$),Q._zod.onattach.push((Y)=>{let J=Y._zod.bag;J.patterns??(J.patterns=new Set),J.patterns.add($)}),Q._zod.check=(Y)=>{if(Y.value.startsWith(W.prefix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:W.prefix,input:Y.value,inst:Q,continue:!W.abort})}}),RJ=M("$ZodCheckEndsWith",(Q,W)=>{I0.init(Q,W);let $=new RegExp(`.*${t1(W.suffix)}$`);W.pattern??(W.pattern=$),Q._zod.onattach.push((Y)=>{let J=Y._zod.bag;J.patterns??(J.patterns=new Set),J.patterns.add($)}),Q._zod.check=(Y)=>{if(Y.value.endsWith(W.suffix))return;Y.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:W.suffix,input:Y.value,inst:Q,continue:!W.abort})}});var bJ=M("$ZodCheckOverwrite",(Q,W)=>{I0.init(Q,W),Q._zod.check=($)=>{$.value=W.tx($.value)}});class $W{constructor(Q=[]){if(this.content=[],this.indent=0,this)this.args=Q}indented(Q){this.indent+=1,Q(this),this.indent-=1}write(Q){if(typeof Q==="function"){Q(this,{execution:"sync"}),Q(this,{execution:"async"});return}let $=Q.split(`
`).filter((X)=>X),Y=Math.min(...$.map((X)=>X.length-X.trimStart().length)),J=$.map((X)=>X.slice(Y)).map((X)=>" ".repeat(this.indent*2)+X);for(let X of J)this.content.push(X)}compile(){let Q=Function,W=this?.args,Y=[...(this?.content??[""]).map((J)=>`  ${J}`)];return new Q(...W,Y.join(`
`))}}var IJ={major:4,minor:0,patch:0};var Y0=M("$ZodType",(Q,W)=>{var $;Q??(Q={}),Q._zod.def=W,Q._zod.bag=Q._zod.bag||{},Q._zod.version=IJ;let Y=[...Q._zod.def.checks??[]];if(Q._zod.traits.has("$ZodCheck"))Y.unshift(Q);for(let J of Y)for(let X of J._zod.onattach)X(Q);if(Y.length===0)($=Q._zod).deferred??($.deferred=[]),Q._zod.deferred?.push(()=>{Q._zod.run=Q._zod.parse});else{let J=(X,H,G)=>{let B=j6(X),K;for(let V of H){if(V._zod.def.when){if(!V._zod.def.when(X))continue}else if(B)continue;let L=X.issues.length,U=V._zod.check(X);if(U instanceof Promise&&G?.async===!1)throw new a1;if(K||U instanceof Promise)K=(K??Promise.resolve()).then(async()=>{if(await U,X.issues.length===L)return;if(!B)B=j6(X,L)});else{if(X.issues.length===L)continue;if(!B)B=j6(X,L)}}if(K)return K.then(()=>{return X});return X};Q._zod.run=(X,H)=>{let G=Q._zod.parse(X,H);if(G instanceof Promise){if(H.async===!1)throw new a1;return G.then((B)=>J(B,Y,H))}return J(G,Y,H)}}Q["~standard"]={validate:(J)=>{try{let X=z6(Q,J);return X.success?{value:X.data}:{issues:X.error?.issues}}catch(X){return E6(Q,J).then((H)=>H.success?{value:H.data}:{issues:H.error?.issues})}},vendor:"zod",version:1}}),d4=M("$ZodString",(Q,W)=>{Y0.init(Q,W),Q._zod.pattern=[...Q?._zod.bag?.patterns??[]].pop()??GJ(Q._zod.bag),Q._zod.parse=($,Y)=>{if(W.coerce)try{$.value=String($.value)}catch(J){}if(typeof $.value==="string")return $;return $.issues.push({expected:"string",code:"invalid_type",input:$.value,inst:Q}),$}}),G0=M("$ZodStringFormat",(Q,W)=>{p4.init(Q,W),d4.init(Q,W)}),JW=M("$ZodGUID",(Q,W)=>{W.pattern??(W.pattern=i7),G0.init(Q,W)}),XW=M("$ZodUUID",(Q,W)=>{if(W.version){let Y={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[W.version];if(Y===void 0)throw Error(`Invalid UUID version: "${W.version}"`);W.pattern??(W.pattern=sQ(Y))}else W.pattern??(W.pattern=sQ());G0.init(Q,W)}),HW=M("$ZodEmail",(Q,W)=>{W.pattern??(W.pattern=n7),G0.init(Q,W)}),GW=M("$ZodURL",(Q,W)=>{G0.init(Q,W),Q._zod.check=($)=>{try{let Y=$.value,J=new URL(Y),X=J.href;if(W.hostname){if(W.hostname.lastIndex=0,!W.hostname.test(J.hostname))$.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:QJ.source,input:$.value,inst:Q,continue:!W.abort})}if(W.protocol){if(W.protocol.lastIndex=0,!W.protocol.test(J.protocol.endsWith(":")?J.protocol.slice(0,-1):J.protocol))$.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:W.protocol.source,input:$.value,inst:Q,continue:!W.abort})}if(!Y.endsWith("/")&&X.endsWith("/"))$.value=X.slice(0,-1);else $.value=X;return}catch(Y){$.issues.push({code:"invalid_format",format:"url",input:$.value,inst:Q,continue:!W.abort})}}}),BW=M("$ZodEmoji",(Q,W)=>{W.pattern??(W.pattern=o7()),G0.init(Q,W)}),KW=M("$ZodNanoID",(Q,W)=>{W.pattern??(W.pattern=p7),G0.init(Q,W)}),FW=M("$ZodCUID",(Q,W)=>{W.pattern??(W.pattern=f7),G0.init(Q,W)}),VW=M("$ZodCUID2",(Q,W)=>{W.pattern??(W.pattern=u7),G0.init(Q,W)}),LW=M("$ZodULID",(Q,W)=>{W.pattern??(W.pattern=l7),G0.init(Q,W)}),qW=M("$ZodXID",(Q,W)=>{W.pattern??(W.pattern=m7),G0.init(Q,W)}),UW=M("$ZodKSUID",(Q,W)=>{W.pattern??(W.pattern=c7),G0.init(Q,W)}),hJ=M("$ZodISODateTime",(Q,W)=>{W.pattern??(W.pattern=HJ(W)),G0.init(Q,W)}),fJ=M("$ZodISODate",(Q,W)=>{W.pattern??(W.pattern=YJ),G0.init(Q,W)}),uJ=M("$ZodISOTime",(Q,W)=>{W.pattern??(W.pattern=XJ(W)),G0.init(Q,W)}),lJ=M("$ZodISODuration",(Q,W)=>{W.pattern??(W.pattern=d7),G0.init(Q,W)}),AW=M("$ZodIPv4",(Q,W)=>{W.pattern??(W.pattern=r7),G0.init(Q,W),Q._zod.onattach.push(($)=>{let Y=$._zod.bag;Y.format="ipv4"})}),DW=M("$ZodIPv6",(Q,W)=>{W.pattern??(W.pattern=a7),G0.init(Q,W),Q._zod.onattach.push(($)=>{let Y=$._zod.bag;Y.format="ipv6"}),Q._zod.check=($)=>{try{new URL(`http://[${$.value}]`)}catch{$.issues.push({code:"invalid_format",format:"ipv6",input:$.value,inst:Q,continue:!W.abort})}}}),OW=M("$ZodCIDRv4",(Q,W)=>{W.pattern??(W.pattern=t7),G0.init(Q,W)}),wW=M("$ZodCIDRv6",(Q,W)=>{W.pattern??(W.pattern=s7),G0.init(Q,W),Q._zod.check=($)=>{let[Y,J]=$.value.split("/");try{if(!J)throw Error();let X=Number(J);if(`${X}`!==J)throw Error();if(X<0||X>128)throw Error();new URL(`http://[${Y}]`)}catch{$.issues.push({code:"invalid_format",format:"cidrv6",input:$.value,inst:Q,continue:!W.abort})}}});function mJ(Q){if(Q==="")return!0;if(Q.length%4!==0)return!1;try{return atob(Q),!0}catch{return!1}}var NW=M("$ZodBase64",(Q,W)=>{W.pattern??(W.pattern=e7),G0.init(Q,W),Q._zod.onattach.push(($)=>{$._zod.bag.contentEncoding="base64"}),Q._zod.check=($)=>{if(mJ($.value))return;$.issues.push({code:"invalid_format",format:"base64",input:$.value,inst:Q,continue:!W.abort})}});function fF(Q){if(!eQ.test(Q))return!1;let W=Q.replace(/[-_]/g,(Y)=>Y==="-"?"+":"/"),$=W.padEnd(Math.ceil(W.length/4)*4,"=");return mJ($)}var MW=M("$ZodBase64URL",(Q,W)=>{W.pattern??(W.pattern=eQ),G0.init(Q,W),Q._zod.onattach.push(($)=>{$._zod.bag.contentEncoding="base64url"}),Q._zod.check=($)=>{if(fF($.value))return;$.issues.push({code:"invalid_format",format:"base64url",input:$.value,inst:Q,continue:!W.abort})}}),jW=M("$ZodE164",(Q,W)=>{W.pattern??(W.pattern=WJ),G0.init(Q,W)});function uF(Q,W=null){try{let $=Q.split(".");if($.length!==3)return!1;let[Y]=$;if(!Y)return!1;let J=JSON.parse(atob(Y));if("typ"in J&&J?.typ!=="JWT")return!1;if(!J.alg)return!1;if(W&&(!("alg"in J)||J.alg!==W))return!1;return!0}catch{return!1}}var zW=M("$ZodJWT",(Q,W)=>{G0.init(Q,W),Q._zod.check=($)=>{if(uF($.value,W.alg))return;$.issues.push({code:"invalid_format",format:"jwt",input:$.value,inst:Q,continue:!W.abort})}});var o9=M("$ZodNumber",(Q,W)=>{Y0.init(Q,W),Q._zod.pattern=Q._zod.bag.pattern??KJ,Q._zod.parse=($,Y)=>{if(W.coerce)try{$.value=Number($.value)}catch(H){}let J=$.value;if(typeof J==="number"&&!Number.isNaN(J)&&Number.isFinite(J))return $;let X=typeof J==="number"?Number.isNaN(J)?"NaN":!Number.isFinite(J)?"Infinity":void 0:void 0;return $.issues.push({expected:"number",code:"invalid_type",input:J,inst:Q,...X?{received:X}:{}}),$}}),EW=M("$ZodNumber",(Q,W)=>{DJ.init(Q,W),o9.init(Q,W)}),PW=M("$ZodBoolean",(Q,W)=>{Y0.init(Q,W),Q._zod.pattern=FJ,Q._zod.parse=($,Y)=>{if(W.coerce)try{$.value=Boolean($.value)}catch(X){}let J=$.value;if(typeof J==="boolean")return $;return $.issues.push({expected:"boolean",code:"invalid_type",input:J,inst:Q}),$}});var RW=M("$ZodNull",(Q,W)=>{Y0.init(Q,W),Q._zod.pattern=VJ,Q._zod.values=new Set([null]),Q._zod.parse=($,Y)=>{let J=$.value;if(J===null)return $;return $.issues.push({expected:"null",code:"invalid_type",input:J,inst:Q}),$}});var bW=M("$ZodUnknown",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($)=>$}),SW=M("$ZodNever",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($,Y)=>{return $.issues.push({expected:"never",code:"invalid_type",input:$.value,inst:Q}),$}});function CJ(Q,W,$){if(Q.issues.length)W.issues.push(...b1($,Q.issues));W.value[$]=Q.value}var IW=M("$ZodArray",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($,Y)=>{let J=$.value;if(!Array.isArray(J))return $.issues.push({expected:"array",code:"invalid_type",input:J,inst:Q}),$;$.value=Array(J.length);let X=[];for(let H=0;H<J.length;H++){let G=J[H],B=W.element._zod.run({value:G,issues:[]},Y);if(B instanceof Promise)X.push(B.then((K)=>CJ(K,$,H)));else CJ(B,$,H)}if(X.length)return Promise.all(X).then(()=>$);return $}});function n9(Q,W,$){if(Q.issues.length)W.issues.push(...b1($,Q.issues));W.value[$]=Q.value}function ZJ(Q,W,$,Y){if(Q.issues.length)if(Y[$]===void 0)if($ in Y)W.value[$]=void 0;else W.value[$]=Q.value;else W.issues.push(...b1($,Q.issues));else if(Q.value===void 0){if($ in Y)W.value[$]=void 0}else W.value[$]=Q.value}var r9=M("$ZodObject",(Q,W)=>{Y0.init(Q,W);let $=f4(()=>{let L=Object.keys(W.shape);for(let q of L)if(!(W.shape[q]instanceof Y0))throw Error(`Invalid element at key "${q}": expected a Zod schema`);let U=lQ(W.shape);return{shape:W.shape,keys:L,keySet:new Set(L),numKeys:L.length,optionalKeys:new Set(U)}});H0(Q._zod,"propValues",()=>{let L=W.shape,U={};for(let q in L){let A=L[q]._zod;if(A.values){U[q]??(U[q]=new Set);for(let D of A.values)U[q].add(D)}}return U});let Y=(L)=>{let U=new $W(["shape","payload","ctx"]),q=$.value,A=(j)=>{let z=M6(j);return`shape[${z}]._zod.run({ value: input[${z}], issues: [] }, ctx)`};U.write("const input = payload.value;");let D=Object.create(null),O=0;for(let j of q.keys)D[j]=`key_${O++}`;U.write("const newResult = {}");for(let j of q.keys)if(q.optionalKeys.has(j)){let z=D[j];U.write(`const ${z} = ${A(j)};`);let C=M6(j);U.write(`
        if (${z}.issues.length) {
          if (input[${C}] === undefined) {
            if (${C} in input) {
              newResult[${C}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${z}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${C}, ...iss.path] : [${C}],
              }))
            );
          }
        } else if (${z}.value === undefined) {
          if (${C} in input) newResult[${C}] = undefined;
        } else {
          newResult[${C}] = ${z}.value;
        }
        `)}else{let z=D[j];U.write(`const ${z} = ${A(j)};`),U.write(`
          if (${z}.issues.length) payload.issues = payload.issues.concat(${z}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${M6(j)}, ...iss.path] : [${M6(j)}]
          })));`),U.write(`newResult[${M6(j)}] = ${z}.value`)}U.write("payload.value = newResult;"),U.write("return payload;");let w=U.compile();return(j,z)=>w(L,j,z)},J,X=$4,H=!l9.jitless,B=H&&fQ.value,K=W.catchall,V;Q._zod.parse=(L,U)=>{V??(V=$.value);let q=L.value;if(!X(q))return L.issues.push({expected:"object",code:"invalid_type",input:q,inst:Q}),L;let A=[];if(H&&B&&U?.async===!1&&U.jitless!==!0){if(!J)J=Y(W.shape);L=J(L,U)}else{L.value={};let z=V.shape;for(let C of V.keys){let S=z[C],D0=S._zod.run({value:q[C],issues:[]},U),b0=S._zod.optin==="optional"&&S._zod.optout==="optional";if(D0 instanceof Promise)A.push(D0.then((k1)=>b0?ZJ(k1,L,C,q):n9(k1,L,C)));else if(b0)ZJ(D0,L,C,q);else n9(D0,L,C)}}if(!K)return A.length?Promise.all(A).then(()=>L):L;let D=[],O=V.keySet,w=K._zod,j=w.def.type;for(let z of Object.keys(q)){if(O.has(z))continue;if(j==="never"){D.push(z);continue}let C=w.run({value:q[z],issues:[]},U);if(C instanceof Promise)A.push(C.then((S)=>n9(S,L,z)));else n9(C,L,z)}if(D.length)L.issues.push({code:"unrecognized_keys",keys:D,input:q,inst:Q});if(!A.length)return L;return Promise.all(A).then(()=>{return L})}});function vJ(Q,W,$,Y){for(let J of Q)if(J.issues.length===0)return W.value=J.value,W;return W.issues.push({code:"invalid_union",input:W.value,inst:$,errors:Q.map((J)=>J.issues.map((X)=>q1(X,Y,s0())))}),W}var a9=M("$ZodUnion",(Q,W)=>{Y0.init(Q,W),H0(Q._zod,"optin",()=>W.options.some(($)=>$._zod.optin==="optional")?"optional":void 0),H0(Q._zod,"optout",()=>W.options.some(($)=>$._zod.optout==="optional")?"optional":void 0),H0(Q._zod,"values",()=>{if(W.options.every(($)=>$._zod.values))return new Set(W.options.flatMap(($)=>Array.from($._zod.values)));return}),H0(Q._zod,"pattern",()=>{if(W.options.every(($)=>$._zod.pattern)){let $=W.options.map((Y)=>Y._zod.pattern);return new RegExp(`^(${$.map((Y)=>l4(Y.source)).join("|")})$`)}return}),Q._zod.parse=($,Y)=>{let J=!1,X=[];for(let H of W.options){let G=H._zod.run({value:$.value,issues:[]},Y);if(G instanceof Promise)X.push(G),J=!0;else{if(G.issues.length===0)return G;X.push(G)}}if(!J)return vJ(X,$,Q,Y);return Promise.all(X).then((H)=>{return vJ(H,$,Q,Y)})}}),CW=M("$ZodDiscriminatedUnion",(Q,W)=>{a9.init(Q,W);let $=Q._zod.parse;H0(Q._zod,"propValues",()=>{let J={};for(let X of W.options){let H=X._zod.propValues;if(!H||Object.keys(H).length===0)throw Error(`Invalid discriminated union option at index "${W.options.indexOf(X)}"`);for(let[G,B]of Object.entries(H)){if(!J[G])J[G]=new Set;for(let K of B)J[G].add(K)}}return J});let Y=f4(()=>{let J=W.options,X=new Map;for(let H of J){let G=H._zod.propValues[W.discriminator];if(!G||G.size===0)throw Error(`Invalid discriminated union option at index "${W.options.indexOf(H)}"`);for(let B of G){if(X.has(B))throw Error(`Duplicate discriminator value "${String(B)}"`);X.set(B,H)}}return X});Q._zod.parse=(J,X)=>{let H=J.value;if(!$4(H))return J.issues.push({code:"invalid_type",expected:"object",input:H,inst:Q}),J;let G=Y.value.get(H?.[W.discriminator]);if(G)return G._zod.run(J,X);if(W.unionFallback)return $(J,X);return J.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:H,path:[W.discriminator],inst:Q}),J}}),ZW=M("$ZodIntersection",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($,Y)=>{let J=$.value,X=W.left._zod.run({value:J,issues:[]},Y),H=W.right._zod.run({value:J,issues:[]},Y);if(X instanceof Promise||H instanceof Promise)return Promise.all([X,H]).then(([B,K])=>{return TJ($,B,K)});return TJ($,X,H)}});function YW(Q,W){if(Q===W)return{valid:!0,data:Q};if(Q instanceof Date&&W instanceof Date&&+Q===+W)return{valid:!0,data:Q};if(Y4(Q)&&Y4(W)){let $=Object.keys(W),Y=Object.keys(Q).filter((X)=>$.indexOf(X)!==-1),J={...Q,...W};for(let X of Y){let H=YW(Q[X],W[X]);if(!H.valid)return{valid:!1,mergeErrorPath:[X,...H.mergeErrorPath]};J[X]=H.data}return{valid:!0,data:J}}if(Array.isArray(Q)&&Array.isArray(W)){if(Q.length!==W.length)return{valid:!1,mergeErrorPath:[]};let $=[];for(let Y=0;Y<Q.length;Y++){let J=Q[Y],X=W[Y],H=YW(J,X);if(!H.valid)return{valid:!1,mergeErrorPath:[Y,...H.mergeErrorPath]};$.push(H.data)}return{valid:!0,data:$}}return{valid:!1,mergeErrorPath:[]}}function TJ(Q,W,$){if(W.issues.length)Q.issues.push(...W.issues);if($.issues.length)Q.issues.push(...$.issues);if(j6(Q))return Q;let Y=YW(W.value,$.value);if(!Y.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(Y.mergeErrorPath)}`);return Q.value=Y.data,Q}var vW=M("$ZodRecord",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($,Y)=>{let J=$.value;if(!Y4(J))return $.issues.push({expected:"record",code:"invalid_type",input:J,inst:Q}),$;let X=[];if(W.keyType._zod.values){let H=W.keyType._zod.values;$.value={};for(let B of H)if(typeof B==="string"||typeof B==="number"||typeof B==="symbol"){let K=W.valueType._zod.run({value:J[B],issues:[]},Y);if(K instanceof Promise)X.push(K.then((V)=>{if(V.issues.length)$.issues.push(...b1(B,V.issues));$.value[B]=V.value}));else{if(K.issues.length)$.issues.push(...b1(B,K.issues));$.value[B]=K.value}}let G;for(let B in J)if(!H.has(B))G=G??[],G.push(B);if(G&&G.length>0)$.issues.push({code:"unrecognized_keys",input:J,inst:Q,keys:G})}else{$.value={};for(let H of Reflect.ownKeys(J)){if(H==="__proto__")continue;let G=W.keyType._zod.run({value:H,issues:[]},Y);if(G instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(G.issues.length){$.issues.push({origin:"record",code:"invalid_key",issues:G.issues.map((K)=>q1(K,Y,s0())),input:H,path:[H],inst:Q}),$.value[G.value]=G.value;continue}let B=W.valueType._zod.run({value:J[H],issues:[]},Y);if(B instanceof Promise)X.push(B.then((K)=>{if(K.issues.length)$.issues.push(...b1(H,K.issues));$.value[G.value]=K.value}));else{if(B.issues.length)$.issues.push(...b1(H,B.issues));$.value[G.value]=B.value}}}if(X.length)return Promise.all(X).then(()=>$);return $}});var TW=M("$ZodEnum",(Q,W)=>{Y0.init(Q,W);let $=h4(W.entries);Q._zod.values=new Set($),Q._zod.pattern=new RegExp(`^(${$.filter((Y)=>uQ.has(typeof Y)).map((Y)=>typeof Y==="string"?t1(Y):Y.toString()).join("|")})$`),Q._zod.parse=(Y,J)=>{let X=Y.value;if(Q._zod.values.has(X))return Y;return Y.issues.push({code:"invalid_value",values:$,input:X,inst:Q}),Y}}),kW=M("$ZodLiteral",(Q,W)=>{Y0.init(Q,W),Q._zod.values=new Set(W.values),Q._zod.pattern=new RegExp(`^(${W.values.map(($)=>typeof $==="string"?t1($):$?$.toString():String($)).join("|")})$`),Q._zod.parse=($,Y)=>{let J=$.value;if(Q._zod.values.has(J))return $;return $.issues.push({code:"invalid_value",values:W.values,input:J,inst:Q}),$}});var _W=M("$ZodTransform",(Q,W)=>{Y0.init(Q,W),Q._zod.parse=($,Y)=>{let J=W.transform($.value,$);if(Y.async)return(J instanceof Promise?J:Promise.resolve(J)).then((H)=>{return $.value=H,$});if(J instanceof Promise)throw new a1;return $.value=J,$}}),xW=M("$ZodOptional",(Q,W)=>{Y0.init(Q,W),Q._zod.optin="optional",Q._zod.optout="optional",H0(Q._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,void 0]):void 0}),H0(Q._zod,"pattern",()=>{let $=W.innerType._zod.pattern;return $?new RegExp(`^(${l4($.source)})?$`):void 0}),Q._zod.parse=($,Y)=>{if(W.innerType._zod.optin==="optional")return W.innerType._zod.run($,Y);if($.value===void 0)return $;return W.innerType._zod.run($,Y)}}),yW=M("$ZodNullable",(Q,W)=>{Y0.init(Q,W),H0(Q._zod,"optin",()=>W.innerType._zod.optin),H0(Q._zod,"optout",()=>W.innerType._zod.optout),H0(Q._zod,"pattern",()=>{let $=W.innerType._zod.pattern;return $?new RegExp(`^(${l4($.source)}|null)$`):void 0}),H0(Q._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,null]):void 0}),Q._zod.parse=($,Y)=>{if($.value===null)return $;return W.innerType._zod.run($,Y)}}),gW=M("$ZodDefault",(Q,W)=>{Y0.init(Q,W),Q._zod.optin="optional",H0(Q._zod,"values",()=>W.innerType._zod.values),Q._zod.parse=($,Y)=>{if($.value===void 0)return $.value=W.defaultValue,$;let J=W.innerType._zod.run($,Y);if(J instanceof Promise)return J.then((X)=>kJ(X,W));return kJ(J,W)}});function kJ(Q,W){if(Q.value===void 0)Q.value=W.defaultValue;return Q}var hW=M("$ZodPrefault",(Q,W)=>{Y0.init(Q,W),Q._zod.optin="optional",H0(Q._zod,"values",()=>W.innerType._zod.values),Q._zod.parse=($,Y)=>{if($.value===void 0)$.value=W.defaultValue;return W.innerType._zod.run($,Y)}}),fW=M("$ZodNonOptional",(Q,W)=>{Y0.init(Q,W),H0(Q._zod,"values",()=>{let $=W.innerType._zod.values;return $?new Set([...$].filter((Y)=>Y!==void 0)):void 0}),Q._zod.parse=($,Y)=>{let J=W.innerType._zod.run($,Y);if(J instanceof Promise)return J.then((X)=>_J(X,Q));return _J(J,Q)}});function _J(Q,W){if(!Q.issues.length&&Q.value===void 0)Q.issues.push({code:"invalid_type",expected:"nonoptional",input:Q.value,inst:W});return Q}var uW=M("$ZodCatch",(Q,W)=>{Y0.init(Q,W),Q._zod.optin="optional",H0(Q._zod,"optout",()=>W.innerType._zod.optout),H0(Q._zod,"values",()=>W.innerType._zod.values),Q._zod.parse=($,Y)=>{let J=W.innerType._zod.run($,Y);if(J instanceof Promise)return J.then((X)=>{if($.value=X.value,X.issues.length)$.value=W.catchValue({...$,error:{issues:X.issues.map((H)=>q1(H,Y,s0()))},input:$.value}),$.issues=[];return $});if($.value=J.value,J.issues.length)$.value=W.catchValue({...$,error:{issues:J.issues.map((X)=>q1(X,Y,s0()))},input:$.value}),$.issues=[];return $}});var lW=M("$ZodPipe",(Q,W)=>{Y0.init(Q,W),H0(Q._zod,"values",()=>W.in._zod.values),H0(Q._zod,"optin",()=>W.in._zod.optin),H0(Q._zod,"optout",()=>W.out._zod.optout),Q._zod.parse=($,Y)=>{let J=W.in._zod.run($,Y);if(J instanceof Promise)return J.then((X)=>xJ(X,W,Y));return xJ(J,W,Y)}});function xJ(Q,W,$){if(j6(Q))return Q;return W.out._zod.run({value:Q.value,issues:Q.issues},$)}var mW=M("$ZodReadonly",(Q,W)=>{Y0.init(Q,W),H0(Q._zod,"propValues",()=>W.innerType._zod.propValues),H0(Q._zod,"values",()=>W.innerType._zod.values),H0(Q._zod,"optin",()=>W.innerType._zod.optin),H0(Q._zod,"optout",()=>W.innerType._zod.optout),Q._zod.parse=($,Y)=>{let J=W.innerType._zod.run($,Y);if(J instanceof Promise)return J.then(yJ);return yJ(J)}});function yJ(Q){return Q.value=Object.freeze(Q.value),Q}var cW=M("$ZodCustom",(Q,W)=>{I0.init(Q,W),Y0.init(Q,W),Q._zod.parse=($,Y)=>{return $},Q._zod.check=($)=>{let Y=$.value,J=W.fn(Y);if(J instanceof Promise)return J.then((X)=>gJ(X,$,Y,Q));gJ(J,$,Y,Q);return}});function gJ(Q,W,$,Y){if(!Q){let J={code:"custom",input:$,inst:Y,path:[...Y._zod.def.path??[]],continue:!Y._zod.def.abort};if(Y._zod.def.params)J.params=Y._zod.def.params;W.issues.push(cQ(J))}}var lF=(Q)=>{let W=typeof Q;switch(W){case"number":return Number.isNaN(Q)?"NaN":"number";case"object":{if(Array.isArray(Q))return"array";if(Q===null)return"null";if(Object.getPrototypeOf(Q)!==Object.prototype&&Q.constructor)return Q.constructor.name}}return W},mF=()=>{let Q={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function W(Y){return Q[Y]??null}let $={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Invalid input: expected ${Y.expected}, received ${lF(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Invalid input: expected ${p9(Y.values[0])}`;return`Invalid option: expected one of ${m9(Y.values,"|")}`;case"too_big":{let J=Y.inclusive?"<=":"<",X=W(Y.origin);if(X)return`Too big: expected ${Y.origin??"value"} to have ${J}${Y.maximum.toString()} ${X.unit??"elements"}`;return`Too big: expected ${Y.origin??"value"} to be ${J}${Y.maximum.toString()}`}case"too_small":{let J=Y.inclusive?">=":">",X=W(Y.origin);if(X)return`Too small: expected ${Y.origin} to have ${J}${Y.minimum.toString()} ${X.unit}`;return`Too small: expected ${Y.origin} to be ${J}${Y.minimum.toString()}`}case"invalid_format":{let J=Y;if(J.format==="starts_with")return`Invalid string: must start with "${J.prefix}"`;if(J.format==="ends_with")return`Invalid string: must end with "${J.suffix}"`;if(J.format==="includes")return`Invalid string: must include "${J.includes}"`;if(J.format==="regex")return`Invalid string: must match pattern ${J.pattern}`;return`Invalid ${$[J.format]??Y.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${Y.divisor}`;case"unrecognized_keys":return`Unrecognized key${Y.keys.length>1?"s":""}: ${m9(Y.keys,", ")}`;case"invalid_key":return`Invalid key in ${Y.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${Y.origin}`;default:return"Invalid input"}}};function pW(){return{localeError:mF()}}var cF=Symbol("ZodOutput"),pF=Symbol("ZodInput");class t9{constructor(){this._map=new Map,this._idmap=new Map}add(Q,...W){let $=W[0];if(this._map.set(Q,$),$&&typeof $==="object"&&"id"in $){if(this._idmap.has($.id))throw Error(`ID ${$.id} already exists in the registry`);this._idmap.set($.id,Q)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(Q){let W=this._map.get(Q);if(W&&typeof W==="object"&&"id"in W)this._idmap.delete(W.id);return this._map.delete(Q),this}get(Q){let W=Q._zod.parent;if(W){let $={...this.get(W)??{}};return delete $.id,{...$,...this._map.get(Q)}}return this._map.get(Q)}has(Q){return this._map.has(Q)}}function cJ(){return new t9}var s1=cJ();function dW(Q,W){return new Q({type:"string",...f(W)})}function iW(Q,W){return new Q({type:"string",format:"email",check:"string_format",abort:!1,...f(W)})}function s9(Q,W){return new Q({type:"string",format:"guid",check:"string_format",abort:!1,...f(W)})}function nW(Q,W){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,...f(W)})}function oW(Q,W){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...f(W)})}function rW(Q,W){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...f(W)})}function aW(Q,W){return new Q({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...f(W)})}function tW(Q,W){return new Q({type:"string",format:"url",check:"string_format",abort:!1,...f(W)})}function sW(Q,W){return new Q({type:"string",format:"emoji",check:"string_format",abort:!1,...f(W)})}function eW(Q,W){return new Q({type:"string",format:"nanoid",check:"string_format",abort:!1,...f(W)})}function Q$(Q,W){return new Q({type:"string",format:"cuid",check:"string_format",abort:!1,...f(W)})}function W$(Q,W){return new Q({type:"string",format:"cuid2",check:"string_format",abort:!1,...f(W)})}function $$(Q,W){return new Q({type:"string",format:"ulid",check:"string_format",abort:!1,...f(W)})}function Y$(Q,W){return new Q({type:"string",format:"xid",check:"string_format",abort:!1,...f(W)})}function J$(Q,W){return new Q({type:"string",format:"ksuid",check:"string_format",abort:!1,...f(W)})}function X$(Q,W){return new Q({type:"string",format:"ipv4",check:"string_format",abort:!1,...f(W)})}function H$(Q,W){return new Q({type:"string",format:"ipv6",check:"string_format",abort:!1,...f(W)})}function G$(Q,W){return new Q({type:"string",format:"cidrv4",check:"string_format",abort:!1,...f(W)})}function B$(Q,W){return new Q({type:"string",format:"cidrv6",check:"string_format",abort:!1,...f(W)})}function K$(Q,W){return new Q({type:"string",format:"base64",check:"string_format",abort:!1,...f(W)})}function F$(Q,W){return new Q({type:"string",format:"base64url",check:"string_format",abort:!1,...f(W)})}function V$(Q,W){return new Q({type:"string",format:"e164",check:"string_format",abort:!1,...f(W)})}function L$(Q,W){return new Q({type:"string",format:"jwt",check:"string_format",abort:!1,...f(W)})}function pJ(Q,W){return new Q({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...f(W)})}function dJ(Q,W){return new Q({type:"string",format:"date",check:"string_format",...f(W)})}function iJ(Q,W){return new Q({type:"string",format:"time",check:"string_format",precision:null,...f(W)})}function nJ(Q,W){return new Q({type:"string",format:"duration",check:"string_format",...f(W)})}function q$(Q,W){return new Q({type:"number",checks:[],...f(W)})}function U$(Q,W){return new Q({type:"number",check:"number_format",abort:!1,format:"safeint",...f(W)})}function A$(Q,W){return new Q({type:"boolean",...f(W)})}function D$(Q,W){return new Q({type:"null",...f(W)})}function O$(Q){return new Q({type:"unknown"})}function w$(Q,W){return new Q({type:"never",...f(W)})}function e9(Q,W){return new QW({check:"less_than",...f(W),value:Q,inclusive:!1})}function i4(Q,W){return new QW({check:"less_than",...f(W),value:Q,inclusive:!0})}function Q8(Q,W){return new WW({check:"greater_than",...f(W),value:Q,inclusive:!1})}function n4(Q,W){return new WW({check:"greater_than",...f(W),value:Q,inclusive:!0})}function W8(Q,W){return new AJ({check:"multiple_of",...f(W),value:Q})}function $8(Q,W){return new OJ({check:"max_length",...f(W),maximum:Q})}function J4(Q,W){return new wJ({check:"min_length",...f(W),minimum:Q})}function Y8(Q,W){return new NJ({check:"length_equals",...f(W),length:Q})}function N$(Q,W){return new MJ({check:"string_format",format:"regex",...f(W),pattern:Q})}function M$(Q){return new jJ({check:"string_format",format:"lowercase",...f(Q)})}function j$(Q){return new zJ({check:"string_format",format:"uppercase",...f(Q)})}function z$(Q,W){return new EJ({check:"string_format",format:"includes",...f(W),includes:Q})}function E$(Q,W){return new PJ({check:"string_format",format:"starts_with",...f(W),prefix:Q})}function P$(Q,W){return new RJ({check:"string_format",format:"ends_with",...f(W),suffix:Q})}function P6(Q){return new bJ({check:"overwrite",tx:Q})}function R$(Q){return P6((W)=>W.normalize(Q))}function b$(){return P6((Q)=>Q.trim())}function S$(){return P6((Q)=>Q.toLowerCase())}function I$(){return P6((Q)=>Q.toUpperCase())}function oJ(Q,W,$){return new Q({type:"array",element:W,...f($)})}function C$(Q,W,$){let Y=f($);return Y.abort??(Y.abort=!0),new Q({type:"custom",check:"custom",fn:W,...Y})}function Z$(Q,W,$){return new Q({type:"custom",check:"custom",fn:W,...f($)})}class v${constructor(Q){this.counter=0,this.metadataRegistry=Q?.metadata??s1,this.target=Q?.target??"draft-2020-12",this.unrepresentable=Q?.unrepresentable??"throw",this.override=Q?.override??(()=>{}),this.io=Q?.io??"output",this.seen=new Map}process(Q,W={path:[],schemaPath:[]}){var $;let Y=Q._zod.def,J={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},X=this.seen.get(Q);if(X){if(X.count++,W.schemaPath.includes(Q))X.cycle=W.path;return X.schema}let H={schema:{},count:1,cycle:void 0,path:W.path};this.seen.set(Q,H);let G=Q._zod.toJSONSchema?.();if(G)H.schema=G;else{let V={...W,schemaPath:[...W.schemaPath,Q],path:W.path},L=Q._zod.parent;if(L)H.ref=L,this.process(L,V),this.seen.get(L).isParent=!0;else{let U=H.schema;switch(Y.type){case"string":{let q=U;q.type="string";let{minimum:A,maximum:D,format:O,patterns:w,contentEncoding:j}=Q._zod.bag;if(typeof A==="number")q.minLength=A;if(typeof D==="number")q.maxLength=D;if(O){if(q.format=J[O]??O,q.format==="")delete q.format}if(j)q.contentEncoding=j;if(w&&w.size>0){let z=[...w];if(z.length===1)q.pattern=z[0].source;else if(z.length>1)H.schema.allOf=[...z.map((C)=>({...this.target==="draft-7"?{type:"string"}:{},pattern:C.source}))]}break}case"number":{let q=U,{minimum:A,maximum:D,format:O,multipleOf:w,exclusiveMaximum:j,exclusiveMinimum:z}=Q._zod.bag;if(typeof O==="string"&&O.includes("int"))q.type="integer";else q.type="number";if(typeof z==="number")q.exclusiveMinimum=z;if(typeof A==="number"){if(q.minimum=A,typeof z==="number")if(z>=A)delete q.minimum;else delete q.exclusiveMinimum}if(typeof j==="number")q.exclusiveMaximum=j;if(typeof D==="number"){if(q.maximum=D,typeof j==="number")if(j<=D)delete q.maximum;else delete q.exclusiveMaximum}if(typeof w==="number")q.multipleOf=w;break}case"boolean":{let q=U;q.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw Error("Symbols cannot be represented in JSON Schema");break}case"null":{U.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw Error("Void cannot be represented in JSON Schema");break}case"never":{U.not={};break}case"date":{if(this.unrepresentable==="throw")throw Error("Date cannot be represented in JSON Schema");break}case"array":{let q=U,{minimum:A,maximum:D}=Q._zod.bag;if(typeof A==="number")q.minItems=A;if(typeof D==="number")q.maxItems=D;q.type="array",q.items=this.process(Y.element,{...V,path:[...V.path,"items"]});break}case"object":{let q=U;q.type="object",q.properties={};let A=Y.shape;for(let w in A)q.properties[w]=this.process(A[w],{...V,path:[...V.path,"properties",w]});let D=new Set(Object.keys(A)),O=new Set([...D].filter((w)=>{let j=Y.shape[w]._zod;if(this.io==="input")return j.optin===void 0;else return j.optout===void 0}));if(O.size>0)q.required=Array.from(O);if(Y.catchall?._zod.def.type==="never")q.additionalProperties=!1;else if(!Y.catchall){if(this.io==="output")q.additionalProperties=!1}else if(Y.catchall)q.additionalProperties=this.process(Y.catchall,{...V,path:[...V.path,"additionalProperties"]});break}case"union":{let q=U;q.anyOf=Y.options.map((A,D)=>this.process(A,{...V,path:[...V.path,"anyOf",D]}));break}case"intersection":{let q=U,A=this.process(Y.left,{...V,path:[...V.path,"allOf",0]}),D=this.process(Y.right,{...V,path:[...V.path,"allOf",1]}),O=(j)=>("allOf"in j)&&Object.keys(j).length===1,w=[...O(A)?A.allOf:[A],...O(D)?D.allOf:[D]];q.allOf=w;break}case"tuple":{let q=U;q.type="array";let A=Y.items.map((w,j)=>this.process(w,{...V,path:[...V.path,"prefixItems",j]}));if(this.target==="draft-2020-12")q.prefixItems=A;else q.items=A;if(Y.rest){let w=this.process(Y.rest,{...V,path:[...V.path,"items"]});if(this.target==="draft-2020-12")q.items=w;else q.additionalItems=w}if(Y.rest)q.items=this.process(Y.rest,{...V,path:[...V.path,"items"]});let{minimum:D,maximum:O}=Q._zod.bag;if(typeof D==="number")q.minItems=D;if(typeof O==="number")q.maxItems=O;break}case"record":{let q=U;q.type="object",q.propertyNames=this.process(Y.keyType,{...V,path:[...V.path,"propertyNames"]}),q.additionalProperties=this.process(Y.valueType,{...V,path:[...V.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw Error("Set cannot be represented in JSON Schema");break}case"enum":{let q=U,A=h4(Y.entries);if(A.every((D)=>typeof D==="number"))q.type="number";if(A.every((D)=>typeof D==="string"))q.type="string";q.enum=A;break}case"literal":{let q=U,A=[];for(let D of Y.values)if(D===void 0){if(this.unrepresentable==="throw")throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof D==="bigint")if(this.unrepresentable==="throw")throw Error("BigInt literals cannot be represented in JSON Schema");else A.push(Number(D));else A.push(D);if(A.length===0);else if(A.length===1){let D=A[0];q.type=D===null?"null":typeof D,q.const=D}else{if(A.every((D)=>typeof D==="number"))q.type="number";if(A.every((D)=>typeof D==="string"))q.type="string";if(A.every((D)=>typeof D==="boolean"))q.type="string";if(A.every((D)=>D===null))q.type="null";q.enum=A}break}case"file":{let q=U,A={type:"string",format:"binary",contentEncoding:"binary"},{minimum:D,maximum:O,mime:w}=Q._zod.bag;if(D!==void 0)A.minLength=D;if(O!==void 0)A.maxLength=O;if(w)if(w.length===1)A.contentMediaType=w[0],Object.assign(q,A);else q.anyOf=w.map((j)=>{return{...A,contentMediaType:j}});else Object.assign(q,A);break}case"transform":{if(this.unrepresentable==="throw")throw Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let q=this.process(Y.innerType,V);U.anyOf=[q,{type:"null"}];break}case"nonoptional":{this.process(Y.innerType,V),H.ref=Y.innerType;break}case"success":{let q=U;q.type="boolean";break}case"default":{this.process(Y.innerType,V),H.ref=Y.innerType,U.default=JSON.parse(JSON.stringify(Y.defaultValue));break}case"prefault":{if(this.process(Y.innerType,V),H.ref=Y.innerType,this.io==="input")U._prefault=JSON.parse(JSON.stringify(Y.defaultValue));break}case"catch":{this.process(Y.innerType,V),H.ref=Y.innerType;let q;try{q=Y.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}U.default=q;break}case"nan":{if(this.unrepresentable==="throw")throw Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let q=U,A=Q._zod.pattern;if(!A)throw Error("Pattern not found in template literal");q.type="string",q.pattern=A.source;break}case"pipe":{let q=this.io==="input"?Y.in._zod.def.type==="transform"?Y.out:Y.in:Y.out;this.process(q,V),H.ref=q;break}case"readonly":{this.process(Y.innerType,V),H.ref=Y.innerType,U.readOnly=!0;break}case"promise":{this.process(Y.innerType,V),H.ref=Y.innerType;break}case"optional":{this.process(Y.innerType,V),H.ref=Y.innerType;break}case"lazy":{let q=Q._zod.innerType;this.process(q,V),H.ref=q;break}case"custom":{if(this.unrepresentable==="throw")throw Error("Custom types cannot be represented in JSON Schema");break}default:}}}let B=this.metadataRegistry.get(Q);if(B)Object.assign(H.schema,B);if(this.io==="input"&&E0(Q))delete H.schema.examples,delete H.schema.default;if(this.io==="input"&&H.schema._prefault)($=H.schema).default??($.default=H.schema._prefault);return delete H.schema._prefault,this.seen.get(Q).schema}emit(Q,W){let $={cycles:W?.cycles??"ref",reused:W?.reused??"inline",external:W?.external??void 0},Y=this.seen.get(Q);if(!Y)throw Error("Unprocessed schema. This is a bug in Zod.");let J=(K)=>{let V=this.target==="draft-2020-12"?"$defs":"definitions";if($.external){let A=$.external.registry.get(K[0])?.id,D=$.external.uri??((w)=>w);if(A)return{ref:D(A)};let O=K[1].defId??K[1].schema.id??`schema${this.counter++}`;return K[1].defId=O,{defId:O,ref:`${D("__shared")}#/${V}/${O}`}}if(K[1]===Y)return{ref:"#"};let U=`${"#"}/${V}/`,q=K[1].schema.id??`__schema${this.counter++}`;return{defId:q,ref:U+q}},X=(K)=>{if(K[1].schema.$ref)return;let V=K[1],{ref:L,defId:U}=J(K);if(V.def={...V.schema},U)V.defId=U;let q=V.schema;for(let A in q)delete q[A];q.$ref=L};if($.cycles==="throw")for(let K of this.seen.entries()){let V=K[1];if(V.cycle)throw Error(`Cycle detected: #/${V.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let K of this.seen.entries()){let V=K[1];if(Q===K[0]){X(K);continue}if($.external){let U=$.external.registry.get(K[0])?.id;if(Q!==K[0]&&U){X(K);continue}}if(this.metadataRegistry.get(K[0])?.id){X(K);continue}if(V.cycle){X(K);continue}if(V.count>1){if($.reused==="ref"){X(K);continue}}}let H=(K,V)=>{let L=this.seen.get(K),U=L.def??L.schema,q={...U};if(L.ref===null)return;let A=L.ref;if(L.ref=null,A){H(A,V);let D=this.seen.get(A).schema;if(D.$ref&&V.target==="draft-7")U.allOf=U.allOf??[],U.allOf.push(D);else Object.assign(U,D),Object.assign(U,q)}if(!L.isParent)this.override({zodSchema:K,jsonSchema:U,path:L.path??[]})};for(let K of[...this.seen.entries()].reverse())H(K[0],{target:this.target});let G={};if(this.target==="draft-2020-12")G.$schema="https://json-schema.org/draft/2020-12/schema";else if(this.target==="draft-7")G.$schema="http://json-schema.org/draft-07/schema#";else console.warn(`Invalid target: ${this.target}`);if($.external?.uri){let K=$.external.registry.get(Q)?.id;if(!K)throw Error("Schema is missing an `id` property");G.$id=$.external.uri(K)}Object.assign(G,Y.def);let B=$.external?.defs??{};for(let K of this.seen.entries()){let V=K[1];if(V.def&&V.defId)B[V.defId]=V.def}if($.external);else if(Object.keys(B).length>0)if(this.target==="draft-2020-12")G.$defs=B;else G.definitions=B;try{return JSON.parse(JSON.stringify(G))}catch(K){throw Error("Error converting schema to JSON.")}}}function T$(Q,W){if(Q instanceof t9){let Y=new v$(W),J={};for(let G of Q._idmap.entries()){let[B,K]=G;Y.process(K)}let X={},H={registry:Q,uri:W?.uri,defs:J};for(let G of Q._idmap.entries()){let[B,K]=G;X[B]=Y.emit(K,{...W,external:H})}if(Object.keys(J).length>0){let G=Y.target==="draft-2020-12"?"$defs":"definitions";X.__shared={[G]:J}}return{schemas:X}}let $=new v$(W);return $.process(Q),$.emit(Q,W)}function E0(Q,W){let $=W??{seen:new Set};if($.seen.has(Q))return!1;$.seen.add(Q);let J=Q._zod.def;switch(J.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return E0(J.element,$);case"object":{for(let X in J.shape)if(E0(J.shape[X],$))return!0;return!1}case"union":{for(let X of J.options)if(E0(X,$))return!0;return!1}case"intersection":return E0(J.left,$)||E0(J.right,$);case"tuple":{for(let X of J.items)if(E0(X,$))return!0;if(J.rest&&E0(J.rest,$))return!0;return!1}case"record":return E0(J.keyType,$)||E0(J.valueType,$);case"map":return E0(J.keyType,$)||E0(J.valueType,$);case"set":return E0(J.valueType,$);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return E0(J.innerType,$);case"lazy":return E0(J.getter(),$);case"default":return E0(J.innerType,$);case"prefault":return E0(J.innerType,$);case"custom":return!1;case"transform":return!0;case"pipe":return E0(J.in,$)||E0(J.out,$);case"success":return!1;case"catch":return!1;default:}throw Error(`Unknown schema type: ${J.type}`)}var RV=M("ZodMiniType",(Q,W)=>{if(!Q._zod)throw Error("Uninitialized schema in ZodMiniType.");Y0.init(Q,W),Q.def=W,Q.parse=($,Y)=>nQ(Q,$,Y,{callee:Q.parse}),Q.safeParse=($,Y)=>z6(Q,$,Y),Q.parseAsync=async($,Y)=>rQ(Q,$,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async($,Y)=>E6(Q,$,Y),Q.check=(...$)=>{return Q.clone({...W,checks:[...W.checks??[],...$.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=($,Y)=>e0(Q,$,Y),Q.brand=()=>Q,Q.register=($,Y)=>{return $.add(Q,Y),Q}});var bV=M("ZodMiniObject",(Q,W)=>{r9.init(Q,W),RV.init(Q,W),r.defineLazy(Q,"shape",()=>W.shape)});function k$(Q,W){let $={type:"object",get shape(){return r.assignProp(this,"shape",{...Q}),this.shape},...r.normalizeParams(W)};return new bV($)}function $1(Q){return!!Q._zod}function b6(Q){let W=Object.values(Q);if(W.length===0)return k$({});let $=W.every($1),Y=W.every((J)=>!$1(J));if($)return k$(Q);if(Y)return _Q(Q);throw Error("Mixed Zod versions detected in object shape.")}function e1(Q,W){if($1(Q))return z6(Q,W);return Q.safeParse(W)}async function J8(Q,W){if($1(Q))return await E6(Q,W);return await Q.safeParseAsync(W)}function Q6(Q){if(!Q)return;let W;if($1(Q))W=Q._zod?.def?.shape;else W=Q.shape;if(!W)return;if(typeof W==="function")try{return W()}catch{return}return W}function X4(Q){if(!Q)return;if(typeof Q==="object"){let W=Q,$=Q;if(!W._def&&!$._zod){let Y=Object.values(Q);if(Y.length>0&&Y.every((J)=>typeof J==="object"&&J!==null&&(J._def!==void 0||J._zod!==void 0||typeof J.parse==="function")))return b6(Q)}}if($1(Q)){let $=Q._zod?.def;if($&&($.type==="object"||$.shape!==void 0))return Q}else if(Q.shape!==void 0)return Q;return}function X8(Q){if(Q&&typeof Q==="object"){if("message"in Q&&typeof Q.message==="string")return Q.message;if("issues"in Q&&Array.isArray(Q.issues)&&Q.issues.length>0){let W=Q.issues[0];if(W&&typeof W==="object"&&"message"in W)return String(W.message)}try{return JSON.stringify(Q)}catch{return String(Q)}}return String(Q)}function aJ(Q){return Q.description}function tJ(Q){if($1(Q))return Q._zod?.def?.type==="optional";let W=Q;if(typeof Q.isOptional==="function")return Q.isOptional();return W._def?.typeName==="ZodOptional"}function H8(Q){if($1(Q)){let X=Q._zod?.def;if(X){if(X.value!==void 0)return X.value;if(Array.isArray(X.values)&&X.values.length>0)return X.values[0]}}let $=Q._def;if($){if($.value!==void 0)return $.value;if(Array.isArray($.values)&&$.values.length>0)return $.values[0]}let Y=Q.value;if(Y!==void 0)return Y;return}var o4={};ZQ(o4,{time:()=>y$,duration:()=>g$,datetime:()=>_$,date:()=>x$,ZodISOTime:()=>QX,ZodISODuration:()=>WX,ZodISODateTime:()=>sJ,ZodISODate:()=>eJ});var sJ=M("ZodISODateTime",(Q,W)=>{hJ.init(Q,W),L0.init(Q,W)});function _$(Q){return pJ(sJ,Q)}var eJ=M("ZodISODate",(Q,W)=>{fJ.init(Q,W),L0.init(Q,W)});function x$(Q){return dJ(eJ,Q)}var QX=M("ZodISOTime",(Q,W)=>{uJ.init(Q,W),L0.init(Q,W)});function y$(Q){return iJ(QX,Q)}var WX=M("ZodISODuration",(Q,W)=>{lJ.init(Q,W),L0.init(Q,W)});function g$(Q){return nJ(WX,Q)}var $X=(Q,W)=>{d9.init(Q,W),Q.name="ZodError",Object.defineProperties(Q,{format:{value:($)=>dQ(Q,$)},flatten:{value:($)=>pQ(Q,$)},addIssue:{value:($)=>Q.issues.push($)},addIssues:{value:($)=>Q.issues.push(...$)},isEmpty:{get(){return Q.issues.length===0}}})},lj=M("ZodError",$X),r4=M("ZodError",$X,{Parent:Error});var YX=iQ(r4),JX=oQ(r4),XX=aQ(r4),HX=tQ(r4);var N0=M("ZodType",(Q,W)=>{return Y0.init(Q,W),Q.def=W,Object.defineProperty(Q,"_def",{value:W}),Q.check=(...$)=>{return Q.clone({...W,checks:[...W.checks??[],...$.map((Y)=>typeof Y==="function"?{_zod:{check:Y,def:{check:"custom"},onattach:[]}}:Y)]})},Q.clone=($,Y)=>e0(Q,$,Y),Q.brand=()=>Q,Q.register=($,Y)=>{return $.add(Q,Y),Q},Q.parse=($,Y)=>YX(Q,$,Y,{callee:Q.parse}),Q.safeParse=($,Y)=>XX(Q,$,Y),Q.parseAsync=async($,Y)=>JX(Q,$,Y,{callee:Q.parseAsync}),Q.safeParseAsync=async($,Y)=>HX(Q,$,Y),Q.spa=Q.safeParseAsync,Q.refine=($,Y)=>Q.check(EL($,Y)),Q.superRefine=($)=>Q.check(PL($)),Q.overwrite=($)=>Q.check(P6($)),Q.optional=()=>w0(Q),Q.nullable=()=>KX(Q),Q.nullish=()=>w0(KX(Q)),Q.nonoptional=($)=>DL(Q,$),Q.array=()=>a(Q),Q.or=($)=>B0([Q,$]),Q.and=($)=>B8(Q,$),Q.transform=($)=>f$(Q,UX($)),Q.default=($)=>qL(Q,$),Q.prefault=($)=>AL(Q,$),Q.catch=($)=>wL(Q,$),Q.pipe=($)=>f$(Q,$),Q.readonly=()=>jL(Q),Q.describe=($)=>{let Y=Q.clone();return s1.add(Y,{description:$}),Y},Object.defineProperty(Q,"description",{get(){return s1.get(Q)?.description},configurable:!0}),Q.meta=(...$)=>{if($.length===0)return s1.get(Q);let Y=Q.clone();return s1.add(Y,$[0]),Y},Q.isOptional=()=>Q.safeParse(void 0).success,Q.isNullable=()=>Q.safeParse(null).success,Q}),FX=M("_ZodString",(Q,W)=>{d4.init(Q,W),N0.init(Q,W);let $=Q._zod.bag;Q.format=$.format??null,Q.minLength=$.minimum??null,Q.maxLength=$.maximum??null,Q.regex=(...Y)=>Q.check(N$(...Y)),Q.includes=(...Y)=>Q.check(z$(...Y)),Q.startsWith=(...Y)=>Q.check(E$(...Y)),Q.endsWith=(...Y)=>Q.check(P$(...Y)),Q.min=(...Y)=>Q.check(J4(...Y)),Q.max=(...Y)=>Q.check($8(...Y)),Q.length=(...Y)=>Q.check(Y8(...Y)),Q.nonempty=(...Y)=>Q.check(J4(1,...Y)),Q.lowercase=(Y)=>Q.check(M$(Y)),Q.uppercase=(Y)=>Q.check(j$(Y)),Q.trim=()=>Q.check(b$()),Q.normalize=(...Y)=>Q.check(R$(...Y)),Q.toLowerCase=()=>Q.check(S$()),Q.toUpperCase=()=>Q.check(I$())}),xV=M("ZodString",(Q,W)=>{d4.init(Q,W),FX.init(Q,W),Q.email=($)=>Q.check(iW(yV,$)),Q.url=($)=>Q.check(tW(gV,$)),Q.jwt=($)=>Q.check(L$(sV,$)),Q.emoji=($)=>Q.check(sW(hV,$)),Q.guid=($)=>Q.check(s9(GX,$)),Q.uuid=($)=>Q.check(nW(G8,$)),Q.uuidv4=($)=>Q.check(oW(G8,$)),Q.uuidv6=($)=>Q.check(rW(G8,$)),Q.uuidv7=($)=>Q.check(aW(G8,$)),Q.nanoid=($)=>Q.check(eW(fV,$)),Q.guid=($)=>Q.check(s9(GX,$)),Q.cuid=($)=>Q.check(Q$(uV,$)),Q.cuid2=($)=>Q.check(W$(lV,$)),Q.ulid=($)=>Q.check($$(mV,$)),Q.base64=($)=>Q.check(K$(rV,$)),Q.base64url=($)=>Q.check(F$(aV,$)),Q.xid=($)=>Q.check(Y$(cV,$)),Q.ksuid=($)=>Q.check(J$(pV,$)),Q.ipv4=($)=>Q.check(X$(dV,$)),Q.ipv6=($)=>Q.check(H$(iV,$)),Q.cidrv4=($)=>Q.check(G$(nV,$)),Q.cidrv6=($)=>Q.check(B$(oV,$)),Q.e164=($)=>Q.check(V$(tV,$)),Q.datetime=($)=>Q.check(_$($)),Q.date=($)=>Q.check(x$($)),Q.time=($)=>Q.check(y$($)),Q.duration=($)=>Q.check(g$($))});function N(Q){return dW(xV,Q)}var L0=M("ZodStringFormat",(Q,W)=>{G0.init(Q,W),FX.init(Q,W)}),yV=M("ZodEmail",(Q,W)=>{HW.init(Q,W),L0.init(Q,W)});var GX=M("ZodGUID",(Q,W)=>{JW.init(Q,W),L0.init(Q,W)});var G8=M("ZodUUID",(Q,W)=>{XW.init(Q,W),L0.init(Q,W)});var gV=M("ZodURL",(Q,W)=>{GW.init(Q,W),L0.init(Q,W)});var hV=M("ZodEmoji",(Q,W)=>{BW.init(Q,W),L0.init(Q,W)});var fV=M("ZodNanoID",(Q,W)=>{KW.init(Q,W),L0.init(Q,W)});var uV=M("ZodCUID",(Q,W)=>{FW.init(Q,W),L0.init(Q,W)});var lV=M("ZodCUID2",(Q,W)=>{VW.init(Q,W),L0.init(Q,W)});var mV=M("ZodULID",(Q,W)=>{LW.init(Q,W),L0.init(Q,W)});var cV=M("ZodXID",(Q,W)=>{qW.init(Q,W),L0.init(Q,W)});var pV=M("ZodKSUID",(Q,W)=>{UW.init(Q,W),L0.init(Q,W)});var dV=M("ZodIPv4",(Q,W)=>{AW.init(Q,W),L0.init(Q,W)});var iV=M("ZodIPv6",(Q,W)=>{DW.init(Q,W),L0.init(Q,W)});var nV=M("ZodCIDRv4",(Q,W)=>{OW.init(Q,W),L0.init(Q,W)});var oV=M("ZodCIDRv6",(Q,W)=>{wW.init(Q,W),L0.init(Q,W)});var rV=M("ZodBase64",(Q,W)=>{NW.init(Q,W),L0.init(Q,W)});var aV=M("ZodBase64URL",(Q,W)=>{MW.init(Q,W),L0.init(Q,W)});var tV=M("ZodE164",(Q,W)=>{jW.init(Q,W),L0.init(Q,W)});var sV=M("ZodJWT",(Q,W)=>{zW.init(Q,W),L0.init(Q,W)});var VX=M("ZodNumber",(Q,W)=>{o9.init(Q,W),N0.init(Q,W),Q.gt=(Y,J)=>Q.check(Q8(Y,J)),Q.gte=(Y,J)=>Q.check(n4(Y,J)),Q.min=(Y,J)=>Q.check(n4(Y,J)),Q.lt=(Y,J)=>Q.check(e9(Y,J)),Q.lte=(Y,J)=>Q.check(i4(Y,J)),Q.max=(Y,J)=>Q.check(i4(Y,J)),Q.int=(Y)=>Q.check(BX(Y)),Q.safe=(Y)=>Q.check(BX(Y)),Q.positive=(Y)=>Q.check(Q8(0,Y)),Q.nonnegative=(Y)=>Q.check(n4(0,Y)),Q.negative=(Y)=>Q.check(e9(0,Y)),Q.nonpositive=(Y)=>Q.check(i4(0,Y)),Q.multipleOf=(Y,J)=>Q.check(W8(Y,J)),Q.step=(Y,J)=>Q.check(W8(Y,J)),Q.finite=()=>Q;let $=Q._zod.bag;Q.minValue=Math.max($.minimum??Number.NEGATIVE_INFINITY,$.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,Q.maxValue=Math.min($.maximum??Number.POSITIVE_INFINITY,$.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,Q.isInt=($.format??"").includes("int")||Number.isSafeInteger($.multipleOf??0.5),Q.isFinite=!0,Q.format=$.format??null});function $0(Q){return q$(VX,Q)}var eV=M("ZodNumberFormat",(Q,W)=>{EW.init(Q,W),VX.init(Q,W)});function BX(Q){return U$(eV,Q)}var QL=M("ZodBoolean",(Q,W)=>{PW.init(Q,W),N0.init(Q,W)});function R0(Q){return A$(QL,Q)}var WL=M("ZodNull",(Q,W)=>{RW.init(Q,W),N0.init(Q,W)});function u$(Q){return D$(WL,Q)}var $L=M("ZodUnknown",(Q,W)=>{bW.init(Q,W),N0.init(Q,W)});function q0(){return O$($L)}var YL=M("ZodNever",(Q,W)=>{SW.init(Q,W),N0.init(Q,W)});function JL(Q){return w$(YL,Q)}var XL=M("ZodArray",(Q,W)=>{IW.init(Q,W),N0.init(Q,W),Q.element=W.element,Q.min=($,Y)=>Q.check(J4($,Y)),Q.nonempty=($)=>Q.check(J4(1,$)),Q.max=($,Y)=>Q.check($8($,Y)),Q.length=($,Y)=>Q.check(Y8($,Y)),Q.unwrap=()=>Q.element});function a(Q,W){return oJ(XL,Q,W)}var LX=M("ZodObject",(Q,W)=>{r9.init(Q,W),N0.init(Q,W),r.defineLazy(Q,"shape",()=>W.shape),Q.keyof=()=>d0(Object.keys(Q._zod.def.shape)),Q.catchall=($)=>Q.clone({...Q._zod.def,catchall:$}),Q.passthrough=()=>Q.clone({...Q._zod.def,catchall:q0()}),Q.loose=()=>Q.clone({...Q._zod.def,catchall:q0()}),Q.strict=()=>Q.clone({...Q._zod.def,catchall:JL()}),Q.strip=()=>Q.clone({...Q._zod.def,catchall:void 0}),Q.extend=($)=>{return r.extend(Q,$)},Q.merge=($)=>r.merge(Q,$),Q.pick=($)=>r.pick(Q,$),Q.omit=($)=>r.omit(Q,$),Q.partial=(...$)=>r.partial(AX,Q,$[0]),Q.required=(...$)=>r.required(DX,Q,$[0])});function v(Q,W){let $={type:"object",get shape(){return r.assignProp(this,"shape",{...Q}),this.shape},...r.normalizeParams(W)};return new LX($)}function u0(Q,W){return new LX({type:"object",get shape(){return r.assignProp(this,"shape",{...Q}),this.shape},catchall:q0(),...r.normalizeParams(W)})}var qX=M("ZodUnion",(Q,W)=>{a9.init(Q,W),N0.init(Q,W),Q.options=W.options});function B0(Q,W){return new qX({type:"union",options:Q,...r.normalizeParams(W)})}var HL=M("ZodDiscriminatedUnion",(Q,W)=>{qX.init(Q,W),CW.init(Q,W)});function l$(Q,W,$){return new HL({type:"union",options:W,discriminator:Q,...r.normalizeParams($)})}var GL=M("ZodIntersection",(Q,W)=>{ZW.init(Q,W),N0.init(Q,W)});function B8(Q,W){return new GL({type:"intersection",left:Q,right:W})}var BL=M("ZodRecord",(Q,W)=>{vW.init(Q,W),N0.init(Q,W),Q.keyType=W.keyType,Q.valueType=W.valueType});function U0(Q,W,$){return new BL({type:"record",keyType:Q,valueType:W,...r.normalizeParams($)})}var h$=M("ZodEnum",(Q,W)=>{TW.init(Q,W),N0.init(Q,W),Q.enum=W.entries,Q.options=Object.values(W.entries);let $=new Set(Object.keys(W.entries));Q.extract=(Y,J)=>{let X={};for(let H of Y)if($.has(H))X[H]=W.entries[H];else throw Error(`Key ${H} not found in enum`);return new h$({...W,checks:[],...r.normalizeParams(J),entries:X})},Q.exclude=(Y,J)=>{let X={...W.entries};for(let H of Y)if($.has(H))delete X[H];else throw Error(`Key ${H} not found in enum`);return new h$({...W,checks:[],...r.normalizeParams(J),entries:X})}});function d0(Q,W){let $=Array.isArray(Q)?Object.fromEntries(Q.map((Y)=>[Y,Y])):Q;return new h$({type:"enum",entries:$,...r.normalizeParams(W)})}var KL=M("ZodLiteral",(Q,W)=>{kW.init(Q,W),N0.init(Q,W),Q.values=new Set(W.values),Object.defineProperty(Q,"value",{get(){if(W.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return W.values[0]}})});function _(Q,W){return new KL({type:"literal",values:Array.isArray(Q)?Q:[Q],...r.normalizeParams(W)})}var FL=M("ZodTransform",(Q,W)=>{_W.init(Q,W),N0.init(Q,W),Q._zod.parse=($,Y)=>{$.addIssue=(X)=>{if(typeof X==="string")$.issues.push(r.issue(X,$.value,W));else{let H=X;if(H.fatal)H.continue=!1;H.code??(H.code="custom"),H.input??(H.input=$.value),H.inst??(H.inst=Q),H.continue??(H.continue=!0),$.issues.push(r.issue(H))}};let J=W.transform($.value,$);if(J instanceof Promise)return J.then((X)=>{return $.value=X,$});return $.value=J,$}});function UX(Q){return new FL({type:"transform",transform:Q})}var AX=M("ZodOptional",(Q,W)=>{xW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType});function w0(Q){return new AX({type:"optional",innerType:Q})}var VL=M("ZodNullable",(Q,W)=>{yW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType});function KX(Q){return new VL({type:"nullable",innerType:Q})}var LL=M("ZodDefault",(Q,W)=>{gW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType,Q.removeDefault=Q.unwrap});function qL(Q,W){return new LL({type:"default",innerType:Q,get defaultValue(){return typeof W==="function"?W():W}})}var UL=M("ZodPrefault",(Q,W)=>{hW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType});function AL(Q,W){return new UL({type:"prefault",innerType:Q,get defaultValue(){return typeof W==="function"?W():W}})}var DX=M("ZodNonOptional",(Q,W)=>{fW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType});function DL(Q,W){return new DX({type:"nonoptional",innerType:Q,...r.normalizeParams(W)})}var OL=M("ZodCatch",(Q,W)=>{uW.init(Q,W),N0.init(Q,W),Q.unwrap=()=>Q._zod.def.innerType,Q.removeCatch=Q.unwrap});function wL(Q,W){return new OL({type:"catch",innerType:Q,catchValue:typeof W==="function"?W:()=>W})}var NL=M("ZodPipe",(Q,W)=>{lW.init(Q,W),N0.init(Q,W),Q.in=W.in,Q.out=W.out});function f$(Q,W){return new NL({type:"pipe",in:Q,out:W})}var ML=M("ZodReadonly",(Q,W)=>{mW.init(Q,W),N0.init(Q,W)});function jL(Q){return new ML({type:"readonly",innerType:Q})}var OX=M("ZodCustom",(Q,W)=>{cW.init(Q,W),N0.init(Q,W)});function zL(Q){let W=new I0({check:"custom"});return W._zod.check=Q,W}function wX(Q,W){return C$(OX,Q??(()=>!0),W)}function EL(Q,W={}){return Z$(OX,Q,W)}function PL(Q){let W=zL(($)=>{return $.addIssue=(Y)=>{if(typeof Y==="string")$.issues.push(r.issue(Y,$.value,W._zod.def));else{let J=Y;if(J.fatal)J.continue=!1;J.code??(J.code="custom"),J.input??(J.input=$.value),J.inst??(J.inst=W),J.continue??(J.continue=!W._zod.def.abort),$.issues.push(r.issue(J))}},Q($.value,$)});return W}function m$(Q,W){return f$(UX(Q),W)}s0(pW());var c$="2025-11-25",NX="2025-03-26",a4=[c$,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],W6="io.modelcontextprotocol/related-task",F8="2.0",C0=wX((Q)=>Q!==null&&(typeof Q==="object"||typeof Q==="function")),MX=B0([N(),$0().int()]),jX=N(),Wz=u0({ttl:B0([$0(),u$()]).optional(),pollInterval:$0().optional()}),RL=v({ttl:$0().optional()}),bL=v({taskId:N()}),p$=u0({progressToken:MX.optional(),[W6]:bL.optional()}),Q1=v({_meta:p$.optional()}),t4=Q1.extend({task:RL.optional()}),zX=(Q)=>t4.safeParse(Q).success,Z0=v({method:N(),params:Q1.loose().optional()}),Y1=v({_meta:p$.optional()}),J1=v({method:N(),params:Y1.loose().optional()}),v0=u0({_meta:p$.optional()}),V8=B0([N(),$0().int()]),EX=v({jsonrpc:_(F8),id:V8,...Z0.shape}).strict(),$6=(Q)=>EX.safeParse(Q).success,PX=v({jsonrpc:_(F8),...J1.shape}).strict(),RX=(Q)=>PX.safeParse(Q).success,d$=v({jsonrpc:_(F8),id:V8,result:v0}).strict(),g1=(Q)=>d$.safeParse(Q).success;var y;(function(Q){Q[Q.ConnectionClosed=-32000]="ConnectionClosed",Q[Q.RequestTimeout=-32001]="RequestTimeout",Q[Q.ParseError=-32700]="ParseError",Q[Q.InvalidRequest=-32600]="InvalidRequest",Q[Q.MethodNotFound=-32601]="MethodNotFound",Q[Q.InvalidParams=-32602]="InvalidParams",Q[Q.InternalError=-32603]="InternalError",Q[Q.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(y||(y={}));var i$=v({jsonrpc:_(F8),id:V8.optional(),error:v({code:$0().int(),message:N(),data:q0().optional()})}).strict();var G4=(Q)=>i$.safeParse(Q).success;var n$=B0([EX,PX,d$,i$]),$z=B0([d$,i$]),L8=v0.strict(),SL=Y1.extend({requestId:V8.optional(),reason:N().optional()}),q8=J1.extend({method:_("notifications/cancelled"),params:SL}),IL=v({src:N(),mimeType:N().optional(),sizes:a(N()).optional(),theme:d0(["light","dark"]).optional()}),s4=v({icons:a(IL).optional()}),H4=v({name:N(),title:N().optional()}),bX=H4.extend({...H4.shape,...s4.shape,version:N(),websiteUrl:N().optional(),description:N().optional()}),CL=B8(v({applyDefaults:R0().optional()}),U0(N(),q0())),ZL=m$((Q)=>{if(Q&&typeof Q==="object"&&!Array.isArray(Q)){if(Object.keys(Q).length===0)return{form:{}}}return Q},B8(v({form:CL.optional(),url:C0.optional()}),U0(N(),q0()).optional())),vL=u0({list:C0.optional(),cancel:C0.optional(),requests:u0({sampling:u0({createMessage:C0.optional()}).optional(),elicitation:u0({create:C0.optional()}).optional()}).optional()}),TL=u0({list:C0.optional(),cancel:C0.optional(),requests:u0({tools:u0({call:C0.optional()}).optional()}).optional()}),kL=v({experimental:U0(N(),C0).optional(),sampling:v({context:C0.optional(),tools:C0.optional()}).optional(),elicitation:ZL.optional(),roots:v({listChanged:R0().optional()}).optional(),tasks:vL.optional()}),_L=Q1.extend({protocolVersion:N(),capabilities:kL,clientInfo:bX}),U8=Z0.extend({method:_("initialize"),params:_L}),o$=(Q)=>U8.safeParse(Q).success,xL=v({experimental:U0(N(),C0).optional(),logging:C0.optional(),completions:C0.optional(),prompts:v({listChanged:R0().optional()}).optional(),resources:v({subscribe:R0().optional(),listChanged:R0().optional()}).optional(),tools:v({listChanged:R0().optional()}).optional(),tasks:TL.optional()}),yL=v0.extend({protocolVersion:N(),capabilities:xL,serverInfo:bX,instructions:N().optional()}),r$=J1.extend({method:_("notifications/initialized"),params:Y1.optional()});var A8=Z0.extend({method:_("ping"),params:Q1.optional()}),gL=v({progress:$0(),total:w0($0()),message:w0(N())}),hL=v({...Y1.shape,...gL.shape,progressToken:MX}),D8=J1.extend({method:_("notifications/progress"),params:hL}),fL=Q1.extend({cursor:jX.optional()}),e4=Z0.extend({params:fL.optional()}),Q9=v0.extend({nextCursor:jX.optional()}),uL=d0(["working","input_required","completed","failed","cancelled"]),W9=v({taskId:N(),status:uL,ttl:B0([$0(),u$()]),createdAt:N(),lastUpdatedAt:N(),pollInterval:w0($0()),statusMessage:w0(N())}),B4=v0.extend({task:W9}),lL=Y1.merge(W9),$9=J1.extend({method:_("notifications/tasks/status"),params:lL}),O8=Z0.extend({method:_("tasks/get"),params:Q1.extend({taskId:N()})}),w8=v0.merge(W9),N8=Z0.extend({method:_("tasks/result"),params:Q1.extend({taskId:N()})}),Yz=v0.loose(),M8=e4.extend({method:_("tasks/list")}),j8=Q9.extend({tasks:a(W9)}),z8=Z0.extend({method:_("tasks/cancel"),params:Q1.extend({taskId:N()})}),SX=v0.merge(W9),IX=v({uri:N(),mimeType:w0(N()),_meta:U0(N(),q0()).optional()}),CX=IX.extend({text:N()}),a$=N().refine((Q)=>{try{return atob(Q),!0}catch{return!1}},{message:"Invalid Base64 string"}),ZX=IX.extend({blob:a$}),Y9=d0(["user","assistant"]),K4=v({audience:a(Y9).optional(),priority:$0().min(0).max(1).optional(),lastModified:o4.datetime({offset:!0}).optional()}),vX=v({...H4.shape,...s4.shape,uri:N(),description:w0(N()),mimeType:w0(N()),annotations:K4.optional(),_meta:w0(u0({}))}),mL=v({...H4.shape,...s4.shape,uriTemplate:N(),description:w0(N()),mimeType:w0(N()),annotations:K4.optional(),_meta:w0(u0({}))}),E8=e4.extend({method:_("resources/list")}),cL=Q9.extend({resources:a(vX)}),P8=e4.extend({method:_("resources/templates/list")}),pL=Q9.extend({resourceTemplates:a(mL)}),t$=Q1.extend({uri:N()}),dL=t$,R8=Z0.extend({method:_("resources/read"),params:dL}),iL=v0.extend({contents:a(B0([CX,ZX]))}),nL=J1.extend({method:_("notifications/resources/list_changed"),params:Y1.optional()}),oL=t$,rL=Z0.extend({method:_("resources/subscribe"),params:oL}),aL=t$,tL=Z0.extend({method:_("resources/unsubscribe"),params:aL}),sL=Y1.extend({uri:N()}),eL=J1.extend({method:_("notifications/resources/updated"),params:sL}),Qq=v({name:N(),description:w0(N()),required:w0(R0())}),Wq=v({...H4.shape,...s4.shape,description:w0(N()),arguments:w0(a(Qq)),_meta:w0(u0({}))}),b8=e4.extend({method:_("prompts/list")}),$q=Q9.extend({prompts:a(Wq)}),Yq=Q1.extend({name:N(),arguments:U0(N(),N()).optional()}),S8=Z0.extend({method:_("prompts/get"),params:Yq}),s$=v({type:_("text"),text:N(),annotations:K4.optional(),_meta:U0(N(),q0()).optional()}),e$=v({type:_("image"),data:a$,mimeType:N(),annotations:K4.optional(),_meta:U0(N(),q0()).optional()}),QY=v({type:_("audio"),data:a$,mimeType:N(),annotations:K4.optional(),_meta:U0(N(),q0()).optional()}),Jq=v({type:_("tool_use"),name:N(),id:N(),input:U0(N(),q0()),_meta:U0(N(),q0()).optional()}),Xq=v({type:_("resource"),resource:B0([CX,ZX]),annotations:K4.optional(),_meta:U0(N(),q0()).optional()}),Hq=vX.extend({type:_("resource_link")}),WY=B0([s$,e$,QY,Hq,Xq]),Gq=v({role:Y9,content:WY}),Bq=v0.extend({description:N().optional(),messages:a(Gq)}),Kq=J1.extend({method:_("notifications/prompts/list_changed"),params:Y1.optional()}),Fq=v({title:N().optional(),readOnlyHint:R0().optional(),destructiveHint:R0().optional(),idempotentHint:R0().optional(),openWorldHint:R0().optional()}),Vq=v({taskSupport:d0(["required","optional","forbidden"]).optional()}),TX=v({...H4.shape,...s4.shape,description:N().optional(),inputSchema:v({type:_("object"),properties:U0(N(),C0).optional(),required:a(N()).optional()}).catchall(q0()),outputSchema:v({type:_("object"),properties:U0(N(),C0).optional(),required:a(N()).optional()}).catchall(q0()).optional(),annotations:Fq.optional(),execution:Vq.optional(),_meta:U0(N(),q0()).optional()}),I8=e4.extend({method:_("tools/list")}),Lq=Q9.extend({tools:a(TX)}),C8=v0.extend({content:a(WY).default([]),structuredContent:U0(N(),q0()).optional(),isError:R0().optional()}),Jz=C8.or(v0.extend({toolResult:q0()})),qq=t4.extend({name:N(),arguments:U0(N(),q0()).optional()}),F4=Z0.extend({method:_("tools/call"),params:qq}),Uq=J1.extend({method:_("notifications/tools/list_changed"),params:Y1.optional()}),Xz=v({autoRefresh:R0().default(!0),debounceMs:$0().int().nonnegative().default(300)}),J9=d0(["debug","info","notice","warning","error","critical","alert","emergency"]),Aq=Q1.extend({level:J9}),$Y=Z0.extend({method:_("logging/setLevel"),params:Aq}),Dq=Y1.extend({level:J9,logger:N().optional(),data:q0()}),Oq=J1.extend({method:_("notifications/message"),params:Dq}),wq=v({name:N().optional()}),Nq=v({hints:a(wq).optional(),costPriority:$0().min(0).max(1).optional(),speedPriority:$0().min(0).max(1).optional(),intelligencePriority:$0().min(0).max(1).optional()}),Mq=v({mode:d0(["auto","required","none"]).optional()}),jq=v({type:_("tool_result"),toolUseId:N().describe("The unique identifier for the corresponding tool call."),content:a(WY).default([]),structuredContent:v({}).loose().optional(),isError:R0().optional(),_meta:U0(N(),q0()).optional()}),zq=l$("type",[s$,e$,QY]),K8=l$("type",[s$,e$,QY,Jq,jq]),Eq=v({role:Y9,content:B0([K8,a(K8)]),_meta:U0(N(),q0()).optional()}),Pq=t4.extend({messages:a(Eq),modelPreferences:Nq.optional(),systemPrompt:N().optional(),includeContext:d0(["none","thisServer","allServers"]).optional(),temperature:$0().optional(),maxTokens:$0().int(),stopSequences:a(N()).optional(),metadata:C0.optional(),tools:a(TX).optional(),toolChoice:Mq.optional()}),Rq=Z0.extend({method:_("sampling/createMessage"),params:Pq}),YY=v0.extend({model:N(),stopReason:w0(d0(["endTurn","stopSequence","maxTokens"]).or(N())),role:Y9,content:zq}),JY=v0.extend({model:N(),stopReason:w0(d0(["endTurn","stopSequence","maxTokens","toolUse"]).or(N())),role:Y9,content:B0([K8,a(K8)])}),bq=v({type:_("boolean"),title:N().optional(),description:N().optional(),default:R0().optional()}),Sq=v({type:_("string"),title:N().optional(),description:N().optional(),minLength:$0().optional(),maxLength:$0().optional(),format:d0(["email","uri","date","date-time"]).optional(),default:N().optional()}),Iq=v({type:d0(["number","integer"]),title:N().optional(),description:N().optional(),minimum:$0().optional(),maximum:$0().optional(),default:$0().optional()}),Cq=v({type:_("string"),title:N().optional(),description:N().optional(),enum:a(N()),default:N().optional()}),Zq=v({type:_("string"),title:N().optional(),description:N().optional(),oneOf:a(v({const:N(),title:N()})),default:N().optional()}),vq=v({type:_("string"),title:N().optional(),description:N().optional(),enum:a(N()),enumNames:a(N()).optional(),default:N().optional()}),Tq=B0([Cq,Zq]),kq=v({type:_("array"),title:N().optional(),description:N().optional(),minItems:$0().optional(),maxItems:$0().optional(),items:v({type:_("string"),enum:a(N())}),default:a(N()).optional()}),_q=v({type:_("array"),title:N().optional(),description:N().optional(),minItems:$0().optional(),maxItems:$0().optional(),items:v({anyOf:a(v({const:N(),title:N()}))}),default:a(N()).optional()}),xq=B0([kq,_q]),yq=B0([vq,Tq,xq]),gq=B0([yq,bq,Sq,Iq]),hq=t4.extend({mode:_("form").optional(),message:N(),requestedSchema:v({type:_("object"),properties:U0(N(),gq),required:a(N()).optional()})}),fq=t4.extend({mode:_("url"),message:N(),elicitationId:N(),url:N().url()}),uq=B0([hq,fq]),lq=Z0.extend({method:_("elicitation/create"),params:uq}),mq=Y1.extend({elicitationId:N()}),cq=J1.extend({method:_("notifications/elicitation/complete"),params:mq}),Z8=v0.extend({action:d0(["accept","decline","cancel"]),content:m$((Q)=>Q===null?void 0:Q,U0(N(),B0([N(),$0(),R0(),a(N())])).optional())}),pq=v({type:_("ref/resource"),uri:N()});var dq=v({type:_("ref/prompt"),name:N()}),iq=Q1.extend({ref:B0([dq,pq]),argument:v({name:N(),value:N()}),context:v({arguments:U0(N(),N()).optional()}).optional()}),v8=Z0.extend({method:_("completion/complete"),params:iq});function kX(Q){if(Q.params.ref.type!=="ref/prompt")throw TypeError(`Expected CompleteRequestPrompt, but got ${Q.params.ref.type}`)}function _X(Q){if(Q.params.ref.type!=="ref/resource")throw TypeError(`Expected CompleteRequestResourceTemplate, but got ${Q.params.ref.type}`)}var nq=v0.extend({completion:u0({values:a(N()).max(100),total:w0($0().int()),hasMore:w0(R0())})}),oq=v({uri:N().startsWith("file://"),name:N().optional(),_meta:U0(N(),q0()).optional()}),rq=Z0.extend({method:_("roots/list"),params:Q1.optional()}),XY=v0.extend({roots:a(oq)}),aq=J1.extend({method:_("notifications/roots/list_changed"),params:Y1.optional()}),Hz=B0([A8,U8,v8,$Y,S8,b8,E8,P8,R8,rL,tL,F4,I8,O8,N8,M8,z8]),Gz=B0([q8,D8,r$,aq,$9]),Bz=B0([L8,YY,JY,Z8,XY,w8,j8,B4]),Kz=B0([A8,Rq,lq,rq,O8,N8,M8,z8]),Fz=B0([q8,D8,Oq,eL,nL,Uq,Kq,$9,cq]),Vz=B0([L8,yL,nq,Bq,$q,cL,pL,iL,C8,Lq,w8,j8,B4]);class k extends Error{constructor(Q,W,$){super(`MCP error ${Q}: ${W}`);this.code=Q,this.data=$,this.name="McpError"}static fromError(Q,W,$){if(Q===y.UrlElicitationRequired&&$){let Y=$;if(Y.elicitations)return new xX(Y.elicitations,W)}return new k(Q,W,$)}}class xX extends k{constructor(Q,W=`URL elicitation${Q.length>1?"s":""} required`){super(y.UrlElicitationRequired,W,{elicitations:Q})}get elicitations(){return this.data?.elicitations??[]}}function Y6(Q){return Q==="completed"||Q==="failed"||Q==="cancelled"}var gX=Symbol("Let zodToJsonSchema decide on which parser to use");var yX={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},hX=(Q)=>typeof Q==="string"?{...yX,name:Q}:{...yX,...Q};var fX=(Q)=>{let W=hX(Q),$=W.name!==void 0?[...W.basePath,W.definitionPath,W.name]:W.basePath;return{...W,flags:{hasReferencedOpenAiAnyType:!1},currentPath:$,propertyPath:void 0,seen:new Map(Object.entries(W.definitions).map(([Y,J])=>[J._def,{def:J._def,path:[...W.basePath,W.definitionPath,Y],jsonSchema:void 0}]))}};function HY(Q,W,$,Y){if(!Y?.errorMessages)return;if($)Q.errorMessage={...Q.errorMessage,[W]:$}}function t(Q,W,$,Y,J){Q[W]=$,HY(Q,W,Y,J)}var T8=(Q,W)=>{let $=0;for(;$<Q.length&&$<W.length;$++)if(Q[$]!==W[$])break;return[(Q.length-$).toString(),...W.slice($)].join("/")};function A0(Q){if(Q.target!=="openAi")return{};let W=[...Q.basePath,Q.definitionPath,Q.openAiAnyTypeName];return Q.flags.hasReferencedOpenAiAnyType=!0,{$ref:Q.$refStrategy==="relative"?T8(W,Q.currentPath):W.join("/")}}function uX(Q,W){let $={type:"array"};if(Q.type?._def&&Q.type?._def?.typeName!==P.ZodAny)$.items=u(Q.type._def,{...W,currentPath:[...W.currentPath,"items"]});if(Q.minLength)t($,"minItems",Q.minLength.value,Q.minLength.message,W);if(Q.maxLength)t($,"maxItems",Q.maxLength.value,Q.maxLength.message,W);if(Q.exactLength)t($,"minItems",Q.exactLength.value,Q.exactLength.message,W),t($,"maxItems",Q.exactLength.value,Q.exactLength.message,W);return $}function lX(Q,W){let $={type:"integer",format:"int64"};if(!Q.checks)return $;for(let Y of Q.checks)switch(Y.kind){case"min":if(W.target==="jsonSchema7")if(Y.inclusive)t($,"minimum",Y.value,Y.message,W);else t($,"exclusiveMinimum",Y.value,Y.message,W);else{if(!Y.inclusive)$.exclusiveMinimum=!0;t($,"minimum",Y.value,Y.message,W)}break;case"max":if(W.target==="jsonSchema7")if(Y.inclusive)t($,"maximum",Y.value,Y.message,W);else t($,"exclusiveMaximum",Y.value,Y.message,W);else{if(!Y.inclusive)$.exclusiveMaximum=!0;t($,"maximum",Y.value,Y.message,W)}break;case"multipleOf":t($,"multipleOf",Y.value,Y.message,W);break}return $}function mX(){return{type:"boolean"}}function k8(Q,W){return u(Q.type._def,W)}var cX=(Q,W)=>{return u(Q.innerType._def,W)};function GY(Q,W,$){let Y=$??W.dateStrategy;if(Array.isArray(Y))return{anyOf:Y.map((J,X)=>GY(Q,W,J))};switch(Y){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return tq(Q,W)}}var tq=(Q,W)=>{let $={type:"integer",format:"unix-time"};if(W.target==="openApi3")return $;for(let Y of Q.checks)switch(Y.kind){case"min":t($,"minimum",Y.value,Y.message,W);break;case"max":t($,"maximum",Y.value,Y.message,W);break}return $};function pX(Q,W){return{...u(Q.innerType._def,W),default:Q.defaultValue()}}function dX(Q,W){return W.effectStrategy==="input"?u(Q.schema._def,W):A0(W)}function iX(Q){return{type:"string",enum:Array.from(Q.values)}}var sq=(Q)=>{if("type"in Q&&Q.type==="string")return!1;return"allOf"in Q};function nX(Q,W){let $=[u(Q.left._def,{...W,currentPath:[...W.currentPath,"allOf","0"]}),u(Q.right._def,{...W,currentPath:[...W.currentPath,"allOf","1"]})].filter((X)=>!!X),Y=W.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,J=[];return $.forEach((X)=>{if(sq(X)){if(J.push(...X.allOf),X.unevaluatedProperties===void 0)Y=void 0}else{let H=X;if("additionalProperties"in X&&X.additionalProperties===!1){let{additionalProperties:G,...B}=X;H=B}else Y=void 0;J.push(H)}}),J.length?{allOf:J,...Y}:void 0}function oX(Q,W){let $=typeof Q.value;if($!=="bigint"&&$!=="number"&&$!=="boolean"&&$!=="string")return{type:Array.isArray(Q.value)?"array":"object"};if(W.target==="openApi3")return{type:$==="bigint"?"integer":$,enum:[Q.value]};return{type:$==="bigint"?"integer":$,const:Q.value}}var BY=void 0,U1={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>{if(BY===void 0)BY=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u");return BY},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function _8(Q,W){let $={type:"string"};if(Q.checks)for(let Y of Q.checks)switch(Y.kind){case"min":t($,"minLength",typeof $.minLength==="number"?Math.max($.minLength,Y.value):Y.value,Y.message,W);break;case"max":t($,"maxLength",typeof $.maxLength==="number"?Math.min($.maxLength,Y.value):Y.value,Y.message,W);break;case"email":switch(W.emailStrategy){case"format:email":A1($,"email",Y.message,W);break;case"format:idn-email":A1($,"idn-email",Y.message,W);break;case"pattern:zod":l0($,U1.email,Y.message,W);break}break;case"url":A1($,"uri",Y.message,W);break;case"uuid":A1($,"uuid",Y.message,W);break;case"regex":l0($,Y.regex,Y.message,W);break;case"cuid":l0($,U1.cuid,Y.message,W);break;case"cuid2":l0($,U1.cuid2,Y.message,W);break;case"startsWith":l0($,RegExp(`^${KY(Y.value,W)}`),Y.message,W);break;case"endsWith":l0($,RegExp(`${KY(Y.value,W)}$`),Y.message,W);break;case"datetime":A1($,"date-time",Y.message,W);break;case"date":A1($,"date",Y.message,W);break;case"time":A1($,"time",Y.message,W);break;case"duration":A1($,"duration",Y.message,W);break;case"length":t($,"minLength",typeof $.minLength==="number"?Math.max($.minLength,Y.value):Y.value,Y.message,W),t($,"maxLength",typeof $.maxLength==="number"?Math.min($.maxLength,Y.value):Y.value,Y.message,W);break;case"includes":{l0($,RegExp(KY(Y.value,W)),Y.message,W);break}case"ip":{if(Y.version!=="v6")A1($,"ipv4",Y.message,W);if(Y.version!=="v4")A1($,"ipv6",Y.message,W);break}case"base64url":l0($,U1.base64url,Y.message,W);break;case"jwt":l0($,U1.jwt,Y.message,W);break;case"cidr":{if(Y.version!=="v6")l0($,U1.ipv4Cidr,Y.message,W);if(Y.version!=="v4")l0($,U1.ipv6Cidr,Y.message,W);break}case"emoji":l0($,U1.emoji(),Y.message,W);break;case"ulid":{l0($,U1.ulid,Y.message,W);break}case"base64":{switch(W.base64Strategy){case"format:binary":{A1($,"binary",Y.message,W);break}case"contentEncoding:base64":{t($,"contentEncoding","base64",Y.message,W);break}case"pattern:zod":{l0($,U1.base64,Y.message,W);break}}break}case"nanoid":l0($,U1.nanoid,Y.message,W);case"toLowerCase":case"toUpperCase":case"trim":break;default:((J)=>{})(Y)}return $}function KY(Q,W){return W.patternStrategy==="escape"?QU(Q):Q}var eq=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function QU(Q){let W="";for(let $=0;$<Q.length;$++){if(!eq.has(Q[$]))W+="\\";W+=Q[$]}return W}function A1(Q,W,$,Y){if(Q.format||Q.anyOf?.some((J)=>J.format)){if(!Q.anyOf)Q.anyOf=[];if(Q.format){if(Q.anyOf.push({format:Q.format,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{format:Q.errorMessage.format}}}),delete Q.format,Q.errorMessage){if(delete Q.errorMessage.format,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.anyOf.push({format:W,...$&&Y.errorMessages&&{errorMessage:{format:$}}})}else t(Q,"format",W,$,Y)}function l0(Q,W,$,Y){if(Q.pattern||Q.allOf?.some((J)=>J.pattern)){if(!Q.allOf)Q.allOf=[];if(Q.pattern){if(Q.allOf.push({pattern:Q.pattern,...Q.errorMessage&&Y.errorMessages&&{errorMessage:{pattern:Q.errorMessage.pattern}}}),delete Q.pattern,Q.errorMessage){if(delete Q.errorMessage.pattern,Object.keys(Q.errorMessage).length===0)delete Q.errorMessage}}Q.allOf.push({pattern:rX(W,Y),...$&&Y.errorMessages&&{errorMessage:{pattern:$}}})}else t(Q,"pattern",rX(W,Y),$,Y)}function rX(Q,W){if(!W.applyRegexFlags||!Q.flags)return Q.source;let $={i:Q.flags.includes("i"),m:Q.flags.includes("m"),s:Q.flags.includes("s")},Y=$.i?Q.source.toLowerCase():Q.source,J="",X=!1,H=!1,G=!1;for(let B=0;B<Y.length;B++){if(X){J+=Y[B],X=!1;continue}if($.i){if(H){if(Y[B].match(/[a-z]/)){if(G)J+=Y[B],J+=`${Y[B-2]}-${Y[B]}`.toUpperCase(),G=!1;else if(Y[B+1]==="-"&&Y[B+2]?.match(/[a-z]/))J+=Y[B],G=!0;else J+=`${Y[B]}${Y[B].toUpperCase()}`;continue}}else if(Y[B].match(/[a-z]/)){J+=`[${Y[B]}${Y[B].toUpperCase()}]`;continue}}if($.m){if(Y[B]==="^"){J+=`(^|(?<=[\r
]))`;continue}else if(Y[B]==="$"){J+=`($|(?=[\r
]))`;continue}}if($.s&&Y[B]==="."){J+=H?`${Y[B]}\r
`:`[${Y[B]}\r
]`;continue}if(J+=Y[B],Y[B]==="\\")X=!0;else if(H&&Y[B]==="]")H=!1;else if(!H&&Y[B]==="[")H=!0}try{new RegExp(J)}catch{return console.warn(`Could not convert regex pattern at ${W.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),Q.source}return J}function x8(Q,W){if(W.target==="openAi")console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.");if(W.target==="openApi3"&&Q.keyType?._def.typeName===P.ZodEnum)return{type:"object",required:Q.keyType._def.values,properties:Q.keyType._def.values.reduce((Y,J)=>({...Y,[J]:u(Q.valueType._def,{...W,currentPath:[...W.currentPath,"properties",J]})??A0(W)}),{}),additionalProperties:W.rejectedAdditionalProperties};let $={type:"object",additionalProperties:u(Q.valueType._def,{...W,currentPath:[...W.currentPath,"additionalProperties"]})??W.allowedAdditionalProperties};if(W.target==="openApi3")return $;if(Q.keyType?._def.typeName===P.ZodString&&Q.keyType._def.checks?.length){let{type:Y,...J}=_8(Q.keyType._def,W);return{...$,propertyNames:J}}else if(Q.keyType?._def.typeName===P.ZodEnum)return{...$,propertyNames:{enum:Q.keyType._def.values}};else if(Q.keyType?._def.typeName===P.ZodBranded&&Q.keyType._def.type._def.typeName===P.ZodString&&Q.keyType._def.type._def.checks?.length){let{type:Y,...J}=k8(Q.keyType._def,W);return{...$,propertyNames:J}}return $}function aX(Q,W){if(W.mapStrategy==="record")return x8(Q,W);let $=u(Q.keyType._def,{...W,currentPath:[...W.currentPath,"items","items","0"]})||A0(W),Y=u(Q.valueType._def,{...W,currentPath:[...W.currentPath,"items","items","1"]})||A0(W);return{type:"array",maxItems:125,items:{type:"array",items:[$,Y],minItems:2,maxItems:2}}}function tX(Q){let W=Q.values,Y=Object.keys(Q.values).filter((X)=>{return typeof W[W[X]]!=="number"}).map((X)=>W[X]),J=Array.from(new Set(Y.map((X)=>typeof X)));return{type:J.length===1?J[0]==="string"?"string":"number":["string","number"],enum:Y}}function sX(Q){return Q.target==="openAi"?void 0:{not:A0({...Q,currentPath:[...Q.currentPath,"not"]})}}function eX(Q){return Q.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var X9={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function W3(Q,W){if(W.target==="openApi3")return Q3(Q,W);let $=Q.options instanceof Map?Array.from(Q.options.values()):Q.options;if($.every((Y)=>(Y._def.typeName in X9)&&(!Y._def.checks||!Y._def.checks.length))){let Y=$.reduce((J,X)=>{let H=X9[X._def.typeName];return H&&!J.includes(H)?[...J,H]:J},[]);return{type:Y.length>1?Y:Y[0]}}else if($.every((Y)=>Y._def.typeName==="ZodLiteral"&&!Y.description)){let Y=$.reduce((J,X)=>{let H=typeof X._def.value;switch(H){case"string":case"number":case"boolean":return[...J,H];case"bigint":return[...J,"integer"];case"object":if(X._def.value===null)return[...J,"null"];case"symbol":case"undefined":case"function":default:return J}},[]);if(Y.length===$.length){let J=Y.filter((X,H,G)=>G.indexOf(X)===H);return{type:J.length>1?J:J[0],enum:$.reduce((X,H)=>{return X.includes(H._def.value)?X:[...X,H._def.value]},[])}}}else if($.every((Y)=>Y._def.typeName==="ZodEnum"))return{type:"string",enum:$.reduce((Y,J)=>[...Y,...J._def.values.filter((X)=>!Y.includes(X))],[])};return Q3(Q,W)}var Q3=(Q,W)=>{let $=(Q.options instanceof Map?Array.from(Q.options.values()):Q.options).map((Y,J)=>u(Y._def,{...W,currentPath:[...W.currentPath,"anyOf",`${J}`]})).filter((Y)=>!!Y&&(!W.strictUnions||typeof Y==="object"&&Object.keys(Y).length>0));return $.length?{anyOf:$}:void 0};function $3(Q,W){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(Q.innerType._def.typeName)&&(!Q.innerType._def.checks||!Q.innerType._def.checks.length)){if(W.target==="openApi3")return{type:X9[Q.innerType._def.typeName],nullable:!0};return{type:[X9[Q.innerType._def.typeName],"null"]}}if(W.target==="openApi3"){let Y=u(Q.innerType._def,{...W,currentPath:[...W.currentPath]});if(Y&&"$ref"in Y)return{allOf:[Y],nullable:!0};return Y&&{...Y,nullable:!0}}let $=u(Q.innerType._def,{...W,currentPath:[...W.currentPath,"anyOf","0"]});return $&&{anyOf:[$,{type:"null"}]}}function Y3(Q,W){let $={type:"number"};if(!Q.checks)return $;for(let Y of Q.checks)switch(Y.kind){case"int":$.type="integer",HY($,"type",Y.message,W);break;case"min":if(W.target==="jsonSchema7")if(Y.inclusive)t($,"minimum",Y.value,Y.message,W);else t($,"exclusiveMinimum",Y.value,Y.message,W);else{if(!Y.inclusive)$.exclusiveMinimum=!0;t($,"minimum",Y.value,Y.message,W)}break;case"max":if(W.target==="jsonSchema7")if(Y.inclusive)t($,"maximum",Y.value,Y.message,W);else t($,"exclusiveMaximum",Y.value,Y.message,W);else{if(!Y.inclusive)$.exclusiveMaximum=!0;t($,"maximum",Y.value,Y.message,W)}break;case"multipleOf":t($,"multipleOf",Y.value,Y.message,W);break}return $}function J3(Q,W){let $=W.target==="openAi",Y={type:"object",properties:{}},J=[],X=Q.shape();for(let G in X){let B=X[G];if(B===void 0||B._def===void 0)continue;let K=$U(B);if(K&&$){if(B._def.typeName==="ZodOptional")B=B._def.innerType;if(!B.isNullable())B=B.nullable();K=!1}let V=u(B._def,{...W,currentPath:[...W.currentPath,"properties",G],propertyPath:[...W.currentPath,"properties",G]});if(V===void 0)continue;if(Y.properties[G]=V,!K)J.push(G)}if(J.length)Y.required=J;let H=WU(Q,W);if(H!==void 0)Y.additionalProperties=H;return Y}function WU(Q,W){if(Q.catchall._def.typeName!=="ZodNever")return u(Q.catchall._def,{...W,currentPath:[...W.currentPath,"additionalProperties"]});switch(Q.unknownKeys){case"passthrough":return W.allowedAdditionalProperties;case"strict":return W.rejectedAdditionalProperties;case"strip":return W.removeAdditionalStrategy==="strict"?W.allowedAdditionalProperties:W.rejectedAdditionalProperties}}function $U(Q){try{return Q.isOptional()}catch{return!0}}var X3=(Q,W)=>{if(W.currentPath.toString()===W.propertyPath?.toString())return u(Q.innerType._def,W);let $=u(Q.innerType._def,{...W,currentPath:[...W.currentPath,"anyOf","1"]});return $?{anyOf:[{not:A0(W)},$]}:A0(W)};var H3=(Q,W)=>{if(W.pipeStrategy==="input")return u(Q.in._def,W);else if(W.pipeStrategy==="output")return u(Q.out._def,W);let $=u(Q.in._def,{...W,currentPath:[...W.currentPath,"allOf","0"]}),Y=u(Q.out._def,{...W,currentPath:[...W.currentPath,"allOf",$?"1":"0"]});return{allOf:[$,Y].filter((J)=>J!==void 0)}};function G3(Q,W){return u(Q.type._def,W)}function B3(Q,W){let Y={type:"array",uniqueItems:!0,items:u(Q.valueType._def,{...W,currentPath:[...W.currentPath,"items"]})};if(Q.minSize)t(Y,"minItems",Q.minSize.value,Q.minSize.message,W);if(Q.maxSize)t(Y,"maxItems",Q.maxSize.value,Q.maxSize.message,W);return Y}function K3(Q,W){if(Q.rest)return{type:"array",minItems:Q.items.length,items:Q.items.map(($,Y)=>u($._def,{...W,currentPath:[...W.currentPath,"items",`${Y}`]})).reduce(($,Y)=>Y===void 0?$:[...$,Y],[]),additionalItems:u(Q.rest._def,{...W,currentPath:[...W.currentPath,"additionalItems"]})};else return{type:"array",minItems:Q.items.length,maxItems:Q.items.length,items:Q.items.map(($,Y)=>u($._def,{...W,currentPath:[...W.currentPath,"items",`${Y}`]})).reduce(($,Y)=>Y===void 0?$:[...$,Y],[])}}function F3(Q){return{not:A0(Q)}}function V3(Q){return A0(Q)}var L3=(Q,W)=>{return u(Q.innerType._def,W)};var q3=(Q,W,$)=>{switch(W){case P.ZodString:return _8(Q,$);case P.ZodNumber:return Y3(Q,$);case P.ZodObject:return J3(Q,$);case P.ZodBigInt:return lX(Q,$);case P.ZodBoolean:return mX();case P.ZodDate:return GY(Q,$);case P.ZodUndefined:return F3($);case P.ZodNull:return eX($);case P.ZodArray:return uX(Q,$);case P.ZodUnion:case P.ZodDiscriminatedUnion:return W3(Q,$);case P.ZodIntersection:return nX(Q,$);case P.ZodTuple:return K3(Q,$);case P.ZodRecord:return x8(Q,$);case P.ZodLiteral:return oX(Q,$);case P.ZodEnum:return iX(Q);case P.ZodNativeEnum:return tX(Q);case P.ZodNullable:return $3(Q,$);case P.ZodOptional:return X3(Q,$);case P.ZodMap:return aX(Q,$);case P.ZodSet:return B3(Q,$);case P.ZodLazy:return()=>Q.getter()._def;case P.ZodPromise:return G3(Q,$);case P.ZodNaN:case P.ZodNever:return sX($);case P.ZodEffects:return dX(Q,$);case P.ZodAny:return A0($);case P.ZodUnknown:return V3($);case P.ZodDefault:return pX(Q,$);case P.ZodBranded:return k8(Q,$);case P.ZodReadonly:return L3(Q,$);case P.ZodCatch:return cX(Q,$);case P.ZodPipeline:return H3(Q,$);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return((Y)=>{return})(W)}};function u(Q,W,$=!1){let Y=W.seen.get(Q);if(W.override){let G=W.override?.(Q,W,Y,$);if(G!==gX)return G}if(Y&&!$){let G=YU(Y,W);if(G!==void 0)return G}let J={def:Q,path:W.currentPath,jsonSchema:void 0};W.seen.set(Q,J);let X=q3(Q,Q.typeName,W),H=typeof X==="function"?u(X(),W):X;if(H)JU(Q,W,H);if(W.postProcess){let G=W.postProcess(H,Q,W);return J.jsonSchema=H,G}return J.jsonSchema=H,H}var YU=(Q,W)=>{switch(W.$refStrategy){case"root":return{$ref:Q.path.join("/")};case"relative":return{$ref:T8(W.currentPath,Q.path)};case"none":case"seen":{if(Q.path.length<W.currentPath.length&&Q.path.every(($,Y)=>W.currentPath[Y]===$))return console.warn(`Recursive reference detected at ${W.currentPath.join("/")}! Defaulting to any`),A0(W);return W.$refStrategy==="seen"?A0(W):void 0}}},JU=(Q,W,$)=>{if(Q.description){if($.description=Q.description,W.markdownDescription)$.markdownDescription=Q.description}return $};var FY=(Q,W)=>{let $=fX(W),Y=typeof W==="object"&&W.definitions?Object.entries(W.definitions).reduce((B,[K,V])=>({...B,[K]:u(V._def,{...$,currentPath:[...$.basePath,$.definitionPath,K]},!0)??A0($)}),{}):void 0,J=typeof W==="string"?W:W?.nameStrategy==="title"?void 0:W?.name,X=u(Q._def,J===void 0?$:{...$,currentPath:[...$.basePath,$.definitionPath,J]},!1)??A0($),H=typeof W==="object"&&W.name!==void 0&&W.nameStrategy==="title"?W.name:void 0;if(H!==void 0)X.title=H;if($.flags.hasReferencedOpenAiAnyType){if(!Y)Y={};if(!Y[$.openAiAnyTypeName])Y[$.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:$.$refStrategy==="relative"?"1":[...$.basePath,$.definitionPath,$.openAiAnyTypeName].join("/")}}}let G=J===void 0?Y?{...X,[$.definitionPath]:Y}:X:{$ref:[...$.$refStrategy==="relative"?[]:$.basePath,$.definitionPath,J].join("/"),[$.definitionPath]:{...Y,[J]:X}};if($.target==="jsonSchema7")G.$schema="http://json-schema.org/draft-07/schema#";else if($.target==="jsonSchema2019-09"||$.target==="openAi")G.$schema="https://json-schema.org/draft/2019-09/schema#";if($.target==="openAi"&&(("anyOf"in G)||("oneOf"in G)||("allOf"in G)||("type"in G)&&Array.isArray(G.type)))console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.");return G};function XU(Q){if(!Q)return"draft-7";if(Q==="jsonSchema7"||Q==="draft-7")return"draft-7";if(Q==="jsonSchema2019-09"||Q==="draft-2020-12")return"draft-2020-12";return"draft-7"}function VY(Q,W){if($1(Q))return T$(Q,{target:XU(W?.target),io:W?.pipeStrategy??"input"});return FY(Q,{strictUnions:W?.strictUnions??!0,pipeStrategy:W?.pipeStrategy??"input"})}function LY(Q){let $=Q6(Q)?.method;if(!$)throw Error("Schema is missing a method literal");let Y=H8($);if(typeof Y!=="string")throw Error("Schema method literal must be a string");return Y}function qY(Q,W){let $=e1(Q,W);if(!$.success)throw $.error;return $.data}var HU=60000;class UY{constructor(Q){if(this._options=Q,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(q8,(W)=>{this._oncancel(W)}),this.setNotificationHandler(D8,(W)=>{this._onprogress(W)}),this.setRequestHandler(A8,(W)=>({})),this._taskStore=Q?.taskStore,this._taskMessageQueue=Q?.taskMessageQueue,this._taskStore)this.setRequestHandler(O8,async(W,$)=>{let Y=await this._taskStore.getTask(W.params.taskId,$.sessionId);if(!Y)throw new k(y.InvalidParams,"Failed to retrieve task: Task not found");return{...Y}}),this.setRequestHandler(N8,async(W,$)=>{let Y=async()=>{let J=W.params.taskId;if(this._taskMessageQueue){let H;while(H=await this._taskMessageQueue.dequeue(J,$.sessionId)){if(H.type==="response"||H.type==="error"){let G=H.message,B=G.id,K=this._requestResolvers.get(B);if(K)if(this._requestResolvers.delete(B),H.type==="response")K(G);else{let V=G,L=new k(V.error.code,V.error.message,V.error.data);K(L)}else{let V=H.type==="response"?"Response":"Error";this._onerror(Error(`${V} handler missing for request ${B}`))}continue}await this._transport?.send(H.message,{relatedRequestId:$.requestId})}}let X=await this._taskStore.getTask(J,$.sessionId);if(!X)throw new k(y.InvalidParams,`Task not found: ${J}`);if(!Y6(X.status))return await this._waitForTaskUpdate(J,$.signal),await Y();if(Y6(X.status)){let H=await this._taskStore.getTaskResult(J,$.sessionId);return this._clearTaskQueue(J),{...H,_meta:{...H._meta,[W6]:{taskId:J}}}}return await Y()};return await Y()}),this.setRequestHandler(M8,async(W,$)=>{try{let{tasks:Y,nextCursor:J}=await this._taskStore.listTasks(W.params?.cursor,$.sessionId);return{tasks:Y,nextCursor:J,_meta:{}}}catch(Y){throw new k(y.InvalidParams,`Failed to list tasks: ${Y instanceof Error?Y.message:String(Y)}`)}}),this.setRequestHandler(z8,async(W,$)=>{try{let Y=await this._taskStore.getTask(W.params.taskId,$.sessionId);if(!Y)throw new k(y.InvalidParams,`Task not found: ${W.params.taskId}`);if(Y6(Y.status))throw new k(y.InvalidParams,`Cannot cancel task in terminal status: ${Y.status}`);await this._taskStore.updateTaskStatus(W.params.taskId,"cancelled","Client cancelled task execution.",$.sessionId),this._clearTaskQueue(W.params.taskId);let J=await this._taskStore.getTask(W.params.taskId,$.sessionId);if(!J)throw new k(y.InvalidParams,`Task not found after cancellation: ${W.params.taskId}`);return{_meta:{},...J}}catch(Y){if(Y instanceof k)throw Y;throw new k(y.InvalidRequest,`Failed to cancel task: ${Y instanceof Error?Y.message:String(Y)}`)}})}async _oncancel(Q){if(!Q.params.requestId)return;this._requestHandlerAbortControllers.get(Q.params.requestId)?.abort(Q.params.reason)}_setupTimeout(Q,W,$,Y,J=!1){this._timeoutInfo.set(Q,{timeoutId:setTimeout(Y,W),startTime:Date.now(),timeout:W,maxTotalTimeout:$,resetTimeoutOnProgress:J,onTimeout:Y})}_resetTimeout(Q){let W=this._timeoutInfo.get(Q);if(!W)return!1;let $=Date.now()-W.startTime;if(W.maxTotalTimeout&&$>=W.maxTotalTimeout)throw this._timeoutInfo.delete(Q),k.fromError(y.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:W.maxTotalTimeout,totalElapsed:$});return clearTimeout(W.timeoutId),W.timeoutId=setTimeout(W.onTimeout,W.timeout),!0}_cleanupTimeout(Q){let W=this._timeoutInfo.get(Q);if(W)clearTimeout(W.timeoutId),this._timeoutInfo.delete(Q)}async connect(Q){this._transport=Q;let W=this.transport?.onclose;this._transport.onclose=()=>{W?.(),this._onclose()};let $=this.transport?.onerror;this._transport.onerror=(J)=>{$?.(J),this._onerror(J)};let Y=this._transport?.onmessage;this._transport.onmessage=(J,X)=>{if(Y?.(J,X),g1(J)||G4(J))this._onresponse(J);else if($6(J))this._onrequest(J,X);else if(RX(J))this._onnotification(J);else this._onerror(Error(`Unknown message type: ${JSON.stringify(J)}`))},await this._transport.start()}_onclose(){let Q=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();let W=k.fromError(y.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let $ of Q.values())$(W)}_onerror(Q){this.onerror?.(Q)}_onnotification(Q){let W=this._notificationHandlers.get(Q.method)??this.fallbackNotificationHandler;if(W===void 0)return;Promise.resolve().then(()=>W(Q)).catch(($)=>this._onerror(Error(`Uncaught error in notification handler: ${$}`)))}_onrequest(Q,W){let $=this._requestHandlers.get(Q.method)??this.fallbackRequestHandler,Y=this._transport,J=Q.params?._meta?.[W6]?.taskId;if($===void 0){let K={jsonrpc:"2.0",id:Q.id,error:{code:y.MethodNotFound,message:"Method not found"}};if(J&&this._taskMessageQueue)this._enqueueTaskMessage(J,{type:"error",message:K,timestamp:Date.now()},Y?.sessionId).catch((V)=>this._onerror(Error(`Failed to enqueue error response: ${V}`)));else Y?.send(K).catch((V)=>this._onerror(Error(`Failed to send an error response: ${V}`)));return}let X=new AbortController;this._requestHandlerAbortControllers.set(Q.id,X);let H=zX(Q.params)?Q.params.task:void 0,G=this._taskStore?this.requestTaskStore(Q,Y?.sessionId):void 0,B={signal:X.signal,sessionId:Y?.sessionId,_meta:Q.params?._meta,sendNotification:async(K)=>{let V={relatedRequestId:Q.id};if(J)V.relatedTask={taskId:J};await this.notification(K,V)},sendRequest:async(K,V,L)=>{let U={...L,relatedRequestId:Q.id};if(J&&!U.relatedTask)U.relatedTask={taskId:J};let q=U.relatedTask?.taskId??J;if(q&&G)await G.updateTaskStatus(q,"input_required");return await this.request(K,V,U)},authInfo:W?.authInfo,requestId:Q.id,requestInfo:W?.requestInfo,taskId:J,taskStore:G,taskRequestedTtl:H?.ttl,closeSSEStream:W?.closeSSEStream,closeStandaloneSSEStream:W?.closeStandaloneSSEStream};Promise.resolve().then(()=>{if(H)this.assertTaskHandlerCapability(Q.method)}).then(()=>$(Q,B)).then(async(K)=>{if(X.signal.aborted)return;let V={result:K,jsonrpc:"2.0",id:Q.id};if(J&&this._taskMessageQueue)await this._enqueueTaskMessage(J,{type:"response",message:V,timestamp:Date.now()},Y?.sessionId);else await Y?.send(V)},async(K)=>{if(X.signal.aborted)return;let V={jsonrpc:"2.0",id:Q.id,error:{code:Number.isSafeInteger(K.code)?K.code:y.InternalError,message:K.message??"Internal error",...K.data!==void 0&&{data:K.data}}};if(J&&this._taskMessageQueue)await this._enqueueTaskMessage(J,{type:"error",message:V,timestamp:Date.now()},Y?.sessionId);else await Y?.send(V)}).catch((K)=>this._onerror(Error(`Failed to send response: ${K}`))).finally(()=>{this._requestHandlerAbortControllers.delete(Q.id)})}_onprogress(Q){let{progressToken:W,...$}=Q.params,Y=Number(W),J=this._progressHandlers.get(Y);if(!J){this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(Q)}`));return}let X=this._responseHandlers.get(Y),H=this._timeoutInfo.get(Y);if(H&&X&&H.resetTimeoutOnProgress)try{this._resetTimeout(Y)}catch(G){this._responseHandlers.delete(Y),this._progressHandlers.delete(Y),this._cleanupTimeout(Y),X(G);return}J($)}_onresponse(Q){let W=Number(Q.id),$=this._requestResolvers.get(W);if($){if(this._requestResolvers.delete(W),g1(Q))$(Q);else{let X=new k(Q.error.code,Q.error.message,Q.error.data);$(X)}return}let Y=this._responseHandlers.get(W);if(Y===void 0){this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(Q)}`));return}this._responseHandlers.delete(W),this._cleanupTimeout(W);let J=!1;if(g1(Q)&&Q.result&&typeof Q.result==="object"){let X=Q.result;if(X.task&&typeof X.task==="object"){let H=X.task;if(typeof H.taskId==="string")J=!0,this._taskProgressTokens.set(H.taskId,W)}}if(!J)this._progressHandlers.delete(W);if(g1(Q))Y(Q);else{let X=k.fromError(Q.error.code,Q.error.message,Q.error.data);Y(X)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(Q,W,$){let{task:Y}=$??{};if(!Y){try{yield{type:"result",result:await this.request(Q,W,$)}}catch(X){yield{type:"error",error:X instanceof k?X:new k(y.InternalError,String(X))}}return}let J;try{let X=await this.request(Q,B4,$);if(X.task)J=X.task.taskId,yield{type:"taskCreated",task:X.task};else throw new k(y.InternalError,"Task creation did not return a task");while(!0){let H=await this.getTask({taskId:J},$);if(yield{type:"taskStatus",task:H},Y6(H.status)){if(H.status==="completed")yield{type:"result",result:await this.getTaskResult({taskId:J},W,$)};else if(H.status==="failed")yield{type:"error",error:new k(y.InternalError,`Task ${J} failed`)};else if(H.status==="cancelled")yield{type:"error",error:new k(y.InternalError,`Task ${J} was cancelled`)};return}if(H.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:J},W,$)};return}let G=H.pollInterval??this._options?.defaultTaskPollInterval??1000;await new Promise((B)=>setTimeout(B,G)),$?.signal?.throwIfAborted()}}catch(X){yield{type:"error",error:X instanceof k?X:new k(y.InternalError,String(X))}}}request(Q,W,$){let{relatedRequestId:Y,resumptionToken:J,onresumptiontoken:X,task:H,relatedTask:G}=$??{};return new Promise((B,K)=>{let V=(w)=>{K(w)};if(!this._transport){V(Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{if(this.assertCapabilityForMethod(Q.method),H)this.assertTaskCapability(Q.method)}catch(w){V(w);return}$?.signal?.throwIfAborted();let L=this._requestMessageId++,U={...Q,jsonrpc:"2.0",id:L};if($?.onprogress)this._progressHandlers.set(L,$.onprogress),U.params={...Q.params,_meta:{...Q.params?._meta||{},progressToken:L}};if(H)U.params={...U.params,task:H};if(G)U.params={...U.params,_meta:{...U.params?._meta||{},[W6]:G}};let q=(w)=>{this._responseHandlers.delete(L),this._progressHandlers.delete(L),this._cleanupTimeout(L),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:L,reason:String(w)}},{relatedRequestId:Y,resumptionToken:J,onresumptiontoken:X}).catch((z)=>this._onerror(Error(`Failed to send cancellation: ${z}`)));let j=w instanceof k?w:new k(y.RequestTimeout,String(w));K(j)};this._responseHandlers.set(L,(w)=>{if($?.signal?.aborted)return;if(w instanceof Error)return K(w);try{let j=e1(W,w.result);if(!j.success)K(j.error);else B(j.data)}catch(j){K(j)}}),$?.signal?.addEventListener("abort",()=>{q($?.signal?.reason)});let A=$?.timeout??HU,D=()=>q(k.fromError(y.RequestTimeout,"Request timed out",{timeout:A}));this._setupTimeout(L,A,$?.maxTotalTimeout,D,$?.resetTimeoutOnProgress??!1);let O=G?.taskId;if(O){let w=(j)=>{let z=this._responseHandlers.get(L);if(z)z(j);else this._onerror(Error(`Response handler missing for side-channeled request ${L}`))};this._requestResolvers.set(L,w),this._enqueueTaskMessage(O,{type:"request",message:U,timestamp:Date.now()}).catch((j)=>{this._cleanupTimeout(L),K(j)})}else this._transport.send(U,{relatedRequestId:Y,resumptionToken:J,onresumptiontoken:X}).catch((w)=>{this._cleanupTimeout(L),K(w)})})}async getTask(Q,W){return this.request({method:"tasks/get",params:Q},w8,W)}async getTaskResult(Q,W,$){return this.request({method:"tasks/result",params:Q},W,$)}async listTasks(Q,W){return this.request({method:"tasks/list",params:Q},j8,W)}async cancelTask(Q,W){return this.request({method:"tasks/cancel",params:Q},SX,W)}async notification(Q,W){if(!this._transport)throw Error("Not connected");this.assertNotificationCapability(Q.method);let $=W?.relatedTask?.taskId;if($){let H={...Q,jsonrpc:"2.0",params:{...Q.params,_meta:{...Q.params?._meta||{},[W6]:W.relatedTask}}};await this._enqueueTaskMessage($,{type:"notification",message:H,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(Q.method)&&!Q.params&&!W?.relatedRequestId&&!W?.relatedTask){if(this._pendingDebouncedNotifications.has(Q.method))return;this._pendingDebouncedNotifications.add(Q.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(Q.method),!this._transport)return;let H={...Q,jsonrpc:"2.0"};if(W?.relatedTask)H={...H,params:{...H.params,_meta:{...H.params?._meta||{},[W6]:W.relatedTask}}};this._transport?.send(H,W).catch((G)=>this._onerror(G))});return}let X={...Q,jsonrpc:"2.0"};if(W?.relatedTask)X={...X,params:{...X.params,_meta:{...X.params?._meta||{},[W6]:W.relatedTask}}};await this._transport.send(X,W)}setRequestHandler(Q,W){let $=LY(Q);this.assertRequestHandlerCapability($),this._requestHandlers.set($,(Y,J)=>{let X=qY(Q,Y);return Promise.resolve(W(X,J))})}removeRequestHandler(Q){this._requestHandlers.delete(Q)}assertCanSetRequestHandler(Q){if(this._requestHandlers.has(Q))throw Error(`A request handler for ${Q} already exists, which would be overridden`)}setNotificationHandler(Q,W){let $=LY(Q);this._notificationHandlers.set($,(Y)=>{let J=qY(Q,Y);return Promise.resolve(W(J))})}removeNotificationHandler(Q){this._notificationHandlers.delete(Q)}_cleanupTaskProgressHandler(Q){let W=this._taskProgressTokens.get(Q);if(W!==void 0)this._progressHandlers.delete(W),this._taskProgressTokens.delete(Q)}async _enqueueTaskMessage(Q,W,$){if(!this._taskStore||!this._taskMessageQueue)throw Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let Y=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(Q,W,$,Y)}async _clearTaskQueue(Q,W){if(this._taskMessageQueue){let $=await this._taskMessageQueue.dequeueAll(Q,W);for(let Y of $)if(Y.type==="request"&&$6(Y.message)){let J=Y.message.id,X=this._requestResolvers.get(J);if(X)X(new k(y.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(J);else this._onerror(Error(`Resolver missing for request ${J} during task ${Q} cleanup`))}}}async _waitForTaskUpdate(Q,W){let $=this._options?.defaultTaskPollInterval??1000;try{let Y=await this._taskStore?.getTask(Q);if(Y?.pollInterval)$=Y.pollInterval}catch{}return new Promise((Y,J)=>{if(W.aborted){J(new k(y.InvalidRequest,"Request cancelled"));return}let X=setTimeout(Y,$);W.addEventListener("abort",()=>{clearTimeout(X),J(new k(y.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(Q,W){let $=this._taskStore;if(!$)throw Error("No task store configured");return{createTask:async(Y)=>{if(!Q)throw Error("No request provided");return await $.createTask(Y,Q.id,{method:Q.method,params:Q.params},W)},getTask:async(Y)=>{let J=await $.getTask(Y,W);if(!J)throw new k(y.InvalidParams,"Failed to retrieve task: Task not found");return J},storeTaskResult:async(Y,J,X)=>{await $.storeTaskResult(Y,J,X,W);let H=await $.getTask(Y,W);if(H){let G=$9.parse({method:"notifications/tasks/status",params:H});if(await this.notification(G),Y6(H.status))this._cleanupTaskProgressHandler(Y)}},getTaskResult:(Y)=>{return $.getTaskResult(Y,W)},updateTaskStatus:async(Y,J,X)=>{let H=await $.getTask(Y,W);if(!H)throw new k(y.InvalidParams,`Task "${Y}" not found - it may have been cleaned up`);if(Y6(H.status))throw new k(y.InvalidParams,`Cannot update task "${Y}" from terminal status "${H.status}" to "${J}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await $.updateTaskStatus(Y,J,X,W);let G=await $.getTask(Y,W);if(G){let B=$9.parse({method:"notifications/tasks/status",params:G});if(await this.notification(B),Y6(G.status))this._cleanupTaskProgressHandler(Y)}},listTasks:(Y)=>{return $.listTasks(Y,W)}}}}function U3(Q){return Q!==null&&typeof Q==="object"&&!Array.isArray(Q)}function A3(Q,W){let $={...Q};for(let Y in W){let J=Y,X=W[J];if(X===void 0)continue;let H=$[J];if(U3(H)&&U3(X))$[J]={...H,...X};else $[J]=X}return $}var DB=j7(c5(),1),OB=j7(AB(),1);function aN(){let Q=new DB.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return OB.default(Q),Q}class t5{constructor(Q){this._ajv=Q??aN()}getValidator(Q){let W="$id"in Q&&typeof Q.$id==="string"?this._ajv.getSchema(Q.$id)??this._ajv.compile(Q):this._ajv.compile(Q);return($)=>{if(W($))return{valid:!0,data:$,errorMessage:void 0};else return{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(W.errors)}}}}class s5{constructor(Q){this._server=Q}requestStream(Q,W,$){return this._server.requestStream(Q,W,$)}async getTask(Q,W){return this._server.getTask({taskId:Q},W)}async getTaskResult(Q,W,$){return this._server.getTaskResult({taskId:Q},W,$)}async listTasks(Q,W){return this._server.listTasks(Q?{cursor:Q}:void 0,W)}async cancelTask(Q,W){return this._server.cancelTask({taskId:Q},W)}}function wB(Q,W,$){if(!Q)throw Error(`${$} does not support task creation (required for ${W})`);switch(W){case"tools/call":if(!Q.tools?.call)throw Error(`${$} does not support task creation for tools/call (required for ${W})`);break;default:break}}function NB(Q,W,$){if(!Q)throw Error(`${$} does not support task creation (required for ${W})`);switch(W){case"sampling/createMessage":if(!Q.sampling?.createMessage)throw Error(`${$} does not support task creation for sampling/createMessage (required for ${W})`);break;case"elicitation/create":if(!Q.elicitation?.create)throw Error(`${$} does not support task creation for elicitation/create (required for ${W})`);break;default:break}}class e5 extends UY{constructor(Q,W){super(W);if(this._serverInfo=Q,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(J9.options.map(($,Y)=>[$,Y])),this.isMessageIgnored=($,Y)=>{let J=this._loggingLevels.get(Y);return J?this.LOG_LEVEL_SEVERITY.get($)<this.LOG_LEVEL_SEVERITY.get(J):!1},this._capabilities=W?.capabilities??{},this._instructions=W?.instructions,this._jsonSchemaValidator=W?.jsonSchemaValidator??new t5,this.setRequestHandler(U8,($)=>this._oninitialize($)),this.setNotificationHandler(r$,()=>this.oninitialized?.()),this._capabilities.logging)this.setRequestHandler($Y,async($,Y)=>{let J=Y.sessionId||Y.requestInfo?.headers["mcp-session-id"]||void 0,{level:X}=$.params,H=J9.safeParse(X);if(H.success)this._loggingLevels.set(J,H.data);return{}})}get experimental(){if(!this._experimental)this._experimental={tasks:new s5(this)};return this._experimental}registerCapabilities(Q){if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=A3(this._capabilities,Q)}setRequestHandler(Q,W){let Y=Q6(Q)?.method;if(!Y)throw Error("Schema is missing a method literal");let J;if($1(Y)){let H=Y;J=H._zod?.def?.value??H.value}else{let H=Y;J=H._def?.value??H.value}if(typeof J!=="string")throw Error("Schema method literal must be a string");if(J==="tools/call"){let H=async(G,B)=>{let K=e1(F4,G);if(!K.success){let q=K.error instanceof Error?K.error.message:String(K.error);throw new k(y.InvalidParams,`Invalid tools/call request: ${q}`)}let{params:V}=K.data,L=await Promise.resolve(W(G,B));if(V.task){let q=e1(B4,L);if(!q.success){let A=q.error instanceof Error?q.error.message:String(q.error);throw new k(y.InvalidParams,`Invalid task creation result: ${A}`)}return q.data}let U=e1(C8,L);if(!U.success){let q=U.error instanceof Error?U.error.message:String(U.error);throw new k(y.InvalidParams,`Invalid tools/call result: ${q}`)}return U.data};return super.setRequestHandler(Q,H)}return super.setRequestHandler(Q,W)}assertCapabilityForMethod(Q){switch(Q){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw Error(`Client does not support sampling (required for ${Q})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw Error(`Client does not support elicitation (required for ${Q})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw Error(`Client does not support listing roots (required for ${Q})`);break;case"ping":break}}assertNotificationCapability(Q){switch(Q){case"notifications/message":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw Error(`Server does not support notifying about resources (required for ${Q})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw Error(`Server does not support notifying of tool list changes (required for ${Q})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw Error(`Server does not support notifying of prompt list changes (required for ${Q})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw Error(`Client does not support URL elicitation (required for ${Q})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(Q){if(!this._capabilities)return;switch(Q){case"completion/complete":if(!this._capabilities.completions)throw Error(`Server does not support completions (required for ${Q})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw Error(`Server does not support logging (required for ${Q})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw Error(`Server does not support prompts (required for ${Q})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw Error(`Server does not support resources (required for ${Q})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw Error(`Server does not support tools (required for ${Q})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw Error(`Server does not support tasks capability (required for ${Q})`);break;case"ping":case"initialize":break}}assertTaskCapability(Q){NB(this._clientCapabilities?.tasks?.requests,Q,"Client")}assertTaskHandlerCapability(Q){if(!this._capabilities)return;wB(this._capabilities.tasks?.requests,Q,"Server")}async _oninitialize(Q){let W=Q.params.protocolVersion;return this._clientCapabilities=Q.params.capabilities,this._clientVersion=Q.params.clientInfo,{protocolVersion:a4.includes(W)?W:c$,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},L8)}async createMessage(Q,W){if(Q.tools||Q.toolChoice){if(!this._clientCapabilities?.sampling?.tools)throw Error("Client does not support sampling tools capability.")}if(Q.messages.length>0){let $=Q.messages[Q.messages.length-1],Y=Array.isArray($.content)?$.content:[$.content],J=Y.some((B)=>B.type==="tool_result"),X=Q.messages.length>1?Q.messages[Q.messages.length-2]:void 0,H=X?Array.isArray(X.content)?X.content:[X.content]:[],G=H.some((B)=>B.type==="tool_use");if(J){if(Y.some((B)=>B.type!=="tool_result"))throw Error("The last message must contain only tool_result content if any is present");if(!G)throw Error("tool_result blocks are not matching any tool_use from the previous message")}if(G){let B=new Set(H.filter((V)=>V.type==="tool_use").map((V)=>V.id)),K=new Set(Y.filter((V)=>V.type==="tool_result").map((V)=>V.toolUseId));if(B.size!==K.size||![...B].every((V)=>K.has(V)))throw Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}if(Q.tools)return this.request({method:"sampling/createMessage",params:Q},JY,W);return this.request({method:"sampling/createMessage",params:Q},YY,W)}async elicitInput(Q,W){switch(Q.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support url elicitation.");let Y=Q;return this.request({method:"elicitation/create",params:Y},Z8,W)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw Error("Client does not support form elicitation.");let Y=Q.mode==="form"?Q:{...Q,mode:"form"},J=await this.request({method:"elicitation/create",params:Y},Z8,W);if(J.action==="accept"&&J.content&&Y.requestedSchema)try{let H=this._jsonSchemaValidator.getValidator(Y.requestedSchema)(J.content);if(!H.valid)throw new k(y.InvalidParams,`Elicitation response content does not match requested schema: ${H.errorMessage}`)}catch(X){if(X instanceof k)throw X;throw new k(y.InternalError,`Error validating elicitation response: ${X instanceof Error?X.message:String(X)}`)}return J}}}createElicitationCompletionNotifier(Q,W){if(!this._clientCapabilities?.elicitation?.url)throw Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:Q}},W)}async listRoots(Q,W){return this.request({method:"roots/list",params:Q},XY,W)}async sendLoggingMessage(Q,W){if(this._capabilities.logging){if(!this.isMessageIgnored(Q.level,W))return this.notification({method:"notifications/message",params:Q})}}async sendResourceUpdated(Q){return this.notification({method:"notifications/resources/updated",params:Q})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}var jB=Symbol.for("mcp.completable");function Q7(Q){return!!Q&&typeof Q==="object"&&jB in Q}function zB(Q){return Q[jB]?.complete}var MB;(function(Q){Q.Completable="McpCompletable"})(MB||(MB={}));class m1{static isTemplate(Q){return/\{[^}\s]+\}/.test(Q)}static validateLength(Q,W,$){if(Q.length>W)throw Error(`${$} exceeds maximum length of ${W} characters (got ${Q.length})`)}get variableNames(){return this.parts.flatMap((Q)=>typeof Q==="string"?[]:Q.names)}constructor(Q){m1.validateLength(Q,1e6,"Template"),this.template=Q,this.parts=this.parse(Q)}toString(){return this.template}parse(Q){let W=[],$="",Y=0,J=0;while(Y<Q.length)if(Q[Y]==="{"){if($)W.push($),$="";let X=Q.indexOf("}",Y);if(X===-1)throw Error("Unclosed template expression");if(J++,J>1e4)throw Error("Template contains too many expressions (max 10000)");let H=Q.slice(Y+1,X),G=this.getOperator(H),B=H.includes("*"),K=this.getNames(H),V=K[0];for(let L of K)m1.validateLength(L,1e6,"Variable name");W.push({name:V,operator:G,names:K,exploded:B}),Y=X+1}else $+=Q[Y],Y++;if($)W.push($);return W}getOperator(Q){return["+","#",".","/","?","&"].find(($)=>Q.startsWith($))||""}getNames(Q){let W=this.getOperator(Q);return Q.slice(W.length).split(",").map(($)=>$.replace("*","").trim()).filter(($)=>$.length>0)}encodeValue(Q,W){if(m1.validateLength(Q,1e6,"Variable value"),W==="+"||W==="#")return encodeURI(Q);return encodeURIComponent(Q)}expandPart(Q,W){if(Q.operator==="?"||Q.operator==="&"){let X=Q.names.map((G)=>{let B=W[G];if(B===void 0)return"";let K=Array.isArray(B)?B.map((V)=>this.encodeValue(V,Q.operator)).join(","):this.encodeValue(B.toString(),Q.operator);return`${G}=${K}`}).filter((G)=>G.length>0);if(X.length===0)return"";return(Q.operator==="?"?"?":"&")+X.join("&")}if(Q.names.length>1){let X=Q.names.map((H)=>W[H]).filter((H)=>H!==void 0);if(X.length===0)return"";return X.map((H)=>Array.isArray(H)?H[0]:H).join(",")}let $=W[Q.name];if($===void 0)return"";let J=(Array.isArray($)?$:[$]).map((X)=>this.encodeValue(X,Q.operator));switch(Q.operator){case"":return J.join(",");case"+":return J.join(",");case"#":return"#"+J.join(",");case".":return"."+J.join(".");case"/":return"/"+J.join("/");default:return J.join(",")}}expand(Q){let W="",$=!1;for(let Y of this.parts){if(typeof Y==="string"){W+=Y;continue}let J=this.expandPart(Y,Q);if(!J)continue;if((Y.operator==="?"||Y.operator==="&")&&$)W+=J.replace("?","&");else W+=J;if(Y.operator==="?"||Y.operator==="&")$=!0}return W}escapeRegExp(Q){return Q.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}partToRegExp(Q){let W=[];for(let J of Q.names)m1.validateLength(J,1e6,"Variable name");if(Q.operator==="?"||Q.operator==="&"){for(let J=0;J<Q.names.length;J++){let X=Q.names[J],H=J===0?"\\"+Q.operator:"&";W.push({pattern:H+this.escapeRegExp(X)+"=([^&]+)",name:X})}return W}let $,Y=Q.name;switch(Q.operator){case"":$=Q.exploded?"([^/]+(?:,[^/]+)*)":"([^/,]+)";break;case"+":case"#":$="(.+)";break;case".":$="\\.([^/,]+)";break;case"/":$="/"+(Q.exploded?"([^/]+(?:,[^/]+)*)":"([^/,]+)");break;default:$="([^/]+)"}return W.push({pattern:$,name:Y}),W}match(Q){m1.validateLength(Q,1e6,"URI");let W="^",$=[];for(let H of this.parts)if(typeof H==="string")W+=this.escapeRegExp(H);else{let G=this.partToRegExp(H);for(let{pattern:B,name:K}of G)W+=B,$.push({name:K,exploded:H.exploded})}W+="$",m1.validateLength(W,1e6,"Generated regex pattern");let Y=new RegExp(W),J=Q.match(Y);if(!J)return null;let X={};for(let H=0;H<$.length;H++){let{name:G,exploded:B}=$[H],K=J[H+1],V=G.replace("*","");if(B&&K.includes(","))X[V]=K.split(",");else X[V]=K}return X}}var tN=/^[A-Za-z0-9._-]{1,128}$/;function sN(Q){let W=[];if(Q.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(Q.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${Q.length})`]};if(Q.includes(" "))W.push("Tool name contains spaces, which may cause parsing issues");if(Q.includes(","))W.push("Tool name contains commas, which may cause parsing issues");if(Q.startsWith("-")||Q.endsWith("-"))W.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts");if(Q.startsWith(".")||Q.endsWith("."))W.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts");if(!tN.test(Q)){let $=Q.split("").filter((Y)=>!/[A-Za-z0-9._-]/.test(Y)).filter((Y,J,X)=>X.indexOf(Y)===J);return W.push(`Tool name contains invalid characters: ${$.map((Y)=>`"${Y}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:W}}return{isValid:!0,warnings:W}}function eN(Q,W){if(W.length>0){console.warn(`Tool name validation warning for "${Q}":`);for(let $ of W)console.warn(`  - ${$}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function W7(Q){let W=sN(Q);return eN(Q,W.warnings),W.isValid}class $7{constructor(Q){this._mcpServer=Q}registerToolTask(Q,W,$){let Y={taskSupport:"required",...W.execution};if(Y.taskSupport==="forbidden")throw Error(`Cannot register task-based tool '${Q}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(Q,W.title,W.description,W.inputSchema,W.outputSchema,W.annotations,Y,W._meta,$)}}class J7{constructor(Q,W){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new e5(Q,W)}get experimental(){if(!this._experimental)this._experimental={tasks:new $7(this)};return this._experimental}async connect(Q){return await this.server.connect(Q)}async close(){await this.server.close()}setToolRequestHandlers(){if(this._toolHandlersInitialized)return;this.server.assertCanSetRequestHandler(U6(I8)),this.server.assertCanSetRequestHandler(U6(F4)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(I8,()=>({tools:Object.entries(this._registeredTools).filter(([,Q])=>Q.enabled).map(([Q,W])=>{let $={name:Q,title:W.title,description:W.description,inputSchema:(()=>{let Y=X4(W.inputSchema);return Y?VY(Y,{strictUnions:!0,pipeStrategy:"input"}):QM})(),annotations:W.annotations,execution:W.execution,_meta:W._meta};if(W.outputSchema){let Y=X4(W.outputSchema);if(Y)$.outputSchema=VY(Y,{strictUnions:!0,pipeStrategy:"output"})}return $})})),this.server.setRequestHandler(F4,async(Q,W)=>{try{let $=this._registeredTools[Q.params.name];if(!$)throw new k(y.InvalidParams,`Tool ${Q.params.name} not found`);if(!$.enabled)throw new k(y.InvalidParams,`Tool ${Q.params.name} disabled`);let Y=!!Q.params.task,J=$.execution?.taskSupport,X="createTask"in $.handler;if((J==="required"||J==="optional")&&!X)throw new k(y.InternalError,`Tool ${Q.params.name} has taskSupport '${J}' but was not registered with registerToolTask`);if(J==="required"&&!Y)throw new k(y.MethodNotFound,`Tool ${Q.params.name} requires task augmentation (taskSupport: 'required')`);if(J==="optional"&&!Y&&X)return await this.handleAutomaticTaskPolling($,Q,W);let H=await this.validateToolInput($,Q.params.arguments,Q.params.name),G=await this.executeToolHandler($,H,W);if(Y)return G;return await this.validateToolOutput($,G,Q.params.name),G}catch($){if($ instanceof k){if($.code===y.UrlElicitationRequired)throw $}return this.createToolError($ instanceof Error?$.message:String($))}}),this._toolHandlersInitialized=!0}createToolError(Q){return{content:[{type:"text",text:Q}],isError:!0}}async validateToolInput(Q,W,$){if(!Q.inputSchema)return;let J=X4(Q.inputSchema)??Q.inputSchema,X=await J8(J,W);if(!X.success){let H="error"in X?X.error:"Unknown error",G=X8(H);throw new k(y.InvalidParams,`Input validation error: Invalid arguments for tool ${$}: ${G}`)}return X.data}async validateToolOutput(Q,W,$){if(!Q.outputSchema)return;if(!("content"in W))return;if(W.isError)return;if(!W.structuredContent)throw new k(y.InvalidParams,`Output validation error: Tool ${$} has an output schema but no structured content was provided`);let Y=X4(Q.outputSchema),J=await J8(Y,W.structuredContent);if(!J.success){let X="error"in J?J.error:"Unknown error",H=X8(X);throw new k(y.InvalidParams,`Output validation error: Invalid structured content for tool ${$}: ${H}`)}}async executeToolHandler(Q,W,$){let Y=Q.handler;if("createTask"in Y){if(!$.taskStore)throw Error("No task store provided.");let X={...$,taskStore:$.taskStore};if(Q.inputSchema)return await Promise.resolve(Y.createTask(W,X));else return await Promise.resolve(Y.createTask(X))}if(Q.inputSchema)return await Promise.resolve(Y(W,$));else return await Promise.resolve(Y($))}async handleAutomaticTaskPolling(Q,W,$){if(!$.taskStore)throw Error("No task store provided for task-capable tool.");let Y=await this.validateToolInput(Q,W.params.arguments,W.params.name),J=Q.handler,X={...$,taskStore:$.taskStore},H=Y?await Promise.resolve(J.createTask(Y,X)):await Promise.resolve(J.createTask(X)),G=H.task.taskId,B=H.task,K=B.pollInterval??5000;while(B.status!=="completed"&&B.status!=="failed"&&B.status!=="cancelled"){await new Promise((L)=>setTimeout(L,K));let V=await $.taskStore.getTask(G);if(!V)throw new k(y.InternalError,`Task ${G} not found during polling`);B=V}return await $.taskStore.getTaskResult(G)}setCompletionRequestHandler(){if(this._completionHandlerInitialized)return;this.server.assertCanSetRequestHandler(U6(v8)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(v8,async(Q)=>{switch(Q.params.ref.type){case"ref/prompt":return kX(Q),this.handlePromptCompletion(Q,Q.params.ref);case"ref/resource":return _X(Q),this.handleResourceCompletion(Q,Q.params.ref);default:throw new k(y.InvalidParams,`Invalid completion reference: ${Q.params.ref}`)}}),this._completionHandlerInitialized=!0}async handlePromptCompletion(Q,W){let $=this._registeredPrompts[W.name];if(!$)throw new k(y.InvalidParams,`Prompt ${W.name} not found`);if(!$.enabled)throw new k(y.InvalidParams,`Prompt ${W.name} disabled`);if(!$.argsSchema)return v9;let J=Q6($.argsSchema)?.[Q.params.argument.name];if(!Q7(J))return v9;let X=zB(J);if(!X)return v9;let H=await X(Q.params.argument.value,Q.params.context);return PB(H)}async handleResourceCompletion(Q,W){let $=Object.values(this._registeredResourceTemplates).find((X)=>X.resourceTemplate.uriTemplate.toString()===W.uri);if(!$){if(this._registeredResources[W.uri])return v9;throw new k(y.InvalidParams,`Resource template ${Q.params.ref.uri} not found`)}let Y=$.resourceTemplate.completeCallback(Q.params.argument.name);if(!Y)return v9;let J=await Y(Q.params.argument.value,Q.params.context);return PB(J)}setResourceRequestHandlers(){if(this._resourceHandlersInitialized)return;this.server.assertCanSetRequestHandler(U6(E8)),this.server.assertCanSetRequestHandler(U6(P8)),this.server.assertCanSetRequestHandler(U6(R8)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(E8,async(Q,W)=>{let $=Object.entries(this._registeredResources).filter(([J,X])=>X.enabled).map(([J,X])=>({uri:J,name:X.name,...X.metadata})),Y=[];for(let J of Object.values(this._registeredResourceTemplates)){if(!J.resourceTemplate.listCallback)continue;let X=await J.resourceTemplate.listCallback(W);for(let H of X.resources)Y.push({...J.metadata,...H})}return{resources:[...$,...Y]}}),this.server.setRequestHandler(P8,async()=>{return{resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([W,$])=>({name:W,uriTemplate:$.resourceTemplate.uriTemplate.toString(),...$.metadata}))}}),this.server.setRequestHandler(R8,async(Q,W)=>{let $=new URL(Q.params.uri),Y=this._registeredResources[$.toString()];if(Y){if(!Y.enabled)throw new k(y.InvalidParams,`Resource ${$} disabled`);return Y.readCallback($,W)}for(let J of Object.values(this._registeredResourceTemplates)){let X=J.resourceTemplate.uriTemplate.match($.toString());if(X)return J.readCallback($,X,W)}throw new k(y.InvalidParams,`Resource ${$} not found`)}),this._resourceHandlersInitialized=!0}setPromptRequestHandlers(){if(this._promptHandlersInitialized)return;this.server.assertCanSetRequestHandler(U6(b8)),this.server.assertCanSetRequestHandler(U6(S8)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(b8,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,Q])=>Q.enabled).map(([Q,W])=>{return{name:Q,title:W.title,description:W.description,arguments:W.argsSchema?$M(W.argsSchema):void 0}})})),this.server.setRequestHandler(S8,async(Q,W)=>{let $=this._registeredPrompts[Q.params.name];if(!$)throw new k(y.InvalidParams,`Prompt ${Q.params.name} not found`);if(!$.enabled)throw new k(y.InvalidParams,`Prompt ${Q.params.name} disabled`);if($.argsSchema){let Y=X4($.argsSchema),J=await J8(Y,Q.params.arguments);if(!J.success){let G="error"in J?J.error:"Unknown error",B=X8(G);throw new k(y.InvalidParams,`Invalid arguments for prompt ${Q.params.name}: ${B}`)}let X=J.data,H=$.callback;return await Promise.resolve(H(X,W))}else{let Y=$.callback;return await Promise.resolve(Y(W))}}),this._promptHandlersInitialized=!0}resource(Q,W,...$){let Y;if(typeof $[0]==="object")Y=$.shift();let J=$[0];if(typeof W==="string"){if(this._registeredResources[W])throw Error(`Resource ${W} is already registered`);let X=this._createRegisteredResource(Q,void 0,W,Y,J);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),X}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let X=this._createRegisteredResourceTemplate(Q,void 0,W,Y,J);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),X}}registerResource(Q,W,$,Y){if(typeof W==="string"){if(this._registeredResources[W])throw Error(`Resource ${W} is already registered`);let J=this._createRegisteredResource(Q,$.title,W,$,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}else{if(this._registeredResourceTemplates[Q])throw Error(`Resource template ${Q} is already registered`);let J=this._createRegisteredResourceTemplate(Q,$.title,W,$,Y);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),J}}_createRegisteredResource(Q,W,$,Y,J){let X={name:Q,title:W,metadata:Y,readCallback:J,enabled:!0,disable:()=>X.update({enabled:!1}),enable:()=>X.update({enabled:!0}),remove:()=>X.update({uri:null}),update:(H)=>{if(typeof H.uri<"u"&&H.uri!==$){if(delete this._registeredResources[$],H.uri)this._registeredResources[H.uri]=X}if(typeof H.name<"u")X.name=H.name;if(typeof H.title<"u")X.title=H.title;if(typeof H.metadata<"u")X.metadata=H.metadata;if(typeof H.callback<"u")X.readCallback=H.callback;if(typeof H.enabled<"u")X.enabled=H.enabled;this.sendResourceListChanged()}};return this._registeredResources[$]=X,X}_createRegisteredResourceTemplate(Q,W,$,Y,J){let X={resourceTemplate:$,title:W,metadata:Y,readCallback:J,enabled:!0,disable:()=>X.update({enabled:!1}),enable:()=>X.update({enabled:!0}),remove:()=>X.update({name:null}),update:(B)=>{if(typeof B.name<"u"&&B.name!==Q){if(delete this._registeredResourceTemplates[Q],B.name)this._registeredResourceTemplates[B.name]=X}if(typeof B.title<"u")X.title=B.title;if(typeof B.template<"u")X.resourceTemplate=B.template;if(typeof B.metadata<"u")X.metadata=B.metadata;if(typeof B.callback<"u")X.readCallback=B.callback;if(typeof B.enabled<"u")X.enabled=B.enabled;this.sendResourceListChanged()}};this._registeredResourceTemplates[Q]=X;let H=$.uriTemplate.variableNames;if(Array.isArray(H)&&H.some((B)=>!!$.completeCallback(B)))this.setCompletionRequestHandler();return X}_createRegisteredPrompt(Q,W,$,Y,J){let X={title:W,description:$,argsSchema:Y===void 0?void 0:b6(Y),callback:J,enabled:!0,disable:()=>X.update({enabled:!1}),enable:()=>X.update({enabled:!0}),remove:()=>X.update({name:null}),update:(H)=>{if(typeof H.name<"u"&&H.name!==Q){if(delete this._registeredPrompts[Q],H.name)this._registeredPrompts[H.name]=X}if(typeof H.title<"u")X.title=H.title;if(typeof H.description<"u")X.description=H.description;if(typeof H.argsSchema<"u")X.argsSchema=b6(H.argsSchema);if(typeof H.callback<"u")X.callback=H.callback;if(typeof H.enabled<"u")X.enabled=H.enabled;this.sendPromptListChanged()}};if(this._registeredPrompts[Q]=X,Y){if(Object.values(Y).some((G)=>{let B=G instanceof t0?G._def?.innerType:G;return Q7(B)}))this.setCompletionRequestHandler()}return X}_createRegisteredTool(Q,W,$,Y,J,X,H,G,B){W7(Q);let K={title:W,description:$,inputSchema:EB(Y),outputSchema:EB(J),annotations:X,execution:H,_meta:G,handler:B,enabled:!0,disable:()=>K.update({enabled:!1}),enable:()=>K.update({enabled:!0}),remove:()=>K.update({name:null}),update:(V)=>{if(typeof V.name<"u"&&V.name!==Q){if(typeof V.name==="string")W7(V.name);if(delete this._registeredTools[Q],V.name)this._registeredTools[V.name]=K}if(typeof V.title<"u")K.title=V.title;if(typeof V.description<"u")K.description=V.description;if(typeof V.paramsSchema<"u")K.inputSchema=b6(V.paramsSchema);if(typeof V.outputSchema<"u")K.outputSchema=b6(V.outputSchema);if(typeof V.callback<"u")K.handler=V.callback;if(typeof V.annotations<"u")K.annotations=V.annotations;if(typeof V._meta<"u")K._meta=V._meta;if(typeof V.enabled<"u")K.enabled=V.enabled;this.sendToolListChanged()}};return this._registeredTools[Q]=K,this.setToolRequestHandlers(),this.sendToolListChanged(),K}tool(Q,...W){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let $,Y,J,X;if(typeof W[0]==="string")$=W.shift();if(W.length>1){let G=W[0];if(Y7(G)){if(Y=W.shift(),W.length>1&&typeof W[0]==="object"&&W[0]!==null&&!Y7(W[0]))X=W.shift()}else if(typeof G==="object"&&G!==null)X=W.shift()}let H=W[0];return this._createRegisteredTool(Q,void 0,$,Y,J,X,{taskSupport:"forbidden"},void 0,H)}registerTool(Q,W,$){if(this._registeredTools[Q])throw Error(`Tool ${Q} is already registered`);let{title:Y,description:J,inputSchema:X,outputSchema:H,annotations:G,_meta:B}=W;return this._createRegisteredTool(Q,Y,J,X,H,G,{taskSupport:"forbidden"},B,$)}prompt(Q,...W){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let $;if(typeof W[0]==="string")$=W.shift();let Y;if(W.length>1)Y=W.shift();let J=W[0],X=this._createRegisteredPrompt(Q,void 0,$,Y,J);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),X}registerPrompt(Q,W,$){if(this._registeredPrompts[Q])throw Error(`Prompt ${Q} is already registered`);let{title:Y,description:J,argsSchema:X}=W,H=this._createRegisteredPrompt(Q,Y,J,X,$);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),H}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(Q,W){return this.server.sendLoggingMessage(Q,W)}sendResourceListChanged(){if(this.isConnected())this.server.sendResourceListChanged()}sendToolListChanged(){if(this.isConnected())this.server.sendToolListChanged()}sendPromptListChanged(){if(this.isConnected())this.server.sendPromptListChanged()}}class MQ{constructor(Q,W){this._callbacks=W,this._uriTemplate=typeof Q==="string"?new m1(Q):Q}get uriTemplate(){return this._uriTemplate}get listCallback(){return this._callbacks.list}completeCallback(Q){return this._callbacks.complete?.[Q]}}var QM={type:"object",properties:{}};function RB(Q){return Q!==null&&typeof Q==="object"&&"parse"in Q&&typeof Q.parse==="function"&&"safeParse"in Q&&typeof Q.safeParse==="function"}function WM(Q){return"_def"in Q||"_zod"in Q||RB(Q)}function Y7(Q){if(typeof Q!=="object"||Q===null)return!1;if(WM(Q))return!1;if(Object.keys(Q).length===0)return!0;return Object.values(Q).some(RB)}function EB(Q){if(!Q)return;if(Y7(Q))return b6(Q);return Q}function $M(Q){let W=Q6(Q);if(!W)return[];return Object.entries(W).map(([$,Y])=>{let J=aJ(Y),X=tJ(Y);return{name:$,description:J,required:!X}})}function U6(Q){let $=Q6(Q)?.method;if(!$)throw Error("Schema is missing a method literal");let Y=H8($);if(typeof Y==="string")return Y;throw Error("Schema method literal must be a string")}function PB(Q){return{completion:{values:Q.slice(0,100),total:Q.length,hasMore:Q.length>100}}}var v9={completion:{values:[],hasMore:!1}};var X7=null;function T9(){return new J7({name:"Blockbench MCP",version:u6})}function k9(){if(!X7)X7=T9();return X7}var $S=k9();var _6={},x6={},b4={},H7={};function bB(Q){let W=Q._def;if(W.typeName==="ZodObject")return W.shape?.()??{};if(W.typeName==="ZodEffects"&&W.schema)return bB(W.schema);return{}}function I(Q,W,$="stable",Y=!0){if(_6[Q])throw Error(`Tool with name "${Q}" already exists.`);let J=bB(W.parameters),X={title:W.annotations?.title??W.description,description:W.description,inputSchema:J,execute:W.execute,annotations:W.annotations};if(H7[Q]=X,Y){let H=k9();H.registerTool.bind(H)(Q,{title:X.title,description:X.description,inputSchema:J},async(B,K)=>{let L={reportProgress:()=>{}},U=await W.execute(B,L);if(typeof U==="string")return{content:[{type:"text",text:U}]};if(U&&typeof U==="object"&&"content"in U)return U;return{content:[{type:"text",text:JSON.stringify(U)}]}})}return _6[Q]={name:Q,description:X.title,enabled:Y,status:$},_6[Q]}function SB(){return H7}function YM(){return Object.fromEntries(Object.entries(H7).filter(([Q])=>_6[Q]?.enabled))}function IB(Q){let W=YM(),$=Q;for(let[Y,J]of Object.entries(W))$.registerTool(Y,{title:J.title,description:J.description,inputSchema:J.inputSchema},async(X,H)=>{let B={reportProgress:()=>{}},K=await J.execute(X,B);if(typeof K==="string")return{content:[{type:"text",text:K}]};if(K&&typeof K==="object"&&"content"in K)return K;return{content:[{type:"text",text:JSON.stringify(K)}]}})}var CB={};function jQ(Q,W){if(b4[Q])throw Error(`Resource with name "${Q}" already exists.`);let $={name:Q,uriTemplate:W.uriTemplate,metadata:{title:W.title,description:W.description},listCallback:W.listCallback,readCallback:W.readCallback};CB[Q]=$;let Y=k9();return Y.registerResource.bind(Y)(Q,new MQ(W.uriTemplate,{list:W.listCallback}),{title:W.title,description:W.description},async(X,H)=>{let G=Object.fromEntries(Object.entries(H).map(([B,K])=>{if(Array.isArray(K))return[B,K[0]??""];return[B,K]}));return W.readCallback(X,G)}),b4[Q]={name:Q,description:W.description,uriTemplate:W.uriTemplate},b4[Q]}function ZB(Q){let W=Q;for(let[$,Y]of Object.entries(CB))W.registerResource($,new MQ(Y.uriTemplate,{list:Y.listCallback}),Y.metadata,async(J,X)=>{let H=Object.fromEntries(Object.entries(X).map(([G,B])=>{if(Array.isArray(B))return[G,B[0]??""];return[G,B]}));return Y.readCallback(J,H)})}var G7={};function zQ(Q,W,$="stable",Y=!0){if(x6[Q])throw Error(`Prompt with name "${Q}" already exists.`);if(Y&&W.generate&&W.argsSchema){let J={name:Q,title:W.title||W.description,description:W.description,argsSchema:W.argsSchema.shape,generate:async(X)=>{return await W.generate(X)}};G7[Q]=J,k9().registerPrompt(Q,{title:J.title,description:J.description,argsSchema:J.argsSchema},J.generate)}return x6[Q]={name:Q,arguments:W.argsSchema?.shape||{},description:W.description,enabled:Y,status:$},x6[Q]}function vB(){return G7}function TB(Q){let W=Q;for(let[$,Y]of Object.entries(G7))W.registerPrompt($,{title:Y.title,description:Y.description,argsSchema:Y.argsSchema},Y.generate)}function S4(Q,W="image/png"){let $=typeof Q==="string"?Q:Q.url,Y=$;if($.startsWith("data:")){let J=$.match(/^data:([^;]+);base64,(.+)$/);if(J)W=J[1]||W,Y=J[2]}return{content:[{type:"image",data:Y,mimeType:W}]}}function z0(Q){return(Project?.textures??Texture.all).find(({id:$,name:Y,uuid:J})=>$===Q||Y===Q||J===Q)||null}function B1(Q){let W=Group.all.find(($)=>$.name===Q);if(!W)throw Error(`Bone/group "${Q}" not found. Use the list_outline tool to see available groups and bones.`);return W}function y6(Q){let W=Mesh.all.find(($)=>$.uuid===Q||$.name===Q);if(!W)throw Error(`Mesh "${Q}" not found. Use the list_outline tool to see available meshes.`);return W}function I4(Q){let W=Outliner.root.find(($)=>$.uuid===Q||$.name===Q);if(!W)throw Error(`Element "${Q}" not found. Use the list_outline tool to see available elements.`);return W}function h0(Q){let W=z0(Q);if(!W)throw Error(`Texture "${Q}" not found. Use the list_textures tool to see available textures.`);return W}function _9(Q){let W=TextureGroup.all.find(($)=>$.uuid===Q||$.name===Q);if(!W)throw Error(`Material/texture group "${Q}" not found. Use the list_materials tool to see available materials.`);return W}function x9(Q,W){let $=Q.find((Y)=>Y.pbr_channel===W);return $?{name:$.name,uuid:$.uuid,hasTexture:!0}:{hasTexture:!1}}function c1(Q){if(Q)return y6(Q);let W=Mesh.selected[0];if(!W)throw Error("No mesh selected and no mesh_id provided. Select a mesh or provide a mesh_id. Use the list_outline tool to see available meshes.");return W}function B7(Q){let W=Project;if(!W||Q!==void 0)W=ModelProject.all.find((J)=>J.name===Q||J.uuid===Q||J.selected);if(!W)throw Error("No project found in the Blockbench editor.");if(!W.selected)W.select();let $=Preview.selected;if(!$)throw Error("No preview available for the selected project.");let Y;if(Canvas.withoutGizmos(()=>{$.render(),Y=$.canvas.toDataURL()}),!Y)throw Error("Failed to capture preview screenshot.");return S4(Y,"image/png")}async function g6(){return new Promise((Q,W)=>{let $=!1,Y=setTimeout(()=>{if(!$)$=!0,W(Error("App screenshot timed out after 5 seconds."))},5000);Screencam.fullScreen({},(J)=>{if(!$)if($=!0,clearTimeout(Y),J)Q(S4(J,"image/png"));else W(Error("Failed to capture app screenshot - no data returned."))})})}function kB(){I("capture_screenshot",{description:"Returns the image data of the current view.",annotations:{title:"Capture Screenshot",readOnlyHint:!0},parameters:F.object({project:F.string().optional().describe("Project name or UUID.")}),async execute({project:Q}){return B7(Q)}},K0),I("capture_app_screenshot",{description:"Returns the image data of the Blockbench app.",annotations:{title:"Capture App Screenshot",readOnlyHint:!0},parameters:F.object({}),async execute(){return g6()}},K0),I("set_camera_angle",{description:"Sets the camera angle to the specified value.",annotations:{title:"Set Camera Angle",destructiveHint:!0},parameters:F.object({position:F.array(F.number()).length(3).describe("Camera position."),target:F.array(F.number()).length(3).optional().describe("Camera target position."),rotation:F.array(F.number()).length(3).optional().describe("Camera rotation."),projection:F.enum(["unset","orthographic","perspective"]).describe("Camera projection type.")}),async execute(Q){let W=Preview.selected;if(!W)throw Error("No preview found in the Blockbench editor.");return W.loadAnglePreset({...Q}),await B7()}},g)}function _B(){I("create_animation",{description:"Creates a new animation with keyframes for bones.",annotations:{title:"Create Animation",destructiveHint:!0},parameters:F.object({name:F.string().describe("Name of the animation"),loop:F.boolean().default(!1).describe("Whether the animation should loop"),animation_length:F.number().optional().describe("Length of the animation in seconds"),bones:F.record(F.array(F.object({time:F.number(),position:F.array(F.number()).length(3).optional(),rotation:F.array(F.number()).length(3).optional(),scale:F.union([F.array(F.number()).length(3),F.number()]).optional()}))).describe("Keyframes for each bone"),particle_effects:F.record(F.string().describe("Effect name")).optional().describe("Particle effects with timestamps as keys")}),async execute({name:Q,loop:W,animation_length:$,bones:Y,particle_effects:J}){let X={loop:W,...$&&{animation_length:$},bones:Object.fromEntries(Object.entries(Y).map(([H,G])=>{let B=G.reduce((K,V)=>{let L=V.time.toString();if(V.position)(K.position??={})[L]=V.position;if(V.rotation)(K.rotation??={})[L]=V.rotation;if(V.scale)(K.scale??={})[L]=V.scale;return K},{});return[H,B]})),...J&&{particle_effects:J}};return Animator.loadFile({content:JSON.stringify({format_version:"1.8.0",animations:{[`animation.${Q}`]:X}})}),`Created animation "${Q}" with keyframes for ${Object.keys(Y).length} bones${J?` and ${Object.keys(J).length} particle effects`:""}`}},K0),I("manage_keyframes",{description:"Creates, deletes, or edits keyframes in the animation timeline for specific bones and channels.",annotations:{title:"Manage Keyframes",destructiveHint:!0},parameters:F.object({animation_id:F.string().optional().describe("Animation UUID or name. If not provided, uses current animation."),action:F.enum(["create","delete","edit","select"]).describe("Action to perform on keyframes."),bone_name:F.string().describe("Name of the bone/group to manage keyframes for."),channel:F.enum(["rotation","position","scale"]).describe("Animation channel to modify."),keyframes:F.array(F.object({time:F.number().describe("Time in seconds for the keyframe."),values:F.union([F.array(F.number()).length(3),F.number()]).optional().describe("Values for the keyframe. [x,y,z] for position/rotation, number for uniform scale."),interpolation:F.enum(["linear","catmullrom","bezier","step"]).optional().default("linear").describe("Interpolation type for the keyframe."),bezier_handles:F.object({left_time:F.number().optional(),left_value:F.array(F.number()).length(3).optional(),right_time:F.number().optional(),right_value:F.array(F.number()).length(3).optional()}).optional().describe("Bezier handle positions for bezier interpolation.")})).describe("Keyframe data for the action.")}),async execute({animation_id:Q,action:W,bone_name:$,channel:Y,keyframes:J}){let X=Q?Animation.all.find((B)=>B.uuid===Q||B.name===Q):Animation.selected;if(!X)throw Error("No animation found or selected.");let H=B1($),G=X.animators[H.uuid];if(!G)G=new BoneAnimator(H.uuid,X,$),X.animators[H.uuid]=G;switch(Undo.initEdit({animations:[X],keyframes:[]}),W){case"create":J.forEach((B)=>{let K=G.createKeyframe({time:B.time,channel:Y,values:B.values,interpolation:B.interpolation},B.time,Y,!1);if(B.interpolation==="bezier"&&B.bezier_handles){if(B.bezier_handles.left_time!==void 0)K.bezier_left_time=B.bezier_handles.left_time;if(B.bezier_handles.left_value)K.bezier_left_value=B.bezier_handles.left_value;if(B.bezier_handles.right_time!==void 0)K.bezier_right_time=B.bezier_handles.right_time;if(B.bezier_handles.right_value)K.bezier_right_value=B.bezier_handles.right_value}});break;case"delete":J.forEach((B)=>{let K=G[Y]?.find((V)=>Math.abs(V.time-B.time)<0.001);if(K)K.remove()});break;case"edit":J.forEach((B)=>{let K=G[Y]?.find((V)=>Math.abs(V.time-B.time)<0.001);if(K){if(B.values)K.set("values",B.values);if(B.interpolation)K.interpolation=B.interpolation;if(B.interpolation==="bezier"&&B.bezier_handles){if(B.bezier_handles.left_time!==void 0)K.bezier_left_time=B.bezier_handles.left_time;if(B.bezier_handles.left_value)K.bezier_left_value=B.bezier_handles.left_value;if(B.bezier_handles.right_time!==void 0)K.bezier_right_time=B.bezier_handles.right_time;if(B.bezier_handles.right_value)K.bezier_right_value=B.bezier_handles.right_value}}});break;case"select":Timeline.selected.empty(),J.forEach((B)=>{let K=G[Y]?.find((V)=>Math.abs(V.time-B.time)<0.001);if(K)K.select()});break}return Undo.finishEdit(`${W} keyframes`),Animator.preview(),`Successfully performed ${W} on ${J.length} keyframes for ${$}.${Y}`}},g),I("animation_graph_editor",{description:"Controls animation curves in the graph editor for fine-tuning animations.",annotations:{title:"Animation Graph Editor",destructiveHint:!0},parameters:F.object({animation_id:F.string().optional().describe("Animation UUID or name. If not provided, uses current animation."),bone_name:F.string().describe("Name of the bone/group to modify curves for."),channel:F.enum(["rotation","position","scale"]).describe("Animation channel to modify."),axis:F.enum(["x","y","z","all"]).default("all").describe("Axis to modify curves for."),action:F.enum(["smooth","linear","ease_in","ease_out","ease_in_out","stepped","custom"]).describe("Type of curve modification to apply."),keyframe_range:F.object({start:F.number().describe("Start time of the range."),end:F.number().describe("End time of the range.")}).optional().describe("Time range to apply the curve modification. If not provided, applies to all keyframes."),custom_curve:F.object({control_point_1:F.array(F.number()).length(2).describe("First control point [time, value]."),control_point_2:F.array(F.number()).length(2).describe("Second control point [time, value].")}).optional().describe("Custom bezier curve control points (only for 'custom' action).")}),async execute({animation_id:Q,bone_name:W,channel:$,axis:Y,action:J,keyframe_range:X,custom_curve:H}){let G=Q?Animation.all.find((L)=>L.uuid===Q||L.name===Q):Animation.selected;if(!G)throw Error("No animation found or selected.");let B=B1(W),K=G.animators[B.uuid];if(!K||!K[$])throw Error(`No keyframes found for ${W}.${$}`);Undo.initEdit({animations:[G],keyframes:K[$]});let V=K[$].filter((L)=>{if(!X)return!0;return L.time>=X.start&&L.time<=X.end});return V.forEach((L,U)=>{switch(J){case"linear":L.interpolation="linear";break;case"stepped":L.interpolation="step";break;case"smooth":L.interpolation="catmullrom";break;case"ease_in":case"ease_out":case"ease_in_out":L.interpolation="bezier";let q=V[U+1];if(q){let A=q.time-L.time;if(L.bezier_left_time=0,L.bezier_right_time=A,J==="ease_in")L.bezier_right_time=A*0.6;else if(J==="ease_out")L.bezier_left_time=A*0.4;else L.bezier_left_time=A*0.3,L.bezier_right_time=A*0.7}break;case"custom":if(!H)throw Error("custom_curve is required for 'custom' action.");L.interpolation="bezier",L.bezier_left_time=H.control_point_1[0],L.bezier_left_value=[H.control_point_1[1],H.control_point_1[1],H.control_point_1[1]],L.bezier_right_time=H.control_point_2[0],L.bezier_right_value=[H.control_point_2[1],H.control_point_2[1],H.control_point_2[1]];break}}),Undo.finishEdit("Modify animation curves"),Animator.preview(),updateKeyframeSelection(),`Applied ${J} curve to ${V.length} keyframes in ${W}.${$}`}},g),I("bone_rigging",{description:"Creates and manipulates the bone structure (rig) of a model for animation.",annotations:{title:"Bone Rigging",destructiveHint:!0},parameters:F.object({action:F.enum(["create","parent","unparent","delete","rename","set_pivot","set_ik","mirror"]).describe("Action to perform on the bone structure."),bone_data:F.object({name:F.string().describe("Name of the bone."),parent:F.string().optional().describe("Parent bone name."),origin:F.array(F.number()).length(3).optional().describe("Pivot point of the bone."),rotation:F.array(F.number()).length(3).optional().describe("Initial rotation of the bone."),children:F.array(F.string()).optional().describe("Names of elements to add to this bone."),ik_enabled:F.boolean().optional().describe("Enable inverse kinematics for this bone."),ik_target:F.string().optional().describe("Target bone for IK chain."),mirror_axis:F.enum(["x","y","z"]).optional().describe("Axis to mirror the bone across.")}).describe("Bone configuration data.")}),async execute({action:Q,bone_data:W}){Undo.initEdit({outliner:!0,elements:[],groups:[]});let $="";switch(Q){case"create":{let Y=new Group({name:W.name,origin:W.origin||[0,0,0],rotation:W.rotation||[0,0,0]}).init();if(W.parent){let J=Group.all.find((X)=>X.name===W.parent);if(J)Y.addTo(J)}if(W.children)W.children.forEach((J)=>{let X=Outliner.elements.find((H)=>H.name===J);if(X)X.addTo(Y)});if(W.ik_enabled&&W.ik_target)Y.ik_enabled=!0,Y.ik_target=W.ik_target;$=`Created bone "${Y.name}" with UUID ${Y.uuid}`;break}case"parent":{let Y=B1(W.name),J=W.parent?Group.all.find((X)=>X.name===W.parent):"root";Y.addTo(J),$=`Parented "${W.name}" to "${W.parent||"root"}"`;break}case"unparent":{B1(W.name).addTo("root"),$=`Unparented "${W.name}"`;break}case"delete":{B1(W.name).remove(),$=`Deleted bone "${W.name}"`;break}case"rename":{let Y=B1(W.name),J=W.children?.[0]||"new_name";Y.name=J,$=`Renamed bone to "${J}"`;break}case"set_pivot":{let Y=B1(W.name);if(W.origin)Y.origin=W.origin;$=`Set pivot point for "${W.name}"`;break}case"set_ik":{let Y=B1(W.name);if(Y.ik_enabled=W.ik_enabled||!1,W.ik_target)Y.ik_target=W.ik_target;$=`Updated IK settings for "${W.name}"`;break}case"mirror":{let Y=B1(W.name),J=W.mirror_axis||"x",X=Y.duplicate(),H=J==="x"?0:J==="y"?1:2;X.origin[H]*=-1,X.name=Y.name.includes("left")?Y.name.replace("left","right"):Y.name.includes("right")?Y.name.replace("right","left"):Y.name+"_mirrored",$=`Mirrored bone "${W.name}" across ${J} axis`;break}}return Undo.finishEdit(`Bone rigging: ${Q}`),Canvas.updateAll(),$}},g),I("animation_timeline",{description:"Controls the animation timeline, including playback, time scrubbing, and timeline settings.",annotations:{title:"Animation Timeline",destructiveHint:!0},parameters:F.object({action:F.enum(["play","pause","stop","set_time","set_length","set_fps","loop","select_range"]).describe("Timeline action to perform."),time:F.number().optional().describe("Time in seconds (for set_time action)."),length:F.number().optional().describe("Animation length in seconds (for set_length action)."),fps:F.number().min(1).max(120).optional().describe("Frames per second (for set_fps action)."),loop_mode:F.enum(["once","loop","hold"]).optional().describe("Loop mode for the animation."),range:F.object({start:F.number(),end:F.number()}).optional().describe("Time range for selection.")}),async execute({action:Q,time:W,length:$,fps:Y,loop_mode:J,range:X}){if(!Animation.selected)throw Error("No animation selected.");let H="";switch(Q){case"play":Timeline.start(),H="Started animation playback";break;case"pause":Timeline.pause(),H="Paused animation playback";break;case"stop":Timeline.setTime(0),Timeline.pause(),H="Stopped animation playback";break;case"set_time":if(W===void 0)throw Error("Time parameter required for set_time action.");Timeline.setTime(W),H=`Set timeline to ${W} seconds`;break;case"set_length":if($===void 0)throw Error("Length parameter required for set_length action.");Animation.selected.length=$,H=`Set animation length to ${$} seconds`;break;case"set_fps":if(Y===void 0)throw Error("FPS parameter required for set_fps action.");Animation.selected.snapping=Y,H=`Set animation FPS to ${Y}`;break;case"loop":if(J)Animation.selected.loop=J;H=`Set loop mode to ${J||Animation.selected.loop}`;break;case"select_range":if(!X)throw Error("Range parameter required for select_range action.");Timeline.keyframes.forEach((G)=>{if(G.time>=X.start&&G.time<=X.end)G.select();else G.selected=!1}),H=`Selected keyframes between ${X.start} and ${X.end} seconds`;break}return Animator.preview(),H}},g),I("batch_keyframe_operations",{description:"Performs batch operations on multiple keyframes at once.",annotations:{title:"Batch Keyframe Operations",destructiveHint:!0},parameters:F.object({selection:F.enum(["all","selected","range","pattern"]).default("selected").describe("Which keyframes to operate on."),range:F.object({start:F.number(),end:F.number()}).optional().describe("Time range for keyframe selection."),pattern:F.object({interval:F.number().describe("Time interval between keyframes."),offset:F.number().optional().default(0).describe("Time offset for the pattern.")}).optional().describe("Pattern-based selection."),operation:F.enum(["offset","scale","reverse","mirror","smooth","bake"]).describe("Operation to perform on keyframes."),parameters:F.object({offset_time:F.number().optional().describe("Time offset to apply."),offset_values:F.array(F.number()).length(3).optional().describe("Value offset to apply."),scale_factor:F.number().optional().describe("Scale factor for time or values."),scale_pivot:F.number().optional().describe("Pivot point for scaling."),mirror_axis:F.enum(["x","y","z"]).optional().describe("Axis to mirror values across."),bake_interval:F.number().optional().describe("Interval for baking keyframes.")}).optional().describe("Operation-specific parameters.")}),async execute({selection:Q,range:W,pattern:$,operation:Y,parameters:J={}}){if(!Animation.selected)throw Error("No animation selected.");let X=[];switch(Q){case"all":X=Timeline.keyframes;break;case"selected":X=Timeline.selected;break;case"range":if(!W)throw Error("Range required for range selection.");X=Timeline.keyframes.filter((H)=>H.time>=W.start&&H.time<=W.end);break;case"pattern":if(!$)throw Error("Pattern required for pattern selection.");X=Timeline.keyframes.filter((H)=>{let G=H.time-$.offset;return Math.abs(G%$.interval)<0.001});break}if(X.length===0)throw Error("No keyframes found matching selection criteria.");switch(Undo.initEdit({keyframes:X}),Y){case"offset":X.forEach((A)=>{if(J.offset_time!==void 0)A.time+=J.offset_time;if(J.offset_values){let D=A.getArray();A.set("values",[D[0]+J.offset_values[0],D[1]+J.offset_values[1],D[2]+J.offset_values[2]])}});break;case"scale":let H=J.scale_pivot||0,G=J.scale_factor||1;X.forEach((A)=>{A.time=H+(A.time-H)*G});break;case"reverse":let B=X.map((A)=>A.time),K=Math.min(...B),V=Math.max(...B);X.forEach((A)=>{A.time=V-(A.time-K)});break;case"mirror":if(!J.mirror_axis)throw Error("Mirror axis required for mirror operation.");let L=J.mirror_axis==="x"?0:J.mirror_axis==="y"?1:2;X.forEach((A)=>{let D=A.getArray();D[L]*=-1,A.set("values",D)});break;case"smooth":X.forEach((A)=>{A.interpolation="catmullrom"});break;case"bake":let U=J.bake_interval||1/Animation.selected.snapping;new Set(X.map((A)=>A.animator)).forEach((A)=>{["rotation","position","scale"].forEach((O)=>{let w=A[O];if(!w||w.length<2)return;let j=Math.min(...w.map((C)=>C.time)),z=Math.max(...w.map((C)=>C.time));for(let C=j;C<=z;C+=U)if(!w.find((S)=>Math.abs(S.time-C)<0.001))Timeline.time=C,A.fillValues(A.createKeyframe({time:C,channel:O,values:A.interpolate(O,!0)},C,O,!1),null,!1)})});break}return Undo.finishEdit(`Batch keyframe operation: ${Y}`),Animator.preview(),`Performed ${Y} on ${X.length} keyframes`}},g),I("animation_copy_paste",{description:"Copies and pastes animation data between bones or animations.",annotations:{title:"Animation Copy/Paste",destructiveHint:!0},parameters:F.object({action:F.enum(["copy","paste","mirror_paste"]).describe("Copy or paste action."),source:F.object({animation:F.string().optional().describe("Source animation name or UUID."),bone:F.string().describe("Source bone name."),channels:F.array(F.enum(["rotation","position","scale"])).optional().default(["rotation","position","scale"]).describe("Channels to copy."),time_range:F.object({start:F.number(),end:F.number()}).optional().describe("Time range to copy. If not provided, copies all keyframes.")}).optional().describe("Source data for copy operation."),target:F.object({animation:F.string().optional().describe("Target animation name or UUID."),bone:F.string().describe("Target bone name."),time_offset:F.number().optional().default(0).describe("Time offset for pasted keyframes."),mirror_axis:F.enum(["x","y","z"]).optional().describe("Axis to mirror across for mirror_paste.")}).optional().describe("Target data for paste operation.")}),async execute({action:Q,source:W,target:$}){if(!global.animationClipboard)global.animationClipboard=null;switch(Q){case"copy":{if(!W)throw Error("Source data required for copy operation.");let Y=W.animation?Animation.all.find((G)=>G.uuid===W.animation||G.name===W.animation):Animation.selected;if(!Y)throw Error("Source animation not found.");let J=B1(W.bone),X=Y.animators[J.uuid];if(!X)throw Error(`No animation data for bone "${W.bone}".`);let H={bone_name:W.bone,channels:{}};return W.channels.forEach((G)=>{if(!X[G])return;let B=X[G];if(W.time_range)B=B.filter((K)=>K.time>=W.time_range.start&&K.time<=W.time_range.end);H.channels[G]=B.map((K)=>({time:K.time,values:K.getArray(),interpolation:K.interpolation,bezier_left_time:K.bezier_left_time,bezier_left_value:K.bezier_left_value,bezier_right_time:K.bezier_right_time,bezier_right_value:K.bezier_right_value}))}),global.animationClipboard=H,`Copied animation data from "${W.bone}" (${Object.keys(H.channels).join(", ")})`}case"paste":case"mirror_paste":{if(!$)throw Error("Target data required for paste operation.");if(!global.animationClipboard)throw Error("No animation data in clipboard. Copy first.");let Y=$.animation?Animation.all.find((K)=>K.uuid===$.animation||K.name===$.animation):Animation.selected;if(!Y)throw Error("Target animation not found.");let J=B1($.bone),X=Y.animators[J.uuid];if(!X)X=new BoneAnimator(J.uuid,Y,$.bone),Y.animators[J.uuid]=X;Undo.initEdit({animations:[Y],keyframes:[]});let H=global.animationClipboard,G=Q==="mirror_paste"?$.mirror_axis||"x":null,B=G==="x"?0:G==="y"?1:G==="z"?2:-1;return Object.entries(H.channels).forEach(([K,V])=>{V.forEach((L)=>{let U=[...L.values];if(G&&(K==="rotation"||K==="position"))U[B]*=-1;let q=X.createKeyframe({time:L.time+($.time_offset||0),channel:K,values:U,interpolation:L.interpolation},L.time+($.time_offset||0),K,!1);if(L.interpolation==="bezier"){if(L.bezier_left_time!==void 0)q.bezier_left_time=L.bezier_left_time;if(L.bezier_left_value)q.bezier_left_value=L.bezier_left_value;if(L.bezier_right_time!==void 0)q.bezier_right_time=L.bezier_right_time;if(L.bezier_right_value)q.bezier_right_value=L.bezier_right_value}})}),Undo.finishEdit(`${Q} animation data`),Animator.preview(),`Pasted animation data to "${$.bone}"${G?` (mirrored on ${G} axis)`:""}`}}}},g)}var K7=F.object({name:F.string(),origin:F.array(F.number()).length(3).describe("Pivot point of the cube.").optional().default([0,0,0]),from:F.array(F.number()).length(3).describe("Starting point of the cube.").optional().default([0,0,0]),to:F.array(F.number()).length(3).describe("Ending point of the cube.").optional().default([1,1,1]),rotation:F.array(F.number()).length(3).describe("Rotation of the cube.").optional().default([0,0,0])}),xB=F.object({name:F.string(),position:F.array(F.number()).length(3).describe("Position of the mesh.").optional().default([0,0,0]),rotation:F.array(F.number()).length(3).describe("Rotation of the mesh.").optional().default([0,0,0]),scale:F.array(F.number()).length(3).describe("Scale of the mesh.").optional().default([1,1,1]),vertices:F.array(F.array(F.number()).length(3).describe("Vertex coordinates in the mesh.")).describe("Vertices of the mesh.").optional().default([])});function yB(){I("place_cube",{description:"Places a cube of the given size at the specified position. Texture and group are optional.",annotations:{title:"Place Cube",destructiveHint:!0},parameters:F.object({elements:F.array(K7).min(1).describe("Array of cubes to place."),texture:F.string().optional().describe("Texture ID or name to apply to the cube."),group:F.string().optional().describe("Group/bone to which the cube belongs."),faces:F.union([F.array(F.enum(["north","south","east","west","up","down"])).describe("Array of faces to apply the texture to."),F.boolean().optional().describe("Whether to apply the texture to all faces. Set to `true` to enable auto UV mapping."),F.array(F.object({face:F.enum(["north","south","east","west","up","down"]).describe("Face to apply the texture to."),uv:F.array(F.number()).length(4).describe("Custom UV mapping for the face.")})).describe("Array of faces with custom UV mapping.")]).optional().default(!0).describe("Faces to apply the texture to. Set to `true` to enable auto UV mapping.")}),async execute({elements:Q,texture:W,faces:$,group:Y},{reportProgress:J}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let X=Q.length,H=W?z0(W):Texture.getDefault();if(!H)throw Error(`No texture found for "${W}".`);let B=getAllGroups().find((L)=>L.name===Y||L.uuid===Y),K=$===!0||Array.isArray($)&&$.every((L)=>typeof L==="string"),V=Q.map((L,U)=>{let q=new Cube({autouv:K?1:0,name:L.name,from:L.from,to:L.to,origin:L.origin,rotation:L.rotation}).init();if(q.addTo(B),!K&&Array.isArray($))$.forEach(({face:A,uv:D})=>{q.faces[A].extend({uv:D})});else q.applyTexture(H,$!==!1?$:void 0),q.mapAutoUV();return J({progress:U,total:X}),q});return Undo.finishEdit("Agent placed cubes"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(V.map((L)=>`Added cube ${L.name} with ID ${L.uuid}`)))}},K0),I("modify_cube",{description:"Modifies the cube with the given ID. Auto UV setting: saved as an integer, where 0 means disabled, 1 means enabled, and 2 means relative auto UV (cube position affects UV)",annotations:{title:"Modify Cube",destructiveHint:!0},parameters:F.object({id:F.string().optional().describe("ID or name of the cube to modify. Defaults to selected, which could be more than one."),...K7.shape,name:F.string().optional().describe("New name of the cube."),autouv:F.enum(["0","1","2"]).optional().describe("Auto UV setting. 0 = disabled, 1 = enabled, 2 = relative auto UV."),uv_offset:F.array(F.number()).length(2).optional().describe("UV offset for the texture."),mirror_uv:F.boolean().optional().describe("Whether to mirror the UVs."),shade:F.boolean().optional().describe("Whether to apply shading to the cube."),inflate:F.number().optional().describe("Inflation amount for the cube."),color:F.number().optional().describe("Single digit to represent a color from a palette."),visibility:F.boolean().optional().describe("Whether the cube is visible or not.")}),async execute({id:Q,name:W,origin:$,from:Y,to:J,rotation:X,uv_offset:H,autouv:G,mirror_uv:B,shade:K,inflate:V,color:L,visibility:U}){let q=Outliner.root.filter((A)=>A instanceof Cube&&(A.uuid===Q||A.name===Q))??Cube.selected;if(!q.length)throw Error(`Cube with ID "${Q}" not found.`);return Undo.initEdit({elements:Array.isArray(q)?q:[q],outliner:!0,collections:[]}),q.forEach((A)=>{let D=$??A.origin,O=Y??A.from,w=J??A.to,j=X??A.rotation,z=H??A.uv_offset;A.extend({name:W??A.name,origin:D,from:O,to:w,rotation:j,uv_offset:z,autouv:G?Number(G):A.autouv,mirror_uv:Boolean(B??A.mirror_uv),inflate:V??A.inflate,color:L??A.color,visibility:U??A.visibility,shade:K??A.shade})}),Undo.finishEdit("Agent modified cubes"),Canvas.updateAll(),`Modified cubes ${q.map((A)=>A.name).join(", ")} with IDs ${q.map((A)=>A.uuid).join(", ")}`}},K0)}function gB(){I("remove_element",{description:"Removes the element with the given ID.",annotations:{title:"Remove Element",destructiveHint:!0},parameters:F.object({id:F.string().describe("ID or name of the element to remove.")}),async execute({id:Q}){let W=I4(Q);return Undo.initEdit({elements:[],outliner:!0,collections:[]}),W.remove(),Undo.finishEdit("Agent removed element"),Canvas.updateAll(),`Removed element with ID ${Q}`}},g),I("add_group",{description:"Adds a new group with the given name and options.",annotations:{title:"Add Group",destructiveHint:!0},parameters:F.object({name:F.string(),origin:F.array(F.number()).length(3),rotation:F.array(F.number()).length(3),parent:F.string().optional().default("root"),visibility:F.boolean().optional().default(!0),autouv:F.enum(["0","1","2"]).optional().default("0").describe("Auto UV setting. 0 = disabled, 1 = enabled, 2 = relative auto UV."),selected:F.boolean().optional().default(!1),shade:F.boolean().optional().default(!1)}),async execute({name:Q,origin:W,rotation:$,parent:Y,visibility:J,autouv:X,selected:H,shade:G}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let B=new Group({name:Q,origin:W,rotation:$,autouv:Number(X),visibility:Boolean(J),selected:Boolean(H),shade:Boolean(G)}).init();return B.addTo(getAllGroups().find((K)=>K.name===Y||K.uuid===Y)),Undo.finishEdit("Agent added group"),Canvas.updateAll(),`Added group ${B.name} with ID ${B.uuid}`}},K0),I("list_outline",{description:"Returns a list of all groups and their children in the Blockbench editor.",annotations:{title:"List Outline",readOnlyHint:!0},parameters:F.object({}),async execute(){let Q=Outliner.elements;return JSON.stringify(Q.map((W)=>{let{name:$,uuid:Y}=W;return{name:$,uuid:Y}}),null,2)}},K0),I("duplicate_element",{description:"Duplicates a cube, mesh or group by ID or name.  You may offset the duplicate or assign a new name.",annotations:{title:"Duplicate Element",destructiveHint:!0},parameters:F.object({id:F.string().describe("ID or name of the element to duplicate."),offset:F.array(F.number()).length(3).optional().default([0,0,0]),newName:F.string().optional()}),async execute({id:Q,offset:W,newName:$}){let Y=I4(Q);function J(K,V){let L=new Cube({name:$||`${K.name}_copy`,from:K.from.map((U,q)=>U+W[q]),to:K.to.map((U,q)=>U+W[q]),origin:K.origin.map((U,q)=>U+W[q]),rotation:K.rotation,autouv:K.autouv,uv_offset:K.uv_offset,mirror_uv:K.mirror_uv,shade:K.shade,inflate:K.inflate,color:K.color,visibility:K.visibility}).init();return L.addTo(V),L}function X(K,V){let L=new Group({name:$||`${K.name}_copy`,origin:K.origin.map((U,q)=>U+W[q]),rotation:K.rotation,autouv:K.autouv,selected:K.selected,shade:K.shade,visibility:K.visibility}).init();return L.addTo(V),K.children.forEach((U)=>G(U,L)),L}function H(K,V){let L=new Mesh({name:$||`${K.name}_copy`,vertices:{},origin:K.origin.map((q,A)=>q+W[A]),rotation:K.rotation}).init(),U={};if(Object.entries(K.vertices).forEach(([q,A])=>{U[q]=L.addVertices([A[0]+W[0],A[1]+W[1],A[2]+W[2]])[0]}),K.faces.forEach((q)=>{L.addFaces(new MeshFace(L,{vertices:q.vertices.map((A)=>U[A]),uv:q.uv}))}),L.addTo(V),K.material)L.applyTexture(K.material);return L}function G(K,V){if(K instanceof Cube)return J(K,V);if(K instanceof Group)return X(K,V);if(K instanceof Mesh)return H(K,V);throw Error("Unsupported element type.")}Undo.initEdit({elements:[],outliner:!0,collections:[]});let B=G(Y,Y.parent??Outliner);return Undo.finishEdit("Agent duplicated element"),Canvas.updateAll(),`Duplicated "${Y.name}" as "${B.name}" (ID: ${B.uuid}).`}},g),I("rename_element",{description:"Renames a cube, mesh or group by ID or name.",annotations:{title:"Rename Element",destructiveHint:!0},parameters:F.object({id:F.string().describe("ID or name of the element to rename."),new_name:F.string().describe("New name to assign.")}),async execute({id:Q,new_name:W}){let $=I4(Q);return Undo.initEdit({elements:[$],outliner:!0,collections:[]}),$.extend({name:W}),Undo.finishEdit("Agent renamed element"),Canvas.updateAll(),`Renamed element "${Q}" to "${W}".`}},g)}function hB(){I("from_geo_json",{description:"Imports a model from a GeoJSON file.",annotations:{title:"Import GeoJSON",destructiveHint:!0},parameters:F.object({geojson:F.string().describe("Path to the GeoJSON file or data URL, or the GeoJSON string itself.")}),async execute({geojson:Q}){if(!Q.startsWith("{")&&!Q.startsWith("["))Q=await fetch(Q).then((W)=>W.text());if(typeof Q!=="string")throw Error("Invalid GeoJSON input. Expected a string.");return Codecs.bedrock.parse(JSON.parse(Q),""),new Promise((W)=>{setTimeout(async()=>{W(await g6())},3000)})}},K0)}function fB(){I("place_mesh",{description:"Places a mesh at the specified position. Texture and group are optional.",annotations:{title:"Place Mesh",destructiveHint:!0},parameters:F.object({elements:F.array(xB).min(1).describe("Array of meshes to place."),texture:F.string().optional().describe("Texture ID or name to apply to the mesh."),group:F.string().optional().describe("Group/bone to which the mesh belongs.")}),async execute({elements:Q,texture:W,group:$},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let J=Q.length,X=W?z0(W):Texture.getDefault();if(!X)throw Error(`No texture found for "${W}".`);let G=getAllGroups().find((K)=>K.name===$||K.uuid===$),B=Q.map((K,V)=>{let L=new Mesh({name:K.name,vertices:{}}).init();return K.vertices.forEach((U)=>{L.addVertices(U)}),L.addTo(G),L.applyTexture(X),Y({progress:V,total:J}),L});return Undo.finishEdit("Agent placed meshes"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(B.map((K)=>`Added mesh ${K.name} with ID ${K.uuid}`)))}},g),I("extrude_mesh",{description:"Extrudes selected faces or edges of a mesh.",annotations:{title:"Extrude Mesh",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),distance:F.number().default(1).describe("Distance to extrude."),mode:F.enum(["faces","edges","vertices"]).default("faces").describe("What to extrude: faces, edges, or vertices.")}),async execute({mesh_id:Q,distance:W,mode:$}){let Y=c1(Q),J=$==="faces"?BarItems.extrude_mesh_selection:$==="edges"?BarItems.extrude_mesh_selection:BarItems.extrude_mesh_selection;if(!J)throw Error(`Extrude tool for ${$} not found.`);return J.click({},W),`Extruded ${$} of mesh "${Y.name}" by ${W} units`}},g),I("subdivide_mesh",{description:"Subdivides selected faces of a mesh to create more geometry.",annotations:{title:"Subdivide Mesh",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),cuts:F.number().min(1).max(10).default(1).describe("Number of subdivision cuts to make.")}),async execute({mesh_id:Q,cuts:W}){let $=c1(Q),Y=BarItems.loop_cut;if(!Y)throw Error("Loop cut tool not found.");return Y.click({},void 0,void 0,W),`Subdivided mesh "${$.name}" with ${W} cuts`}},g),I("create_sphere",{description:"Creates a sphere mesh at the specified position with the given parameters. The sphere is created as a mesh with vertices and faces using spherical coordinates.",annotations:{title:"Create Sphere",destructiveHint:!0},parameters:F.object({elements:F.array(F.object({name:F.string().describe("Name of the sphere."),position:F.array(F.number()).length(3).describe("Position of the sphere center."),diameter:F.number().min(1).max(64).default(16).describe("Diameter of the sphere."),sides:F.number().min(3).max(48).default(12).describe("Number of horizontal divisions (affects sphere quality)."),rotation:F.array(F.number()).length(3).optional().default([0,0,0]).describe("Rotation of the sphere."),align_edges:F.boolean().optional().default(!0).describe("Whether to align edges for better geometry.")})).min(1).describe("Array of spheres to create."),texture:F.string().optional().describe("Texture ID or name to apply to the sphere."),group:F.string().optional().describe("Group/bone to which the sphere belongs.")}),async execute({elements:Q,texture:W,group:$},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let J=Q.length,X=W?z0(W):Texture.getDefault();if(!X)throw Error(`No texture found for "${W}".`);let G=getAllGroups().find((K)=>K.name===$||K.uuid===$),B=Q.map((K,V)=>{let L=new Mesh({name:K.name,vertices:{},origin:K.position,rotation:K.rotation||[0,0,0]}).init(),U=K.diameter/2,q=Math.round(K.sides/2)*2,[A]=L.addVertices([0,-U,0]),[D]=L.addVertices([0,U,0]),O=[],w=K.align_edges?0.5:0;for(let j=0;j<K.sides;j++){let z=Math.sin((j+w)/K.sides*Math.PI*2),C=Math.cos((j+w)/K.sides*Math.PI*2),S=[];for(let D0=1;D0<q/2;D0++){let b0=Math.sin(D0/q*Math.PI*2)*U,k1=z*b0,M0=Math.cos(D0/q*Math.PI*2)*U,P0=C*b0;S.push(...L.addVertices([k1,M0,P0]))}O.push(S)}for(let j=0;j<K.sides;j++){let z=O[j],C=O[j+1]||O[0];for(let S=0;S<q/2;S++){if(S==0){L.addFaces(new MeshFace(L,{vertices:[z[S],C[S],D],uv:{}}));continue}if(!z[S]){L.addFaces(new MeshFace(L,{vertices:[C[S-1],z[S-1],A],uv:{}}));continue}L.addFaces(new MeshFace(L,{vertices:[z[S],C[S],z[S-1],C[S-1]],uv:{}}))}}if(L.addTo(G),X)L.applyTexture(X);return Y({progress:V,total:J}),L});return Undo.finishEdit("Agent created spheres"),Canvas.updateAll(),await Promise.resolve(JSON.stringify(B.map((K)=>`Added sphere ${K.name} with ID ${K.uuid}`)))}},K0),I("select_mesh_elements",{description:"Selects vertices, edges, or faces of a mesh for manipulation.",annotations:{title:"Select Mesh Elements",destructiveHint:!0},parameters:F.object({mesh_id:F.string().describe("ID or name of the mesh to select elements from."),mode:F.enum(["vertex","edge","face"]).describe("Selection mode."),elements:F.array(F.union([F.string().describe("Vertex key, edge as 'vkey1-vkey2', or face key"),F.number().describe("Index of the element")])).optional().describe("Specific elements to select. If not provided, selects all."),action:F.enum(["select","add","remove","toggle"]).default("select").describe("Selection action: select (replace), add, remove, or toggle.")}),async execute({mesh_id:Q,mode:W,elements:$,action:Y}){let J=y6(Q);Undo.initEdit({elements:[J],selection:!0,collections:[]}),BarItems.selection_mode.set(W);let X=Project?.mesh_selection[J.uuid]??{vertices:[],edges:[],faces:[]};if(Y==="select")X.vertices=[],X.edges.length=0,X.faces=[];if(!$||$.length===0){if(W==="vertex")X.vertices=Object.keys(J.vertices);else if(W==="face")X.faces=Object.keys(J.faces);else if(W==="edge"){let H=[],G=new Set;for(let K in J.faces){let L=J.faces[K].getEdges();for(let[U,q]of L){let A=U<q?`${U}-${q}`:`${q}-${U}`;if(!G.has(A))G.add(A),H.push([U,q])}}let B=X.edges;B.length=0,B.push(...H)}}else $.forEach((H)=>{if(W==="vertex"){let G=String(H);if(Y==="add"||Y==="select"){if(!X.vertices.includes(G))X.vertices.push(G)}else if(Y==="remove")X.vertices=X.vertices.filter((B)=>B!==G);else if(Y==="toggle")if(X.vertices.includes(G))X.vertices=X.vertices.filter((B)=>B!==G);else X.vertices.push(G)}else if(W==="face"){let G=String(H);if(Y==="add"||Y==="select"){if(!X.faces.includes(G))X.faces.push(G)}else if(Y==="remove")X.faces=X.faces.filter((B)=>B!==G);else if(Y==="toggle")if(X.faces.includes(G))X.faces=X.faces.filter((B)=>B!==G);else X.faces.push(G)}else if(W==="edge"){let G=String(H).split("-");if(G.length===2){let B=[G[0],G[1]],K=X.edges;if(Y==="add"||Y==="select")K.push(B);else if(Y==="remove"){let V=K.filter((L)=>!(L[0]===B[0]&&L[1]===B[1])&&!(L[0]===B[1]&&L[1]===B[0]));K.length=0,K.push(...V)}else if(Y==="toggle")if(K.some((L)=>L[0]===B[0]&&L[1]===B[1]||L[0]===B[1]&&L[1]===B[0])){let L=K.filter((U)=>!(U[0]===B[0]&&U[1]===B[1])&&!(U[0]===B[1]&&U[1]===B[0]));K.length=0,K.push(...L)}else K.push(B)}}});return J.select(),Canvas.updateView({elements:[J],selection:!0}),Undo.finishEdit("Select mesh elements"),JSON.stringify({mesh:J.name,mode:W,selected:{vertices:X.vertices.length,edges:X.edges.length,faces:X.faces.length}})}},g),I("move_mesh_vertices",{description:"Moves selected vertices of a mesh by the specified offset.",annotations:{title:"Move Mesh Vertices",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),offset:F.array(F.number()).length(3).describe("Offset to move vertices by [x, y, z]."),vertices:F.array(F.string()).optional().describe("Specific vertex keys to move. If not provided, moves all selected vertices.")}),async execute({mesh_id:Q,offset:W,vertices:$}){let Y=c1(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let J=$||Y.getSelectedVertices();return J.forEach((X)=>{if(Y.vertices[X])Y.vertices[X][0]+=W[0],Y.vertices[X][1]+=W[1],Y.vertices[X][2]+=W[2]}),Y.preview_controller.updateGeometry(Y),Undo.finishEdit("Move mesh vertices"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Moved ${J.length} vertices of mesh "${Y.name}"`}},g),I("delete_mesh_elements",{description:"Deletes selected vertices, edges, or faces from a mesh.",annotations:{title:"Delete Mesh Elements",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),mode:F.enum(["vertices","edges","faces"]).default("faces").describe("What to delete: vertices, edges, or faces."),keep_vertices:F.boolean().default(!1).describe("When deleting faces/edges, whether to keep the vertices.")}),async execute({mesh_id:Q,mode:W,keep_vertices:$}){let Y=c1(Q),J=BarItems.delete_mesh_selection;if(!J)throw Error("Delete mesh selection tool not found.");return J.click({},$),`Deleted selected ${W} from mesh "${Y.name}"`}},g),I("merge_mesh_vertices",{description:"Merges vertices that are within a specified distance of each other.",annotations:{title:"Merge Mesh Vertices",destructiveHint:!0},parameters:F.object({mesh_id:F.string().describe("ID or name of the mesh."),threshold:F.number().min(0).max(10).default(0.1).describe("Maximum distance between vertices to merge."),selected_only:F.boolean().default(!0).describe("Whether to only merge selected vertices.")}),async execute({mesh_id:Q,threshold:W,selected_only:$}){let Y=y6(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let J=$?Y.getSelectedVertices():Object.keys(Y.vertices),X=0,H={};for(let G=0;G<J.length;G++){let B=J[G];if(H[B])continue;for(let K=G+1;K<J.length;K++){let V=J[K];if(H[V])continue;let L=Y.vertices[B],U=Y.vertices[V];if(Math.sqrt((L[0]-U[0])**2+(L[1]-U[1])**2+(L[2]-U[2])**2)<=W)H[V]=B,X++}}return Object.entries(H).forEach(([G,B])=>{for(let K in Y.faces){let V=Y.faces[K],L=V.vertices.indexOf(G);if(L!==-1)V.vertices[L]=B,V.uv[B]=V.uv[G]||[0,0],delete V.uv[G]}delete Y.vertices[G]}),Y.preview_controller.updateGeometry(Y),Undo.finishEdit("Merge mesh vertices"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Merged ${X} vertices in mesh "${Y.name}"`}},g),I("create_mesh_face",{description:"Creates a new face from selected vertices.",annotations:{title:"Create Mesh Face",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),vertices:F.array(F.string()).min(3).max(4).describe("Vertex keys to create face from. Must be 3 or 4 vertices."),texture:F.string().optional().describe("Texture ID or name to apply to the new face.")}),async execute({mesh_id:Q,vertices:W,texture:$}){let Y=c1(Q);Undo.initEdit({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}});let J=new MeshFace(Y,{vertices:W,texture:$?z0($)?.uuid:void 0}),[X]=Y.addFaces(J);return UVEditor.setAutoSize(null,!0,[X]),Y.preview_controller.updateGeometry(Y),Y.preview_controller.updateUV(Y),Undo.finishEdit("Create mesh face"),Canvas.updateView({elements:[Y],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Created face with ${W.length} vertices in mesh "${Y.name}"`}},g),I("create_cylinder",{description:"Creates one or more cylinder meshes with optional end caps.",annotations:{title:"Create Cylinder",destructiveHint:!0},parameters:F.object({elements:F.array(F.object({name:F.string(),position:F.array(F.number()).length(3),height:F.number().min(1).max(64).default(16),diameter:F.number().min(1).max(64).default(16),sides:F.number().min(3).max(64).default(12),rotation:F.array(F.number()).length(3).optional().default([0,0,0]),capped:F.boolean().optional().default(!0)})).min(1),texture:F.string().optional(),group:F.string().optional()}),async execute({elements:Q,texture:W,group:$},{reportProgress:Y}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let J=Q.length,X=W?z0(W):Texture.getDefault();if(!X)throw Error(`Texture "${W}" not found.`);let H=getAllGroups().find((B)=>B.name===$||B.uuid===$),G=Q.map((B,K)=>{let V=new Mesh({name:B.name,vertices:{},origin:B.position,rotation:B.rotation||[0,0,0]}).init(),L=B.diameter/2,U=B.height,q=Math.round(B.sides),A=V.addVertices([0,U/2,0])[0],D=V.addVertices([0,-U/2,0])[0],O=[],w=[];for(let j=0;j<q;j++){let z=j/q*Math.PI*2,C=Math.cos(z)*L,S=Math.sin(z)*L;O.push(V.addVertices([C,U/2,S])[0]),w.push(V.addVertices([C,-U/2,S])[0])}for(let j=0;j<q;j++){let z=(j+1)%q;if(V.addFaces(new MeshFace(V,{vertices:[w[j],w[z],O[z],O[j]],uv:{}})),B.capped)V.addFaces(new MeshFace(V,{vertices:[O[j],O[z],A],uv:{}})),V.addFaces(new MeshFace(V,{vertices:[w[z],w[j],D],uv:{}}))}if(V.addTo(H),X)V.applyTexture(X);return Y({progress:K,total:J}),V});return Undo.finishEdit("Agent created cylinders"),Canvas.updateAll(),JSON.stringify(G.map((B)=>`Added cylinder ${B.name} (ID ${B.uuid})`))}},g),I("knife_tool",{description:"Uses the knife tool to cut custom edges into mesh faces.",annotations:{title:"Knife Tool",destructiveHint:!0},parameters:F.object({mesh_id:F.string().describe("ID or name of the mesh to cut."),points:F.array(F.object({position:F.array(F.number()).length(3).describe("3D position of the cut point."),face:F.string().optional().describe("Face key to attach the point to.")})).min(2).describe("Points defining the cut path.")}),async execute({mesh_id:Q,points:W}){let $=y6(Q);Undo.initEdit({elements:[$],element_aspects:{geometry:!0,uv:!0,faces:!0}});let Y=new KnifeToolContext($);return W.forEach((J)=>{Y.points.push({position:new THREE.Vector3(...J.position),fkey:J.face,type:J.face?"face":"edge"})}),Y.apply(),Undo.finishEdit("Knife cut mesh"),Canvas.updateView({elements:[$],element_aspects:{geometry:!0,uv:!0,faces:!0}}),`Applied knife cut to mesh "${$.name}" with ${W.length} points`}},g)}function uB(){I("paint_fill_tool",{description:"Uses the fill/bucket tool to fill areas with color.",annotations:{title:"Paint Fill Tool",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),x:F.number().describe("X coordinate to start fill."),y:F.number().describe("Y coordinate to start fill."),color:F.string().optional().describe("Fill color as hex string."),opacity:F.number().min(0).max(255).optional().describe("Fill opacity (0-255)."),tolerance:F.number().min(0).max(100).optional().describe("Color tolerance for fill."),fill_mode:F.enum(["color","color_connected","face","element","selected_elements","selection"]).optional().default("color_connected").describe("Fill mode."),blend_mode:F.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]).optional().describe("Fill blend mode.")}),async execute({texture_id:Q,x:W,y:$,color:Y,opacity:J,tolerance:X,fill_mode:H,blend_mode:G}){let B=Q?z0(Q):Texture.getDefault();if(!B)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[B],bitmap:!0}),Y)ColorPanel.set(Y);if(J!==void 0)BarItems.slider_brush_opacity.set(J);if(H)BarItems.fill_mode.set(H);if(G)BarItems.blend_mode.set(G);return BarItems.fill_tool.select(),Painter.startPaintTool(B,W,$,{}),Painter.stopPaintTool(),Undo.finishEdit("Fill tool"),Canvas.updateAll(),`Filled area at (${W}, ${$}) on texture "${B.name}"`}},g),I("draw_shape_tool",{description:"Draws geometric shapes on textures.",annotations:{title:"Draw Shape Tool",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),shape:F.enum(["rectangle","rectangle_h","ellipse","ellipse_h"]).describe("Shape to draw. '_h' suffix means hollow."),start:F.object({x:F.number().describe("Start X coordinate."),y:F.number().describe("Start Y coordinate.")}),end:F.object({x:F.number().describe("End X coordinate."),y:F.number().describe("End Y coordinate.")}),color:F.string().optional().describe("Shape color as hex string."),line_width:F.number().min(1).max(50).optional().describe("Line width for hollow shapes."),opacity:F.number().min(0).max(255).optional().describe("Shape opacity (0-255)."),blend_mode:F.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]).optional().describe("Shape blend mode.")}),async execute({texture_id:Q,shape:W,start:$,end:Y,color:J,line_width:X,opacity:H,blend_mode:G}){let B=Q?z0(Q):Texture.getDefault();if(!B)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[B],bitmap:!0}),J)ColorPanel.set(J);if(H!==void 0)BarItems.slider_brush_opacity.set(H);if(X!==void 0)BarItems.slider_brush_size.set(X);if(G)BarItems.blend_mode.set(G);return BarItems.draw_shape_type.set(W),BarItems.draw_shape_tool.select(),Painter.startPaintTool(B,$.x,$.y,{}),Painter.useShapeTool(B,Y.x,Y.y,{}),Painter.stopPaintTool(),Undo.finishEdit("Draw shape"),Canvas.updateAll(),`Drew ${W} from (${$.x}, ${$.y}) to (${Y.x}, ${Y.y}) on texture "${B.name}"`}},g),I("gradient_tool",{description:"Applies gradients to textures.",annotations:{title:"Gradient Tool",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),start:F.object({x:F.number().describe("Gradient start X coordinate."),y:F.number().describe("Gradient start Y coordinate.")}),end:F.object({x:F.number().describe("Gradient end X coordinate."),y:F.number().describe("Gradient end Y coordinate.")}),start_color:F.string().describe("Start color as hex string."),end_color:F.string().describe("End color as hex string."),opacity:F.number().min(0).max(255).optional().describe("Gradient opacity (0-255)."),blend_mode:F.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]).optional().describe("Gradient blend mode.")}),async execute({texture_id:Q,start:W,end:$,start_color:Y,end_color:J,opacity:X,blend_mode:H}){let G=Q?z0(Q):Texture.getDefault();if(!G)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[G],bitmap:!0}),ColorPanel.set(Y),ColorPanel.set(J,!0),X!==void 0)BarItems.slider_brush_opacity.set(X);if(H)BarItems.blend_mode.set(H);return BarItems.gradient_tool.select(),Painter.startPaintTool(G,W.x,W.y,{}),Painter.useGradientTool(G,$.x,$.y,{}),Painter.stopPaintTool(),Undo.finishEdit("Apply gradient"),Canvas.updateAll(),`Applied gradient from (${W.x}, ${W.y}) to (${$.x}, ${$.y}) on texture "${G.name}"`}},g),I("color_picker_tool",{description:"Picks colors from textures and sets them as the active color.",annotations:{title:"Color Picker Tool",readOnlyHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),x:F.number().describe("X coordinate to pick color from."),y:F.number().describe("Y coordinate to pick color from."),set_as_secondary:F.boolean().optional().default(!1).describe("Set as secondary color instead of primary."),pick_opacity:F.boolean().optional().default(!1).describe("Also pick and apply the pixel's opacity.")}),async execute({texture_id:Q,x:W,y:$,set_as_secondary:Y,pick_opacity:J}){let X=Q?z0(Q):Texture.getDefault();if(!X)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");Painter.colorPicker(X,W,$,{button:Y?2:0});let H=ColorPanel.get();if(J){let G=Painter.getPixelColor(X.ctx,W,$),B=Math.floor(G.getAlpha()*255);for(let K in BarItems){let V=BarItems[K];if(V.tool_settings&&V.tool_settings.brush_opacity>=0)V.tool_settings.brush_opacity=B}return`Picked color ${H} with opacity ${B} from (${W}, ${$}) on texture "${X.name}"`}return`Picked color ${H} from (${W}, ${$}) on texture "${X.name}"`}},g),I("copy_brush_tool",{description:"Uses the copy/clone brush to copy texture areas.",annotations:{title:"Copy Brush Tool",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),source:F.object({x:F.number().describe("Source X coordinate to copy from."),y:F.number().describe("Source Y coordinate to copy from.")}),target:F.object({x:F.number().describe("Target X coordinate to paste to."),y:F.number().describe("Target Y coordinate to paste to.")}),brush_size:F.number().min(1).max(100).optional().describe("Copy brush size."),opacity:F.number().min(0).max(255).optional().describe("Copy opacity (0-255)."),mode:F.enum(["copy","sample","pattern"]).optional().default("copy").describe("Copy brush mode.")}),async execute({texture_id:Q,source:W,target:$,brush_size:Y,opacity:J,mode:X}){let H=Q?z0(Q):Texture.getDefault();if(!H)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[H],bitmap:!0}),Y!==void 0)BarItems.slider_brush_size.set(Y);if(J!==void 0)BarItems.slider_brush_opacity.set(J);if(X)BarItems.copy_brush_mode.set(X);return BarItems.copy_brush.select(),Painter.startPaintTool(H,W.x,W.y,{},{ctrlOrCmd:!0}),Painter.startPaintTool(H,$.x,$.y,{}),Painter.stopPaintTool(),Undo.finishEdit("Copy brush"),Canvas.updateAll(),`Copied from (${W.x}, ${W.y}) to (${$.x}, ${$.y}) on texture "${H.name}"`}},g),I("eraser_tool",{description:"Erases parts of textures with customizable settings.",annotations:{title:"Eraser Tool",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),coordinates:F.array(F.object({x:F.number().describe("X coordinate to erase at."),y:F.number().describe("Y coordinate to erase at.")})).describe("Array of coordinates to erase at."),brush_size:F.number().min(1).max(100).optional().describe("Eraser brush size."),opacity:F.number().min(0).max(255).optional().describe("Eraser opacity (0-255)."),softness:F.number().min(0).max(100).optional().describe("Eraser softness percentage."),shape:F.enum(["square","circle"]).optional().describe("Eraser shape."),connect_strokes:F.boolean().optional().default(!0).describe("Whether to connect erase strokes with lines.")}),async execute({texture_id:Q,coordinates:W,brush_size:$,opacity:Y,softness:J,shape:X,connect_strokes:H}){let G=Q?z0(Q):Texture.getDefault();if(!G)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");if(Undo.initEdit({textures:[G],bitmap:!0}),$!==void 0)BarItems.slider_brush_size.set($);if(Y!==void 0)BarItems.slider_brush_opacity.set(Y);if(J!==void 0)BarItems.slider_brush_softness.set(J);if(X!==void 0)BarItems.brush_shape.set(X);BarItems.eraser.select();for(let B=0;B<W.length;B++){let K=W[B];if(B===0||!H)Painter.startPaintTool(G,K.x,K.y,{});else Painter.movePaintTool(G,K.x,K.y,{})}return Painter.stopPaintTool(),Undo.finishEdit("Erase texture"),Canvas.updateAll(),`Erased ${W.length} points on texture "${G.name}"`}},g),I("paint_settings",{description:"Configures paint mode settings and preferences.",annotations:{title:"Paint Settings",destructiveHint:!0},parameters:F.object({mirror_painting:F.object({enabled:F.boolean().describe("Enable mirror painting."),axis:F.array(F.enum(["x","y","z"])).optional().describe("Mirror axes."),texture:F.boolean().optional().describe("Enable texture mirroring."),texture_center:F.object({x:F.number().describe("X coordinate of texture mirror center."),y:F.number().describe("Y coordinate of texture mirror center.")}).optional().describe("Texture mirror center.")}).optional().describe("Mirror painting settings."),lock_alpha:F.boolean().optional().describe("Lock alpha channel while painting."),pixel_perfect:F.boolean().optional().describe("Enable pixel perfect drawing."),paint_side_restrict:F.boolean().optional().describe("Restrict painting to current face side."),color_erase_mode:F.boolean().optional().describe("Enable color erase mode."),brush_opacity_modifier:F.enum(["none","pressure","tilt"]).optional().describe("Brush opacity modifier for stylus."),brush_size_modifier:F.enum(["none","pressure","tilt"]).optional().describe("Brush size modifier for stylus."),paint_with_stylus_only:F.boolean().optional().describe("Only allow painting with stylus input."),pick_color_opacity:F.boolean().optional().describe("Pick opacity when using color picker."),pick_combined_color:F.boolean().optional().describe("Pick combined layer colors.")}),async execute({mirror_painting:Q,lock_alpha:W,pixel_perfect:$,paint_side_restrict:Y,color_erase_mode:J,brush_opacity_modifier:X,brush_size_modifier:H,paint_with_stylus_only:G,pick_color_opacity:B,pick_combined_color:K}){let V=[];if(Q!==void 0){if(BarItems.mirror_painting.set(Q.enabled),Painter.mirror_painting=Q.enabled,V.push(`Mirror painting: ${Q.enabled}`),Q.enabled&&(Q.axis||Q.texture||Q.texture_center)){let L=Painter.mirror_painting_options;if(Q.axis)Q.axis.forEach((U)=>{L[U]=!0});if(Q.texture!==void 0)L.texture=Q.texture;if(Q.texture_center)L.texture_center=[Q.texture_center.x,Q.texture_center.y];V.push("Mirror options updated")}}if(W!==void 0)Painter.lock_alpha=W,V.push(`Lock alpha: ${W}`);if($!==void 0)BarItems.pixel_perfect_drawing.set($),V.push(`Pixel perfect: ${$}`);if(J!==void 0)BarItems.color_erase_mode.set(J),Painter.erase_mode=J,V.push(`Color erase mode: ${J}`);if(Y!==void 0)V.paint_side_restrict.value=Y,V.push(`Paint side restrict: ${Y}`);if(X!==void 0)V.brush_opacity_modifier.value=X,V.push(`Brush opacity modifier: ${X}`);if(H!==void 0)V.brush_size_modifier.value=H,V.push(`Brush size modifier: ${H}`);if(G!==void 0)V.paint_with_stylus_only.value=G,V.push(`Paint with stylus only: ${G}`);if(B!==void 0)V.pick_color_opacity.value=B,V.push(`Pick color opacity: ${B}`);if(K!==void 0)V.pick_combined_color.value=K,V.push(`Pick combined color: ${K}`);return`Updated paint settings: ${V.join(", ")}`}},g),I("paint_with_brush",{description:"Paints on textures using the brush tool with customizable settings.",annotations:{title:"Paint with Brush",destructiveHint:!0},parameters:F.object({texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),coordinates:F.array(F.object({x:F.number().describe("X coordinate on texture."),y:F.number().describe("Y coordinate on texture.")})).describe("Array of coordinates to paint at."),brush_settings:F.object({size:F.number().min(1).max(100).optional().describe("Brush size."),opacity:F.number().min(0).max(255).optional().describe("Brush opacity (0-255)."),softness:F.number().min(0).max(100).optional().describe("Brush softness percentage."),shape:F.enum(["square","circle"]).optional().describe("Brush shape."),color:F.string().optional().describe("Brush color as hex string."),blend_mode:F.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]).optional().describe("Brush blend mode.")}).optional().describe("Brush settings to apply."),connect_strokes:F.boolean().optional().default(!0).describe("Whether to connect paint strokes with lines.")}),async execute({texture_id:Q,coordinates:W,brush_settings:$,connect_strokes:Y}){let J=Q?z0(Q):Texture.getDefault();if(!J)throw Error(Q?`Texture with ID "${Q}" not found.`:"No texture available.");Undo.initEdit({textures:[J],selected_texture:!0,bitmap:!0});let X=$?.color??"#000000",H=parseInt(X.slice(1,3),16),G=parseInt(X.slice(3,5),16),B=parseInt(X.slice(5,7),16),K=$?.opacity??255,V=$?.size??1,L=$?.softness??0,U=$?.shape??"square";return BarItems.slider_brush_size.value=V,BarItems.slider_brush_opacity.value=K,BarItems.slider_brush_softness.value=L,BarItems.brush_shape.value=U,ColorPanel.set(X),J.edit((q)=>{let A=q.getContext("2d");for(let D of W)if(U==="circle")Painter.editCircle(A,D.x,D.y,V,L,()=>({r:H,g:G,b:B,a:K}));else Painter.editSquare(A,D.x,D.y,V,L,()=>({r:H,g:G,b:B,a:K}))},{edit_name:"Paint with brush"}),Undo.finishEdit("Paint with brush"),Canvas.updateAll(),`Painted ${W.length} points on texture "${J.name}"`}},g),I("create_brush_preset",{description:"Creates a custom brush preset with specified settings.",annotations:{title:"Create Brush Preset",destructiveHint:!0},parameters:F.object({name:F.string().describe("Name of the brush preset."),size:F.number().min(1).max(100).optional().describe("Brush size."),opacity:F.number().min(0).max(255).optional().describe("Brush opacity (0-255)."),softness:F.number().min(0).max(100).optional().describe("Brush softness percentage."),shape:F.enum(["square","circle"]).optional().describe("Brush shape."),color:F.string().optional().describe("Brush color as hex string."),blend_mode:F.enum(["default","set_opacity","color","behind","multiply","add","screen","overlay","difference"]).optional().describe("Brush blend mode."),pixel_perfect:F.boolean().optional().describe("Enable pixel perfect drawing.")}),async execute({name:Q,size:W,opacity:$,softness:Y,shape:J,color:X,blend_mode:H,pixel_perfect:G}){let B={name:Q,size:W||null,opacity:$||null,softness:Y||null,shape:J||"square",color:X||null,blend_mode:H||"default",pixel_perfect:G||!1};return StateMemory.brush_presets.push(B),StateMemory.save("brush_presets"),`Created brush preset "${Q}" with settings: ${JSON.stringify(B)}`}},g),I("load_brush_preset",{description:"Loads and applies a brush preset by name.",annotations:{title:"Load Brush Preset",destructiveHint:!0},parameters:F.object({preset_name:F.string().describe("Name of the brush preset to load.")}),async execute({preset_name:Q}){let W=StateMemory.brush_presets.find(($)=>$.name===Q);if(!W)throw Error(`Brush preset "${Q}" not found.`);return Painter.loadBrushPreset(W),`Loaded brush preset "${Q}"`}},g),I("texture_selection",{description:"Creates, modifies, or manipulates texture selections for painting.",annotations:{title:"Texture Selection",destructiveHint:!0},parameters:F.object({action:F.enum(["select_rectangle","select_ellipse","select_all","clear_selection","invert_selection","expand_selection","contract_selection","feather_selection"]).describe("Selection action to perform."),texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),coordinates:F.object({x1:F.number().describe("Start X coordinate."),y1:F.number().describe("Start Y coordinate."),x2:F.number().describe("End X coordinate."),y2:F.number().describe("End Y coordinate.")}).optional().describe("Selection area coordinates."),radius:F.number().optional().describe("Radius for expand/contract/feather operations."),mode:F.enum(["create","add","subtract","intersect"]).optional().default("create").describe("Selection mode.")}),async execute({action:Q,texture_id:W,coordinates:$,radius:Y,mode:J}){let X=W?z0(W):Texture.getDefault();if(!X)throw Error(W?`Texture with ID "${W}" not found.`:"No texture available.");Undo.initEdit({textures:[X],bitmap:!0});let H=X.selection;switch(Q){case"select_rectangle":if(!$)throw Error("Coordinates required for rectangle selection.");H.clear(),H.start_x=$.x1,H.start_y=$.y1,H.end_x=$.x2,H.end_y=$.y2,H.is_custom=!1;break;case"select_ellipse":if(!$)throw Error("Coordinates required for ellipse selection.");H.clear(),H.is_custom=!0;let G=($.x1+$.x2)/2,B=($.y1+$.y2)/2,K=Math.abs($.x2-$.x1)/2,V=Math.abs($.y2-$.y1)/2;for(let L=Math.floor(G-K);L<=Math.ceil(G+K);L++)for(let U=Math.floor(B-V);U<=Math.ceil(B+V);U++){let q=(L-G)/K,A=(U-B)/V;if(q*q+A*A<=1)H.set(L,U,!0)}break;case"select_all":H.selectAll();break;case"clear_selection":H.clear();break;case"invert_selection":H.invert();break;case"expand_selection":if(Y===void 0)throw Error("Radius required for expand selection.");H.expand(Y);break;case"contract_selection":if(Y===void 0)throw Error("Radius required for contract selection.");H.contract(Y);break;case"feather_selection":if(Y===void 0)throw Error("Radius required for feather selection.");H.feather(Y);break}return UVEditor.vue.updateTexture(),Undo.finishEdit("Texture selection"),`Applied ${Q} to texture "${X.name}"`}},g),I("texture_layer_management",{description:"Creates, manages, and manipulates texture layers.",annotations:{title:"Texture Layer Management",destructiveHint:!0},parameters:F.object({action:F.enum(["create_layer","delete_layer","duplicate_layer","merge_down","set_opacity","set_blend_mode","move_layer","rename_layer","flatten_layers"]).describe("Layer management action."),texture_id:F.string().optional().describe("Texture ID or name. If not provided, uses selected texture."),layer_name:F.string().optional().describe("Name of the layer."),opacity:F.number().min(0).max(100).optional().describe("Layer opacity percentage."),blend_mode:F.enum(["normal","multiply","screen","overlay","soft_light","hard_light","color_dodge","color_burn","darken","lighten","difference","exclusion"]).optional().describe("Layer blend mode."),target_index:F.number().optional().describe("Target position for moving layers.")}),async execute({action:Q,texture_id:W,layer_name:$,opacity:Y,blend_mode:J,target_index:X}){let H=W?z0(W):Texture.selected;if(!H)throw Error(W?`Texture with ID "${W}" not found.`:"No texture selected.");Undo.initEdit({textures:[H],layers:H.layers,bitmap:!0});let G="";switch(Q){case"create_layer":if(!H.layers_enabled)H.activateLayers(!0);let B=new TextureLayer({name:$||`Layer ${H.layers.length+1}`},H);B.setSize(H.width,H.height),B.addForEditing(),G=`Created layer "${B.name}"`;break;case"delete_layer":if(!TextureLayer.selected)throw Error("No layer selected.");let K=TextureLayer.selected;K.remove(),G=`Deleted layer "${K.name}"`;break;case"duplicate_layer":if(!TextureLayer.selected)throw Error("No layer selected.");let V=TextureLayer.selected,L=V.duplicate();L.name=`${V.name} copy`,G=`Duplicated layer "${L.name}"`;break;case"merge_down":if(!TextureLayer.selected)throw Error("No layer selected.");TextureLayer.selected.mergeDown(!0),G="Merged layer down";break;case"set_opacity":if(!TextureLayer.selected)throw Error("No layer selected.");if(Y===void 0)throw Error("Opacity value required.");TextureLayer.selected.opacity=Y/100,H.updateChangesAfterEdit(),G=`Set layer opacity to ${Y}%`;break;case"set_blend_mode":if(!TextureLayer.selected)throw Error("No layer selected.");if(!J)throw Error("Blend mode required.");TextureLayer.selected.blend_mode=J,H.updateChangesAfterEdit(),G=`Set layer blend mode to ${J}`;break;case"move_layer":if(!TextureLayer.selected)throw Error("No layer selected.");if(X===void 0)throw Error("Target index required.");let U=TextureLayer.selected;H.layers.remove(U),H.layers.splice(X,0,U),G=`Moved layer to position ${X}`;break;case"rename_layer":if(!TextureLayer.selected)throw Error("No layer selected.");if(!$)throw Error("New layer name required.");let q=TextureLayer.selected.name;TextureLayer.selected.name=$,G=`Renamed layer from "${q}" to "${$}"`;break;case"flatten_layers":if(!H.layers_enabled)throw Error("Texture has no layers to flatten.");H.flattenLayers(),G="Flattened all layers";break}return H.updateChangesAfterEdit(),Undo.finishEdit(`Layer management: ${Q}`),updateInterfacePanels(),G}},g)}function lB(){I("create_project",{description:"Creates a new project with the given name and project type.",annotations:{title:"Create Project",destructiveHint:!0,openWorldHint:!0},parameters:F.object({name:F.string(),format:F.enum(Object.keys(Formats)).default("bedrock_block")}),async execute({name:Q,format:W}){if(!newProject(Formats[W]))throw Error("Failed to create project.");return Project.name=Q,`Created project with name "${Q}" (UUID: ${Project?.uuid}) and format "${W}".`}},K0)}function mB(){I("create_texture",{description:"Creates a new texture with the given name and size.",annotations:{title:"Create Texture",destructiveHint:!0,openWorldHint:!0},parameters:F.object({name:F.string(),width:F.number().min(16).max(4096).default(16),height:F.number().min(16).max(4096).default(16),data:F.string().optional().describe("Path to the image file or data URL."),group:F.string().optional(),fill_color:F.union([F.array(F.number().min(0).max(255)).length(4).describe("RGBA color array [R, G, B, A]"),F.string().regex(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{8})$/,"HEX color string (e.g. #RRGGBB or #RRGGBBAA)"),F.string().regex(/^[a-z]{3,20}$/,"Color name (e.g. 'red', 'blue', 'green')")]).optional().describe("RGBA color to fill the texture, as tuple or HEX string."),layer_name:F.string().optional().describe("Name of the texture layer. Required if fill_color is set."),pbr_channel:F.enum(["color","normal","height","mer"]).optional().describe("PBR channel to use for the texture. Color, normal, height, or Metalness/Emissive/Roughness (MER) map."),render_mode:F.enum(["default","emissive","additive","layered"]).optional().default("default").describe("Render mode for the texture. Default, emissive, additive, or layered."),render_sides:F.enum(["auto","front","double"]).optional().default("auto").describe("Render sides for the texture. Auto, front, or double.")}).refine((Q)=>!(Q.data&&Q.fill_color),{message:"The 'data' and 'fill_color' properties cannot both be defined.",path:["data","fill_color"]}).refine((Q)=>!(Q.fill_color&&!Q.layer_name),{message:"The 'layer_name' property is required when 'fill_color' is set.",path:["layer_name","fill_color"]}).refine(({pbr_channel:Q,group:W})=>Q&&W||!Q,{message:"The 'group' property is required when 'pbr_channel' is set.",path:["group","pbr_channel"]}),async execute({name:Q,width:W,height:$,data:Y,pbr_channel:J,fill_color:X,group:H,layer_name:G}){Undo.initEdit({textures:[],collections:[]});let B=new Texture({name:Q,width:W,height:$,group:H,pbr_channel:J,internal:!0});if(Y){if(Y.startsWith("data:image/"))B.source=Y,B.width=W,B.height=$;else B=B.fromFile({name:Y.split(/[\/\\]/).pop()||Y,path:Y.replace(/^file:\/\//,"")});B.load(),B.fillParticle(),B.layers_enabled=!1}else{let{ctx:K}=B.getActiveCanvas();if(X){let V=Array.isArray(X)?tinycolor({r:Number(X[0]),g:Number(X[1]),b:Number(X[2]),a:Number(X[3]??255)}):tinycolor(X);K.fillStyle=V.toRgbString().toLowerCase(),K.fillRect(0,0,B.width,B.height)}else K.clearRect(0,0,B.width,B.height);B.updateSource(K.canvas.toDataURL("image/png",1)),B.updateLayerChanges(!0)}return B.add(),Undo.finishEdit("Agent created texture"),Canvas.updateAll(),S4({url:B.getDataURL()})}},g),I("apply_texture",{description:"Applies the given texture to the element with the specified ID.",annotations:{title:"Apply Texture",destructiveHint:!0},parameters:F.object({id:F.string().describe("ID or name of the element to apply the texture to."),texture:F.string().describe("ID or name of the texture to apply."),applyTo:F.enum(["all","blank","none"]).describe("Apply texture to element or group.").optional().default("blank")}),async execute({applyTo:Q,id:W,texture:$}){let Y=I4(W),J=$?h0($):Texture.getDefault();if(!J)throw Error("No default texture available. Use the create_texture tool to create one first.");return Undo.initEdit({elements:[],outliner:!0,collections:[]}),J.select(),Texture.selected?.apply(Q==="none"?!1:Q==="all"?!0:"blank"),J.updateChangesAfterEdit(),Undo.finishEdit("Agent applied texture"),Canvas.updateAll(),`Applied texture ${J.name} to element with ID ${W}`}},K0),I("add_texture_group",{description:"Adds a new texture group with the given name.",annotations:{title:"Add Texture Group",destructiveHint:!0},parameters:F.object({name:F.string(),textures:F.array(F.string()).optional().describe("Array of texture IDs or names to add to the group."),is_material:F.boolean().optional().default(!0).describe("Whether the texture group is a PBR material or not.")}),async execute({name:Q,textures:W,is_material:$}){Undo.initEdit({elements:[],outliner:!0,collections:[],textures:[]});let Y=new TextureGroup({name:Q,is_material:$}).add();if(W){let J=W.map((X)=>z0(X)).filter(Boolean);if(J.length===0)throw Error(`No textures found for "${W}".`);J.forEach((X)=>{X?.extend({group:Y.uuid})})}return Undo.finishEdit("Agent added texture group"),Canvas.updateAll(),`Added texture group ${Y.name} with ID ${Y.uuid}`}},g),I("list_textures",{description:"Returns a list of all textures in the Blockbench editor.",annotations:{title:"List Textures",readOnlyHint:!0},parameters:F.object({}),async execute(){let Q=Project?.textures??Texture.all;return JSON.stringify(Q.map((W)=>({name:W.name,uuid:W.uuid,id:W.id,group:W.group})))}},K0),I("get_texture",{description:"Returns the image data of the given texture or default texture.",annotations:{title:"Get Texture",readOnlyHint:!0},parameters:F.object({texture:F.string().optional().describe("Texture ID or name.")}),async execute({texture:Q}){if(!Q){let $=Texture.getDefault();if(!$)throw Error("No default texture available. Use the create_texture tool to create one first, or specify a texture ID.");return S4({url:$.getDataURL()})}let W=h0(Q);return S4({url:W.getDataURL()})}},K0),I("create_pbr_material",{description:"Creates a new PBR material (texture group with is_material=true) and optionally assigns textures to PBR channels. Use this for Minecraft Bedrock resource packs or any format supporting PBR.",annotations:{title:"Create PBR Material",destructiveHint:!0},parameters:F.object({name:F.string().describe("Name of the material."),color_texture:F.string().optional().describe("Texture ID/name for the color (albedo) channel."),normal_texture:F.string().optional().describe("Texture ID/name for the normal map channel."),height_texture:F.string().optional().describe("Texture ID/name for the height/displacement map channel."),mer_texture:F.string().optional().describe("Texture ID/name for the MER (Metalness/Emissive/Roughness) channel."),color_value:F.array(F.number().min(0).max(255)).length(4).optional().describe("Uniform RGBA color [R,G,B,A] when no color texture is provided."),mer_value:F.array(F.number().min(0).max(255)).length(3).optional().describe("Uniform MER values [Metalness, Emissive, Roughness] (0-255) when no MER texture is provided."),subsurface_value:F.number().min(0).max(255).optional().describe("Subsurface scattering value (0-255) for Bedrock 1.21.30+ materials.")}),async execute({name:Q,color_texture:W,normal_texture:$,height_texture:Y,mer_texture:J,color_value:X,mer_value:H,subsurface_value:G}){let B=[];if(W){let V=h0(W);B.push(V)}if($){let V=h0($);B.push(V)}if(Y){let V=h0(Y);B.push(V)}if(J){let V=h0(J);B.push(V)}Undo.initEdit({texture_groups:[],textures:B});let K=new TextureGroup({name:Q,is_material:!0});if(X)K.material_config.color_value=X;if(H)K.material_config.mer_value=H;if(G!==void 0)K.material_config.subsurface_value=G;if(K.material_config.saved=!1,K.add(),W)h0(W).extend({group:K.uuid,pbr_channel:"color"});if($)h0($).extend({group:K.uuid,pbr_channel:"normal"});if(Y)h0(Y).extend({group:K.uuid,pbr_channel:"height"});if(J)h0(J).extend({group:K.uuid,pbr_channel:"mer"});return K.updateMaterial(),Undo.finishEdit("Agent created PBR material"),Canvas.updateAll(),JSON.stringify({success:!0,material:{name:K.name,uuid:K.uuid,is_material:!0,channels:{color:W?!0:!!X,normal:!!$,height:!!Y,mer:J?!0:!!H}}})}},g),I("configure_material",{description:"Configures an existing PBR material's properties including channel assignments, uniform values, and subsurface scattering.",annotations:{title:"Configure Material",destructiveHint:!0},parameters:F.object({material:F.string().describe("Material name or UUID to configure."),color_texture:F.string().optional().describe("Texture ID/name for the color channel, or 'none' to use uniform color."),normal_texture:F.string().optional().describe("Texture ID/name for the normal map, or 'none' to remove."),height_texture:F.string().optional().describe("Texture ID/name for the height map, or 'none' to remove."),mer_texture:F.string().optional().describe("Texture ID/name for MER channel, or 'none' to use uniform values."),color_value:F.array(F.number().min(0).max(255)).length(4).optional().describe("Uniform RGBA color [R,G,B,A] when no color texture."),mer_value:F.array(F.number().min(0).max(255)).length(3).optional().describe("Uniform MER values [Metalness, Emissive, Roughness] (0-255)."),subsurface_value:F.number().min(0).max(255).optional().describe("Subsurface scattering value (0-255).")}),async execute({material:Q,color_texture:W,normal_texture:$,height_texture:Y,mer_texture:J,color_value:X,mer_value:H,subsurface_value:G}){let B=_9(Q),K=B.getTextures();if(Undo.initEdit({texture_groups:[B],textures:K}),W==="none")K.filter((V)=>V.pbr_channel==="color").forEach((V)=>V.group="");else if(W)K.filter((L)=>L.pbr_channel==="color").forEach((L)=>L.pbr_channel="color"),h0(W).extend({group:B.uuid,pbr_channel:"color"});if($==="none")K.filter((V)=>V.pbr_channel==="normal").forEach((V)=>V.group="");else if($)h0($).extend({group:B.uuid,pbr_channel:"normal"});if(Y==="none")K.filter((V)=>V.pbr_channel==="height").forEach((V)=>V.group="");else if(Y)h0(Y).extend({group:B.uuid,pbr_channel:"height"});if(J==="none")K.filter((V)=>V.pbr_channel==="mer").forEach((V)=>V.group="");else if(J)h0(J).extend({group:B.uuid,pbr_channel:"mer"});if(X)B.material_config.color_value=X;if(H)B.material_config.mer_value=H;if(G!==void 0)B.material_config.subsurface_value=G;return B.material_config.saved=!1,B.updateMaterial(),Undo.finishEdit("Agent configured material"),Canvas.updateAll(),`Configured material "${B.name}"`}},g),I("list_materials",{description:"Lists all PBR materials (texture groups with is_material=true) and their assigned textures per channel.",annotations:{title:"List Materials",readOnlyHint:!0},parameters:F.object({}),async execute(){let W=TextureGroup.all.filter(($)=>$.is_material).map(($)=>{let Y=$.getTextures();return{name:$.name,uuid:$.uuid,channels:{color:x9(Y,"color"),normal:x9(Y,"normal"),height:x9(Y,"height"),mer:x9(Y,"mer")},config:{color_value:$.material_config.color_value,mer_value:$.material_config.mer_value,subsurface_value:$.material_config.subsurface_value,saved:$.material_config.saved}}});return JSON.stringify(W,null,2)}},K0),I("get_material_info",{description:"Gets detailed information about a PBR material including the compiled texture_set.json preview for Bedrock export.",annotations:{title:"Get Material Info",readOnlyHint:!0},parameters:F.object({material:F.string().describe("Material name or UUID.")}),async execute({material:Q}){let W=_9(Q),$=W.getTextures(),Y=null;try{Y=W.material_config.compileForBedrock()}catch{}let J={name:W.name,uuid:W.uuid,is_material:W.is_material,textures:$.map((X)=>({name:X.name,uuid:X.uuid,pbr_channel:X.pbr_channel,width:X.width,height:X.height,render_mode:X.render_mode,render_sides:X.render_sides})),config:{color_value:W.material_config.color_value,mer_value:W.material_config.mer_value,subsurface_value:W.material_config.subsurface_value,saved:W.material_config.saved,file_path:W.material_config.getFilePath()},texture_set_json:Y};return JSON.stringify(J,null,2)}},K0),I("import_texture_set",{description:"Imports a Minecraft Bedrock texture_set.json file and creates a PBR material with the associated textures.",annotations:{title:"Import Texture Set",destructiveHint:!0,openWorldHint:!0},parameters:F.object({path:F.string().describe("Path to the .texture_set.json file to import.")}),async execute({path:Q}){if(!Q.endsWith(".texture_set.json"))throw Error("Path must end with '.texture_set.json'. Example: 'path/to/mytexture.texture_set.json'");if(!requireNativeModule("fs").existsSync(Q))throw Error(`File not found: ${Q}`);return importTextureSet({path:Q,name:Q.split(/[\/\\]/).pop()}),`Imported texture set from "${Q}". Check the textures panel for the new material.`}},g),I("assign_texture_channel",{description:"Assigns a texture to a specific PBR channel within a material.",annotations:{title:"Assign Texture Channel",destructiveHint:!0},parameters:F.object({material:F.string().describe("Material name or UUID."),texture:F.string().describe("Texture name or UUID to assign."),channel:F.enum(["color","normal","height","mer"]).describe("PBR channel to assign the texture to.")}),async execute({material:Q,texture:W,channel:$}){let Y=_9(Q),J=h0(W);return Undo.initEdit({texture_groups:[Y],textures:[J]}),Y.getTextures().filter((H)=>H.pbr_channel===$&&H.uuid!==J.uuid).forEach((H)=>{H.pbr_channel="color"}),J.extend({group:Y.uuid,pbr_channel:$}),Y.material_config.saved=!1,Y.updateMaterial(),Undo.finishEdit("Agent assigned texture channel"),Canvas.updateAll(),`Assigned texture "${J.name}" to ${$} channel of material "${Y.name}"`}},g),I("save_material_config",{description:"Saves the material's texture_set.json file to disk (Bedrock format). Requires the color texture to have a valid file path.",annotations:{title:"Save Material Config",destructiveHint:!0,openWorldHint:!0},parameters:F.object({material:F.string().describe("Material name or UUID to save.")}),async execute({material:Q}){let W=_9(Q),$=W.material_config.getFilePath();if(!$)throw Error("Cannot save: Material needs a color texture with a valid file path. Save the color texture first, then try again.");return W.material_config.save(),`Saved material config to "${$}"`}},g)}function cB(){I("trigger_action",{description:"Triggers an action in the Blockbench editor.",annotations:{title:"Trigger Action",destructiveHint:!0,openWorldHint:!0},parameters:F.object({action:F.enum(Object.keys(BarItems)).describe("Action to trigger."),confirmDialog:F.boolean().optional().default(!0).describe("Whether or not to automatically confirm any dialogs that appear as a result of the action."),confirmEvent:F.string().optional().describe("Stringified form of event arguments.")}),async execute({action:Q,confirmEvent:W,confirmDialog:$}){Undo.initEdit({elements:[],outliner:!0,collections:[]});let Y=W?JSON.parse(W):{};if(!(Q in BarItems))throw Error(`Action "${Q}" not found.`);let J=BarItems[Q];if(J&&J instanceof Action){let{event:H,...G}=Y;J.trigger(new Event(H||"click",{...G}))}if($)Dialog.open?.confirm();Undo.finishEdit("Agent triggered action");let X;try{X=await g6()}catch(H){X=`Action "${Q}" executed, but failed to capture app screenshot: ${H}`}return X}},g),I("risky_eval",{description:"Evaluates the given expression and logs it to the console. Do not pass `console` commands as they will not work.",annotations:{title:"Eval",destructiveHint:!0,openWorldHint:!0},parameters:F.object({code:F.string().refine((Q)=>!/console\.|\/\/|\/\*/.test(Q),{message:"Code must not include 'console.', '//' or '/* */' comments."}).describe("JavaScript code to evaluate. Do not pass `console` commands or comments.")}),async execute({code}){try{Undo.initEdit({elements:[],outliner:!0,collections:[]});let result=await eval(code.trim());if(result!==void 0)return JSON.stringify(result);return"(Code executed successfully, but no result was returned.)"}catch(Q){return`Error executing code: ${Q}`}finally{Undo.finishEdit("Agent executed code")}}},K0),I("emulate_clicks",{description:"Emulates clicks on the given interface elements.",annotations:{title:"Emulate Clicks",destructiveHint:!0,openWorldHint:!0},parameters:F.object({position:F.object({x:F.number(),y:F.number(),button:F.enum(["left","right"]).optional().default("left").describe("Mouse button to use.")}),drag:F.object({to:F.object({x:F.number(),y:F.number()}),duration:F.number().optional().default(100).describe("Duration of the drag in milliseconds.")}).optional().describe("Drag options. If set, will perform a drag from position to 'to'.")}),async execute({position:Q,drag:W}){let{x:$,y:Y,button:J}=Q,X=new MouseEvent("click",{clientX:$,clientY:Y,button:J==="left"?0:2});if(document.dispatchEvent(X),W){let{to:H,duration:G}=W,B=new MouseEvent("mousedown",{clientX:$,clientY:Y,button:J==="left"?0:2}),K=new MouseEvent("mouseup",{clientX:H.x,clientY:H.y,button:J==="left"?0:2});document.dispatchEvent(B),await new Promise((V)=>setTimeout(V,G)),document.dispatchEvent(K)}return await g6()}},g),I("fill_dialog",{description:"Fills the dialog with the given values.",annotations:{title:"Fill Dialog",destructiveHint:!0,openWorldHint:!0},parameters:F.object({values:F.string().describe("Stringified form of values to fill the dialog with."),confirm:F.boolean().optional().default(!0).describe("Whether to confirm or cancel the dialog after filling it. True to confirm, false to cancel.")}),async execute({values:Q,confirm:W}){if(!Dialog.stack.length)throw Error("No dialogs found in the Blockbench editor.");if(!Dialog.open)Dialog.stack[Dialog.stack.length-1]?.focus();let $=JSON.parse(Q),Y=Object.keys(Dialog.open?.getFormResult()??{}),J=Object.entries($).reduce((X,[H,G])=>{if(Y.includes(H))X[H]=G;return X});if(Dialog.open?.setFormValues(J,!0),W)Dialog.open?.confirm();else Dialog.open?.cancel();return JSON.stringify({result:`Current dialog stack is now ${Dialog.stack.length} deep.`,dialogs:Dialog.stack.map((X)=>({id:X.id,values:X.getFormResult()}))})}},g)}function pB(){I("set_mesh_uv",{description:"Sets UV coordinates for mesh faces or vertices.",annotations:{title:"Set Mesh UV",destructiveHint:!0},parameters:F.object({mesh_id:F.string().describe("ID or name of the mesh."),face_key:F.string().describe("Face key to set UV for."),uv_mapping:F.record(F.string(),F.array(F.number()).length(2)).describe("UV coordinates for each vertex of the face.")}),async execute({mesh_id:Q,face_key:W,uv_mapping:$}){let Y=y6(Q);Undo.initEdit({elements:[Y],uv_only:!0});let J=Y.faces[W];if(!J)throw Error(`Face with key "${W}" not found in mesh.`);return Object.entries($).forEach(([X,H])=>{if(J.vertices.includes(X))J.uv[X]=H}),Y.preview_controller.updateUV(Y),UVEditor.loadData(),Undo.finishEdit("Set mesh UV"),`Set UV mapping for face "${W}" of mesh "${Y.name}"`}},g),I("auto_uv_mesh",{description:"Automatically generates UV mapping for selected mesh faces.",annotations:{title:"Auto UV Mesh",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),mode:F.enum(["project","unwrap","cylinder","sphere"]).default("project").describe("UV mapping mode: project from view, unwrap, cylinder, or sphere mapping."),faces:F.array(F.string()).optional().describe("Specific face keys to UV map. If not provided, maps all selected faces.")}),async execute({mesh_id:Q,mode:W,faces:$}){let Y=c1(Q);Undo.initEdit({elements:[Y],uv_only:!0});let J=$||UVEditor.getSelectedFaces(Y);if(W==="project")BarItems.uv_project_from_view.click();else J.forEach((X)=>{let H=Y.faces[X];if(!H)return;if(W==="unwrap")UVEditor.setAutoSize(null,!0,[X]);else if(W==="cylinder")H.getSortedVertices().forEach((B,K)=>{let V=Y.vertices[B],U=(Math.atan2(V[0],V[2])+Math.PI)/(2*Math.PI)*Project.texture_width,q=(V[1]+8)/16*Project.texture_height;H.uv[B]=[U,q]});else if(W==="sphere")H.getSortedVertices().forEach((B)=>{let K=Y.vertices[B],V=Math.sqrt(K[0]**2+K[1]**2+K[2]**2),L=Math.acos(K[1]/V),q=(Math.atan2(K[0],K[2])+Math.PI)/(2*Math.PI)*Project.texture_width,A=L/Math.PI*Project.texture_height;H.uv[B]=[q,A]})});return Y.preview_controller.updateUV(Y),UVEditor.loadData(),Undo.finishEdit("Auto UV mesh"),`Applied ${W} UV mapping to ${J.length} faces of mesh "${Y.name}"`}},g),I("rotate_mesh_uv",{description:"Rotates UV coordinates of selected mesh faces.",annotations:{title:"Rotate Mesh UV",destructiveHint:!0},parameters:F.object({mesh_id:F.string().optional().describe("ID or name of the mesh. If not provided, uses selected mesh."),angle:F.enum(["-90","90","180"]).default("90").describe("Rotation angle in degrees."),faces:F.array(F.string()).optional().describe("Specific face keys to rotate UV for. If not provided, rotates all selected faces.")}),async execute({mesh_id:Q,angle:W,faces:$}){let Y=c1(Q);Undo.initEdit({elements:[Y],uv_only:!0});let J=parseInt(W);return UVEditor.rotate(J),Undo.finishEdit("Rotate mesh UV"),`Rotated UV by ${W} degrees for mesh "${Y.name}"`}},g)}var JM=[_B,kB,yB,gB,hB,fB,uB,lB,mB,cB,pB];for(let Q of JM)Q();jQ("projects",{uriTemplate:"projects://{id}",title:"Blockbench Projects",description:"Returns information about available projects in Blockbench. Use without an ID to list all projects, or provide a project UUID/name to get details about a specific project.",async listCallback(){let Q=ModelProject.all;if(!Q||Q.length===0)return{resources:[]};return{resources:Q.map((W)=>({uri:`projects://${W.uuid}`,name:W.name||W.uuid,description:`${W.format?.name??"Unknown format"} project${W.saved?"":" (unsaved)"}`,mimeType:"application/json"}))}},async readCallback(Q,{id:W}){let $=ModelProject.all;if(!$||$.length===0)return{contents:[{uri:Q.href,text:JSON.stringify({projects:[],count:0}),mimeType:"application/json"}]};let Y=(J)=>({uuid:J.uuid,name:J.name,selected:J.selected,saved:J.saved,format:J.format?.id??null,formatName:J.format?.name??null,boxUv:J.box_uv,textureWidth:J.texture_width,textureHeight:J.texture_height,savePath:J.save_path||null,exportPath:J.export_path||null,elementCount:J.elements?.length??0,groupCount:J.groups?.length??0,textureCount:J.textures?.length??0,animationCount:J.animations?.length??0,modelIdentifier:J.model_identifier||null,geometryName:J.geometry_name||null});if(W){let J=$.find((X)=>X.uuid===W||X.name===W);if(!J)throw Error(`Project with ID "${W}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify(Y(J)),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({projects:$.map(Y),count:$.length,activeProject:Project?Project.uuid:null}),mimeType:"application/json"}]}}});jQ("nodes",{uriTemplate:"nodes://{id}",title:"Blockbench Nodes",description:"Returns the current nodes in the Blockbench editor.",async listCallback(){if(!Project?.nodes_3d)return{resources:[]};return{resources:Object.values(Project.nodes_3d).map((W)=>({uri:`nodes://${W.uuid}`,name:W.name||W.uuid,description:"3D node in current project",mimeType:"application/json"}))}},async readCallback(Q,{id:W}){if(!Project?.nodes_3d)throw Error("No nodes found in the Blockbench editor.");let $=Project.nodes_3d[W]??Object.values(Project.nodes_3d).find((G)=>G.name===W||G.uuid===W);if(!$)throw Error(`Node with ID "${W}" not found.`);let{position:Y,rotation:J,scale:X,...H}=$;return{contents:[{uri:Q.href,text:JSON.stringify({...H,position:Y.toArray(),rotation:J.toArray(),scale:X.toArray()}),mimeType:"application/json"}]}}});jQ("textures",{uriTemplate:"textures://{id}",title:"Blockbench Textures",description:"Returns information about textures in the current Blockbench project. Use without an ID to list all textures, or provide a texture UUID/name to get details about a specific texture.",async listCallback(){let Q=Project?.textures??[];if(Q.length===0)return{resources:[]};return{resources:Q.map((W)=>({uri:`textures://${W.uuid}`,name:W.name||W.uuid,mimeType:"application/json",description:W.path?`Texture from ${W.path}`:"Embedded texture"}))}},async readCallback(Q,{id:W}){let $=Project?.textures??[];if($.length===0)return{contents:[{uri:Q.href,text:JSON.stringify({textures:[],count:0}),mimeType:"application/json"}]};let Y=(J)=>({uuid:J.uuid,name:J.name,id:J.id,width:J.width,height:J.height,frameCount:J.frameCount,ratio:J.ratio,path:J.path||null,folder:J.folder||null,namespace:J.namespace||null,particle:J.particle??!1,render_mode:J.render_mode||"default",render_sides:J.render_sides||"auto",visible:J.visible??!0,saved:J.saved??!1,selected:J.selected??!1,source:J.source||null});if(W){let J=$.find((X)=>X.uuid===W||X.name===W||X.id===W);if(!J)throw Error(`Texture with ID "${W}" not found.`);return{contents:[{uri:Q.href,text:JSON.stringify(Y(J)),mimeType:"application/json"}]}}return{contents:[{uri:Q.href,text:JSON.stringify({textures:$.map(Y),count:$.length}),mimeType:"application/json"}]}}});zQ("blockbench_native_apis",{description:"Essential information about Blockbench v5.0 native API security model and requireNativeModule() usage. Use this when working with Node.js modules, file system access, or native APIs in Blockbench plugins.",argsSchema:F.object({}),async generate(){return{messages:[{role:"user",content:{type:"text",text:await`# Blockbench v5.0 Native API Security Model

**CRITICAL: Read this carefully before using any Node.js APIs or native modules in Blockbench plugins.**

## Overview

Blockbench v5.0 introduces a new security model that significantly changes how plugins access native Node.js APIs. These changes give users more control and trust over plugin capabilities.

## Key Changes from Previous Versions

### 1. Global Module Variables Removed

- **OLD (pre-v5.0)**: All Node.js APIs were globally available (e.g., \`fs\`, \`os\`, \`child_process\`)
- **NEW (v5.0+)**: Most global variables have been removed
- **EXCEPTION**: \`PathModule\` is still globally available for Node's \`path\` module

### 2. Module Access via \`requireNativeModule()\`

Use the new \`requireNativeModule()\` function instead of \`require()\` for better TypeScript support:

\`\`\`javascript
// TypeScript-friendly with proper type support
const os = requireNativeModule('os');

// Add custom permission message
const child_process = requireNativeModule('child_process', {
    message: 'This permission is required to open ffmpeg and encode the video.'
});
\`\`\`

**IMPORTANT**: \`requireNativeModule()\` will:
- Open a user permission prompt for restricted modules
- Return the module **synchronously** if the user accepts
- Return \`undefined\` if the user denies
- Always check if the module is defined before use!

### 3. Module Categories

#### Safe Modules (No Permission Required)
These can be required without user confirmation:
- \`path\`
- \`crypto\`
- \`events\`
- \`zlib\`
- \`timers\`
- \`url\`
- \`string_decoder\`
- \`querystring\`

#### Restricted Modules (Require User Permission)
These prompt the user for permission:
- \`fs\` (File System - see scoped access below)
- \`child_process\`
- \`electron\`
- \`https\`
- \`net\`
- \`tls\`
- \`util\`
- \`os\`
- \`v8\`

### 4. Scoped File System Access

The \`fs\` module is now limited. For even more restrictive access, use **scoped file systems**:

\`\`\`javascript
// Request scoped fs access to specific directory
const scoped_fs = requireNativeModule('fs', {
    scope: 'C:/path/to/directory'
});

if (scoped_fs) {
    //  Will succeed - inside scope
    scoped_fs.writeFileSync('C:/path/to/directory/file.json', 'hello world');
    
    //  Will throw error - outside scope
    scoped_fs.writeFileSync('C:/foo/bar.json', 'hello world');
}
\`\`\`

**Benefits**:
- Gives users more control over file access
- Builds trust by limiting plugin scope
- Prevents accidental or malicious file system access

### 5. Limited File System Capabilities

Even with permission, the \`fs\` module has reduced capabilities:
-  Reading and writing files is allowed
-  Advanced operations like modifying file permissions are NOT available

### 6. SystemInfo Interface

For basic system information, use the new \`SystemInfo\` global instead of requiring \`os\` or \`process\`:

\`\`\`javascript
// Available properties:
SystemInfo.platform          // 'win32' | 'darwin' | 'linux'
SystemInfo.home_directory    // 'path/to/home'
SystemInfo.arch             // 'x64' | 'arm64'
SystemInfo.appdata_directory // 'C:\\\\Users\\\\Name\\\\AppData\\\\Roaming'
SystemInfo.os_version       // 'Windows 11 Home', etc.
\`\`\`

## Best Practices for Plugin Development

### 1. Request Permissions On-Demand

**DON'T** request modules during plugin load:
\`\`\`javascript
//  BAD - Bombards user with prompts on install
BBPlugin.register('my_plugin', {
    onload() {
        const fs = requireNativeModule('fs');
        const os = requireNativeModule('os');
        const child_process = requireNativeModule('child_process');
    }
});
\`\`\`

**DO** request when actually needed:
\`\`\`javascript
//  GOOD - User knows why permission is needed
BBPlugin.register('my_plugin', {
    onload() {
        // Setup without requiring modules
    }
});

function exportModel() {
    const fs = requireNativeModule('fs', {
        message: 'File system access needed to save your model.'
    });
    
    if (!fs) {
        Blockbench.showQuickMessage('Export cancelled - file system access denied', 2000);
        return;
    }
    
    // Proceed with export...
}
\`\`\`

### 2. Always Check for undefined

\`\`\`javascript
const os = requireNativeModule('os');

//  ALWAYS check before use
if (!os) {
    console.warn('OS module access denied');
    return;
}

// Now safe to use
const platform = os.platform();
\`\`\`

### 3. Use Scoped Access When Possible

If you only need access to specific directories, use scoped file systems:

\`\`\`javascript
// Instead of full fs access
const project_dir = 'C:/Users/Name/Projects/MyProject';
const scoped_fs = requireNativeModule('fs', {
    scope: project_dir,
    message: 'Access needed to read/write project files in ' + project_dir
});

if (scoped_fs) {
    // Limited to project_dir only - safer!
    scoped_fs.writeFileSync(PathModule.join(project_dir, 'output.json'), data);
}
\`\`\`

### 4. Provide Clear Permission Messages

\`\`\`javascript
const child_process = requireNativeModule('child_process', {
    message: 'This plugin needs to run FFmpeg to encode your animation as a video file.'
});
\`\`\`

### 5. Use SystemInfo for Basic Info

\`\`\`javascript
//  No permission needed
if (SystemInfo.platform === 'win32') {
    // Windows-specific code
}

//  Requires permission unnecessarily
const os = requireNativeModule('os');
if (os?.platform() === 'win32') {
    // Windows-specific code
}
\`\`\`

## Example: Safe Plugin Structure

\`\`\`javascript
BBPlugin.register('safe_exporter', {
    title: 'Safe Model Exporter',
    onload() {
        // Minimal setup - no permissions yet
        new Action('export_custom', {
            name: 'Export Custom Format',
            icon: 'save',
            click: () => this.exportModel()
        });
    },
    
    exportModel() {
        // Request permission only when needed
        const fs = requireNativeModule('fs', {
            message: 'Save your model to disk'
        });
        
        if (!fs) {
            Blockbench.showMessageBox({
                title: 'Permission Required',
                message: 'File system access is required to save the model.'
            });
            return;
        }
        
        // Proceed with export
        try {
            const data = this.generateModelData();
            fs.writeFileSync(this.getExportPath(), data);
            Blockbench.showQuickMessage('Export successful!', 2000);
        } catch (error) {
            console.error('Export failed:', error);
            Blockbench.showQuickMessage('Export failed', 2000);
        }
    }
});
\`\`\`

## Migration from Pre-v5.0 Plugins

| Old (Pre-v5.0) | New (v5.0+) |
|----------------|-------------|
| \`fs.readFileSync()\` | \`const fs = requireNativeModule('fs'); if (fs) fs.readFileSync()\` |
| \`os.platform()\` | \`SystemInfo.platform\` |
| \`process.cwd()\` | Use Blockbench APIs or SystemInfo |
| \`require('path')\` | \`PathModule\` (still global) |
| Module at load time | Module on-demand with permission check |

## Summary Checklist

When using native APIs in Blockbench v5.0 plugins:

- [ ] Use \`requireNativeModule()\` instead of \`require()\`
- [ ] Always check if module is defined before use
- [ ] Request permissions on-demand, not during plugin load
- [ ] Provide clear permission messages
- [ ] Use \`SystemInfo\` for basic system info instead of \`os\`
- [ ] Consider scoped file system access for better security
- [ ] Use \`PathModule\` for path operations (no permission needed)
- [ ] Test with user denying permissions to ensure graceful failures

---

**Remember**: These changes improve user trust and security. Embrace them to build better, safer plugins!
`}}]}}});zQ("blockbench_code_eval_safety",{description:"Critical safety guide for agents using code evaluation/execution tools with Blockbench v5.0+. Contains breaking changes, quick reference, common mistakes, and safe code patterns for native module usage. MUST READ before generating or executing Blockbench plugin code.",argsSchema:F.object({}),async generate(){return{messages:[{role:"user",content:{type:"text",text:await`# Blockbench Code Evaluation Safety Guide

**FOR AGENTS USING CODE EVALUATION TOOLS (e.g., \`risky_eval\`, code execution, REPL tools)**

## Critical Security Changes in Blockbench v5.0+

###  BREAKING: Global Node.js APIs Removed

\`\`\`javascript
//  THESE NO LONGER WORK IN v5.0+
fs.readFileSync()         // undefined
os.platform()             // undefined  
child_process.spawn()     // undefined

//  USE THESE INSTEAD
const fs = requireNativeModule('fs');
SystemInfo.platform
PathModule.join()         // Still global
\`\`\`

## Quick Reference for Code Generation

### File System Operations
\`\`\`javascript
// Always wrap in permission check
const fs = requireNativeModule('fs', {
    message: 'Describe why you need file system access'
});

if (!fs) {
    // User denied - handle gracefully
    return { error: 'File system access denied' };
}

// Now safe to use
fs.writeFileSync(path, data);
\`\`\`

### System Information
\`\`\`javascript
// No permission needed - USE THIS
const platform = SystemInfo.platform;        // 'win32' | 'darwin' | 'linux'
const home = SystemInfo.home_directory;
const arch = SystemInfo.arch;                // 'x64' | 'arm64'
const appdata = SystemInfo.appdata_directory;
const version = SystemInfo.os_version;
\`\`\`

### Path Operations
\`\`\`javascript
// No permission needed - USE THIS
const joined = PathModule.join('path', 'to', 'file');
const dirname = PathModule.dirname(path);
const basename = PathModule.basename(path);
\`\`\`

### Child Process (Requires Permission)
\`\`\`javascript
const child_process = requireNativeModule('child_process', {
    message: 'Execute external commands (e.g., FFmpeg for video encoding)'
});

if (!child_process) {
    return { error: 'Process execution denied' };
}

child_process.spawn('command', ['args']);
\`\`\`

## Module Permission Matrix

| Module | Permission | Alternative |
|--------|-----------|-------------|
| \`path\` |  None | Use \`PathModule\` |
| \`crypto\` |  None | Direct require |
| \`fs\` |  User prompt | \`requireNativeModule('fs')\` |
| \`os\` |  User prompt | Use \`SystemInfo\` instead |
| \`child_process\` |  User prompt | \`requireNativeModule('child_process')\` |
| \`http/https\` |  User prompt | \`requireNativeModule('https')\` |

## Code Generation Template

When generating Blockbench plugin code, use this pattern:

\`\`\`javascript
//  SAFE PATTERN FOR v5.0+
function myFeature() {
    // 1. Check if we need native modules
    const needsFileSystem = true; // or false
    
    if (needsFileSystem) {
        // 2. Request permission with clear message
        const fs = requireNativeModule('fs', {
            message: 'Save configuration to disk'
        });
        
        // 3. Handle denial gracefully
        if (!fs) {
            Blockbench.showQuickMessage('Feature requires file system access', 2000);
            return false;
        }
        
        // 4. Use the module
        try {
            fs.writeFileSync(path, data);
            return true;
        } catch (error) {
            console.error('Failed:', error);
            return false;
        }
    }
    
    // 5. Use SystemInfo for basic system checks
    if (SystemInfo.platform === 'win32') {
        // Windows-specific code
    }
}
\`\`\`

## Common Mistakes to Avoid

###  Don't Do This
\`\`\`javascript
// Requesting at plugin load
BBPlugin.register('my_plugin', {
    onload() {
        const fs = requireNativeModule('fs');
        const os = requireNativeModule('os');
        const cp = requireNativeModule('child_process');
        // Bombards user with 3 permission prompts!
    }
});

// Using without checking
const fs = requireNativeModule('fs');
fs.readFileSync(path); // Crashes if user denied!

// Using old globals
if (process.platform === 'win32') { // undefined in v5.0!
\`\`\`

###  Do This
\`\`\`javascript
// Request on-demand
BBPlugin.register('my_plugin', {
    onload() {
        // Just setup, no permissions yet
        new Action('my_action', {
            click: () => this.doWork()
        });
    },
    
    doWork() {
        // Request only when needed
        const fs = requireNativeModule('fs', {
            message: 'Save your work'
        });
        
        if (!fs) {
            return; // Handle gracefully
        }
        
        // Use safely
        fs.writeFileSync(path, data);
    }
});

// Use SystemInfo instead of process/os
if (SystemInfo.platform === 'win32') {
    // Windows-specific
}
\`\`\`

## Scoped File System (Enhanced Security)

For directory-specific access:

\`\`\`javascript
const project_fs = requireNativeModule('fs', {
    scope: '/path/to/project',
    message: 'Access project files in /path/to/project'
});

if (project_fs) {
    //  Works - inside scope
    project_fs.writeFileSync('/path/to/project/file.json', data);
    
    //  Throws - outside scope  
    project_fs.writeFileSync('/etc/passwd', data);
}
\`\`\`

## Evaluation Safety Checklist

Before running ANY generated code in Blockbench v5.0+:

- [ ] Uses \`requireNativeModule()\` instead of \`require()\` for native modules
- [ ] Checks if module is defined before use (\`if (!module) return\`)
- [ ] Uses \`SystemInfo\` for platform/arch/home instead of \`os\`/\`process\`
- [ ] Uses \`PathModule\` for path operations
- [ ] Requests permissions on-demand, not at plugin load
- [ ] Includes clear permission messages
- [ ] Handles user denial gracefully
- [ ] Avoids direct use of \`fs\`, \`os\`, \`child_process\` globals

## Migration Quick-Fixes

| Old Code | New Code |
|----------|----------|
| \`fs.readFileSync()\` | \`const fs = requireNativeModule('fs'); if (fs) fs.readFileSync()\` |
| \`os.platform()\` | \`SystemInfo.platform\` |
| \`os.homedir()\` | \`SystemInfo.home_directory\` |
| \`process.platform\` | \`SystemInfo.platform\` |
| \`require('path')\` | \`PathModule\` |
| At plugin load | On-demand in action handlers |

---

**Remember**: Code that works in Blockbench 4.x WILL BREAK in 5.0+ if it uses native modules. Always use the new patterns above.
`}}]}}});zQ("model_creation_strategy",{description:"A strategy for creating a new 3D model in Blockbench.",argsSchema:F.object({format:F.enum(["java_block","bedrock"]).optional(),approach:F.enum(["ui","programmatic","import"]).optional()}),async generate({format:Q,approach:W}){let $=[];if(Q==="java_block")$.push(await`Create a new block model for Minecraft: Java Edition.
- Rotations are limited to 22.5 degree steps and one axis per element
- The model is limited to a size of 3 by 3 by 3 blocks. Display settings can make item models larger though
`);if(Q==="bedrock")$.push(await`Create a new block model for Minecraft: Bedrock Edition.
- Size total size of a block is limited to 30 pixels in all dimensions. The limit can be off-centered in all directions by 7 pixels from the block center.
`);if(W==="ui")$.push(await"### Prefer tools, actions, and UI interactivity to assemble models\nWhen creating Blockbench models, use the following MCP tools (if available). They are listed in order of preference.\n\n1. `list_outline` - Check to see what the current project structure is like. This returns the 3D model outline information for the current project.\n2. `create_project` - If no project is open, or if the prompt calls for a new project, create a new project in Blockbench prior to attempting to use other tools.\n3. `add_group` - Organize meshes into bones\n4. `place_cube` - Creates new cube meshes in the project, with optional texture assignment.\n5. `modify_cube` - Edits existing cubes in the current project.\n6. `remove_element` - Removes a mesh from the active project.\n7. `trigger_action` - Dispatches default event for the given Blockbench Action name. Some actions will require follow-up with `fill_dialog` \n8. `fill_dialog` - Attempts to populate and submit form values in the currently open or visible Dialog window\n9. `emulate_clicks` - Attempts to dispatch click events at the given position in the app window.");if(W==="programmatic")$.push(await`### Lean on your programming expertise when creating Blockbench models

- Utilize the \`risky_eval\` MCP tool to call Blockbench, Node.js, Electron, and JavaScript functions and run scripts.
- The MCP server has access to all variables and functions in the global scope.
- Blockbench exposes much of its API functionality on the \`Blockbench\` global variable namespace.
- Functions and classes can be converted to strings and logged to the console to inspect their source to determine how to properly use them.
- The API reference on the [Blockbench Wiki](https://www.blockbench.net/wiki) is incomplete.
- Never use these tools or APIs to make system changes.`);if(W==="import")$.push(await"# Generate valid .geo.json directly\n- Use tool `from_geo_json` to import .geo.json string(s) directly into Blockbench.");return{messages:[{role:"user",content:{type:"text",text:$.join(`
`)}}]}}});class dB{sessions=new Map;listeners=new Set;add(Q){if(this.sessions.has(Q)){this.updateActivity(Q);return}let W={id:Q,connectedAt:new Date,lastActivity:new Date};this.resetTimeout(W),this.sessions.set(Q,W),this.notifyListeners(),console.log(`[MCP] Session connected: ${Q.slice(0,8)}...`)}remove(Q){let W=this.sessions.get(Q);if(!W)return;if(W.timeoutHandle)clearTimeout(W.timeoutHandle);this.sessions.delete(Q),this.notifyListeners(),console.log(`[MCP] Session disconnected: ${Q.slice(0,8)}...`)}updateActivity(Q){let W=this.sessions.get(Q);if(W)W.lastActivity=new Date,this.resetTimeout(W)}updateClientInfo(Q,W,$){let Y=this.sessions.get(Q);if(Y){Y.clientName=W,Y.clientVersion=$,this.notifyListeners();let J=W||Q.slice(0,8)+"...";console.log(`[MCP] Session identified: ${J}${$?` v${$}`:""}`)}}resetTimeout(Q){if(Q.timeoutHandle)clearTimeout(Q.timeoutHandle);Q.timeoutHandle=setTimeout(()=>{console.log(`[MCP] Session timed out: ${Q.id.slice(0,8)}...`),this.remove(Q.id)},300000)}getAll(){return[...this.sessions.values()]}getCount(){return this.sessions.size}has(Q){return this.sessions.has(Q)}subscribe(Q){return this.listeners.add(Q),Q(this.getAll()),()=>this.listeners.delete(Q)}notifyListeners(){let Q=this.getAll();this.listeners.forEach((W)=>{try{W(Q)}catch($){console.error("[MCP] Session listener error:",$)}})}clear(){for(let Q of this.sessions.values())if(Q.timeoutHandle)clearTimeout(Q.timeoutHandle);this.sessions.clear(),this.listeners.clear()}}var z1=new dB;var h6,EQ;function iB(Q){let W=Settings.get("mcp_port")||3000,$=Settings.get("mcp_endpoint")||"/bb-mcp";Blockbench.addCSS("#mcp-status-bar{display:flex;align-items:center;gap:8px;padding:4px 12px;background-color:var(--color-dark);border-block-start:1px solid var(--color-border);font-size:0.85em;user-select:none}#mcp-status-bar .mcp-status-indicator{display:flex;align-items:center;gap:6px;cursor:pointer;padding:2px 8px;border-radius:4px;transition:background-color 0.2s}#mcp-status-bar .mcp-status-indicator:hover{background-color:var(--color-button)}#mcp-status-bar .mcp-status-dot{inline-size:8px;block-size:8px;border-radius:50%;background-color:var(--color-subtle_text);transition:background-color 0.3s}#mcp-status-bar .mcp-status-dot.connected{background-color:#4caf50;box-shadow:0 0 8px rgba(76,175,80,0.6);animation:pulse 2s ease-in-out infinite}#mcp-status-bar .mcp-status-dot.disconnected{background-color:#f44336}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}#mcp-status-bar .mcp-status-text{color:var(--color-text);font-weight:500}#mcp-status-bar .mcp-server-info{color:var(--color-subtle_text);font-size:0.9em;margin-inline-start:4px}"),h6=document.createElement("div"),h6.id="mcp-status-bar";let Y=document.createElement("div");Y.className="mcp-status-indicator",Y.title="Click to view MCP panel";let J=document.createElement("div");J.className="mcp-status-dot";let X=document.createElement("span");X.className="mcp-status-text",X.textContent="MCP Server";let H=document.createElement("span");H.className="mcp-server-info",H.textContent=`(${W}${$})`,Y.appendChild(J),Y.appendChild(X),Y.appendChild(H),h6.appendChild(Y);let G=(K)=>{let V=K.length;if(V>0)J.classList.remove("disconnected"),J.classList.add("connected"),X.textContent=V===1?"MCP Server (1 client)":`MCP Server (${V} clients)`;else J.classList.remove("connected"),J.classList.add("disconnected"),X.textContent="MCP Server"};EQ=z1.subscribe(G),Y.addEventListener("click",()=>{let K=Panels.mcp_panel;if(!K)return;if(K.folded){K.fold(!1);return}if(K.slot==="float")K.moveToFront()});let B=document.getElementById("status_bar");if(!B){console.warn("Could not find status_bar element");return}B.appendChild(h6)}function nB(){if(EQ)EQ(),EQ=void 0;if(h6)h6.remove(),h6=void 0}function PQ(Q){let W=Q._def,$=W.typeName,Y=!1,J=!1,X=W.description,H=void 0,G,B,K,V;if($==="ZodOptional"||$==="ZodNullable"){Y=!0;let U=W.innerType;return{...PQ(U),isOptional:!0}}if($==="ZodDefault"){H=W.defaultValue?.();let U=W.innerType;return{...PQ(U),defaultValue:H,isOptional:!0}}if($==="ZodArray")J=!0,V=W.type;if($==="ZodEnum")G=W.values;if($==="ZodNumber")W.checks?.forEach((q)=>{if(q.kind==="min")B=q.value;if(q.kind==="max")K=q.value});let L="text";switch($){case"ZodString":L="text";break;case"ZodNumber":L="number";break;case"ZodBoolean":L="checkbox";break;case"ZodEnum":L="select";break;case"ZodArray":L="textarea";break;case"ZodObject":L="textarea";break;case"ZodUnion":L="textarea";break;default:L="text"}return{type:L,isOptional:Y,isArray:J,description:X,defaultValue:H,enumValues:G,min:B,max:K,innerType:V}}function HM(Q){let W={};for(let[$,Y]of Object.entries(Q)){let J=PQ(Y),X=Y._def,H={label:`${$}${J.isOptional?"":" *"}`,description:J.description||`Parameter: ${$}`,type:J.type};if(J.defaultValue!==void 0)if(J.type==="textarea")H.value=JSON.stringify(J.defaultValue,null,2);else H.value=J.defaultValue;if(J.description)H.placeholder=J.description;if(J.enumValues){H.options={};for(let G of J.enumValues)H.options[G]=G}if(J.min!==void 0)H.min=J.min;if(J.max!==void 0)H.max=J.max;if(J.type==="textarea"){if(H.height=100,J.isArray)H.placeholder="Enter JSON array, e.g. [1, 2, 3]",H.value=H.value??"[]";else if(X.typeName==="ZodObject")H.placeholder="Enter JSON object",H.value=H.value??"{}"}W[$]=H}return W}function oB(Q,W){let $={};for(let[Y,J]of Object.entries(W)){let X=Q[Y],H=PQ(J);if(H.isOptional&&(X===""||X===void 0||X===null))continue;if(H.type==="textarea"&&typeof X==="string")try{$[Y]=JSON.parse(X)}catch{$[Y]=X}else if(H.type==="number"&&typeof X==="string")$[Y]=parseFloat(X);else $[Y]=X}return $}var F7=null;function rB(Q,W,$){let Y=typeof W==="string"?W:JSON.stringify(W,null,2);F7?.hide(),F7=new Dialog({id:"mcp_tool_result",title:`Result: ${Q}`,width:600,lines:[`<pre style="
        background: var(--color-back);
        padding: 12px;
        border-radius: 4px;
        overflow: auto;
        max-height: 400px;
        white-space: pre-wrap;
        word-break: break-word;
        color: ${$?"var(--color-error)":"var(--color-text)"};
        font-family: var(--font-code);
        font-size: 12px;
      ">${GM(Y)}</pre>`],singleButton:!0,buttons:["Close"]}),F7.show()}function GM(Q){return Q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var V7=null;function aB(Q){let $=SB()[Q];if(!$){Blockbench.showQuickMessage(`Tool "${Q}" not found`,2000);return}V7?.hide();let Y=HM($.inputSchema),J=Object.keys(Y).length>0;V7=new Dialog({id:"mcp_tool_test",title:$.title||Q,width:500,form:J?Y:void 0,lines:J?void 0:['<p style="color: var(--color-subtle_text); font-style: italic;">This tool has no parameters.</p>'],buttons:["Run Tool","Copy Input","Cancel"],confirmIndex:0,cancelIndex:2,onButton(X){if(X===1){let G=this.form?.result??{},B=J?oB(G,$.inputSchema):{},K=JSON.stringify({tool:Q,arguments:B},null,2);return navigator.clipboard.writeText(K).then(()=>{Blockbench.showQuickMessage("Input copied to clipboard",1500)}).catch(()=>{Blockbench.showQuickMessage("Failed to copy to clipboard",1500)}),!1}},async onConfirm(X){let H=J?oB(X,$.inputSchema):{};Blockbench.showQuickMessage("Running tool...",1000);try{let G=await $.execute(H),B;if(typeof G==="string")B=G;else if(G&&typeof G==="object"&&"content"in G)B=G.content.map((V)=>{if(V.type==="text")return V.text;if(V.type==="image")return`[Image: ${V.data?.slice(0,50)}...]`;return JSON.stringify(V)}).join(`
`);else B=G;rB(Q,B,!1)}catch(G){let B=G instanceof Error?G.message:String(G);rB(Q,`Error: ${B}`,!0)}}}),V7.show()}function U7(Q){let W=Q._def,$=W.typeName,Y=!1,J=W.description,X=void 0,H;if($==="ZodOptional"||$==="ZodNullable"){Y=!0;let B=W.innerType;return{...U7(B),isOptional:!0}}if($==="ZodDefault"){X=W.defaultValue?.();let B=W.innerType;return{...U7(B),defaultValue:X,isOptional:!0}}if($==="ZodEnum")H=W.values;let G="text";switch($){case"ZodString":G="text";break;case"ZodNumber":G="number";break;case"ZodBoolean":G="checkbox";break;case"ZodEnum":G="select";break;default:G="text"}return{type:G,isOptional:Y,description:J,defaultValue:X,enumValues:H}}function BM(Q){let W={};for(let[$,Y]of Object.entries(Q)){let J=U7(Y),X={label:`${$}${J.isOptional?"":" *"}`,description:J.description||`Argument: ${$}`,type:J.type};if(J.defaultValue!==void 0)X.value=J.defaultValue;if(J.description)X.placeholder=J.description;if(J.enumValues){X.options={"":"(none)"};for(let H of J.enumValues)X.options[H]=H}W[$]=X}return W}function sB(Q){return Q.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var L7=null;function tB(Q,W,$=!1){L7?.hide(),L7=new Dialog({id:"mcp_prompt_content",title:`Prompt: ${Q}`,width:700,lines:[`<pre style="
        background: var(--color-back);
        padding: 12px;
        border-radius: 4px;
        overflow: auto;
        max-height: 500px;
        white-space: pre-wrap;
        word-break: break-word;
        color: ${$?"var(--color-error)":"var(--color-text)"};
        font-family: var(--font-code);
        font-size: 12px;
        line-height: 1.5;
      ">${sB(W)}</pre>`],buttons:["Copy","Close"],onButton(Y){if(Y===0)return navigator.clipboard.writeText(W).then(()=>{Blockbench.showQuickMessage("Prompt copied to clipboard",1500)}).catch(()=>{Blockbench.showQuickMessage("Failed to copy to clipboard",1500)}),!1}}),L7.show()}var q7=null;function eB(Q){let $=vB()[Q];if(!$){Blockbench.showQuickMessage(`Prompt "${Q}" not found`,2000);return}q7?.hide();let Y=$.argsSchema&&Object.keys($.argsSchema).length>0,J=Y?BM($.argsSchema):{};q7=new Dialog({id:"mcp_prompt_preview",title:$.title||Q,width:500,form:Y?J:void 0,lines:[`<p style="margin-bottom: 12px; color: var(--color-subtle_text);">${sB($.description)}</p>`,...Y?[]:['<p style="color: var(--color-subtle_text); font-style: italic;">This prompt has no arguments.</p>']],buttons:["Generate Prompt","Cancel"],confirmIndex:0,cancelIndex:1,async onConfirm(X){let H={};for(let[G,B]of Object.entries(X))if(B!==""&&B!==void 0&&B!==null)H[G]=B;Blockbench.showQuickMessage("Generating prompt...",1000);try{let B=(await $.generate(H)).messages.map((K)=>{let V=K.role==="user"?"User":"Assistant",L=typeof K.content==="string"?K.content:K.content.text;return`[${V}]
${L}`}).join(`

---

`);tB(Q,B)}catch(G){let B=G instanceof Error?G.message:String(G);tB(Q,`Error: ${B}`,!0)}}}),q7.show()}var A7,RQ;function QK({server:Q,tools:W,resources:$,prompts:Y}){return Blockbench.addCSS(".mcp-panel{display:grid;grid-template-rows:auto 1fr auto;max-block-size:66vh;overflow:auto;padding:10px;details{overflow:auto}summary{cursor:pointer}dl{display:grid;grid-template-columns:1fr 1fr;grid-auto-flow:row;margin:0;padding:0;dt{font-size:0.825em;font-weight:bold;grid-column:1;margin:0;padding:0}dd{grid-column:2;margin:0;padding:0}}.stable{border:1px solid green;border-radius:4px;background:hsla(from green h 90% 80% / 0.5);color:hsl(from green h 30% 20%)}.experimental{border:1px solid orange;border-radius:4px;background:hsla(from orange h 90% 80% / 0.5);color:hsl(from orange h 30% 20%)}.tool-toggle-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--color-border)}.tool-toggle-row:last-child{border-bottom:none}.tool-toggle-row.clickable{cursor:pointer;padding:8px;margin:0 -8px;border-radius:4px;transition:background-color 0.15s ease}.tool-toggle-row.clickable:hover{background-color:var(--color-button)}.tool-toggle-row.clickable:active{background-color:var(--color-accent)}.tool-toggle-row.clickable .tool-name::after{content:\"chevron_right\";font-family:\"Material Icons\";font-size:16px;margin-left:4px;opacity:0.5;vertical-align:middle}.tool-info{flex:1;min-width:0}.tool-name{font-weight:bold;font-size:0.9em;margin-bottom:2px}.tool-description{font-size:0.8em;color:var(--color-subtle_text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tool-description+.tool-description{margin-top:4px}.tool-toggle{margin-left:12px;flex-shrink:0;label{font-size:0.9em}}.tool-status{display:inline-block;padding:2px 4px;border-radius:3px;font-size:0.666em;font-weight:bold;text-transform:uppercase;margin-left:8px}.session-item{display:flex;align-items:center;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--color-border);font-size:0.85em}.session-item:last-child{border-bottom:none}.session-id{font-family:monospace;color:var(--color-text)}.session-time{color:var(--color-subtle_text);font-size:0.9em}.no-sessions{color:var(--color-subtle_text);font-style:italic;padding:8px 0}}"),iB(Q),A7=new Panel("mcp_panel",{id:"mcp_panel",icon:"robot",name:"MCP",default_side:"right",resizable:!0,component:{mounted(){let J=this;RQ=z1.subscribe((X)=>{J.sessions=X.map((H)=>({id:H.id,connectedAt:H.connectedAt,lastActivity:H.lastActivity,clientName:H.clientName,clientVersion:H.clientVersion})),J.server.connected=X.length>0})},beforeDestroy(){if(RQ)RQ(),RQ=void 0},data:()=>({sessions:[],server:{connected:!1,name:"Blockbench MCP",version:u6},tools:Object.values(W).map((J)=>({name:J.name,description:J.description,enabled:J.enabled,status:J.status})),resources:Object.values($).map((J)=>({name:J.name,description:J.description,uriTemplate:J.uriTemplate})),prompts:Object.values(Y).map((J)=>({name:J.name,description:J.description,enabled:J.enabled,status:J.status,argumentCount:Object.keys(J.arguments).length}))}),methods:{getDisplayName(J){return J.replace("blockbench_","")},formatSessionId(J){if(J.clientName)return J.clientVersion?`${J.clientName} v${J.clientVersion}`:J.clientName;return J.id.slice(0,8)+"..."},formatTime(J){return new Date(J).toLocaleTimeString()},openToolTest(J){aB(J)},openPromptPreview(J){eB(J)}},name:"mcp_panel",template:`<div class="mcp-panel"><details name="mcp_panel" open><summary>Sessions ({{sessions.length}})</summary><div v-if="sessions.length > 0"><div v-for="session in sessions" :key="session.id" class="session-item" :title="session.id"><span class="session-id">{{formatSessionId(session)}}</span><span class="session-time">{{formatTime(session.connectedAt)}}</span></div></div><div v-else class="no-sessions"> No clients connected </div></details><details name="mcp_panel"><summary>Server</summary><dl><dt>Server Name</dt><dd>{{server.name}}</dd><dt>Server Version</dt><dd>{{server.version}}</dd><dt>Connected Clients</dt><dd>{{sessions.length}}</dd></dl></details><details name="mcp_panel"><summary>Tools</summary><div v-if="tools.length > 0"><div v-for="tool in tools" :key="tool.name" class="tool-toggle-row clickable" @click="openToolTest(tool.name)" :title="'Click to test ' + getDisplayName(tool.name)"><div class="tool-info"><div class="tool-name"> {{getDisplayName(tool.name)}} <span :class="['tool-status', tool.status]">{{tool.status}}</span></div><div class="tool-description" :title="tool.description">{{tool.description}}</div></div></div></div><div v-else><p>No tools available.</p></div></details><details name="mcp_panel"><summary>Resources</summary><div v-if="resources.length > 0"><div v-for="resource in resources" :key="resource.name" class="tool-toggle-row"><div class="tool-info"><div class="tool-name">{{getDisplayName(resource.name)}}</div><div class="tool-description" :title="resource.description">{{resource.description}}</div><div class="tool-description" style="font-style: italic; margin-top: 2px;" :title="resource.uriTemplate">{{resource.uriTemplate}}</div></div></div></div><div v-else><p>No resources available.</p></div></details><details name="mcp_panel"><summary>Prompts</summary><div v-if="prompts.length > 0"><div v-for="prompt in prompts" :key="prompt.name" class="tool-toggle-row clickable" @click="openPromptPreview(prompt.name)" :title="'Click to preview ' + getDisplayName(prompt.name)"><div class="tool-info"><div class="tool-name"> {{getDisplayName(prompt.name)}} <span :class="['tool-status', prompt.status]">{{prompt.status}}</span></div><div class="tool-description" :title="prompt.description">{{prompt.description}}</div><div v-if="prompt.argumentCount > 0" class="tool-description" style="font-style: italic; margin-top: 2px;"> {{prompt.argumentCount}} argument{{prompt.argumentCount > 1 ? 's' : ''}} </div></div></div></div><div v-else><p>No prompts available.</p></div></details></div>`},expand_button:!0}),A7}function WK(){nB(),A7?.delete()}var $K=[];function D7(){$K.push(new Setting("mcp_instructions",{name:"MCP System Instructions",description:"Instructions for the MCP system.",type:"text",value:"Generate simple, low-poly models for Minecraft inside Blockbench.",category:"general",icon:"psychology"}),new Setting("mcp_port",{name:"MCP Server Port",description:"Port for the MCP server.",type:"number",value:3000,category:"general",icon:"numbers"}),new Setting("mcp_endpoint",{name:"MCP Server Endpoint",description:"Endpoint for the MCP server.",type:"text",value:"/bb-mcp",category:"general",icon:"webhook"}))}function O7(){$K.forEach((Q)=>{Q.delete()})}class w7{constructor(Q={}){this._started=!1,this._streamMapping=new Map,this._requestToStreamMapping=new Map,this._requestResponseMap=new Map,this._initialized=!1,this._enableJsonResponse=!1,this._standaloneSseStreamId="_GET_stream",this.sessionIdGenerator=Q.sessionIdGenerator,this._enableJsonResponse=Q.enableJsonResponse??!1,this._eventStore=Q.eventStore,this._onsessioninitialized=Q.onsessioninitialized,this._onsessionclosed=Q.onsessionclosed,this._allowedHosts=Q.allowedHosts,this._allowedOrigins=Q.allowedOrigins,this._enableDnsRebindingProtection=Q.enableDnsRebindingProtection??!1,this._retryInterval=Q.retryInterval}async start(){if(this._started)throw Error("Transport already started");this._started=!0}createJsonErrorResponse(Q,W,$,Y){let J={code:W,message:$};if(Y?.data!==void 0)J.data=Y.data;return new Response(JSON.stringify({jsonrpc:"2.0",error:J,id:null}),{status:Q,headers:{"Content-Type":"application/json",...Y?.headers}})}validateRequestHeaders(Q){if(!this._enableDnsRebindingProtection)return;if(this._allowedHosts&&this._allowedHosts.length>0){let W=Q.headers.get("host");if(!W||!this._allowedHosts.includes(W)){let $=`Invalid Host header: ${W}`;return this.onerror?.(Error($)),this.createJsonErrorResponse(403,-32000,$)}}if(this._allowedOrigins&&this._allowedOrigins.length>0){let W=Q.headers.get("origin");if(W&&!this._allowedOrigins.includes(W)){let $=`Invalid Origin header: ${W}`;return this.onerror?.(Error($)),this.createJsonErrorResponse(403,-32000,$)}}return}async handleRequest(Q,W){let $=this.validateRequestHeaders(Q);if($)return $;switch(Q.method){case"POST":return this.handlePostRequest(Q,W);case"GET":return this.handleGetRequest(Q);case"DELETE":return this.handleDeleteRequest(Q);default:return this.handleUnsupportedRequest()}}async writePrimingEvent(Q,W,$,Y){if(!this._eventStore)return;if(Y<"2025-11-25")return;let J=await this._eventStore.storeEvent($,{}),X=`id: ${J}
data: 

`;if(this._retryInterval!==void 0)X=`id: ${J}
retry: ${this._retryInterval}
data: 

`;Q.enqueue(W.encode(X))}async handleGetRequest(Q){if(!Q.headers.get("accept")?.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32000,"Not Acceptable: Client must accept text/event-stream");let $=this.validateSession(Q);if($)return $;let Y=this.validateProtocolVersion(Q);if(Y)return Y;if(this._eventStore){let B=Q.headers.get("last-event-id");if(B)return this.replayEvents(B)}if(this._streamMapping.get(this._standaloneSseStreamId)!==void 0)return this.createJsonErrorResponse(409,-32000,"Conflict: Only one SSE stream is allowed per session");let J=new TextEncoder,X,H=new ReadableStream({start:(B)=>{X=B},cancel:()=>{this._streamMapping.delete(this._standaloneSseStreamId)}}),G={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};if(this.sessionId!==void 0)G["mcp-session-id"]=this.sessionId;return this._streamMapping.set(this._standaloneSseStreamId,{controller:X,encoder:J,cleanup:()=>{this._streamMapping.delete(this._standaloneSseStreamId);try{X.close()}catch{}}}),new Response(H,{headers:G})}async replayEvents(Q){if(!this._eventStore)return this.createJsonErrorResponse(400,-32000,"Event store not configured");try{let W;if(this._eventStore.getStreamIdForEventId){if(W=await this._eventStore.getStreamIdForEventId(Q),!W)return this.createJsonErrorResponse(400,-32000,"Invalid event ID format");if(this._streamMapping.get(W)!==void 0)return this.createJsonErrorResponse(409,-32000,"Conflict: Stream already has an active connection")}let $={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};if(this.sessionId!==void 0)$["mcp-session-id"]=this.sessionId;let Y=new TextEncoder,J,X=new ReadableStream({start:(G)=>{J=G},cancel:()=>{}}),H=await this._eventStore.replayEventsAfter(Q,{send:async(G,B)=>{if(!this.writeSSEEvent(J,Y,B,G)){this.onerror?.(Error("Failed replay events"));try{J.close()}catch{}}}});return this._streamMapping.set(H,{controller:J,encoder:Y,cleanup:()=>{this._streamMapping.delete(H);try{J.close()}catch{}}}),new Response(X,{headers:$})}catch(W){return this.onerror?.(W),this.createJsonErrorResponse(500,-32000,"Error replaying events")}}writeSSEEvent(Q,W,$,Y){try{let J=`event: message
`;if(Y)J+=`id: ${Y}
`;return J+=`data: ${JSON.stringify($)}

`,Q.enqueue(W.encode(J)),!0}catch{return!1}}handleUnsupportedRequest(){return new Response(JSON.stringify({jsonrpc:"2.0",error:{code:-32000,message:"Method not allowed."},id:null}),{status:405,headers:{Allow:"GET, POST, DELETE","Content-Type":"application/json"}})}async handlePostRequest(Q,W){try{let $=Q.headers.get("accept");if(!$?.includes("application/json")||!$.includes("text/event-stream"))return this.createJsonErrorResponse(406,-32000,"Not Acceptable: Client must accept both application/json and text/event-stream");let Y=Q.headers.get("content-type");if(!Y||!Y.includes("application/json"))return this.createJsonErrorResponse(415,-32000,"Unsupported Media Type: Content-Type must be application/json");let J={headers:Object.fromEntries(Q.headers.entries())},X;if(W?.parsedBody!==void 0)X=W.parsedBody;else try{X=await Q.json()}catch{return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON")}let H;try{if(Array.isArray(X))H=X.map((O)=>n$.parse(O));else H=[n$.parse(X)]}catch{return this.createJsonErrorResponse(400,-32700,"Parse error: Invalid JSON-RPC message")}let G=H.some(o$);if(G){if(this._initialized&&this.sessionId!==void 0)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Server already initialized");if(H.length>1)return this.createJsonErrorResponse(400,-32600,"Invalid Request: Only one initialization request is allowed");if(this.sessionId=this.sessionIdGenerator?.(),this._initialized=!0,this.sessionId&&this._onsessioninitialized)await Promise.resolve(this._onsessioninitialized(this.sessionId))}if(!G){let O=this.validateSession(Q);if(O)return O;let w=this.validateProtocolVersion(Q);if(w)return w}if(!H.some($6)){for(let O of H)this.onmessage?.(O,{authInfo:W?.authInfo,requestInfo:J});return new Response(null,{status:202})}let K=crypto.randomUUID(),V=H.find((O)=>o$(O)),L=V?V.params.protocolVersion:Q.headers.get("mcp-protocol-version")??NX;if(this._enableJsonResponse)return new Promise((O)=>{this._streamMapping.set(K,{resolveJson:O,cleanup:()=>{this._streamMapping.delete(K)}});for(let w of H)if($6(w))this._requestToStreamMapping.set(w.id,K);for(let w of H)this.onmessage?.(w,{authInfo:W?.authInfo,requestInfo:J})});let U=new TextEncoder,q,A=new ReadableStream({start:(O)=>{q=O},cancel:()=>{this._streamMapping.delete(K)}}),D={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};if(this.sessionId!==void 0)D["mcp-session-id"]=this.sessionId;for(let O of H)if($6(O))this._streamMapping.set(K,{controller:q,encoder:U,cleanup:()=>{this._streamMapping.delete(K);try{q.close()}catch{}}}),this._requestToStreamMapping.set(O.id,K);await this.writePrimingEvent(q,U,K,L);for(let O of H){let w,j;if($6(O)&&this._eventStore&&L>="2025-11-25")w=()=>{this.closeSSEStream(O.id)},j=()=>{this.closeStandaloneSSEStream()};this.onmessage?.(O,{authInfo:W?.authInfo,requestInfo:J,closeSSEStream:w,closeStandaloneSSEStream:j})}return new Response(A,{status:200,headers:D})}catch($){return this.onerror?.($),this.createJsonErrorResponse(400,-32700,"Parse error",{data:String($)})}}async handleDeleteRequest(Q){let W=this.validateSession(Q);if(W)return W;let $=this.validateProtocolVersion(Q);if($)return $;return await Promise.resolve(this._onsessionclosed?.(this.sessionId)),await this.close(),new Response(null,{status:200})}validateSession(Q){if(this.sessionIdGenerator===void 0)return;if(!this._initialized)return this.createJsonErrorResponse(400,-32000,"Bad Request: Server not initialized");let W=Q.headers.get("mcp-session-id");if(!W)return this.createJsonErrorResponse(400,-32000,"Bad Request: Mcp-Session-Id header is required");if(W!==this.sessionId)return this.createJsonErrorResponse(404,-32001,"Session not found");return}validateProtocolVersion(Q){let W=Q.headers.get("mcp-protocol-version");if(W!==null&&!a4.includes(W))return this.createJsonErrorResponse(400,-32000,`Bad Request: Unsupported protocol version: ${W} (supported versions: ${a4.join(", ")})`);return}async close(){this._streamMapping.forEach(({cleanup:Q})=>{Q()}),this._streamMapping.clear(),this._requestResponseMap.clear(),this.onclose?.()}closeSSEStream(Q){let W=this._requestToStreamMapping.get(Q);if(!W)return;let $=this._streamMapping.get(W);if($)$.cleanup()}closeStandaloneSSEStream(){let Q=this._streamMapping.get(this._standaloneSseStreamId);if(Q)Q.cleanup()}async send(Q,W){let $=W?.relatedRequestId;if(g1(Q)||G4(Q))$=Q.id;if($===void 0){if(g1(Q)||G4(Q))throw Error("Cannot send a response on a standalone SSE stream unless resuming a previous client request");let X;if(this._eventStore)X=await this._eventStore.storeEvent(this._standaloneSseStreamId,Q);let H=this._streamMapping.get(this._standaloneSseStreamId);if(H===void 0)return;if(H.controller&&H.encoder)this.writeSSEEvent(H.controller,H.encoder,Q,X);return}let Y=this._requestToStreamMapping.get($);if(!Y)throw Error(`No connection established for request ID: ${String($)}`);let J=this._streamMapping.get(Y);if(!this._enableJsonResponse&&J?.controller&&J?.encoder){let X;if(this._eventStore)X=await this._eventStore.storeEvent(Y,Q);this.writeSSEEvent(J.controller,J.encoder,Q,X)}if(g1(Q)||G4(Q)){this._requestResponseMap.set($,Q);let X=Array.from(this._requestToStreamMapping.entries()).filter(([G,B])=>B===Y).map(([G])=>G);if(X.every((G)=>this._requestResponseMap.has(G))){if(!J)throw Error(`No connection established for request ID: ${String($)}`);if(this._enableJsonResponse&&J.resolveJson){let G={"Content-Type":"application/json"};if(this.sessionId!==void 0)G["mcp-session-id"]=this.sessionId;let B=X.map((K)=>this._requestResponseMap.get(K));if(B.length===1)J.resolveJson(new Response(JSON.stringify(B[0]),{status:200,headers:G}));else J.resolveJson(new Response(JSON.stringify(B),{status:200,headers:G}))}else J.cleanup();for(let G of X)this._requestResponseMap.delete(G),this._requestToStreamMapping.delete(G)}}}}function YK(Q){return{200:"OK",201:"Created",204:"No Content",400:"Bad Request",404:"Not Found",405:"Method Not Allowed",500:"Internal Server Error"}[Q]||"Unknown"}function N7({createServer:Q},{port:W,endpoint:$}){let Y=new Map,J=Q((X)=>{let H=Buffer.alloc(0);X.on("data",(V)=>{H=Buffer.concat([H,V]),G().catch((L)=>{if(console.error("[MCP] Unhandled error in processHttpRequests:",L),!X.destroyed)try{K(X,500,{"content-type":"application/json"},JSON.stringify({error:"Internal server error"}),void 0)}catch(U){console.error("[MCP] Failed to send error response:",U),X.destroy()}})}),X.on("error",(V)=>{if(V.message!=="read ECONNRESET")console.error("[MCP] Socket error:",V.message);X.destroy()}),X.on("close",()=>{H=Buffer.alloc(0)});async function G(){while(!0){let V=H.indexOf(`\r
\r
`);if(V===-1)return;let U=H.subarray(0,V).toString().split(`\r
`),[q,A]=U[0].split(" "),D={};for(let M0=1;M0<U.length;M0++){let P0=U[M0].indexOf(":");if(P0>0){let f0=U[M0].substring(0,P0).trim().toLowerCase(),p1=U[M0].substring(P0+1).trim();D[f0]=p1}}let O=V+4,w=parseInt(D["content-length"]||"0",10),j=O+w;if(H.length<j)return;let z=H.subarray(O,j).toString();H=H.subarray(j);let C=`http://localhost:${W}${A}`,S=new Headers;for(let[M0,P0]of Object.entries(D))S.set(M0,P0);let D0={method:q,headers:S};if(q!=="GET"&&q!=="HEAD"&&z)D0.body=z;let b0=new Request(C,D0);if(A.split("?")[0]!==$&&!A.startsWith($+"/")&&!A.startsWith($+"?")){K(X,404,{"content-type":"text/plain"},"Not Found",D.connection);continue}try{let M0=D["mcp-session-id"],P0=M0?Y.get(M0):null;if(!P0){let a0=T9();IB(a0),ZB(a0),TB(a0);let f6=new w7({sessionIdGenerator:()=>crypto.randomUUID(),enableJsonResponse:!0,onsessioninitialized:(W1)=>{console.log(`[MCP] Session initialized: ${W1.slice(0,8)}...`),z1.add(W1);let C4=Y.get("__pending__");if(C4){Y.delete("__pending__"),Y.set(W1,C4);let y9=C4.server.server;y9.oninitialized=()=>{let IQ=y9.getClientVersion();if(IQ)z1.updateClientInfo(W1,IQ.name,IQ.version)}}},onsessionclosed:(W1)=>{console.log(`[MCP] Session closed: ${W1.slice(0,8)}...`),z1.remove(W1),Y.delete(W1)}});if(await a0.connect(f6),P0={transport:f6,server:a0},!M0)Y.set("__pending__",P0)}if(M0)z1.updateActivity(M0);let f0=await P0.transport.handleRequest(b0);console.log(`[MCP] Response: ${f0.status} ${f0.headers.get("content-type")}`);let p1={};if(f0.headers.forEach((a0,f6)=>{p1[f6]=a0}),(f0.headers.get("content-type")||"").includes("text/event-stream"))if(B(X,f0.status,p1),f0.body){let a0=f0.body.getReader(),f6=new TextDecoder;try{while(!0){let{done:W1,value:C4}=await a0.read();if(W1)break;let y9=f6.decode(C4,{stream:!0});X.write(y9)}}catch(W1){console.error("[MCP] SSE stream error:",W1)}finally{X.end()}}else X.end();else{let a0=await f0.text();K(X,f0.status,p1,a0,D.connection)}}catch(M0){console.error("[MCP] Request handler error:",M0),K(X,500,{"content-type":"application/json"},JSON.stringify({error:String(M0)}),D.connection)}}}function B(V,L,U){let q=`HTTP/1.1 ${L} ${YK(L)}\r
`;delete U["content-length"],U["cache-control"]="no-cache",U.connection="keep-alive";for(let[A,D]of Object.entries(U))q+=`${A}: ${D}\r
`;q+=`\r
`,V.write(q)}function K(V,L,U,q,A){let D=`HTTP/1.1 ${L} ${YK(L)}\r
`;if(!U["content-length"])U["content-length"]=Buffer.byteLength(q).toString();for(let[O,w]of Object.entries(U))D+=`${O}: ${w}\r
`;if(D+=`\r
`,D+=q,V.write(D),A?.toLowerCase()!=="keep-alive")V.end()}});return J.listen(W,()=>{console.log(`[MCP] Server listening on http://localhost:${W}${$}`)}),J.on("error",(X)=>{console.error("[MCP] Server error:",X),Blockbench.showQuickMessage(`MCP Server error: ${X.message}`,3000)}),[J,Y]}var bQ=null,M7=null;BBPlugin.register("mcp",{version:u6,title:"MCP Server",author:"Jason J. Gardner",description:"Create an MCP server inside Blockbench.",tags:["MCP","AI"],icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMzMuODkgMzcyLjg0Ij48cGF0aCBkPSJNMjU5LjU0LDc0LjI0YzYwLjcxLTcuNDEsOTcuNTYsNjIuMDYsNTYuNCwxMDguOWwtMTM0LjQzLDEzMy44MWMtMS4wOSwyLjExLTEuNjUsNC44NC0uMDIsNi44NWwyOS4zLDI5LjdjNC43OCwxMi41LTYuMDUsMjMuMDktMTguMTMsMTcuMTMtMy43Ny0xLjg2LTI3LjM1LTI1LjU5LTMwLjkyLTMwLjA0LTEwLjM1LTEyLjkzLTkuNjEtMjguMDQuMTUtNDEuMDFsMTM3LjQ2LTEzNi45OWMyOC42My0zOC45OS0yMi4yOS04NS4wOC01OC4zNC01Mi4zOGwtMTExLjk3LDExMi4wM2MtMTIuMzIsOC4wMS0yNS43Mi03Ljg0LTE3LjAzLTE5LjAzbDExNC40OC0xMTQuNzRjMjYuOTItMzguNjEtMjEuMDUtODIuNzItNTcuNjEtNTEuODlMMjEuOTIsMTg0LjA3Yy0xNC42MywxMC4xLTI5LjQzLTguMzQtMTYuNC0yMC4zNUwxNTcuNjMsMTIuODJjMzQuMTMtMjUuNDcsODQuNjEtOS41NCw5OC42OSwzMC4xNC41NSwxLjU1LDMuMjMsMTAuMDMsMy4yMywxMC43N3YyMC41WiIgc3R5bGU9ImZpbGw6Izc4Nzg3ODsgc3Ryb2tlOiNmZmY7IHN0cm9rZS1taXRlcmxpbWl0OjEwOyIvPjxwYXRoIGQ9Ik0yMDEuOTYsNzYuNjVjLTMwLjk1LDMzLjY3LTY1Ljk5LDYzLjg3LTk3LjQ3LDk3LjAzLTcuMjgsNy42Ny0xNC44LDE0Ljg2LTE3LjQ4LDI1LjUyLTkuODQsMzkuMTcsMzcuNzcsNjQuNjUsNjYuMDYsMzYuMDZsMTA5LjEtMTA4LjljMTEuODktNS41MywyNC4xNyw2LjQ0LDE3LjIyLDE4LjIybC0xMTcuMzMsMTE2LjY3Yy02NC4xOSw0My40My0xMzYuNy0zNy40MS04NC41Ny05Ni41NCwzMy4yMi0zNy42OCw3NC45OC03MS42NSwxMDkuMTMtMTA4Ljg5LDExLTEwLjAxLDI2LjY3LDEuOTYsMjAuMywxNS4zMS0xLjEsMi4zMS0zLjQxLDMuODEtNC45OCw1LjUyWiIgc3R5bGU9ImZpbGw6Izc4Nzg3ODsgc3Ryb2tlOiNmZmY7IHN0cm9rZS1taXRlcmxpbWl0OjEwOyIvPjwvc3ZnPg==",variant:"desktop",async onload(){let Q=requireNativeModule("net",{message:"Network access is required for the MCP server to accept connections.",detail:"The MCP plugin needs to create a local server that AI assistants can connect to.",optional:!1});if(!Q){console.error("[MCP] Failed to get net module - server will not start"),Blockbench.showQuickMessage("MCP Server requires network permission",3000);return}D7(),[bQ,M7]=N7(Q,{port:Number(Settings.get("mcp_port")||3000),endpoint:String(Settings.get("mcp_endpoint")||"/bb-mcp")});let W=T9();QK({server:W,tools:_6,resources:b4,prompts:x6})},onunload(){if(bQ)bQ.close(),bQ=null;let Q=Array.from(M7?.values()??[]);for(let W of Q)W.transport.close();M7?.clear(),z1.clear(),WK(),O7()},oninstall(){Blockbench.showQuickMessage("Installed MCP Server plugin",2000),D7()},onuninstall(){Blockbench.showQuickMessage("Uninstalled MCP Server plugin",2000),O7()}});
